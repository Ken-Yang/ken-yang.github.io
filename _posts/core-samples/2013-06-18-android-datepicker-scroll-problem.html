---
layout: post
title: Android DatePicker scroll problem.
date: '2013-06-18T11:34:00.000+08:00'
author: Ken Yang
tags:
- datepicker
- android
modified_time: '2013-06-18T11:41:02.293+08:00'
thumbnail: http://4.bp.blogspot.com/-2NithchKCw8/Ub_SFw-EClI/AAAAAAAAEy4/BDCPKYAElb8/s72-c/Screenshot_2013-06-18-11-18-47.png
blogger_id: tag:blogger.com,1999:blog-866973865356001297.post-1386008704358630130
blogger_orig_url: http://blog.kenyang.net/2013/06/android-datepicker-scroll-problem.html
---

在Android 4.0.4機器上的&nbsp;DatePicker<b><span style="font-size: large;">一定</span></b>會發生scroll的小問題，<br />（但是4.2.3不會發生！而我推測或許3.x以上～4.0.4以下的device都會發生）<br /><br /><br />如下圖，<br />你會發現經過scrolling以後，在年/月/日的三個欄位，位置都怪怪的<br />原因是因為在做position時，那個event是被parent截取到！<br />但理應上應該是DatePicker截取到才對！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-2NithchKCw8/Ub_SFw-EClI/AAAAAAAAEy4/BDCPKYAElb8/s1600/Screenshot_2013-06-18-11-18-47.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://4.bp.blogspot.com/-2NithchKCw8/Ub_SFw-EClI/AAAAAAAAEy4/BDCPKYAElb8/s640/Screenshot_2013-06-18-11-18-47.png" width="360" /></a></div><br /><br />所以workaround就是，自己定義一個class，以及extend DatePicker！<br />然後去取消parent截取event！<br /><br /><pre class="brush: java">public class CustomDatePicker extends DatePicker {<br />    <br />    public CustomDatePicker(Context context, AttributeSet attrs) {<br />        super(context, attrs);<br />    }<br /><br />    public CustomDatePicker(Context context) {<br />        super(context);<br />    }<br /><br />    @SuppressLint("NewApi")<br />    @Override<br />    public boolean onInterceptTouchEvent(MotionEvent ev) {<br />        /*<br />         * Prevent parent component intercept touch event.<br />         * because only happened on Android 3.x ~ 4.0.4, so we need to check the current os version.<br />         */<br />        if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.HONEYCOMB){<br />            if (ev.getActionMasked() == MotionEvent.ACTION_DOWN) {<br />                ViewParent p = getParent();<br />                if (p != null){<br />                    // disallow its parent intercept touch event.<br />                    p.requestDisallowInterceptTouchEvent(true);<br />                }<br />            }<br />        }<br /><br />        return false;<br />    }<br /><br />}<br /></pre><br /><br />而使用方式就是在你的layout.xml中指定我們上方定義的class，<br /><pre class="brush: xml">&lt;view android:id="@+id/share_expires" <br />     android:layout_width="fill_parent" <br />     android:visibility="gone"<br />     android:layout_height="wrap_content" <br />     class="net.kenyang.util.CustomDatePicker" &gt;<br /> &lt;/view&gt;  <br /></pre><br /><br />這樣就能解決scrolling的問題！<br /><br />