---
layout: post
title: BroadcastReceiver trigger ANR
date: '2010-09-10T00:44:00.000+08:00'
author: Ken Yang
tags:
- broadcast receiver
- android
modified_time: '2010-11-06T16:51:37.509+08:00'
blogger_id: tag:blogger.com,1999:blog-866973865356001297.post-9091350449025002491
blogger_orig_url: http://blog.kenyang.net/2010/09/broadcastreceiver-trigger-anr.html
---

<span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">BroadcastReceiver trigger &nbsp;ANR</span></span><br /><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">今天發現某支app丟出了一個ANR!</span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">看了一下LOG!</span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">發現是由</span></span><span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver丟出來的!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">看了一下官方ANR的有關說明!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">才發現!!!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 10.8333px; line-height: 16px;"><span class="Apple-style-span" style="color: red;">A&nbsp;</span><code style="font-family: monospace; line-height: 1em;"><a href="http://developer.android.com/reference/android/content/BroadcastReceiver.html"><span class="Apple-style-span" style="color: red;">BroadcastReceiver</span></a></code><span class="Apple-style-span" style="color: red;">&nbsp;hasn't finished executing within 10 seconds</span></span></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">原來一個</span><span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver要在十秒之內完成，否則會丟出一個ANR!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div>雖然我知道一個long operation盡量在service中完成，</div><div><br /></div><div>但我不知道<span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver的限制time out 這麼短!!!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div>在<span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver的說明文件中也有提到!</span></div><div><br /></div><div><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 10.8333px; line-height: 16px;"><span class="Apple-style-span" style="color: red;">(there is a timeout of 10 seconds that the system allows before considering the receiver to be blocked and a candidate to be killed</span></span></div><div><br /></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">所以大家在send&nbsp;</span><span class="Apple-style-span" style="font-size: 15.8333px;">Broadcast，大家要注意一下了!!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div>