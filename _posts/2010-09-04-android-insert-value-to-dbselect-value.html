---
layout: post
title: android DB on SD Card 新增、查詢（DB 2/2）
date: '2010-09-04T12:46:00.000+08:00'
author: Ken Yang
tags:
- sdcard
- android
- db
modified_time: '2010-11-06T16:54:04.043+08:00'
blogger_id: tag:blogger.com,1999:blog-866973865356001297.post-6443257651080097011
blogger_orig_url: http://blog.kenyang.net/2010/09/android-insert-value-to-dbselect-value.html
---

android insert value to DB、select value from DB<br /><br />這篇文章會介紹<br /><br />如何新增資料到sqllite database，並在database作查詢等動作<br /><br /><a href="http://ken-note.blogspot.com/2010/09/android-create-db-on-sdcard.html">上一篇已經介紹如何在sd card新增資料庫</a><br /><br />這裡就只略過如何新增資料庫，直接說明新增and查詢的動作<br /><br /><pre class="brush: java">public class db_sample {<br /> public static final String STR_TABLE_NAME    = "table_name"; //table名稱<br /> public static final String STR_FIELD_ID     = "field_id";  //欄位名稱 <br /> public static final String STR_FIELD_NAME    = "field_name"; //欄位名稱<br /> private static Context context;         <br /> <br /> public db_sample(Context context) {<br />  this.context = context; //new這個class時，一定要傳入context，因為openOrCreateDatabase是由context底下的method<br /> }<br /> <br /> //建立table的method<br /> public static final void fnCreateDB(){<br />  //MODE_WORLD_WRITEABLE，只能有寫的權限<br />  SQLiteDatabase dbwrite <br />      = context.openOrCreateDatabase("/sdcard/hi_test.db", context.MODE_WORLD_WRITEABLE, null);<br />  <br />  //建立table<br />  String sql = <br />    String.format("CREATE TABLE %s (%s INTEGER primary key autoincrement, %s text )"<br />        , STR_TABLE_NAME  <br />        , STR_FIELD_ID    <br />        , STR_FIELD_NAME   <br />    ); <br />  dbwrite.execSQL(sql);<br /> }<br /> <br /> //新增資料的method<br /> public static final long fnInsert(String strText){<br />  SQLiteDatabase dbwrite <br />      = context.openOrCreateDatabase("/sdcard/hi_test.db", context.MODE_WORLD_WRITEABLE, null);<br />  ContentValues cv = new ContentValues();<br />  cv.put(STR_FIELD_NAME, strText);<br />  return dbwrite.insert(STR_TABLE_NAME, null, cv);//如果return -1代表有錯誤，否則會return該筆資料在第幾列<br /> }<br /> <br /> //撈資料的method<br /> public  static final int fnRead(String strText){<br />  //MODE_WORLD_WRITEABLE，只能有讀取的權限<br />  SQLiteDatabase dbread <br />      = context.openOrCreateDatabase("/sdcard/hi_test.db",context. MODE_WORLD_READABLE, null);<br />  <br />  <br />  Cursor cursor <br />    = dbread.rawQuery( <br />      "select "+STR_FIELD_ID+" from "+STR_TABLE_NAME+" where "+STR_FIELD_NAME+"=?", <br />      new String[] {strText}<br />    );<br />  <br />  if (cursor.moveToFirst()) { <br />   return cursor.getInt(0);<br />  }<br />  return -1;<br /> }<br /> <br />}<br /><br /></pre><br /><br /><br />呼叫方法就如下： <br /><br /><pre class="brush: java">public class test extends Activity{<br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br /> super.onCreate(savedInstanceState);<br /> db_sample db = new db_sample(this);<br /> db.fnCreateDB();<br /> db.fnInsert("HI");<br /> int iID = db.fnRead("HI");<br /> }<br /><br />}<br /></pre>