<span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">如果想要使用Google Data API，在Google中有幾種認證提供選擇!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">在這裡利用AuthSub來做說明!!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">在Google App Engine中使用Google行事曆!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">首先我們必須先去申請AuthSub!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><a href="https://www.google.com/accounts/ManageDomains">網址在這</a>!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">然後必須先AddDomain!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">這邊我們加入了一個Domain為: ken-note.<span class="Apple-style-span" style="color: blue;">appspot.com</span></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">注意:一定要是根目錄!不能是: ken-note.<span class="Apple-style-span" style="color: blue;">appspot.com</span><span class="Apple-style-span" style="color: red;">/login</span></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">新增成功後呢!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Google必須驗證此Domain的擁有權是否為你的!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">有三種新增方式:</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><ol><li>中繼標記 &nbsp; &nbsp;(就是把code放在head之中)</li><li>上載HTML檔 &nbsp; (Google會提供一個HTML檔案，把它上傳至gae後，按驗證即可)</li><li>新增DNS記錄 &nbsp; &nbsp; (因為一定要是domain的擁有人才可以新增，我們不是<span class="Apple-style-span" style="color: blue;">appspot.com的</span>擁有人，因此不能新增)</li></ol><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">這邊我們用第一個例子來做說明!</div></div></div><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div></div><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">只要在您首頁的header加入meta，譬如是:<span class="Apple-style-span" style="color: red;">index.jsp</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">如:</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><pre class="brush: html" style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">&lt;head&gt;<br />&lt;meta name="google-site-verification" content="bHmA4RSzJdTse8mArcUO47g0rLfAYTOjxsq9E7i6sog" /&gt;<br /><br />&lt;/head&gt;<br /><br /></pre><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">接著上傳上去以後，回到驗證擁有權的頁面!<br /><br />按下驗證，驗證成功後<br /><br />會到下個頁面去<br /><br />如圖<br /><br /><br /><br /><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TAM4Ci6DWtI/AAAAAAAAAII/tlAm0aVNE5Y/s1600/2222.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="376" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TAM4Ci6DWtI/AAAAAAAAAII/tlAm0aVNE5Y/s640/2222.png" width="640" /></a></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><br /><br /><br /><br /><br />在上圖的<span class="Apple-style-span" style="color: red;">紅色</span>方塊中，我們需填入我們需要對Google行事曆作操作的page..<br /><br />在這個例子就是<span class="Apple-style-span" style="color: red;">http://ken-note.appspot.com</span><span class="Apple-style-span" style="color: blue;">/select/calendar</span><br /><br />接著按下save即可!!<br /><br />申請工作就完成了!!<br /><br /><br />接著就來寫CODE了!<br /><br />打開你的eclipse吧!!<br /><br />首先必須先產生一個連結!<br /><br />讓使用者點選!<br /><br />點選以後會到一個頁面(Google給您的)來做確認是否要存取行事曆!<br /><br />那段CODE如下<br /><br /><br /><pre class="brush: java">&lt;%<br /><br />String strUrl= AuthSubUtil.getRequestUrl("http://ken-note.appspot.com/select/calendar","http://www.google.com/calendar/feeds/",false,true);<br /><br />String strLink = "&lt;a href=\"" + strUrl + "\" "+onclick+"&gt;點選此處登入Google行事曆。&lt;/a&gt;";<br /><br />%&gt;<br /><br />&lt;%=strLink %&gt;<br /><br /></pre><br /><br />AuthSubUtil.getRequestUrl(填入如在驗證擁有權的page,填入要存取的服務,false,true);<br /><br /><br /><br />接著就來寫對google行事曆作操作的code!<br /><br />就是該<span class="Apple-style-span" style="color: red;">/select/calendar</span> page<br /><br /><br /><pre class="brush: java"> <br />CalendarService cs = new CalendarService("test"); //先create一個Calendar Service的Object<br /><br /> String token = AuthSubUtil.getTokenFromReply(request.getQueryString()); //接著要取得token，token是google回傳給您的<br /><br /> token = AuthSubUtil.exchangeForSessionToken(token, null); //進行轉換的動作!<br /><br /> cs.setAuthSubToken(token);   <br /><br /> java.net.URL feedUrl = new java.net.URL("http://www.google.com/calendar/feeds/default/allcalendars/full");<br /><br /> CalendarFeed resultFeed = cs.getFeed(feedUrl, CalendarFeed.class); //進行連線<br /><br /> <br /><br /> for (int i = 0; i &lt; resultFeed.getEntries().size(); i++) {<br /><br /> CalendarEntry entry = resultFeed.getEntries().get(i);<br /><br /> response.getWriter().print(entry.getTitle().getPlainText()); //取得行事曆的內文，entry(CalendarEntry)底下有很多method，大家可以自行試試看   <br /><br />&nbsp;<br /><br /> } </pre><br /><br /><br />照著上列步驟操作即可完成對Google 行事曆作操作了!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></div></div></span></span>