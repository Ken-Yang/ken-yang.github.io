
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title></title>
    
    <meta name="author" content="Ken Yang">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap styles -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Optional theme -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Sticky Footer -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bs-sticky-footer.css" rel="stylesheet">
    
    <!-- Custom styles -->
    <link href="/assets/themes/bootstrap-3/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div id="wrap">
      <nav class="navbar navbar-default" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#jb-navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Ken Yang筆記</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="jb-navbar-collapse">
          <ul class="nav navbar-nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/about">About Ken Yang</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive">Archive</a></li>
      	
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags">Tags</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
          <form method="get" class="navbar-form navbar-right" role="search" action="https://www.google.com/search">
            <div class="form-group">
              <input name="q" id="search-value" type="text" class="form-control" placeholder="Search">
              <input style="display: none" name="as_sitesearch" id="search-value" type="text" class="form-control" value="blog.kenyang.net">
            </div>
            <button type="submit" class="btn btn-default">Submit</button>
          </form>
        </div><!-- /.navbar-collapse -->
      </nav>

      <div class="container">
        <style>
.myButton {
    -moz-box-shadow:inset 0px 1px 0px 0px #ffffff;
    -webkit-box-shadow:inset 0px 1px 0px 0px #ffffff;
    box-shadow:inset 0px 1px 0px 0px #ffffff;
    background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #f9f9f9), color-stop(1, #e9e9e9));
    background:-moz-linear-gradient(top, #f9f9f9 5%, #e9e9e9 100%);
    background:-webkit-linear-gradient(top, #f9f9f9 5%, #e9e9e9 100%);
    background:-o-linear-gradient(top, #f9f9f9 5%, #e9e9e9 100%);
    background:-ms-linear-gradient(top, #f9f9f9 5%, #e9e9e9 100%);
    background:linear-gradient(to bottom, #f9f9f9 5%, #e9e9e9 100%);
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#f9f9f9', endColorstr='#e9e9e9',GradientType=0);
    background-color:#f9f9f9;
    -moz-border-radius:6px;
    -webkit-border-radius:6px;
    border-radius:6px;
    border:1px solid #dcdcdc;
    display:inline-block;
    cursor:pointer;
    color:#666666;
    font-family:Arial;
    font-size:15px;
    font-weight:bold;
    padding:6px 24px;
    text-decoration:none;
    text-shadow:0px 1px 0px #ffffff;
}
.myButton:hover {
    background:-webkit-gradient(linear, left top, left bottom, color-stop(0.05, #e9e9e9), color-stop(1, #f9f9f9));
    background:-moz-linear-gradient(top, #e9e9e9 5%, #f9f9f9 100%);
    background:-webkit-linear-gradient(top, #e9e9e9 5%, #f9f9f9 100%);
    background:-o-linear-gradient(top, #e9e9e9 5%, #f9f9f9 100%);
    background:-ms-linear-gradient(top, #e9e9e9 5%, #f9f9f9 100%);
    background:linear-gradient(to bottom, #e9e9e9 5%, #f9f9f9 100%);
    filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#e9e9e9', endColorstr='#f9f9f9',GradientType=0);
    background-color:#e9e9e9;
}
.myButton:active {
    position:relative;
    top:1px;
}
</style>

<body>
    <div>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ken on github -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3783438370424072"
     data-ad-slot="1516206098"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

    </div>
    <!-- This loops through the paginated posts -->
    
      <h1><a style="color: #F22430" href="/2012/10/24/install-android-ndk-on-mac">Install Android NDK on MAC</a></h1>
      <div style="width: 100%; border-bottom: 1px solid #E7E7E7;"></div>
      <p class="author">
      <div class="date">
        <span>24 October 2012</span>
      </div>
      </p>
      <div class="content" style="line-height: 28px;">
        <span style="font-family: Verdana, sans-serif;">這篇主要講怎麼<u>安裝</u>以及<u>使用</u><a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a>,</span><br /><span style="font-family: Verdana, sans-serif;">Android NDK簡單地說，就是讓您能夠在你的app當中使用C/C++進行implementation,</span><br /><span style="font-family: Verdana, sans-serif;">它可以把您寫的C/C++ build出一個share object檔案 (*.so) 讓Java call！類似windows中的dll檔！</span><br /><span style="font-family: Verdana, sans-serif;">當然你也可以在JNI call Java method，也就是說是雙向的！</span><br /><span style="font-family: Verdana, sans-serif;">而使用NDK的</span><span style="font-family: Verdana, sans-serif;">好處是大概有下面兩個（我只能想到這兩個..）</span><br /><ol><li><span style="font-family: Verdana, sans-serif;">效能較好（depends on situation)</span></li><li><span style="font-family: Verdana, sans-serif;">可以控制到底層的裝置</span></li></ol><br /><u><span style="font-family: Verdana, sans-serif;"><br /></span></u> <span style="font-family: Verdana, sans-serif;">不過在Android官網也指出</span><br /><blockquote class="tr_bq"><span style="font-family: Verdana, sans-serif;"><span style="background-color: #f9f9f9; color: #222222; line-height: 19px;">”you should understand that&nbsp;</span><span style="background-color: #f9f9f9; color: #222222; line-height: 19px;">the NDK will not benefit most apps“</span></span></blockquote><span style="font-family: Verdana, sans-serif;">所以使用時機要自己斟酌，但我知道蠻多game都是用NDK去implement！</span><br /><span style="font-family: Verdana, sans-serif;">因為需要太多memory，靠自己free效能會較好！</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;">首先先講<a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a>的安裝以及使用方法！</span><br /><br /><span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（1） 下載</b></span><br /><span style="font-family: Verdana, sans-serif;">下載頁面在<a href="http://developer.android.com/tools/sdk/ndk/index.html#Downloads">http://developer.android.com/tools/sdk/ndk/index.html#Downloads</a></span><br /><span style="font-family: Verdana, sans-serif;">請選擇符合你自己ＯＳ的版本！</span><br /><span style="font-family: Verdana, sans-serif;">（如果你使用的是windows！請先下載<a href="http://www.cygwin.com/">cygwin</a>，至於cygwin是什麼，前面很多篇文章已經敘述過，這裡不多加敘述）</span><br /><br /><span style="color: red; font-size: large;"><b>（2）解壓縮</b></span><br /><span style="font-family: Verdana, sans-serif;">此篇是用mac，因此就下載osx的版本吧！</span><br /><span style="font-family: Verdana, sans-serif;">下載下來以後就進行解壓縮．</span><br /><span style="font-family: Verdana, sans-serif;">基本上其實就完成了！</span><br /><span style="font-family: Verdana, sans-serif;">在NDK r4之前還需要跑一隻setup script，但之後的就不用了！</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;">其實解壓縮之後裡面就有很多doc可以看！不過都是英文！</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（3）建立jni資料夾</b></span><br /><span style="font-family: Verdana, sans-serif;">在你的$project/底下建立一個jni資料夾！如下：</span><br /><span style="font-family: Verdana, sans-serif;"><project>$project/jni</project></span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（4）撰寫C/C++</b></span><br /><span style="font-family: Verdana, sans-serif;">在$project<project>/jni底下開始寫C/C++的code了！</project></span><br /><span style="font-family: Verdana, sans-serif;">先建立一個檔案叫做test-jni.c，</span><br /><span style="font-family: Verdana, sans-serif;">內容如下：</span><br /><pre class="brush: c">#include &lt;string.h&gt;<br />#include &lt;jni.h&gt;<br /><br />jstring<br />Java_net_kenyang_jni_RunJNI_getText( JNIEnv* env,<br />                                                  jobject thiz )<br />{<br />    return (*env)-&gt;NewStringUTF(env, "Hello from JNI !");<br />}<br /></pre><span style="font-family: Verdana, sans-serif;">jstring是return type</span><br /><span style="font-family: Verdana, sans-serif;">而</span><span style="font-family: Verdana, sans-serif;"><span style="color: red;">Java</span>_<span style="color: blue;">net_kenyang_jni</span>_<span style="color: #38761d;">RunJNI</span>_<span style="color: #b45f06;">getText</span>是這個method的命名規則！</span><br /><span style="font-family: Verdana, sans-serif;">這是JNI的規則，所以請遵守！</span><br /><br /><span style="font-family: Verdana, sans-serif;">開頭一律Java_<span style="color: blue;">自己的package名稱_</span><span style="color: #38761d;">Class名稱_</span><span style="color: #b45f06;">method名稱</span></span><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">你可以改成自己的！但記得後面的步驟也要記得改！ </span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（5）建立Android.mk</b></span><br /><span style="font-family: Verdana, sans-serif;">一樣在$project/jni底下建立Android.mk檔案</span><br /><span style="font-family: Verdana, sans-serif;">Android.mk這個檔案是用來告訴NDK等等要去build哪些resource！</span><br /><span style="font-family: Verdana, sans-serif;">而我們目前只有一隻test-jni.c，所以檔案內容如下：</span><br /><pre class="brush: c">LOCAL_PATH := $(call my-dir)<br /><br />include $(CLEAR_VARS)<br /><br />LOCAL_MODULE    := test-jni<br />LOCAL_SRC_FILES := test-jni.c<br /><br />include $(BUILD_SHARED_LIBRARY)<br /><br /></pre><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（6）開始build *.so檔案</b></span><br /><span style="font-family: Verdana, sans-serif;">先開啓你的terminate，然後cd到$project/jni底下</span><br /><span style="font-family: Verdana, sans-serif;">直接在該目錄底下</span><span style="font-family: Verdana, sans-serif;">用NDK的tool進行build！</span><br /><span style="font-family: Verdana, sans-serif;">這樣就會產生一個.so檔！</span><br /><span style="font-family: Verdana, sans-serif;">這個檔案會放在$project/lib/armeabi底下！</span><br /><span style="font-family: Verdana, sans-serif;">檔名一定會是lib開頭，.so結尾！</span><br /><span style="font-family: Verdana, sans-serif;">也就是說在這個範例build出來的.so檔案名稱為libtest-jni.so</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;">而build指令如下：</span><br /><pre class="brush: c">cd xxx/project/jni<br />xxx/ndk/ndk-build<br /></pre><br /><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <br /><span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（7）開始寫code</b></span><br /><span style="font-family: Verdana, sans-serif;">在你的android project中直接建立一個activity（名稱為RunJNI）</span><span style="font-family: Verdana, sans-serif;">，</span><br /><span style="font-family: Verdana, sans-serif;">我們將在這個activity中進行呼叫剛剛用c建立的method，</span><br /><span style="font-family: Verdana, sans-serif;">ＣＯＤＥ如下：</span><br /><pre class="brush: java">public class RunJNI extends Activity {<br /> // 宣告一個native method（就是剛剛用c寫的）<br /> private native String getText();<br /> <br /> // 載入剛剛的.so檔案！（這裡不需要加上lib，直接去掉就好<br />    static {<br />        System.loadLibrary("test-jni");<br />    }<br /><br /><br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.run_jni);<br />  <br />  TextView tv = (TextView) findViewById(R.id.textView1);<br />  <br />  // 呼叫method,把method回傳的字給textView進行設定<br />  tv.setText(getText());<br />  <br /> }<br />}<br /><br /></pre><br /><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><span style="font-family: Verdana, sans-serif;">完成上面7個步驟就完成了！</span><br /><span style="font-family: Verdana, sans-serif;">直接點選run應該就可以看到下面畫面！&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-jnrxKIWQCPs/UIekOU43QAI/AAAAAAAAA6k/3LdoMLKSWq0/s1600/Screenshot_2012-10-24-16-18-19.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-jnrxKIWQCPs/UIekOU43QAI/AAAAAAAAA6k/3LdoMLKSWq0/s640/Screenshot_2012-10-24-16-18-19.png" width="360" /></a></div><span style="font-family: Verdana, sans-serif;"><br /></span><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u> <span style="font-family: Verdana, sans-serif;"><br /></span> <br /><pre></pre><pre></pre>
      </div>
      <footer>
        <p><a class="myButton" href="/2012/10/24/install-android-ndk-on-mac">read more &raquo;</a></p>
        <div>
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ken on github -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3783438370424072"
     data-ad-slot="1516206098"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
      </footer>
      <hr>
    
      <h1><a style="color: #F22430" href="/2012/10/18/amazon-ec2-regenerate-key">Amazon EC2 regenerate key</a></h1>
      <div style="width: 100%; border-bottom: 1px solid #E7E7E7;"></div>
      <p class="author">
      <div class="date">
        <span>18 October 2012</span>
      </div>
      </p>
      <div class="content" style="line-height: 28px;">
        <div class="separator" style="clear: both; text-align: left;">前天要上去自己的EC2上的某台機器，</div><div class="separator" style="clear: both; text-align: left;">但發現access key 放在另一台筆電上，剛好那台筆電在公司......</div><div class="separator" style="clear: both; text-align: left;">又有急切需求要上去看一些config，</div><div class="separator" style="clear: both; text-align: left;">偏偏EC2的access key只能被download一次 （就是一開始建立intance的時候）</div><div class="separator" style="clear: both; text-align: left;">所以當下我根本無法上到我的機器看！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">只好把目前的instance 複製一份image出來，</div><div class="separator" style="clear: both; text-align: left;">然後在利用那份image建立一個新的instance！</div><div class="separator" style="clear: both; text-align: left;">利用這個方法來取得新key，又可以存取到一模一樣設定的機器！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">操作如下！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">1. 首先先把自己的正在running的instance stop！</div><div class="separator" style="clear: both; text-align: left;">接著點選該instance -&gt; 點選menu bar上的Instance actions -&gt; 選擇Create Image</div><div class="separator" style="clear: both; text-align: left;">如下圖所示</div><div class="separator" style="clear: both; text-align: left;"><a href="http://3.bp.blogspot.com/-tEXKoyzIJO8/UH-WKKaLMCI/AAAAAAAAA5g/72bF6M5Ccvk/s1600/Screen+Shot+2012-10-17+at+8.52.06+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="396" src="http://3.bp.blogspot.com/-tEXKoyzIJO8/UH-WKKaLMCI/AAAAAAAAA5g/72bF6M5Ccvk/s640/Screen+Shot+2012-10-17+at+8.52.06+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">2. 填寫Image名稱 - &gt;點選Yes, Create</div><div class="separator" style="clear: both; text-align: left;">如下圖&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-j0mnSS1-YYo/UH-WK8P2-OI/AAAAAAAAA5k/zqwCo572WI0/s1600/Screen+Shot+2012-10-17+at+8.52.17+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="392" src="http://1.bp.blogspot.com/-j0mnSS1-YYo/UH-WK8P2-OI/AAAAAAAAA5k/zqwCo572WI0/s640/Screen+Shot+2012-10-17+at+8.52.17+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">3. 完成上述步驟以後，就複製完成了！</div><div class="separator" style="clear: both; text-align: left;">接著就要建立一個新的instance！</div><div class="separator" style="clear: both; text-align: left;">這邊的流程跟建立一般的instance沒什麼不同！<br />只不過要選擇自己複製好的image，如下圖所示．</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-iD0okdXyl4E/UH-WMQRgr6I/AAAAAAAAA50/QKNLhmCVN2M/s1600/Screen+Shot+2012-10-17+at+8.52.53+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="416" src="http://4.bp.blogspot.com/-iD0okdXyl4E/UH-WMQRgr6I/AAAAAAAAA50/QKNLhmCVN2M/s640/Screen+Shot+2012-10-17+at+8.52.53+PM.png" width="640" /></a></div><br /><br />4. 到了Create Key Pair這步驟以後，記得建立一個新的Key Pair!<br />不要使用舊的key pair! （因為沒辦法下載了！）<br />所以要選擇建立新的，就可以下載這支新的key!<br />如下圖所示！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-n2M3lEl_QwM/UH-WNKVNeqI/AAAAAAAAA58/kGMc4m91bvQ/s1600/Screen+Shot+2012-10-17+at+8.56.55+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="436" src="http://1.bp.blogspot.com/-n2M3lEl_QwM/UH-WNKVNeqI/AAAAAAAAA58/kGMc4m91bvQ/s640/Screen+Shot+2012-10-17+at+8.56.55+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">完成上述步驟就有一台和先前舊的那台一模一樣的機器了！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><br />
      </div>
      <footer>
        <p><a class="myButton" href="/2012/10/18/amazon-ec2-regenerate-key">read more &raquo;</a></p>
        <div>
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ken on github -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3783438370424072"
     data-ad-slot="1516206098"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
      </footer>
      <hr>
    
      <h1><a style="color: #F22430" href="/2012/10/06/objetive-c-memory-retain">Objetive-C memory (retain)</a></h1>
      <div style="width: 100%; border-bottom: 1px solid #E7E7E7;"></div>
      <p class="author">
      <div class="date">
        <span>06 October 2012</span>
      </div>
      </p>
      <div class="content" style="line-height: 28px;">
        恩，最近在寫Objective-C，<br />遇到了memory的一些問題，<br />也好險我有個好mentor可以問！<br /><br /><br />從Java跳過來這讓我有點點小混淆！<br />還記得我先前講過<a href="http://blog.kenyang.net/2012/01/java.html">Java複製物件</a>的問題嗎？<br />在Java中直接將instance化的物件，直接給予另一個物件！<br />這樣的情形中，這兩個物件是指向同個物件的！<br />假設我有兩個物件，分別為Ａ、Ｂ！<br />如果Ａ裡面的attribute變了！那麼Ｂ也會變！<br /><br />當然這樣的情形在Objective C也是一樣的！<br />但是Objective C有個method，就是retain!<br />還有一個特殊的機制叫做reference counting<br />retain也是把原本的物件給另一個物件！<br />這兩個物件也是指向同一個物件！<br />而reference counting就是當這個物件被copy或者retain時，<br />他的reference count都會加1! <br />（retain 是原有物件會+1，copy是新的物件+1，copy就類似java的clone）<br /><br /><br />但我一開始遇到了一個寫法上的confused，一開始一直在想這兩種差別！<br />code如下<br /><pre class="brush: c">    Book *b1 = [[Book alloc]init]; // retain count=1沒問題<br />    Book *b2 = b1; // retain count還是1，這我大概理解，就是把b2指向b1<br />    Book *b3 = [b1 retain]; // retain count變2<br />    [b1 setVal:20];  // 如果把b1物件中的value設值20，b2, b3也都會變<br /><br /></pre><br />這時候如果把b2, b3的Val都印出來，也都會是20！<br />那麼我就在思考了這兩種的差異！<br /><br />最後也大概知道了！<br />因為b2和b1算是共享同個物件！<br />如果這時候developer把[b1 release]掉！<br />b2也不能使用了！！<br />很容易發生bad access的問題！<br />所以大部份時候都要使用retain來進行物件的存取！（目前還想不到使用b2的方法用途）<br />以避免原有物件被release出來以後，現有的新物件才不會crash掉！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>
      <footer>
        <p><a class="myButton" href="/2012/10/06/objetive-c-memory-retain">read more &raquo;</a></p>
        <div>
          <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ken on github -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3783438370424072"
     data-ad-slot="1516206098"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        </div>
      </footer>
      <hr>
    

    <!-- Pagination links -->
    <div class="pagination">
      
        <a href="/blog/page19" class="previous">Previous</a>
      
      <span class="page_number ">Page: 20 of 58</span>
      
        <a href="/blog/page21" class="next">Next</a>
      
    </div>

    <div>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- ken on github -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-3783438370424072"
     data-ad-slot="1516206098"
     data-ad-format="auto"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

        <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-70705007-1', 'auto');
  ga('send', 'pageview');

</script>

    </div>
</body>

      </div>

    </div>

    <div id="footer">
      <div class="container">
        <p>&copy; 2016 Ken Yang
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>
        </p>
      </div>
    </div>

    





    <!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/assets/themes/bootstrap-3/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>

