
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title></title>
    
    <meta name="author" content="Ken Yang">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap styles -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Optional theme -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Sticky Footer -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bs-sticky-footer.css" rel="stylesheet">
    
    <!-- Custom styles -->
    <link href="/assets/themes/bootstrap-3/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div id="wrap">
      <nav class="navbar navbar-default" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#jb-navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Ken Yang筆記</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="jb-navbar-collapse">
          <ul class="nav navbar-nav">
            
            
            


  
    
      
      	
      	<li><a href="/about">About Ken Yang</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive">Archive</a></li>
      	
      
    
  
    
      
    
  
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags">Tags</a></li>
      	
      
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  
    
  



          </ul>
          <form method="get" class="navbar-form navbar-right" role="search" action="https://www.google.com/search">
            <div class="form-group">
              <input name="q" id="search-value" type="text" class="form-control" placeholder="Search">
              <input style="display: none" name="as_sitesearch" id="search-value" type="text" class="form-control" value="blog.kenyang.net">
            </div>
            <button type="submit" class="btn btn-default">Submit</button>
          </form>
        </div><!-- /.navbar-collapse -->
      </nav>

      <div class="container">
        <body>
    <div>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- id10t_top -->
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-7586970907106458"
data-ad-slot="1161208442"
data-ad-format="auto"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

    </div>
    <!-- This loops through the paginated posts -->
    
      <h1><a style="color: #F22430" href="/2011/03/31/ubuntu-install-vsftpd">ubuntu install vsftpd</a></h1>
      <div style="width: 100%; border-bottom: 1px solid #E7E7E7;"></div>
      <p class="author">
        <span class="date">2011-03-31 09:50:00 +0800</span>
      </p>
      <div class="content">
        今天剛灌好ubuntu server，順便把vsftpd裝起來，<br />但是發現一直找不到該package，<br />結果發現其實只是沒有更新sources.list，<br />只要下<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 200px;">sudo apt-get update </div><br />更新完以後，就可以找到了。<br />只要下<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 200px;">sudo apt-get install vsftpd </div>就可以安裝起來。<br />安裝完成以後，就針對設定檔進行一些微調<br />像是我不希望我的ftp server可以匿名登入，<br />那麼我就要去設定檔把匿名登入關掉，<br />首先先用編輯器開啟設定檔<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 200px;">sudo vim /etc/vsftpd.conf</div>打開以後，把<br /><br />anonymous_enable=YES<br />改成<br /><br />anonymous_enable=no<br /><br />接著存檔離開。<br />並重新啟動<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 300px;">sudo /etc/init.d/vsftpd restart</div><br />這樣即可。<br />詳細設定檔可以去鳥哥看<br /><br />
      </div>
      <hr>
    
      <h1><a style="color: #F22430" href="/2011/03/18/gaej-datastoreneedindexexception-no">GAE/J DatastoreNeedIndexException: no matching index found解決方式</a></h1>
      <div style="width: 100%; border-bottom: 1px solid #E7E7E7;"></div>
      <p class="author">
        <span class="date">2011-03-18 05:25:00 +0800</span>
      </p>
      <div class="content">
        今天在實作一對多的relation，<br /><br />在部署上去以後，一直覺得出錯，<br /><br />錯誤訊息是：<b>com.google.appengine.api.datastore.DatastoreNeedIndexException: no matching index found..</b><br /><br />原因當然是因為沒有建立index，可是覺得很怪，<br /><br />因為之前記得會自動幫我建立index，<br /><br />找了一下solution，<br /><br />發現只要在local端run一次，就會自動幫我建立好index，<br /><br />並且會放在project_path\war\WEB-INF\appengine-generated資料夾底下，<br /><br />檔名為datastore-indexes-auto.xml<br /><br />裡面就是幫你建立相關的index語法。<br /><br />當然你也可以自己建立index。<br /><br /><br /><br /><br /><br />
      </div>
      <hr>
    
      <h1><a style="color: #F22430" href="/2011/03/10/implement-yahoo-login-using-bbauth">Implement Yahoo Login (Using BBAuth)</a></h1>
      <div style="width: 100%; border-bottom: 1px solid #E7E7E7;"></div>
      <p class="author">
        <span class="date">2011-03-10 10:53:00 +0800</span>
      </p>
      <div class="content">
        想讓自己網站上的使用者不用註冊就可以使用自己的網站，<br /><br />只要有Yahoo帳號就可以登入自己的網站的話，<br /><br />可以導入Yahoo Login API，<br /><br />而Yahoo Login API主要分成三種，<br /><br />可以用下列三種認證/授權方式，<br /><br />1. OAuth<br /><br />2. OpenID<br /><br />3. BBAuth<br /><br />這邊選用第三種BBAuth，<br /><br />首先要先去註冊你的appid，<br /><br /><a href="https://developer.apps.yahoo.com/wsregapp/">點這裡來註冊</a><br /><br />點開以後，會看到如下圖（圖一）的表格，<br /><br />第一格Yahoo ID：不用自己填，會幫你填好<br /><br />第二格Authentication method：點選第二個（Browser Based Authentication）<br /><br />第三格Developer/Company Name：填寫自己的名稱或公司名稱<br /><br />第四格Product Name：填寫產品名稱<br /><br />第五格Web Application URL：是指你網站的網址（不能IP喔）<br /><br /><b>第六格BBAuth Success URL：這格很重要，意思是當使用者登入成功以後，下個頁面要轉到哪個頁面</b><br /><b><br /></b><br />第七格Contact Email：填入自己的信箱就好<br /><br />第八格Phone Number：填入電話，這格為optional，可以不填<br /><br />第九格Description of application：敘述<br /><br /><b>第十格Require Access Scope：這格也很重要！意思是說這個認證可以在Yahoo的哪些服務進行存取，這邊我們先勾選Single Sign On, no user data can be accessed就好</b><br /><b><br /></b><br />填寫完成以後就點選Continue，<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://lh6.googleusercontent.com/-Xzu1Zal2Yrc/TXgz2F15ZFI/AAAAAAAAARs/6U5eGC00EhM/s1600/1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="628" src="https://lh6.googleusercontent.com/-Xzu1Zal2Yrc/TXgz2F15ZFI/AAAAAAAAARs/6U5eGC00EhM/s640/1.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table>點完按鈕Continue以後，會看到下圖（圖二）<br /><br />這頁主要是要進行認證的動作，Yahoo要check這個domain是屬於你的！<br /><br />做法是在自己的domain的根目錄底下放置一個.html檔案，<br /><br />檔名yahoo會提供給你，這邊的檔名是ydnv6nnxP.html。<br /><br />將此檔案放置在domain根目錄底下，<br /><br />然後按下圖中的按鈕Check Domain，<br /><br />此時Yahoo就會去request該.html檔，如果有放置上去，<br /><br />就會通過驗證。就會如圖中的Result: <span class="Apple-style-span" style="color: #38761d;">Pass</span><br /><br />如果是Pass，就繼續往下一步，按下按鈕Continue<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://lh6.googleusercontent.com/-Ti8XoBygyGE/TXgzHJLVt0I/AAAAAAAAARc/0CUUXbJLaDY/s1600/1.5.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="304" src="https://lh6.googleusercontent.com/-Ti8XoBygyGE/TXgzHJLVt0I/AAAAAAAAARc/0CUUXbJLaDY/s640/1.5.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><div class="separator" style="clear: both; text-align: -webkit-auto;"><br /></div><div class="separator" style="clear: both; text-align: -webkit-auto;">點完Continue按鈕以後，會看到下圖（圖三）的畫面</div><div class="separator" style="clear: both; text-align: -webkit-auto;"><br /></div><div class="separator" style="clear: both; text-align: -webkit-auto;">代表申請成功，Yahoo會給你app id和secret</div><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://lh3.googleusercontent.com/-U7J5MM21LMY/TXgzHz4HlTI/AAAAAAAAARk/bLcaZyaNerU/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="262" src="https://lh3.googleusercontent.com/-U7J5MM21LMY/TXgzHz4HlTI/AAAAAAAAARk/bLcaZyaNerU/s640/2.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖三</td></tr></tbody></table><br />申請完成以後就開始來寫code了！！<br /><br />這邊我以JSP/SERVLET為主，<br /><br /><pre class="brush: java">try{<br />     final String strAppId = "appID"; //應用程式碼<br />     final String strSecrect = "secect"; //驗證用<br />     String strTimeStamp = String.valueOf(new Date().getTime()/1000); //把毫秒轉成秒數<br />             <br />     //接下來這段主要是在做md5，<br />     MessageDigest Signature = MessageDigest.getInstance("MD5");<br />     //下面這行是Yahoo要求要進行md5的參數<br />     String tempMD5 = String.format("/WSLogin/V1/wslogin?appid=%s&amp;.intl=tw&amp;send_userhash=1&amp;ts=%s%s", strAppId, strTimeStamp, strSecrect);<br />     Signature.update(tempMD5.getBytes());<br /> <br />     byte[] Bt = Signature.digest();<br />     StringBuffer buffer = new StringBuffer();<br />     for (int i = 0; i &lt; Bt.length; ++i) {<br />          byte b = Bt[i];<br />          int value = (b &amp; 0x7F) + (b &lt; 0 ? 128 : 0);<br />          buffer.append(value &lt; 16 ? "0" : "");<br />          buffer.append(Integer.toHexString(value));<br />     }<br />     //md5 結束<br />           <br />     //進行完md5以後，就進行Redirect<br />     resp.sendRedirect(String.format("https://api.login.yahoo.com/WSLogin/V1/wslogin?appid=%s&amp;.intl=tw&amp;send_userhash=1&amp;ts=%s&amp;sig=%s", strAppId, strTimeStamp, buffer.toString()));<br />  <br />}catch (Exception e) {<br />     //MD5 Exception<br />}<br /></pre><br /><br />在進行完redirect以後，就會轉向Yahoo登入的頁面，<br /><br />登入完成就會將頁面導向之前<b>第六格BBAuth Success</b>的URL<br /><br />接下來有比較重要的幾點，<br /><br />由於Yahoo Login是無法取得使用者的資訊，<br /><br />它不同於Facebook、Goolge Login，<br /><br />可是一般的網站不是都要記住session嗎?<br /><br />可能是將使用者帳號之類的資訊存在session裡面，<br /><br />可是Yahoo卻無法存取到使用者相關資訊，<br /><br />但是!Yahoo會回傳一個userhash，到<b>第六格BBAuth Success</b>的URL中，<br /><br />而這個userhash是唯一的，不會有重複!<br /><br />所以我們一樣可以利用此userhash存在session裡面，<br /><br />還會回傳appid、token、appdata、ts、sig這些參數回來。<br /><br />但比較重要的是userhash，因為這個是Unique的identifier!!<br /><br />大致上這樣就完成一個Yahoo Login了。<br /><br /><br /><a href="http://developer.yahoo.com/bbauth/user.html">參考來源</a><br /><br /><br /><br /><br /><br />
      </div>
      <hr>
    

    <!-- Pagination links -->
    <div class="pagination">
      
        <a href="/blog/page31" class="previous">Previous</a>
      
      <span class="page_number ">Page: 32 of 53</span>
      
        <a href="/blog/page33" class="next">Next</a>
      
    </div>

    <div>
        <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- id10t_top -->
<ins class="adsbygoogle"
style="display:block"
data-ad-client="ca-pub-7586970907106458"
data-ad-slot="1161208442"
data-ad-format="auto"></ins>
<script>
    (adsbygoogle = window.adsbygoogle || []).push({});
</script>

    </div>
</body>

      </div>

    </div>

    <div id="footer">
      <div class="container">
        <p>&copy; 2015 Ken Yang
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>
        </p>
      </div>
    </div>

    





    <!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/assets/themes/bootstrap-3/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>

