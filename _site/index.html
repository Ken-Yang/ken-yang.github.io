
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title></title>
    
    <meta name="author" content="Ken Yang">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Bootstrap styles -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <!-- Optional theme -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet">
    <!-- Sticky Footer -->
    <link href="/assets/themes/bootstrap-3/bootstrap/css/bs-sticky-footer.css" rel="stylesheet">
    
    <!-- Custom styles -->
    <link href="/assets/themes/bootstrap-3/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <!-- Fav and touch icons -->
    <!-- Update these with your own images
      <link rel="shortcut icon" href="images/favicon.ico">
      <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
      <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
      <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
    -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div id="wrap">
      <nav class="navbar navbar-default" role="navigation">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#jb-navbar-collapse">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Ken Yang</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="jb-navbar-collapse">
          <ul class="nav navbar-nav">
            
            
            


  
    
      
      	
      	<li><a href="/archive">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories">Categories</a></li>
      	
      
    
  
    
  
    
      
      	
      	<li><a href="/pages">Pages</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags">Tags</a></li>
      	
      
    
  



          </ul>
          <form class="navbar-form navbar-right" role="search">
            <div class="form-group">
              <input type="text" class="form-control" placeholder="Search">
            </div>
            <button type="submit" class="btn btn-default">Submit</button>
          </form>
        </div><!-- /.navbar-collapse -->
      </nav>

      <div class="container">
        <div class="posts">
  
    <article class="post">

      <h1>Setup Linux Multipath in Ubuntu</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><br />這篇要講Linux Multipath，<br />為了使用Linux Multipath，所以用了multipath-tool這個package，<br />multipath-tool提供了二個功能，<br />&nbsp;&nbsp;&nbsp;1. input/output fail-over<br />&nbsp;&nbsp;&nbsp;2. load balancing for block device<br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. Prerequisite</span><br /><br />開始之前先，準備下面所需要的環境，<br />1. 1台server上有2張網卡(eth0, eth1)<br />2. iSCSI target x1<br />理論上，server上的2張網卡應接在不同的swtich上，抑或在不同的網段上。<br />目的在於某一條線路斷時，才不會影響另外一條。<br />但為了測試可以先都放在同個網段上。<br /><br />假設，<br />eth0 IP為172.16.131.134<br />eth1 IP為172.16.131.135<br />iSCSI IP為172.16.131.138<br /><br />整體的網路架構可以參考此張圖，<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-ZfPX7UenJK4/Vcw-nyopwMI/AAAAAAAAFmo/_MV4SmjPRo8/s1600/Network%2BDiagram%2B-%2BPage%2B1%2B%25283%2529.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-ZfPX7UenJK4/Vcw-nyopwMI/AAAAAAAAFmo/_MV4SmjPRo8/s400/Network%2BDiagram%2B-%2BPage%2B1%2B%25283%2529.png" width="263" /></a></div><span style="color: #e06666; font-size: 18px;">2. Installation</span><br /><br />接著安裝我們需要的package，<br /><pre class="brush: bash">apt-get install open-iscsi<br />apt-get install multipath-tools<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. multipath configuration</span><br /><br />接著來設定multipah，先create一個config file，（你也可以從/usr/share/doc/multipath-tools/examples/multipath.conf.synthetic這裏複製至/etc/multipah.conf底下）<br /><pre class="brush: bash">$ vim /etc/multipath.conf<br /></pre><br />內容如下，參數的說明可以看這（<a href="https://help.ubuntu.com/lts/serverguide/multipath-dm-multipath-config-file.html">點我</a>）<br /><pre class="brush: bash">defaults {<br />     user_friendly_names yes<br />}<br /><br />devices {<br />     device {<br />          polling_interval 5<br />          path_selector "round-robin 0"<br />          path_grouping_policy group_by_prio<br />          prio rdac<br />          path_checker rdac<br />          hardware_handler "1 rdac"<br />          failback immediate<br />          features "2 pg_init_retires 50"<br />          no_path_retry 30<br />          rr_min_io 100<br />     }<br />}<br /></pre><br /><span style="color: #e06666; font-size: 18px;">4. iSCSI configuration</span><br /><br />接著我們要設定iSCSI，讓我們在login某target時，<br />可以透過不同的NIC同時進行login，<br /><pre class="brush: bash">$ iscsiadm -m iface -I eth0 -o new<br />$ iscsiadm -m iface -I eth1 -o new<br />$ iscsiadm -m iface -I eth0 --op=update -n iface.net_ifacename -v eth0<br />$ iscsiadm -m iface -I eth1 --op=update -n iface.net_ifacename -v eth1<br /></pre><br />接著要把reverse path filtering關掉，<br />否則其中一張網卡登入target時的packet會被ignore，<br />所以要去編輯/etc/sysctl.conf，<br />加入下面兩行。<br /><pre class="brush: bash">net.ipv4.conf.eth0.rp_filter=2<br />net.ipv4.conf.eth1.rp_filter=2<br /></pre><br />然後執行下面指令讓conf生效。<br /><pre class="brush: bash">$ sysctl -p<br /></pre><br /><span style="color: #e06666; font-size: 18px;">5. Login iSCSI</span><br /><br />首先先discovery該iSCSI，看該iSCSI上有哪些target，<br />可以發現一模一樣的target卻顯示了2筆，這是因為剛剛前面我們設定了2張nic了！<br /><pre class="brush: bash">$ iscsiadm -m discovery -t st -p 172.16.131.138:3260<br />172.16.131.138:3260,1 iqn.2015-07.net.kenyang:ken.iscsi<br />172.16.131.138:3260,1 iqn.2015-07.net.kenyang:ken.iscsi<br /></pre><br />接著login該target，會發現login了二次，且這二次分別是透過eth0以及eth1去完成。<br /><pre class="brush: bash">$ iscsiadm -m node -T iqn.2015-07.net.kenyang:ken.iscsi --login<br /><br />Logging in to [iface: eth0, target: iqn.2015-07.net.kenyang:ken.iscsi, portal: 172.16.131.138,3260]<br />Logging in to [iface: eth1, target: iqn.2015-07.net.kenyang:ken.iscsi, portal: 172.16.131.138,3260]<br />Login to [iface: eth0, target: iqn.2015-07.net.kenyang:ken.iscsi, portal: 172.16.131.138,3260]: successful<br />Login to [iface: eth1, target: iqn.2015-07.net.kenyang:ken.iscsi, portal: 172.16.131.138,3260]: successful<br /></pre><br />顯示multipath的topology，<br />會發現有2個blcok device，<br />因為我們登入了2次，所以該target在我們server上被視為2個block device，分別為sdb, sdc。<br />然後再透過device mapper的概念去把它aggregate成一個/dev/mapper/mpath1。<br /><pre class="brush: bash">$ multipath -ll<br /><br />mpath1 (xxxxxxxxxxxxxxxxxxx) dm-6 EQLOGIC,100E-00<br />size=60G features='0' hwhandler='0' wp=rw<br />`-+- policy='round-robin 0' prio=1 status=active<br /> |- 7:0:0:0 sdb 8:16 active ready running<br /> `- 8:0:0:0 sdc 8:32 active ready running<br /></pre><br /><span style="color: #e06666; font-size: 18px;">6. Format block device</span><br /><br />最後一步就要把該block device mount起來使用，<br />但mount之前要先fdisk以及mkfs，要注意我們的對象不是sdb,sdc，<br />而是mpatch1。<br /><pre class="brush: bash">fdisk /dev/mapper/mpath1<br />mkfs.ext4 /dev/mapper/mpath1<br /></pre><br />完成以後就可以mount起來使用看看。<br /><pre class="brush: bash">mount /dev/mapper/mpath1 /storage/<br /></pre><br /><br /></div>
      </div>

      <a href="/2015/08/13/setup-linux-multipath-in-ubuntu" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Apache Kafka: Distributed messaging system.</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><br />Apache Kafka是一個分散式的訊息處理framework，<br />透過publish來發佈message，以及subscribe來訂閱取得message。<br />從架構上來看，Kafka可以分為下面幾種角色，<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1. producer:   發佈(publish)message to topic<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2. consumer:   訂閱(subscribe)topic以取得message<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3. broker:     簡單的說就是server，由一台以上的broker組成一個cluster<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4. topic:      message的分類<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5. zookeeper:  嚴格來說，zookeeper不算是Kafka的一部分，但Kafka卻得倚靠zookeeper來做到sync。<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-PvOMN32b-LA/VYfNp-L3GVI/AAAAAAAAFlg/upzpVGdl1sk/s1600/producer_consumer.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-PvOMN32b-LA/VYfNp-L3GVI/AAAAAAAAFlg/upzpVGdl1sk/s1600/producer_consumer.png" /></a></div><br />了解Kafka的每一個角色以後，<br />接下來要講怎麼安裝跟使用。<br /><br /><span style="color: #e06666; font-size: 18px;">1. Install Kafka</span><br /><br />首先，先安裝Kafka，這裡選的版本是0.8.2。<br />Kafka的安裝很簡單，只有一個tarball，解開就好。<br /><pre class="brush: bash">wget http://apache.stu.edu.tw/kafka/0.8.2.0/kafka_2.10-0.8.2.0.tgz<br />tar xvzf kafka_2.10-0.8.2.0.tgz<br />cd kafka_2.10-0.8.2.0/<br /></pre><br /><span style="color: #e06666; font-size: 18px;">2. Start zookeeper</span><br /><br />安裝完以後，在開始之前，<br />要先啟動zookeeper，原因是前面有說過，<br />Kafka倚靠zookeeper做message的sync。<br /><pre class="brush: bash">bin/zookeeper-server-start.sh config/zookeeper.properties &amp;<br /></pre><br />啟動以後，可以透過下面指令去觀察一下，<br />應該會看到2隻java在LISTEN，<br />有一隻的port預設一定是2181，預設值放在config/zookeeper.properties裡面。<br />這個port是給等等的其他broker連上來用的。<br /><pre class="brush: bash">netstat -tnlp<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. Start Kafka server(broker)</span><br /><br />接著啟動三個kafka server，讓這三台server變成一個cluster，<br />為什麼要跑三台？因為Kafka還有replication的功能，所以順便玩一下。<br />然後我只有一台機器，所以我會讓這三台通通run在同一台上面。<br />在啟動之前，要先“複製“and“編輯”一個config檔案，<br /><br />首先，先複製config，因為有三台，但是預設的config只有一個，所以要多複製二個出來。<br /><pre class="brush: bash">cp config/server.properties config/server-2.properties<br />cp config/server.properties config/server-3.properties<br /></pre><br />然後去編輯config/server-2.properties以及server-3.properties這二個檔案，<br /><pre class="brush: bash"># The id of the broker. This must be set to a unique integer for each broker.<br />broker.id=1<br /><br /># The port the socket server listens on<br />port=9092<br /><br /># A comma seperated list of directories under which to store log files<br />log.dirs=/tmp/kafka-logs<br /></pre>只要改broker.id, port, log.dirs這三個key，<br />這三個都要是unique的value，所以就都往上+1吧，<br />例如server-2.properties的例子就是，<br />broker.id=1<br />port=9093<br />log.dirs=/tmp/kafka-logs-2<br /><br />編輯完以後就分別啟動這三台broker吧。<br /><pre class="brush: bash">bin/kafka-server-start.sh config/server.properties &amp;<br />bin/kafka-server-start.sh config/server-2.properties &amp;<br />bin/kafka-server-start.sh config/server-3.properties &amp;<br /></pre><br /><span style="color: #e06666; font-size: 18px;">4. Create a topic</span><br /><br />有了server以後，接著要create一個topic，<br />你可以試著把replication的value改成4，你應該會失敗了，<br />且error msg應該是【4 larger than available brokers: 3】，因為我們剛剛只有start三台broker，所以無法複製四份。<br /><pre class="brush: bash">bin/kafka-topics.sh --create --zookeeper localhost:2181 --replication-factor 3 --partitions 1 --topic test<br /></pre><br />接著你可以去查詢這個topic的資訊，<br /><pre class="brush: bash">bin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic test<br /></pre><br />應該會看到下面的資訊，<br /><pre class="brush: bash">Topic:test PartitionCount:1 ReplicationFactor:3 Configs:<br /> Topic: test Partition: 0 Leader: 2 Replicas: 2,0,1 Isr: 2,0,1<br /></pre>ReplicationFactor是3份，<br />Replicate在0, 1, 2這三台broker上面，<br />topic的leader是broker 2，leader負責partition的read and write。<br />Isr的意思是有哪些broker正在sync，簡單的說可以知道哪些broker是活著的。<br /><br /><span style="color: #e06666; font-size: 18px;">5. Publish: send message to topic</span><br /><br />接著就要開始寫訊息到topic裡面，<br />透過kafka提供的shell可以進行測試，執行以後，就可以直接輸入你要輸入的訊息，<br />輸入完以後，按下ctrl+C就可以離開。<br /><pre class="brush: bash">$ bin/kafka-console-producer.sh --broker-list localhost:9092 --topic test<br />...<br />test message 1<br />test message 2<br />^C <br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">6. Subscribe: get message from topic</span><br /><br />接著就要讀取訊息，<br />kafka一樣有提供shell script讓我們使用，<br />應該就可以看到上一步驟所輸入的訊息了。<br /><pre class="brush: bash">bin/kafka-console-consumer.sh --zookeeper localhost:2181 --topic test --from-beginning<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">7. Advance</span><br /><br />這一步只是要觀察一下replication有無成功，<br />我們可以去stop該topic的leader，<br />以我的例子來說，test leader是broker 2，<br />所以我就去把broker 2關掉，<br /><pre class="brush: bash">$ jobs<br />[1]   Running            bin/zookeeper-server-start.sh config/zookeeper.properties &amp;<br />[2]   Running            bin/kafka-server-start.sh config/server.properties &amp;<br />[3]-  Running            bin/kafka-server-start.sh config/server-1.properties &amp;<br />[4]+  Running            bin/kafka-server-start.sh config/server-2.properties &amp;<br />$ fg 4<br />$ ^C<br /></pre><br />接著我們可以先去看該topic的leader會有什麼變化，應該會發現leader變別台broker了，<br />而且Isr會只剩下0,1。<br /><pre class="brush: bash">bin/kafka-topics.sh --describe --zookeeper localhost:2181 --topic test<br /></pre><br />此時我們一樣在去consume message，message應該還是會保存的完整無缺。<br /><pre class="brush: bash">bin/kafka-console-consumer.sh --zookeeper localhost:2181 --from-beginning --topic test<br /></pre><br /><br />下一篇應該寫kafka+spark streaming吧！？<br /><br /><br /><br /><br /><br /><br /></div>
      </div>

      <a href="/2015/06/25/apache-kafka-distributed-messaging" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to run a simple Apache Spark application? (Ubuntu 12.04)</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">因緣際會下，得稍微摸一下Apache Spark，<br />說實在，在粗淺地摸完Spark以後，我還是想不太出他的應用面。<br />Anyway，這篇主要分為3個section，<br /><br /><ul><li>如何安裝Spark</li><li>如何使用</li><li>如何寫個Spark application</li></ul><br /><br /><span style="color: #e06666; font-size: 18px;">1. Install JDK</span><br /><br />首先要先講安裝，<br />安裝spark之前，要先安裝java+scala，<br /><pre class="brush: bash">apt-add-repository ppa:webupd8team/java<br />apt-get update<br />apt-get install oracle-java7-installer<br /></pre><br /><span style="color: #e06666; font-size: 18px;">2. Install scala</span><br /><br />接著要安裝scala，這裡安裝的版本是2.11.6。<br /><pre class="brush: bash">wget http://www.scala-lang.org/files/archive/scala-2.11.6.tgz<br />mkdir /usr/local/src/scala<br />tar xvf scala-2.11.6.tgz -C /usr/local/src/scala/<br /></pre><br />安裝完以後，要把scala的路徑加入到PATH環境變數中<br /><pre class="brush: bash">echo "export SCALA_HOME=/usr/local/src/scala/scala-2.11.6" &gt;&gt; .bashrc<br />echo "export PATH=\$SCALA_HOME/bin:\$PATH" &gt;&gt; .bashrc<br />. .bashrc<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. Install Spark</span><br /><br />最後就安裝spark，安裝會需要一段時間。<br /><pre class="brush: bash">wget http://www.apache.org/dist/spark/spark-1.4.0/spark-1.4.0.tgz<br />tar xvf spark-1.4.0.tgz<br />cd spark-1.4.0<br />sbt/sbt assembly<br /></pre><br /><span style="color: #e06666; font-size: 18px;">4. Spark Interactive Shell</span><br /><br />安裝完以後，可以進入spark的interactive shell模式做個簡單的測試，<br />進入interactive mode，<br /><pre class="brush: bash">./bin/spark-shell<br /></pre><br />大概會花個10秒做init，進入以後，<br />會看到scala的prompt字樣，這裏就可以對spark進行操作了。<br />下面有二個例子，都是對README.md去做操作，<br />分別為找出含"apache"的句子，<br />以及找出有幾個"apache"的字。<br /><pre class="brush: bash">scala&gt; val textFile = sc.textFile("README.md")<br />scala&gt; textFile.count()<br />scala&gt; val results = textFile.filter(line =&gt; line.contains("apache")) // search apache<br />scala&gt; results.count()<br />scala&gt; results.collect()  // find out those lines contain apache<br /></pre><br /><span style="color: #e06666; font-size: 18px;">5. Start a Spark cluster</span><br /><br />好了，剛剛都是自爽模式，<br />接著我們要啟動一個spark cluster，<br />這個cluster可以讓很多個worker(slave)加入，<br />讓他們去執行工作。<br /><br />啟動cluster的指令如下：<br /><pre class="brush: bash">./sbin/start-master.sh<br /></pre><br />啟動完以後，你可以用netstat -tnlp去看一下，<br />你會發現有3個java bind住的connection，<br />預設分別為7077、8080、6066<br />7077就是這個cluster的port，將來worker要加入就得指定這個port，<br />8080是這個spark的web management UI。<br />所以你就可以打開browser，然後去看看web UI．<br />這時候你的worker數量應該是0。<br />如果想要加入一個worker，得透過下面的指令，<br /><pre class="brush: bash">./sbin/start-slave.sh spark://ubuntu:7077 # change ubuntu to your hostname<br /></pre><br />此時再去web UI看，應該就看到有一個worker存在。<br />上面是透過二個指令去分別啟動master and slave，<br />其實你也可以透過下面一個指令就去啟動master, slave，<br /><pre class="brush: bash">./sbin/start-all.sh<br /></pre><br /><span style="color: #e06666; font-size: 18px;">6. Connecting an Application to the Cluster</span><br /><br />有了一個spark cluster以後，<br />我們就可以把application掛上去，<br />我們可以透過前面使用的spark-shell，把這個shell run在cluster上。<br />只要加入--master這參數即可。<br /><pre class="brush: bash">./bin/spark-shell --master spark://ubuntu:7077 # change ubuntu to your hostname<br /></pre><br />進去以後，你一樣可以執行上面的example玩玩看。<br />同時你也可以去web UI上看看，會在"Running Applications"裡面看到這個shell。<br /><br /><span style="color: #e06666; font-size: 18px;">7. Writing an Application</span><br /><br />上一步也算是自爽模式，<br />我想應該不可能透過shell mode去做你想做的事情，<br />應該還是要寫個application，<br />所以這一步驟就是要寫一個很簡單的classs，<br />然後build它，再把它掛到cluster上執行。<br /><br />開始之前，先來設定一下spark的環境變數，<br /><pre class="brush: bash">echo "export SK_HOME=/root/spark-1.4.0" &gt;&gt; .bashrc<br />. .bashrc<br /></pre><br />然後改這隻script，（$SK_HOME/build/sbt-launch-lib.bash）<br />因為我在build的時候，有發生路徑的問題。<br /><pre class="brush: bash">vim $SK_HOME/build/sbt-launch-lib.bash<br /></pre><br />打開這檔案以後，找到這幾行，<br /><pre class="brush: python">SBT_VERSION=`awk -F "=" '/sbt\.version/ {print $2}' ./project/build.properties`<br />...<br />JAR=build/sbt-launch-${SBT_VERSION}.jar<br /></pre>換成下面這幾行，其實也只是變成絕對路徑。<br /><pre class="brush: python">SBT_VERSION=`awk -F "=" '/sbt\.version/ {print $2}' $SK_HOME/project/build.properties`<br />...<br />JAR=$SK_HOME/build/sbt-launch-${SBT_VERSION}.jar<br /></pre><br />完成以後，先來create幾個資料夾，<br /><pre class="brush: bash">mkdir -p ./spark-app/src/main/scala/<br /></pre><br />接著就可以寫一個簡單的class，<br />這class上面差不多，也是用來算count，<br />記得該class一定要放置在src/main/scala底下。<br /><pre class="brush: bash">cd ./spark-app<br />vim src/main/scala/SimpleApp.scala<br /></pre><br />class內容如下，<br /><pre class="brush: bash">/* SimpleApp.scala */<br />import org.apache.spark.SparkContext<br />import org.apache.spark.SparkContext._<br />import org.apache.spark.SparkConf<br /><br />object SimpleApp {<br />  def main(args: Array[String]) {<br />    val logFile = "/root/spark-1.4.0/README.md"<br />    val conf = new SparkConf().setAppName("Simple Application")<br />    val sc = new SparkContext(conf)<br />    val logData = sc.textFile(logFile, 2).cache()<br />    val numApache = logData.filter(line =&gt; line.contains("apache")).count()<br />    println("Line with apache: %s ".format(numApache))<br />  }<br />}<br /></pre><br />而在開始build之前，要寫一下這個app的dependency，<br />放置在sparka-app底下就好。<br /><pre class="brush: bash">vim simple.sbt<br /></pre><br />內容如下，<br /><pre class="brush: bash">name := "Simple Project"<br /><br />version := "1.0"<br /><br />scalaVersion := "2.11.6"<br /><br />libraryDependencies += "org.apache.spark" %% "spark-core" % "1.4.0"<br /></pre><br />接著就可以開始build，<br /><pre class="brush: bash">$SPARK_HOME/build/sbt package<br /></pre><br /><br />build完以後，<br />會發現spark-app底下多了二個folder（project, target)，<br />而我們要的jar檔會放在target底下，<br />我們就可以把這jar交付給spark執行。<br /><pre class="brush: bash">$SPARK_HOME/bin/spark-submit --class "SimpleApp" --master spark://ubuntu:7077 target/scala-2.11/simple-project_2.11-1.0.jar<br /></pre><br />應該會看到下面的字樣，<br /><pre class="brush: bash">Line with apache: 9 15/06/17 02:55:34 INFO TaskSetManager: Finished task 1.0 in stage 2.0 (TID 5) in 32 ms on 172.16.131.140 (2/2)<br /></pre><br />最後在web UI裡面的"Completed Applications"會看到我們剛剛執行的那個item。<br />基本上這樣就完成了簡單的spark application。<br /><br /><br /><br /><br /></div>
      </div>

      <a href="/2015/06/17/how-to-run-simple-apache-spark" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to create a customized Ubuntu ISO?</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">這篇要講怎麼客製化你自己想要的ubuntu ISO，<br />會講解一些<a href="http://en.wikipedia.org/wiki/Preseed">preseed</a>的參數，<br />preseed file是debian系列的automation config，而redhat系列就是用kickstart，<br />debian系列就是根據preseed file去進行安裝．<br />因此ubuntu也是用preseed，當然ubuntu也可以用kickstart，只是“似乎”支援沒有那麼好!?<br />題外話，雖然說preseed file是debian的標準格式，<br />但有一點要記得，debian自己本身的preseed file，並不是每一個command，ubuntu都能接受！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. Download ubuntu ISO</span><br /><br />首先，你要有一個ubuntu的ISO，<br />這裏我選用ubuntu 12.04的ISO，<br /><pre class="brush: bash">wget http://releases.ubuntu.com/12.04.5/ubuntu-12.04.5-server-amd64.iso<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">2. Mount the ISO</span><br /><br />接著要把ISO內的東西，先mount起來，接著再copy出來，<br /><pre class="brush: bash">mkdir -p /mnt/tmp /mnt/iso<br />mount -o loop ./ubuntu-12.04.5-server-amd64.iso /mnt/tmp<br />rsyn -av /mnt/tmp /mnt/iso<br />umount /mnt/tmp<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. Add boot menu option</span><br /><br />因為要客製化你自己的ISO，<br />所以我們要在boot menu中，新增一個屬於我們自己的menu，<br />首先先開啟這個isolinux/txt.cfg檔案<br /><pre class="brush: bash">vim /mnt/iso/isolinux/txt.cfg<br /></pre><br />打開以後應該會看到下面的內容，<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-VdB_0wKMjWA/VSo0ZnuY9hI/AAAAAAAAFjY/2TZzIfVE7Is/s1600/Screen%2BShot%2B2015-04-12%2Bat%2B4.56.41%2BPM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-VdB_0wKMjWA/VSo0ZnuY9hI/AAAAAAAAFjY/2TZzIfVE7Is/s640/Screen%2BShot%2B2015-04-12%2Bat%2B4.56.41%2BPM.png" /></a></div><br />我們就在label install之前新增一筆boot menu，<br />內容如下，<br /><pre class="brush: bash">label YourCustomizedISO<br />    menu label ^Customized ISO<br />    kernel /install/vmlinuz<br />    append  file=/cdrom/preseed/customized.seed initrd=/install/initrd.gz quiet --<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">4. Add pressed file</span><br /><br />接著就要新增一個客製化的preseed file，<br /><pre class="brush: bash">vim /mnt/iso/preseed/customized.seed<br /></pre><br />內容如下，這份preseed讓你可以不用輸入任何按鍵就進行自動安裝！<br />我覺得還蠻淺顯易懂的，每個section都有標註是在做什麼，<br />比較值得注意的是『Advance command』這個section，<br />這section裡面放的是，『安裝完ubuntu以後，要做些什麼事情。』<br />但是如果你想要在『安裝之前』或者『partition之前或者之後』做些事情，都是可以的。<br />只不過這個example，我們是在『安裝完ubuntu以後』。<br /><br />『preseed/late_command』就是『安裝完ubuntu以後』的意思。<br />不過這邊可能大家會覺得很奇怪，為什麼在late_command中，<br />一開始要cp至/target目錄？/target目錄又是什麼？<br />大家在安裝ubuntu的時候，可以change console一下，這時候cd至/target底下，<br />你會發現其實裡面就是你真正ubuntu安裝的位置！<br />那/target外面的東西是誰的呢(bin, lib, etc,....)？<br />其實是busybox的，所以你一定得把你想要的東西搬到/target裡面，<br />這樣在你安裝完以後，該東西才會存在。<br />接著還有另一段奇怪的command：in-target，<br />『in-target』，簡單的說就是chroot /target而已，<br />你也可以用chroot /target去取代『in-target』。<br /><br /><pre class="brush: bash">####### Localization #######<br />d-i debian-installer/locale string en_US<br />d-i debian-installer/language string en<br />d-i debian-installer/country string US<br /><br /><br />####### Keyboard selection #######<br />d-i console-setup/ask_detect boolean false<br />d-i console-setup/layoutcode string us<br />d-i console-setup/modelcode string pc105<br />d-i kbd-chooser/method string us<br />d-i keyboard-configuration/layout string USA<br />d-i keyboard-configuration/variant string USA<br /><br />####### Network configuration #######<br />#d-i netcfg/choose_interface select auto<br />d-i netcfg/choose_interface select eth0<br />d-i netcfg/get_hostname string ubuntu<br />d-i netcfg/get_domain string<br /># configure the network manually<br />#d-i netcfg/disable_autoconfig boolean true<br /># configure the network automatically<br />d-i netcfg/get_nameservers string 8.8.8.8<br />d-i netcfg/get_ipaddress string 172.16.131.138<br />d-i netcfg/get_netmask string 255.255.255.0<br />d-i netcfg/get_gateway string 172.16.131.2<br />d-i netcfg/confirm_static boolean true<br /><br />####### Apt setup #######<br />d-i apt-setup/security-updates boolean false<br />d-i apt-setup/restricted boolean false<br />d-i apt-setup/universe boolean false<br />d-i apt-setup/backports boolean false<br />d-i apt-setup/security boolean false<br />d-i mirror/http/proxy string<br /><br />####### Base system installation #######<br />d-i debian-installer/splash boolean false<br />d-i base-installer/install-recommends boolean true<br />d-i base-installer/kernel/altmeta string lts-saucy<br /><br />####### Clock and time zone setup #######<br />d-i clock-setup/utc boolean true<br />d-i clock-setup/utc-auto boolean true<br />d-i time/zone string UTC<br /><br />####### Boot loader installation #######<br />d-i finish-install/reboot_in_progress note<br />d-i grub-installer/only_debian boolean true<br />d-i grub-installer/with_other_os boolean true<br /><br />####### Partitioning using LVM #######<br />d-i partman-auto-lvm/guided_size string max<br />d-i partman-auto/choose_recipe select atomic<br />d-i partman-auto/method string lvm<br />d-i partman-lvm/confirm boolean true<br />d-i partman-lvm/confirm boolean true<br />d-i partman-lvm/confirm_nooverwrite boolean true<br />d-i partman-lvm/device_remove_lvm boolean true<br />d-i partman/choose_partition select finish<br />d-i partman/confirm boolean true<br />d-i partman/confirm_nooverwrite boolean true<br />d-i partman/confirm_write_new_label boolean true<br /><br />####### User #######<br />d-i passwd/root-login boolean true<br />d-i passwd/root-password password 1234<br />d-i passwd/root-password-again password 1234<br />d-i user-setup/allow-password-weak boolean true<br /># create user or not<br />d-i passwd/make-user boolean false<br />#d-i user-setup/encrypt-home boolean false<br />#d-i passwd/user-fullname string ken<br />#d-i passwd/username string ken<br />#d-i passwd/user-password password 123456<br />#d-i passwd/user-password-again password 123456<br /><br />####### Package selection #######<br />d-i pkgsel/include string openssh-server vim<br />d-i pkgsel/install-language-support boolean false<br />d-i pkgsel/update-policy select none<br />d-i pkgsel/upgrade select none<br /><br />tasksel tasksel/first multiselect standard, ubuntu-server<br /><br />####### Advance command #######<br />d-i preseed/late_command string \<br />cp /cdrom/preseed/setup-something.bash /target/tmp/setup-something.bash &amp;&amp; in-target chmod +x /tmp/setup-something.bash &amp;&amp; in-target /bin/bash /tmp/setup-something.bash<br /><br /></pre><br /><br /><br /><span style="color: #e06666; font-size: 18px;">5. Make an ISO</span><br /><br />完成上面的步驟後，<br />剩下最後一步就完成了，<br />把剛剛copy出來的內容，在包成一個ISO就好了。<br /><pre class="brush: bash">mkisofs -r -R -J -T -v -b isolinux/isolinux.bin -no-emul-boot -boot-load-size 4 -boot-info-table -z -iso-level 4 -c isolinux/isolinux.cat -o custom.iso /mnt/iso<br /></pre><br />大概等個20秒以後，就會看到一個custom.iso，就代表你成功了！<br /><br /><br /><br /><br /><br /><br /><br /><br /></div><br />
      </div>

      <a href="/2015/04/13/how-to-create-customized-ubuntu-iso" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>MogileFS: Distributed filesystem</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><br /><a href="https://github.com/mogilefs/">MogileFS</a>是分散式檔案系統(DFS)的一種，<br />在MogileFS中，主要分成2個角色，<br />&nbsp;&nbsp;&nbsp;&nbsp; 1. tracker: 記錄有哪些storage<br />&nbsp;&nbsp;&nbsp;&nbsp; 2. storage node: 單純放檔案的角色<br />其實還有第三個角色，是tracker的DB，<br />這db角色是用來存放storage在哪裡、有幾個storage等資訊，<br />以及每個檔案類型要replicate幾份等等之類的資訊，<br />不過我會把tracker's DB和tracker本身歸類在一起，<br />因為它們兩個一定得在同檯機器上，而且缺一不可，<br />但tracker和storage不一定要在同檯機器上面！<br /><br />如果說為什麼要用mogilefs的話，大概有以下2個原因吧，<br />&nbsp;&nbsp;&nbsp;&nbsp; 1. 自動作replicate<br />&nbsp;&nbsp;&nbsp;&nbsp; 2. application level，不需要特別的kernel module（setup簡單)<br /><br /><span style="color: #e06666; font-size: 18px;">1. Install mogilefs</span><br /><br />安裝mogilefs方式大概有三種，用cpan, apt, 拿source自己build，<br />個人偏好用apt-get安裝，<br />這裡選擇在ubuntu 14.04上安裝，<br /><pre class="brush: bash">apt-get install python-software-properties<br />add-apt-repository ppa:saz/mogilefs<br />apt-get update<br />apt-get install mogilefsd mogstored mogilefs-utils<br /></pre><br />這樣就完成安裝，接下來要setup mogilefs,<br /><br /><span style="color: #e06666; font-size: 18px;">2. Setup mogilefs tracker</span><br /><br />前面有說到有tracker就一定要有db，<br />所以請先安裝好mysql，安裝好以後就執行下面的command，<br />記得把password換成你想要使用的密碼！<br /><pre class="brush: java">mysql&gt; CREATE DATABASE mogilefs;<br />mysql&gt; CREATE USER 'mogilefs'@'%' IDENTIFIED BY 'password';<br />mysql&gt; GRANT SELECT,INSERT,UPDATE,DELETE,CREATE,ALTER ON mogilefs.* TO 'mogilefs'@'%';<br />mysql&gt; flush privileges;<br /></pre><br />接著要編輯/etc/mogilefs/mogilefsd.conf這個檔案，<br />這個檔案，其實只有在tracker的角色上才需要去編輯，<br />意思是說如果你有三檯機器，那麼只有其中一檯才需要去設定這個檔案！<br />只要改下面兩個設定就好，<br /><pre class="brush: bash">db_pass = password<br />listen = 10.0.0.172:7001<br /></pre>db_pass就是上一步驟你所輸入的密碼，<br />listen就是這個tracker要listen在哪個ip以及哪一個port上面！<br /><br />接著使用下面的command進行db setup，<br />一樣記得把password換成跟上面一樣的！<br /><pre class="brush: bash">mogdbsetup --dbhost=10.0.0.172:7001 --dbname=mogilefs --dbuser=mogilefs --dbpassword=password<br /></pre><br />接著編輯.mogilefs.conf，這檔案會記錄著你的tracker在哪裡，<br />然後mogilefs會去問這tracker所有storage的資訊．<br /><pre class="brush: bash">echo "trackers = 10.0.0.172:7001" &gt; ~/.mogilefs.conf<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">3. Setup mogilefs storage node</span><br /><br />tracker的目的在於記錄著有哪些storage可以用，<br />所以在完成setup tracker以後，接著就要來setup storage，<br />首先，先增加一個store host，<br /><pre class="brush: bash">mogadm --trackers=10.0.0.172:7001 host add store1 --ip=10.0.0.172 --status=alive<br /></pre>--trackers：指定加在哪個tracker上<br />store1：是你的host name，<br />--ip：就是那一顆storage在哪裡<br /><br />那麼有了host以後，<br />就要有device，一個host裡面可以有很多個device，<br />可以把device想像成local disk、NFS...etc.<br />所以接著要告訴host有哪些device，<br /><pre class="brush: bash">mogadm --trackers=10.0.0.172:7001 device add store1 1 --status=alive<br /></pre>比較特別參數是“1”，<br />1的意思是device 1，<br /><br />再來還要增加一個domain，等等後面會說明這domain的用途<br /><pre class="brush: bash">mogadm domain add ken-storage<br /></pre><br />完成增加一個device了，<br />接著mogilefs store會去找那個device，<br />所以接著要去create folder，之後檔案都會放在那folder裡面，<br /><pre class="brush: bash">mkdir -p /var/mogdata/dev1<br />chown mogstored /var/mogdata/dev1<br /></pre><br />這樣storage也設定完成了，<br />那麼該怎麼知道有設定成功？<br />可以透過mogadm check指令去看，<br />如果是成功的話，應該會看到下面的畫面，<br /><pre class="brush: bash">root@ip-10-0-0-172:~# mogadm check<br />Checking trackers...<br />  10.0.0.172:7001 ... OK<br /><br />Checking hosts...<br />  [ 1] store1 ... OK<br /><br />Checking devices...<br />  host device         size(G)    used(G)    free(G)   use%   ob state   I/O%<br />  ---- ------------ ---------- ---------- ---------- ------ ---------- -----<br />  [ 1] dev1             7.324      1.480      5.844  20.21%  writeable   N/A<br />  ---- ------------ ---------- ---------- ---------- ------<br />             total:     7.324      1.480      5.844  20.21%<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: 18px;">4. Test using command line</span><br /><br />測試之前，請先建立一個tmp file（hello.txt）<br />上傳檔案，<br /><pre class="brush: bash">mogupload  --file="./hello.txt" --domain=ken-storage --key="first-file"<br /></pre>下載檔案<br /><pre class="brush: bash">mogfetch --key="first-file" --file="./output-file" --domain=ken-storage<br /></pre>刪除檔案<br /><pre class="brush: bash">mogdelete --key="first-file"  --domain=ken-storage<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">5. Advance: Replication </span><br /><br />完成上面的基本操作以後，<br />並沒有發揮mogilefs replicate的功能，<br />那要做到replication也很簡單，<br />記得上面我們有add domain嗎？<br />domain其實有點難解釋，可以把它想像成像是AWS S3的bucket，<br />而這bucket下有許多policy，<br />所以我們現在就要替這這bucket(domain)加replicate的policy，<br /><pre class="brush: bash">mogadm class add ken-storage txt --mindevcount=2<br /></pre>這指令的意思是，當檔案的class是txt時，請replicate 2份！<br /><br />完成replication設定以後，<br />因為前面的設定都只有一個device，<br />只有一個deivce情況下，mogilefsd是不會進行replication的，<br />所以我們得再增加一個device，<br />建議你不要在同一檯機器上多增加一個device，畢竟沒有太大意義，<br />你在同一檯機器上做replication....?<br />如果這檯機器掛了，檔案就通通不見了，<br />所以會建議你在第二檯機器上增加一個device，<br />第二檯機器上就單純是storage node的角色了，<br />所以只需要做下面設定，記得把ip換成第二檯的ip！（只要改10.0.0.199的部分）<br /><pre class="brush: bash">echo "trackers = 10.0.0.172:7001" &gt; ~/.mogilefs.conf<br />mogadm --trackers=10.0.0.172:7001 host add store2 --ip=10.0.0.199 --status=alive<br />mogadm --trackers=10.0.0.172:7001 device add store2 2 --status=alive<br />mkdir -p /var/mogdata/dev2<br />chown mogstored /var/mogdata/dev2<br /></pre><br /><span style="color: #e06666; font-size: 18px;">6. Test Replication</span><br /><br />其實跟第四步驟是一樣的，只是多一個參數--class，<br />這class就和上一步驟所填寫的一樣即可．這樣hello.txt就會被複製到另外一檯機器上去！<br /><pre class="brush: bash">mogupload  --file="./hello.txt" --domain=ken-storage --key="first-file" --class=txt<br /></pre><br />如果replication失敗，那麼在db裡面的table file_to_replication將會有那筆資料，<br />你也可以透過/var/log/syslog看是什麼error message，<br />我自己使用的mogilefs版本，就有遇到一個<a href="http://www.php-oa.com/2013/11/01/mogilefs-job-replicate-died.html">syscal module的版本問題</a>，<br />透過<a href="http://www.php-oa.com/2013/11/01/mogilefs-job-replicate-died.html">連結</a>的中的方法去解決的！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">7. Advance: Integrate it with application </span><br /><br />當然有了mogilefs以後，不可能都透過command line去操作呀，<br />如果我想要整合在我的application裡怎麼辦？<br />其實也很簡單，看你用什麼language，至少我用的language(java, python)都有相關的lib可以使用，<br />這裡使用pyhton來作為說明，<br />用<a href="https://github.com/AloneRoad/pymogile">pymogile</a>來作為操作mogile的lib，<br />安裝pymogile，<br /><pre class="brush: bash">git clone https://github.com/AloneRoad/pymogile.git<br />cd pymogile/<br />python setup.py install<br /></pre><br />下面是一個簡單的example用pymogile操作mogilefs，<br /><pre class="brush: python">from pymogile import Client, MogileFSError<br /><br />datastore = Client(domain='ken-storage', trackers=['10.0.0.172:7001'])<br />key_id='replicate'<br /><br />def upload_file():<br />    fp = datastore.new_file(key_id)<br />    fp.write('test')<br />    fp.close()<br /><br />def get_path():<br />    print datastore.get_paths(key_id)<br /><br />def get_data():<br />    print datastore.get_file_data(key_id)<br /><br />upload_file()<br />get_path()<br />get_data()<br /></pre><br /><br /><br /><br /><br /><br /></div><br /><br /><br />
      </div>

      <a href="/2014/11/24/mogilefs-distributed-filesystem" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Create local package repository on Ubuntu</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><br />先前有講過<a href="http://blog.kenyang.net/2014/09/how-to-build-your-own-debian-package.html">如何建立自己的debian package</a>，<br />這裡要講怎麼建立一個local的repository，<br />讓這repository可以在internet上供人使用．<br />其實這概念跟apt-mirror有點像，只不過deb source是來自於自己罷了．<br /><br /><span style="color: #e06666; font-size: 18px;">1. Create your debian package</span><br /><br />這一步驟就去參考<a href="http://blog.kenyang.net/2014/09/how-to-build-your-own-debian-package.html">這篇文章吧</a>，<br />當然你也可以用ubuntu既有的debian package．（只不過我覺得那不如就用apt-mirror就好）<br /><br /><br /><span style="color: #e06666; font-size: 18px;">2. Install apache</span><br /><br />既然你要成為一個repository server，<br />那麼就要安裝web server，這裡就選apache吧．<br /><pre class="brush: bash">apt-get install apache2<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">3. Setup</span><br /><br />先create一個folder在apache default目錄下（ex: /var/www)，<br /><pre class="brush: bash">mkdir -p /var/www/debian<br /></pre><br />把你要給人使用的debian package搬到上面建立的目錄下，<br /><pre class="brush: bash">mv *.deb /var/www/debian<br /></pre><br />接著就替你的debian package建立index，<br /><pre class="brush: bash">cd /var/www<br />dpkg-scanpackages debian /dev/null | gzip -9c &gt; debian/Packages.gz<br /></pre><br />這樣就完成了！<br /><br /><span style="color: #e06666; font-size: 18px;">4. Test</span><br /><br />接著就把你的repo加到list裡面去吧，如果要給別人用，或者在別檯機器上用，<br />記得把127.0.0.1換成public ip．<br /><pre class="brush: bash">echo "deb http://127.0.0.1 debian/" &gt;&gt; /etc/apt/sources.list<br />apt-update<br />apt-install your-deb-package<br /></pre><br /><br /></div><br /><br /><br />
      </div>

      <a href="/2014/10/23/create-local-package-repository-on" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android In-app billing (IAB) version 3</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><br />這篇要講怎麼整合IAB，<br />IAB就是讓user可以在你的app中購買商品．<br /><br /><span style="color: #e06666; font-size: 18px;">1. Download billing service library</span>  <br /><br />開啓Android SDK Manager，<br />找到最下面的 Extras，安裝Google Play Billing Library，<br />安裝完以後，在您Android SDK 目錄中會有該 Library，位置如下：<br /><pre class="brush: java">$SDK_PATH/extras/google/play_billing/in-app-billing-v03<br /></pre><br /><span style="color: #e06666; font-size: 18px;">2. Create new package</span>  <br /><br />接著在這一步要在你的project下建立一個新的package，<br />點選 File &gt; New &gt; Package, 名稱為com.android.vending.billing<br /><br /><span style="color: #e06666; font-size: 18px;">3. Copy necessary files</span>  <br /><br />在這一步驟要複製一些必要的檔案至project中，<br />1. IInAppBillingService.aidl，<br />&nbsp;&nbsp;&nbsp;&nbsp;這個檔案放在$SDK_PATH/extras/google/play_billing/in-app-billing-v03底下，<br />&nbsp;&nbsp;&nbsp;&nbsp;把IInAppBillingService.aidl，複製到我們剛剛create的package中，<br />2. *.java<br />&nbsp;&nbsp;&nbsp;&nbsp;Google幫我們寫好了很多的wrapper，可以很方便地使用IAB，<br />&nbsp;&nbsp;&nbsp;&nbsp;這wrapper會幫我們處理一些bind service的動作，<br />&nbsp;&nbsp;&nbsp;&nbsp;透過這些wrapper可以輕易地整合IAB，<br />&nbsp;&nbsp;&nbsp;&nbsp;檔案路徑如下：<br /><pre class="brush: java">$SDK_PATH/extras/google/play_billing/samples/TrivialDrive/src/com/example/android<br />/trivialdrivesample/util<br /></pre>&nbsp;&nbsp;&nbsp;&nbsp;把這底下所有的.java複製到你的project當中，並且要把package名稱改成自己的<br /><br /><span style="color: #e06666; font-size: 18px;">4. Add permission</span>  <br /><br />接著要在AndroidManifest.xml中加入下面這個權限，<br /><pre class="brush: java">&lt;uses-permission android:name=&quot;com.android.vending.BILLING&quot;&gt;<br />&lt;/uses-permission&gt;</pre><br /><span style="color: #e06666; font-size: 18px;">5. Upload apk</span>  <br /><br />因為要購買一個商品，這商品在新増之前，<br />你一定要有一個apk是有BILLING權限的，<br />否則是不能新增一個商品．<br />所以在這步驟要先上傳上去，你可以上傳以後再把它變成draft就好，<br />當然！你也可以通通寫完code再丟上去測試．<br /><br /><span style="color: #e06666; font-size: 18px;">6. Add product</span>  <br /><br />上傳apk以後，接著就可以去developer console新增product了，<br />1. 先到自己的developer console <br />2. 點選自己的app <br />3. 點選左邊的In-app Products <br />4. 點選Add new product<br />5. 輸入Product ID（這id等等code裡面會用到）<br />6. 最後填寫product的資訊<br /><br /><span style="color: #e06666; font-size: 18px;">7. Get public key</span>  <br /><br />由於在跟Google Play溝通時，<br />需要一把public key，<br />這把key一樣在developer console上，<br />1. 先到自己的developer console <br />2. 點選自己的app <br />3. 點選左邊的Services &amp; APIs<br />key就會在畫面之中，如下圖！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-juHaFVdxJtE/VD9hQRnFPSI/AAAAAAAAFhI/8k_Ou03qUOU/s1600/Screen%2BShot%2B2014-10-16%2Bat%2B2.08.36%2BPM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-juHaFVdxJtE/VD9hQRnFPSI/AAAAAAAAFhI/8k_Ou03qUOU/s1600/Screen%2BShot%2B2014-10-16%2Bat%2B2.08.36%2BPM.png" height="164" width="640" /></a></div><br /><br /><br /><span style="color: #e06666; font-size: 18px;">8. Implement</span>  <br /><br /><span style="color: #e06666; font-size: 18px;">8-1. Setup</span>  <br /><br />首先要先setup IabHelper，<br />在setup時就要把剛剛哪組public_key帶進去，<br />但由於Google有強烈的建議，不要直接hard code public key，<br />至少要用個xor encrypt的方式，或者用拆解字串的方式存放public key，<br />xor encrypt就是你先用xor去encrypt你的public key，<br />之後把encrypt過後的public key放在你的project中，<br />要用的時候再拿出來decrypt，decrypt完以後，應該就會是原先的public key了，<br />接著再判斷一下那組public key是否有包含“某部份”真正public key，<br />有的話才真的是你的public key，<br /><br /><pre class="brush: java">    private IabHelper mHelper;<br />    @Override<br />    public void onCreate(Bundle savedInstanceState) {<br /><br />        String base64EncodedPublicKey = xorDecrypt(PUBLIC_KEY, "key_password");<br /><br />        if (!base64EncodedPublicKey<br />                .contains("eFESRE6ijsRAp3TgWhY1zDwWwo1EqxQgt+f")) {<br />            throw new RuntimeException("This is not my key");<br />        }<br /><br />        mHelper = new IabHelper(this, base64EncodedPublicKey);<br /><br />        mHelper.startSetup(new IabHelper.OnIabSetupFinishedListener() {<br />            public void onIabSetupFinished(IabResult result) {<br />                Log.d(TAG, "Setup finished.");<br />                if (!result.isSuccess()) {<br />                    Log.d(TAG, "Problem setting up In-app Billing: " + result);<br />                }<br /><br />                if (mHelper == null)<br />                    return;<br />                <br />            }<br />        });<br />    }<br /><br />    public static String xorDecrypt(String input, String key) {<br />        byte[] inputBytes = Base64.decode(input, Base64.DEFAULT);<br />        int inputSize = inputBytes.length;<br /><br />        byte[] keyBytes = key.getBytes();<br />        int keySize = keyBytes.length - 1;<br /><br />        byte[] outBytes = new byte[inputSize];<br />        for (int i = 0; i &lt; inputSize; i++) {<br />            outBytes[i] = (byte) (inputBytes[i] ^ keyBytes[i % keySize]);<br />        }<br />        return new String(outBytes);<br />    }<br /><br /></pre><span style="color: #e06666; font-size: 18px;">8-2 購買商品</span>  <br /><br />購買商品要透過launchPurchaseFlow， <br />launchPurchaseFlow有五個參數， <br />1. activity <br />2. product id，就是剛剛上面在developer console新增的那組 <br />3. request code，onActivityResult時會回傳回來 <br />4. listener，購買狀態的listener，用來接收購買成功與否 <br />5. string，可以是空的，可以想像成是補充說明的意思，一樣在購買之後會回傳回來 <br /><pre class="brush: java">    if (mHelper != null) {<br />        mHelper.launchPurchaseFlow(this,<br />                SKU_PREMIUM,<br />                10001,<br />                mPurchaseFinishedListener,<br />                "bGoa+V7g/yqDXvKRqq+JTFn4uQZbPiQJo4pf9RzJ");<br />    }<br /><br /><br />    IabHelper.OnIabPurchaseFinishedListener mPurchaseFinishedListener = new IabHelper.OnIabPurchaseFinishedListener() {<br />        public void onIabPurchaseFinished(IabResult result, Purchase purchase) {<br />            if (result.isFailure()) {<br />                Log.e(TAG, "Error purchasing: " + result);<br />                return;<br />            } else if (purchase.getSku().equals(SKU_PREMIUM)) {<br />                Toast.makeText(getApplicationContext(), "buy success",Toast.LENGTH_LONG).show();<br />                Log.d(TAG, "Success purchasing:");<br />            }<br />        }<br />    };<br /><br /><br /></pre><br /><span style="color: #e06666; font-size: 18px;">8-3 查詢是否有購買</span>   <br /><br />在購買成功以後，android會把購買的結果cache在機器上， <br />以便快速地查詢， 查詢要透過queryInventoryAsync， <br />queryInventoryAsync有二個參數， <br />1. 是否要query product detail（ex: price） <br />2. listener  <br />其實第一個參數不一定要， <br />但是當你在沒有網路的情況下， 你的request一定都會是fail， <br />以至於你無法判斷這個user是否有購買了商品，<br />且如果你加了第一個參數，你就無法得到商品的detail資訊． <br />所以使用者要自己衡量一下何時該用．  <br /><pre class="brush: java">    mHelper.queryInventoryAsync(false,mGotInventoryListener);<br />    QueryInventoryFinishedListener mGotInventoryListener = new QueryInventoryFinishedListener() {<br />        public void onQueryInventoryFinished(IabResult result, Inventory inventory) {<br /><br />            if (result.isFailure()) {<br />                // handle error here<br />            } else {<br />                // does the user have the premium upgrade?<br />                boolean mIsPremium = inventory.hasPurchase(SKU_PREMIUM);<br />                if (mIsPremium) {<br />                    Toast.makeText(getApplicationContext(), "buy",Toast.LENGTH_LONG).show();<br />                }else {<br />                    Toast.makeText(getApplicationContext(), "no buy",Toast.LENGTH_LONG).show();<br />                }<br />            }<br />        }<br />    };<br /></pre><span style="color: #e06666; font-size: 18px;">8-4 Error handling</span>   <br /><br />最後一步驟，如果你launchPurchaseFlow了第一次，然後取消！ <br />隨即馬上launchPurchaseFlow第二次，絕對會crash， <br />原因是因為在onActivityResult中要做點處理， <br />我覺得這很tricky，因為在官網上並沒有提到！ <br />是去看他的example code才發現的！ <br />最後也要記得destroy這個helper．  <br /><pre class="brush: java">    @Override<br />    protected void onActivityResult(int requestCode, int resultCode, Intent data) {<br />        Log.d(TAG, "onActivityResult handled by IABUtil.1");<br />        // Pass on the activity result to the helper for handling<br />        if (mHelper!=null &amp;&amp; !mHelper.handleActivityResult(requestCode, resultCode, data)) {<br />            Log.d(TAG, "onActivityResult handled by IABUtil.2");<br />            // not handled, so handle it ourselves (here's where you'd<br />            // perform any handling of activity results not related to in-app<br />            // billing...<br />            super.onActivityResult(requestCode, resultCode, data);<br />        } else {<br />            Log.d(TAG, "onActivityResult handled by IABUtil.");<br />        }<br />    }<br /><br />    @Override<br />    protected void onDestroy() {<br />        super.onDestroy();<br />        if (adView != null) {<br />            adView.destroy();<br />        }<br /><br />        if (mHelper != null)<br />            mHelper.dispose();<br />        mHelper = null;<br />    }<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">9. Test</span>   <br /><br />要測試IBA真的是件麻煩的事情， <br />要做兩件事， <br />1. create test account <br />&nbsp;&nbsp;&nbsp;&nbsp;因為你用自己的developer account測，會永遠無法購買， '<br />&nbsp;&nbsp;&nbsp;&nbsp;會跟你說publisher cannot purchase this item. <br />&nbsp;&nbsp;&nbsp;&nbsp;所以要去到developer console中的setting裡面加一組test account， <br />2. Export Signed Application <br />&nbsp;&nbsp;&nbsp;&nbsp;因為你無法用debug key去build app， <br />&nbsp;&nbsp;&nbsp;&nbsp;用debug key build出來的app是無法測試的... <br />&nbsp;&nbsp;&nbsp;&nbsp;所以得用production key sign出來的app才可以測試． <br />&nbsp;&nbsp;&nbsp;&nbsp;接著再把sign好的apk裝在手機上就可以測試了！         <br /></div><br /><br /><br /><br />
      </div>

      <a href="/2014/10/16/android-in-app-billing-iab-version-3" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Backup service API  (backup internal database)</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">這篇要講Android自己的<a href="http://developer.android.com/training/cloudsync/backupapi.html">backup service</a>，<br />其實使用起來蠻簡單的，<br />主要分成下面4個步驟，<br /><br /><span style="color: #e06666; font-size: 18px;">1. Register for Android Backup Service</span>  <br /><br />首先要先去註冊一個API Key，先到這個<a href="https://developer.android.com/google/backup/signup.html?csw=1">網站</a>，<br />進去以後輸入你的package name，接著就會給你一組API key．<br />這樣就註冊完成．<br /><br /><span style="color: #e06666; font-size: 18px;">2. Configuration</span>  <br /><br />完成上面的註冊以後，接著要對你的project做configuration，<br />先開啟你的AndroidManifest.xml，<br />先在application element加上一個android:backupAgent這個attribute，<br />這個attribute的名字，就是待會你新增的class名稱，<br /><pre class="brush: java">&lt;application android:label=&quot;MyApp&quot;<br />             android:backupAgent=&quot;ExpenseBackupAgent&quot;&gt;<br /></pre><br />接著在application之中，加入下段的meta data，<br />記得把xxxxxxxxxx換成你剛剛註冊的API Key，<br /><pre class="brush: java">&lt;meta-data android:name=&quot;com.google.android.backup.api_key&quot;<br />android:value=&quot;xxxxxxxxxxxxxxxxxxx&quot; /&gt;<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. Backup internal database</span>  <br /><br />接著新增一個Class，這個Class要繼承BackupAgentHelper，<br />記得這Class名稱要跟你manifest.xml中的一樣！<br />這裡要題外話一下，其實你也可以繼承BackupAgent，<br />當你如果需要做到更複雜的backup時，<br />例如你不想backup整份file，你只想backup某個"部分"的data，<br />這時候你只能透過BackupAgent去做到，<br />而BackupAgentHelper其實也只是BackupAgent的一個wrapper，<br />讓你更輕易的backup和restore罷了．<br />回到主題，先新增一個class繼承BackupAgentHelper，內容如下，<br />在onCreate裡面用到了FileBackupHelper，<br />最原始的FileBackupHelper是真的用來backup某個file，<br />但因為我們這裡要backup db，<br />所以我們要override掉getFilesDir，<br />在getFilesDir中去拿db的路徑，<br />然後透過FileBackupHelper去做backup！<br />只要透過下面的code就可以幫你自動backup和restore了！<br /><br /><pre class="brush: java">public class ExpenseBackupAgent extends BackupAgentHelper {<br />    private static final String DB_NAME = "expense"; // db名稱<br />    private static final String TAG = ExpenseBackupAgent.class<br />            .getCanonicalName();<br /><br />    @Override<br />    public void onCreate() {<br />        Log.e(TAG, "backu db");<br />        FileBackupHelper dbs = new FileBackupHelper(this, DB_NAME);<br />        addHelper("dbs", dbs);<br />    }<br /><br />    @Override<br />    public File getFilesDir() {<br />        final File f = getDatabasePath(DB_NAME);<br />        return f.getParentFile();<br />    }<br />}<br /><br /></pre><br />雖然說backup和restore都是自動的，<br />那麼要怎麼主動的去request backup？<br />那就要用BackupManager了，<br />透過dataChanged，會去幫你queue這個backup的job，<br />為什麼是說queue呢？因為backup不會馬上執行的！<br />都是批次的執行！<br /><pre class="brush: java">BackupManager bm = new BackupManager(this);<br />bm.dataChanged();<br /></pre><br /><span style="color: #e06666; font-size: 18px;">4. Test</span>  <br /><br />上面說到了Backup都是批次執行，不是即時的，那我該怎測試呢？<br />要透過adb了，<br /><pre class="brush: bash">adb shell bmgr backup packagename  # 等於dataChanged<br />adb shell bmgr run                 # 立即去trigger backup job<br />adb uninstall packagename          # 先刪掉app<br /></pre>最後再安裝一次你的app，<br />打開以後應該會發現你的資料都還在！<br /><br /><br /><br /></div><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/10/13/android-backup-service-api-backup" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Set up javadocs and source for 3rd-party libs</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><br />正常的一個3rd-party lib應該會有3個jar，以greenDao為例，<br />&nbsp; &nbsp; 1. greendao-1.3.7.jar<br />&nbsp; &nbsp; 2. greendao-1.3.7-javadoc.jar<br />&nbsp; &nbsp; 3. greendao-1.3.7-sources.jar<br /><br />一般而言，其實只要在libs資料夾放第一個，我們就可以正常使用greenDao了，<br />但是你就會看不到任何的document，大概會看到下面的圖示！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-fvtNRCyhOpc/VCvUN2hg6UI/AAAAAAAAFS0/H5XFWTUx3D0/s1600/Screen%2BShot%2B2014-10-01%2Bat%2B6.15.09%2BPM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-fvtNRCyhOpc/VCvUN2hg6UI/AAAAAAAAFS0/H5XFWTUx3D0/s1600/Screen%2BShot%2B2014-10-01%2Bat%2B6.15.09%2BPM.png" height="112" width="640" /></a></div>但就算你把這3個jar通通放進去libs資料夾，你也看不到任何的document.<br />原因是因為你要有一個greendao-1.3.7.jar.properties檔案去config路徑.<br /><br />我的習慣會在libs資料夾底下，在建立兩個資料夾，分別為<br />&nbsp; &nbsp; &nbsp;1. libs/docs<br />&nbsp; &nbsp; &nbsp;2. libs/src<br />然後把對應的jar放在裡面，<br />所以我的greendao-1.3.7.jar.properties就會跟下面一樣，<br /><pre class="brush: java">src=src/greendao-1.3.7-sources.jar                                                                             <br />doc=docs/greendao-1.3.7-javadoc.jar<br /></pre><br />最後再把project close，然後再open起來，<br />應該就會看到document了！<br /><br /></div>
      </div>

      <a href="/2014/10/01/android-set-up-javadocs-and-source-for" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android ORM lib: greeDao</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><a href="http://en.wikipedia.org/wiki/Object-relational_mapping">ORM</a>應該不用多做解釋了，<br />而Android自己本身並沒有ORM的任何lib可用，<br />但有很多熱心的人做了third-party lib，像是<a href="http://ormlite.com/">OrmLite</a>、<a href="http://greendao-orm.com/">greenDao</a>，<br />本篇要講的是greenDao，<br />為什麼我使用greenDao呢？<br />其實網路上不少人在做OrmLite和greenDao的<a href="https://github.com/littleinc/android-orm-benchmark">benchmark</a>，<br />greenDao的performance真是一片倒，<br />也因此我選擇了greenDao，<br />不過說實在的，greenDao一開始的前置作業真是有點麻煩！<br />所以特地寫一篇來記錄！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. Clone the repository</span><br /><br />先把greenDao的repository clone下來，<br /><pre class="brush: bash">git clone https://github.com/greenrobot/greenDAO.git<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">2. Download jar</span><br /><br />這就是我說的，前置作業很麻煩！<br />有3個必要的jar檔，竟然沒有在repository中！<br />要自行去下載！不過用gradle和marven就不用自行去下載，<br />anyway我用的是eclipse，所以得去下載！<br />&nbsp;&nbsp;&nbsp;&nbsp;1. <a href="http://mvnrepository.com/artifact/org.freemarker/freemarker/2.3.20">freemaker.jar</a><br />&nbsp;&nbsp;&nbsp;&nbsp;2. <a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22de.greenrobot%22%20AND%20a%3A%22greendao-generator%22">greendao-generator-1.3.0</a><br />&nbsp;&nbsp;&nbsp;&nbsp;3. <a href="http://search.maven.org/#search%7Cga%7C1%7Cg%3A%22de.greenrobot%22%20AND%20a%3A%22greendao%22">greendao-1.3.7.jar</a><br />前面兩個jar是為了build出dao而用的，<br />而後面第三個jar給我們app使用的！<br />在開始之前，先說明一下整體流程，<br />大致上分為兩個步驟，<br />&nbsp;&nbsp;&nbsp;&nbsp;1. 產生 DAO files<br />&nbsp;&nbsp;&nbsp;&nbsp;2. 把DAO files 加到自己的android project中<br /><br /><br /><span style="color: #e06666; font-size: 18px;">3. Generate DAO files</span><br /><br />還記得第一步驟clone下來的repository嗎？<br />repository中有很多份中有很多個project，<br />我們只會用到DaoExampleGenerator，<br />首先先開啟你的eclipse，<br />點選【File】-&gt;【Import】-&gt;【General】-&gt;【Existing Projects into Workspace】-&gt;選擇【DaoExampleGenerator】project<br />import進來以後應該會很多error，<br />因為少了2個jar檔，就把【freemaker.jar】和【greendao-generator-1.3.0】import進來吧！<br /><br />接著打開ExampleDaoGenerator這個class，<br />這隻java會幫你generate出4個files，<br />&nbsp;&nbsp;&nbsp;&nbsp;1. DaoMaster<br />&nbsp;&nbsp;&nbsp;&nbsp;2. DaoSession<br />&nbsp;&nbsp;&nbsp;&nbsp;3. Model<br />&nbsp;&nbsp;&nbsp;&nbsp;4. ModelDao<br />DAO就是用來負責db的一切操作, create table, insert, delete, query...etc.<br />model就單純是一個object而已！<br />這四個files都要加到我們的android project之中，<br /><br />接著來說明一下ExampleDaoGenerator裡面在做什麼，(我把原本的code改成我的sample了)<br /><pre class="brush: java">public static void main(String[] args) throws Exception {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 第一個參數是db的版本，第二個是package名稱<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Schema schema = new Schema(1, "net.kenyang.dao"); <br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;addNote(schema);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 產生上述說明的files<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;new DaoGenerator().generateAll(schema, "../");<br />}<br /><br />private static void addNote(Schema schema) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;// 這裡可以想像就是增加一個table，有三個欄位，且都是not null<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Entity note = schema.addEntity("Note");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note.addIdProperty();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note.addStringProperty("title").notNull();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note.addDateProperty("date").notNull();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note.addIntProperty("category").notNull();<br />        <br />}<br /><br /></pre><br />接著只要按下run以後，這些files就會被產生出來！<br />接著就把這些files搬移到你的android project當中，<br />請注意！！由於我們上面的schema是"net.kenyang.dao"，<br />那麼你的android project中也要有這個package，並且把這些files放置在該package當中！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">4. Insert, select, delete</span><br /><br />完成上面的前置作業以後，在開始之前，<br />請記得把第二步驟下載的greendao-1.3.7.jar加到android project中，<br />接著就可以開始使用了！<br /><br />insert<br /><pre class="brush: java">DevOpenHelper helper = new DevOpenHelper(this, "expense", null);<br />DaoMaster daoMaster = new DaoMaster(helper.getWritableDatabase());<br />DaoSession daoSession = daoMaster.newSession();<br /><br />NoteDao noteDao = session.getNoteDao();<br />Note note = new Note(null, "hello", new Date(), 0);<br />noteDao.insert(note);<br /></pre><br />select<br /><pre class="brush: java">QueryBuilder&lt;Note&gt; query = noteDao.queryBuilder();<br />// 查詢如果日期小於今天，並且照日期排序<br />query.where(Properties.Date.le(calendar.getTime())).orderDesc(Properties.Date);<br />for (Note n : query.list()) {<br />     Log.e("ken", n.getTitle());       <br />}<br /></pre><br />update<br /><pre class="brush: java">public void fnUpdate(long id) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note note = noteDao.load(id);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;note.setTitle("change title");<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noteDao.update(note);<br />}<br /></pre><br />delete <br /><pre class="brush: java">public void fnDelete(long id) {<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;noteDao.deleteByKey(id);<br />}<br /><br /></pre><br />比原本的SQLiteOpenHelper好用太多了啊！<br /><br /><br /><br /><br /><br /></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/09/24/android-orm-lib-greedao" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to build your own debian package?</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">其實不久前有寫一篇講怎麼<a href="http://blog.kenyang.net/2014/03/build-deb-package-from-source.html">build deb package</a>，<br />不過那篇的code source並不是來自於自己的source，<br />那麼假設你今天自己有一個web，你想把這web打包成一個deb供人安裝，那該怎麼做呢？<br />這篇主要就是講怎麼create一個自己的deb package．<br /><br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. Install necessary package</span><br /><br /><pre class="brush: bash">sudo apt-get install dh-make<br /></pre>dh-make是用來準備debian package所需要的files，<br />等等會用來gen template files．<br /><br /><br /><span style="color: #e06666; font-size: 18px;">2. Prepare environment</span><br /><br />這裡先create一個folder，名稱為www，<br />www底下也要create一些web所需的資料夾和檔案，像是images, css ,js...etc<br />www的目錄結構大概就長這樣，<br /><br />www<br />├── css<br />│   └── main.css<br />├── images<br />│   └── a.png<br />└── static<br />└── index.html<br /><br /><br /><br />我們要把folder底下的東西都打包進去debian package，<br />並且讓其他人在安裝這個debian package時，可以安裝到我們所指定的path底下！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">3. Generate template files</span><br /><br />在這步要用前面安裝的dh_make來generate出debian package所需要的template files,<br />在generate之前，先設定一個環境變數，<br />這環境變數是用來記錄這個debian package的作者是誰<br /><pre class="brush: bash">export DEBFULLNAME="Ken Yang"<br /></pre><br /><pre class="brush: bash">dh_make --single --packagename ken-sdk_0.1 --native -e xxxx@gmail.com<br /></pre>--packagename要注意一下，<br />--packagename分為兩個部分，<br />前面的部分ken-sdk是package name，<br />package name只能用-來分隔，不能用底線！<br />而後面的_0.1是version number，<br />--natvie，意思是這個debian不是從一個既有的tarball gen出來的！<br /><br />generate完成以後，你會發現在www folder底下多了一個debian folder，<br />這debian folder裡面是放一些build debian package所需要的template files，<br />而既然是template files，那麼就有一些不需要的file或者需要被修改的file，<br />首先先刪除不需要的file吧！<br /><pre class="brush: bash">sudo rm debian/*.ex debian/*.EX<br /></pre><br />接著就來修改這個template，<br />首先要先改control這file，<br /><pre class="brush: bash">vim debian/control<br /></pre>打開以後，會看到很多information，<br />你比較需要改的大概就只有Depends (dependency)，和Description了！<br />改完儲存以後即可！<br /><br />接下來要改copyright，<br /><pre class="brush: bash">vim debian/copyright<br /></pre>打開以後，大概就只有年份和作者名稱要改而已！<br /><br />剩下其他的file，像是README, docs就看你要不要改了，<br />記得rules千萬別改！rules是build package的起頭！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">4. Build debian package</span><br /><br />在完成template的修改，準備開始build之前，<br />我們還有最後一個步驟，就是要指定哪些files or folder是你要放進去這個debian package的！<br />而就是靠一個檔案去記錄！<br />這個檔案名稱很重要，要跟你前面的package name一模一樣，<br />我們前面的package name是ken-sdk，<br />所以這個file要叫做ken-sdk.install，<br />裡面的格式就像下面一樣，<br /><pre class="brush: bash">images/* /opt/www/image<br />css/* /opt/www/css<br />js/* /opt/www/js<br /></pre>第一格參數：現在www folder底下路徑的檔案<br />第二格參數：將來這deb package被安裝時，這些files要被安裝到哪裡<br />儲存以後，就可以開始build，指令如下：<br /><pre class="brush: bash">dpkg-buildpackage -rfakeroot -b<br /></pre>-rfakeroot：使用root的權限<br />-b：單純只是binary，不要去build source<br /><br /><br /><span style="color: #e06666; font-size: 18px;">5. Verify</span><br /><br />完成以後，<br />debian package會放在folder的上層目錄，<br />應該會有一個ken-sdk_0.1_amd64.deb，<br />有一個快速verify你要的files有沒有被包進去，<br /><pre class="brush: bash">lesspipe ken-sdk_0.1_amd64.deb<br /></pre><br />當然你也可以安裝起來看看，<br /><pre class="brush: bash">sudo dpkg --install ../ken-sdk_0.1_amd64.deb<br /></pre><br />接著就去看剛剛指定的folder（/opt/www），是否有我們原本的檔案！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">6. Advance: Pre-Install or Post-Install</span><br /><br />如果你想要在這package完成安裝或者開始安裝之前，做一些前置作業，<br />那麼就可以靠preinst和postinst這兩個檔案，<br />preinst就是安裝之前，<br />postinst就是安裝完成之後，<br />相反地，如果你想要在這package被remove時，也做一些操作，<br />那麼就要有prerm和postrm這兩個檔案！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">7. Advance: Update pacakge</span><br /><br />如果你這package想要更新，<br />變成0.2版本，你可以直接編輯change log，但有點麻煩！<br />可以透過指令快速達成！<br /><pre class="brush: bash">dch -v 0.2 "Update package."<br /></pre><br />之後一樣直接dpkg-buildpackage -rfakeroot -b就可以了！<br /><br /><br /></div><br /><br /><br />
      </div>

      <a href="/2014/09/04/how-to-build-your-own-debian-package" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to create X.509 certificates for Amazon IAM user?</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">You will need X.509 certificates when you send a SOAP request to AWS or use command line tool.<br />There are two ways to create X.509 certificates.<br /><br />(1) If you are not using IAM account:<br />&nbsp;&nbsp;&nbsp;&nbsp;You can create certificate on <a href="https://console.aws.amazon.com/iam/home?nc1=h_m_sc#security_credential">AWS console</a>.<br />&nbsp;&nbsp;&nbsp;&nbsp;Each account only have a maximum of two certificates at a time.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-rmeTV_n3DBc/U_2LJy60heI/AAAAAAAAFQI/lJt0rEcs3xY/s1600/Screen%2BShot%2B2014-08-27%2Bat%2B3.39.21%2BPM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-rmeTV_n3DBc/U_2LJy60heI/AAAAAAAAFQI/lJt0rEcs3xY/s400/Screen%2BShot%2B2014-08-27%2Bat%2B3.39.21%2BPM.png" /></a></div><br /><br />(2) If you are using IAM account:<br />&nbsp;&nbsp;&nbsp;&nbsp;You need to create certificate by yourself.<br /><br /><br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. Create private key</span><br /><br />You need to create a private key first before create a certificate, <br />because you will use this private key to create a certificate.<br /><pre class="brush: bash">openssl genrsa 2048 &gt; private-key.pem<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">2. Create certificate</span><br /><br />Once you finished the step one, you can use the private key to create a certificate.<br /><pre class="brush: bash">openssl req -new -x509 -nodes -sha1 -days 99999 -key private-key.pem -outform PEM &gt; cert.pem  <br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">3. Copy the content of certificate</span><br /><br />After you finished all the steps, just copy the content of the certificate.<br /><pre class="brush: bash">ken@build:~$ cat cert.pem <br />-----BEGIN CERTIFICATE-----<br />MIIDXzCCAkegAwIBAgIJAJxcjyc5F908MA0GCSqGSIb3DQEBBQUAMEUxCzAJBgNV<br />BAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJbnRlcm5ldCBX<br />aWRnaXRzIFB0eSBMdGQwIBcNMTQwODI3MDc1NDAyWhgPMjI4ODA2MTAwNzU0MDJa<br />MEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEwHwYDVQQKDBhJ<br />bnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAw<br />ggEKAoIBAQCk8L/z2O84OcRno7YgGu0UkjnABuXhIM96RfZZKhqg74hga7nsLPLK<br />CzhtslDKAOEjxASo7L0Iq6/5kxJZp4cZakKacDOvnnv2HwQxCXGUEadXcmeknfAh<br />SvyRYS3FrKj4/oth+pwUm6nvd9fGYg01rJITUQupeADCqhSJUypZbQUypmPxf8Sg<br />ek7ZW5ErPuyZZ+WmL6TzZaQXfZqvPrN25hRg7AboB8SIKgusUrLK6WgnISlJ7fDh<br />kCpsy8qSD+Lu74h2hW6TiLy2qJbcTKn8sKb1C4XgWb1FBMzqfJQWtCMVWtDoyzZH<br />Vj07gzeTDkQ1EvUKHk26x6MEsOlcTV9XAgMBAAGjUDBOMB0GA1UdDgQWBBQOYnDF<br />FYz2o3+AlVHWwPIzlcFs4DAfBgNVHSMEGDAWgBQOYnDFFYz2o3+AlVHWwPIzlcFs<br />4DAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4IBAQBPE3ikbJ/vH6QfkwUK<br />qot+nU15keDSZ2c6itRnNuwjfF8lsZQCJ66w2H+HXCLBjnPymemcTPTMUqfovpFs<br />oNohRuQS6IoIrvgXAbb2X4BhygPDNSQPktGVo8qjKUyxYZa4Su8NFkb+OzZWDR4K<br />KN+OLFfaT6cx8o9o5M7cmNRokFisWynJ33EoKj1lW5YIwTwb1VKz4hXW+gKZFX7u<br />pgE1yzkOcoUW5EykNsGUaqLSdycxmDO866IFn6px9etxpIkQwUi+rb78tX6pNtpa<br />IBTsfPBqovXRdMe6mq5uO8x4Nrb47w8DZkrQSTMt1ll4t0bUL15o/6cQ5ajGaaGA<br />QVtO<br />-----END CERTIFICATE-----<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">4. Upload the content of certificate</span><br /><br />Go to the <a href="https://console.aws.amazon.com/iam/home?#users">IAM management console</a>.<br />1. Select an IAM user <br />2. Click "User Actions" <br />3, Click "Manage Signing Certificates"<br />4. Click "Upload Signing Certificates"<br />5. Paste the content<br />6. Click "Upload Signing Certificates"<br /><br />Done. Now you can send a SOAP request to AWS or use the command line tools.<br /><br /><br /><br /></div><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/08/27/how-to-create-x509-certificates-for" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Setting up load balancing with Keepalived</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><a href="http://blog.kenyang.net/2014/07/setting-up-high-availabilityha.html">前一篇</a>有講過了，<br />Keepalived是一個routing software，<br />它可以做到load balancing和high-availability，<br />而<a href="http://blog.kenyang.net/2014/07/setting-up-high-availabilityha.html">前一篇</a>也教怎麼set up HA，<br />這篇會講怎麼set up load balancing，<br /><b><strike>理論上</strike></b>架構應該要和下圖中一樣，才會比較合理，<br />有N檯load-balancer，專門做load balancing，<br />有N檯web！<br />而這些load balancer，都會裝keepalived，然後去binding Virtual IP！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-rxBME9e5d4g/U7fayrtLTzI/AAAAAAAAFMk/yOp-1IBSHaQ/s1600/Network+Diagram.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-rxBME9e5d4g/U7fayrtLTzI/AAAAAAAAFMk/yOp-1IBSHaQ/s1600/Network+Diagram.png" /></a></div><br />但基於測試方便加上懶得安裝這麼多檯機器來說明，<br />先簡化成下圖，<br />每一檯server身兼load balancer和web server，<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-HUzm7NOhTrQ/U7fcTr3Rh3I/AAAAAAAAFMw/c4HRt5LI6sE/s1600/Network+Diagram+(1).png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-HUzm7NOhTrQ/U7fcTr3Rh3I/AAAAAAAAFMw/c4HRt5LI6sE/s1600/Network+Diagram+(1).png" /></a></div><br /><br /><br /><br /><br />和<a href="http://blog.kenyang.net/2014/07/setting-up-high-availabilityha.html">前一篇</a>一樣，假設我們有兩檯server，<br />IP分別為<br />&nbsp;&nbsp;1. 10.1.190.142<br />&nbsp;&nbsp;2. 10.1.190.143<br /><br />virtual ip：10.1.190.150<br /><br />在開始之前，請先去完成<a href="http://blog.kenyang.net/2014/07/setting-up-high-availabilityha.html">前一篇</a>的所有操作，<br /><br /><span style="color: #e06666; font-size: 18px;">1. Generate hash </span><br /><br />首先，先gen hash，<br />這hash是給load balancer用的，<br />原因是load balancer會去確認每一檯的web server是活著的，<br />確認時會帶著這個hash值！<br />因為有兩檯機器，所以要gen 2組，<br /><pre class="brush: bash">root@host1:~$ genhash -s 10.1.190.142 -p 80 -u /index.html<br />MD5SUM = 043e8a8eeaf59e7ef9c6b4cd6f71a7de<br /><br />root@host1:~$ genhash -s 10.1.190.143 -p 80 -u /index.html<br />MD5SUM = 66d84fe2b7e20944dd5d077e768b2cfb<br /><br /></pre><br /><span style="color: #e06666; font-size: 18px;">2. Write a script for handling iptables </span><br /><br />在這步驟，要寫一隻script，<br />負責add和delete rule的，<br />為什麼要add?<br />因為當如果沒有add virtual ip進去rule，<br />當load balancer把packet轉進來時，是送不進來的！<br /><pre class="brush: bash">#!/bin/bash                                                                                                                                                                 <br /><br />VIP=$2<br /><br />count=$(iptables -t nat -L| grep $VIP | wc -l)<br /><br />case "$1" in<br />  --add)<br />    if [[ $count == 0 ]]; then<br />        iptables -A PREROUTING -t nat -d $VIP -p tcp -j REDIRECT<br />    fi  <br />    ;;  <br />  --del)<br />    if [[ $count &gt; 0 ]]; then<br />        iptables -D PREROUTING -t nat -d $VIP -p tcp -j REDIRECT<br />    fi<br />    ;;  <br />esac<br /><br />exit 0<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. Configuration settings</span><br /><br />基本上設置跟第一篇沒有什麼太大差別，<br />首先只有第<span style="color: red;">26,27</span>行，多了兩個指令，<br />分別是當這檯機器進入master模式時，要把rule刪除<br />以及進入backup時，要把rule加進去!<br /><br />以及增加了<span style="color: red;">31~60</span>行的setting,<br />記得第一檯和第二檯都要進行設定，但一樣要把state,priority, router_id改成符合該host的設定！<br /><pre class="brush: bash">global_defs {<br />  notification_email {<br />    kenyang@xxx.com<br />  }<br />  notification_email_from xxxx@example.com<br />  smtp_server 127.0.0.1<br />  smtp_connect_timeout 30<br />  router_id host1      # 用來識別是哪檯機器，如果postfix有安裝，在寄信的時候，title就會跟你說是哪檯機器有問題<br />}<br /><br />vrrp_instance VI_1 {   # VI_1 可以改成自己想要的string<br /><br />  state MASTER         # MASTER意思是這檯為主要的機器<br /><br />  interface eth0       # 把virtual ip binding在eht0上<br /><br />  virtual_router_id 1  # 0~255之間，用來識別是哪一個instance<br />  priority 100         <br /><br />  virtual_ipaddress {<br />    10.1.190.150/24<br />  }<br /><br />  smtp_alert           # 當有問題時要發信通知<br /><br />  notify_master "/etc/keepalived/handle_iptable.sh --del 10.1.190.150" # 當這檯機器進入master模式時，要把rule刪除<br />  notify_backup "/etc/keepalived/handle_iptable.sh --add 10.1.190.150" # 當這檯機器進入backup模式時，要把rule加入<br />}<br /><br /># virtual web server<br />virtual_server 10.1.190.150 80 {<br />  delay_loop 10              # n秒確認底下的web一次<br />  lb_algo rr                 # 使用Round Robin的演算法做load balancing (rr, wrr, al, wlc, ......etc)<br />  lb_kind DR                 # Forwarding的方法 （dr, nat, tun)<br />  persistence_timeout 5      # timeout for persistent connection<br />  protocol TCP <br /><br />  real_server 10.1.190.142 80 {<br />    HTTP_GET {  # 使用HTTP_GET的方式進行確認web活著<br />      url {<br />        path /index.html<br />        digest 043e8a8eeaf59e7ef9c6b4cd6f71a7de   # 剛剛第一步驟gen的hash<br />      }   <br />      connect_timeout 3<br />      nb_get_retry 3<br />      delay_before_retry 2<br />    }   <br />  }<br />  real_server 10.1.190.143 80 {<br />    HTTP_GET { # 使用HTTP_GET的方式進行確認web活著<br />      url {<br />        path /index.html<br />        digest 66d84fe2b7e20944dd5d077e768b2cfb   # 剛剛第一步驟gen的hash<br />      }   <br />      connect_timeout 3<br />      nb_get_retry 3<br />      delay_before_retry 2<br />    }   <br />  }<br />}   <br /></pre><br /><br /><br /><span style="color: #e06666; font-size: 18px;">4. Verify</span><br /><br />完成上述設定以後，<br />先把keepalived reload，<br /><pre class="brush: bash">service keepalived reload<br /></pre><br />reload完成以後，<br />先在第一檯打下面的指令，<br />為什麼是在第一檯打？因為現在第一檯是master，它搶到virtual ip，<br />所以load balancing的工作是交由第一檯來做的！<br /><pre class="brush: bash">ipvsadm -ln<br /></pre><br />打完應該會看到下面的內容，<br />10.1.190.150這檯底下有兩檯主機，<br />分別是142, 143，<br />load balancer就是透過上述的HTTP_GET去確認web server是活著的，<br />比較特別的有兩個參數，<br />&nbsp;&nbsp;1. ActiveConn: 簡言之這檯機器目前有幾個人連上來<br />&nbsp;&nbsp;2. InActConn: 有幾檯機器的tcp status不是established<br /><pre class="brush: bash">Prot LocalAddress:Port Scheduler Flags<br />  -&gt; RemoteAddress:Port           Forward Weight ActiveConn InActConn<br />TCP  10.1.190.150:80 rr persistent 5<br />  -&gt; 10.1.190.142:80              Route   1      0          0         <br />  -&gt; 10.1.190.143:80              Route   1      0          0    <br /></pre><br />這時候在電腦上的browser瀏覽10.1.190.150，<br />然後在手機（或者其他檯電腦上）也瀏覽10.1.190.150<br />然後再馬上在第一檯機器打下面的指令<br /><pre class="brush: bash">ipvsadm -ln<br /></pre>應該會發現ActiveConn都變成1了！<br />如果你有第三檯機器，你可以試試看再連線10.1.190.150!<br />這時某一檯的ActiveConn會變成2！<br /><br /><br /><br /><br /><br /></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/07/07/setting-up-load-balancing-with" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Setting up a High-Availability(HA) environment with Keepalived</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">Keepalived是一個routing software，<br />它可以做到load balancing和high-availability，<br />load balancing會倚靠lvs (linux virtual server, ipvsadm)來做到（但這篇只會做HA，下篇再講怎麼做load balancing），<br />而high-availability是靠VRRP protocol來達成，<br />那什麼是<a href="http://en.wikipedia.org/wiki/Virtual_Router_Redundancy_Protocol" target="_blank">VRRP</a>（Virtual Router Redundancy Protocol ）？<br />簡單的說，就是為了當某個router故障，然後可以快速的failover，<br />Keepalivied就是利用這protocol來達到HA．<br /><br />假設我們有兩檯web server，<br />IP分別為<br />&nbsp;&nbsp;1. 10.1.190.142<br />&nbsp;&nbsp;2. 10.1.190.143<br /><br />在兩檯都安裝好keepalived的情況下，<br />被設定為"MASTER"的那檯機器，會去binding 一個我們所指定的virtual ip！<br />這裡先假設virtual ip為10.1.190.150<br /><br /><span style="color: #e06666; font-size: 18px;">1. Install the packages </span><br /><br />首先先ssh到第一檯和第二檯上，安裝等等會用到的幾個packages，<br />&nbsp;&nbsp;1. keepalived<br />&nbsp;&nbsp;2. nginx: 你也可以選擇你想要用的web server<br />&nbsp;&nbsp;3. postfix: optional, 安裝postfix的目的在於，server壞掉時，會寄信通知你<br /><pre class="brush: bash">apt-get install keepalived nginx postfix<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">2. Set up environment </span><br /><br />安裝好以後，先確認你的nginx是有起來的，<br />開browser去打一下web server就可以簡單確認！<br /><br />接著先到第一檯機器上去進行keepalived的config設定 <br /><pre class="brush: bash">vim /etc/keepalived/keepalived.conf<br /></pre><br />內容如下：<br /><pre class="brush: bash">global_defs {<br />  notification_email {<br />    kenyang@xxx.com<br />  }<br />  notification_email_from xxxx@example.com<br />  smtp_server 127.0.0.1<br />  smtp_connect_timeout 30<br />  router_id host1      # 用來識別是哪檯機器，如果postfix有安裝，在寄信的時候，title就會跟你說是哪檯機器有問題<br />}<br /><br />vrrp_instance VI_1 {   # VI_1 可以改成自己想要的string<br /><br />  state MASTER         # MASTER意思是這檯為主要的機器<br /><br />  interface eth0       # 把virtual ip binding在eht0上<br /><br />  virtual_router_id 1  # 0~255之間，用來識別是哪一個instance<br />  priority 100         <br /><br />  virtual_ipaddress {<br />    10.1.190.150/24<br />  }<br /><br />  smtp_alert           # 當有問題時要發信通知<br />}<br /></pre><br /><br />接著就到第二檯上去進行設定，<br />其實內容大致上和第一檯一模一樣，<br />只有router_id, state, priority需要變動<br />內容如下，<br /><pre class="brush: bash">global_defs {<br />  ... same with host1 ...<br />  router_id host2  <br />}<br /><br />vrrp_instance VI_1 {   # VI_1 可以改成自己想要的string<br />  ... same with host 1 ....<br />  state BACKUP<br />  priority 50         <br />}<br /></pre><br />完成設定以後，分別在兩檯機器上打開keepalived，<br /><pre class="brush: bash">service keepalived start<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">3. Verify </span><br /><br />最後就來驗證ha是work的，<br />先到第一檯上去，因為第一檯設定為MASTER，<br />因此理論上第一檯除了自己的IP (10.1.190.142)以外，<br />還要拿到這個virtual ip (10.1.190.150)，<br />打下面的指令可以驗證，<br /><pre class="brush: bash">root@host1:~$ ip a | grep eth0 | grep inet<br />    inet 10.1.190.142/24 brd 10.1.190.255 scope global eth0<br />    inet 10.1.190.150/24 scope global secondary eth0<br /></pre><br />接著打開web browser去連virtual ip (10.1.190.150)，<br />都會導到第一檯的nginx去！<br />這時候把第一檯關機！<br /><pre class="brush: bash">root@host1:~$ shutdown now<br /></pre><br />此時第二檯應該要拿到virtual ip，<br />一樣打下面的指令做驗證<br /><pre class="brush: bash">root@host2:~$ ip a | grep eth0 | grep inet<br />    inet 10.1.190.143/24 brd 10.1.190.255 scope global eth0<br />    inet 10.1.190.150/24 scope global secondary eth0<br /></pre><br />然後再打開web browser去連virtual ip (10.1.190.150)，<br />此時看到的內容會是第二檯nginx上的內容！<br /><br /><br />除此之外，如果postfix有設定成功，<br />應該是會收到mail跟你說host2進入了MASTER模式，<br />標題是：[host2] VRRP Instance VI_1 - Entering MASTER state<br />內容是：=&gt; VRRP Instance is now owning VRRP VIPs &lt;=   下一篇再教怎麼用keepalived做load balance.           </div><br />
      </div>

      <a href="/2014/07/06/setting-up-high-availabilityha" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Getting started with Amazon EC2 API Tools</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><a href="https://aws.amazon.com/ec2/" target="_blank">Amazon EC2</a>是什麼東西，這裡就不多做介紹了，<br />這裡主要介紹 Amazon EC2 API Tools，這個tool讓developer用來管理EC2上的instances，<br />不管是create, terminate, stop, create key等等之類的操作都可以透過API tool來完成，<br />那什麼時候需要用到這個tool? 像是automation啊，或者如果你想要customize自己的AMI時，<br />還是得先安裝 Amazon EC2 API Tools以及<a href="http://aws.amazon.com/developertools/368">AMI Tools</a>，不過AMI就是另外一個課題了，有機會的話再開另一篇來講吧！<br />這裡就focus在下面兩個主題：<br />&nbsp;&nbsp;&nbsp;&nbsp;1. how to <span style="color: red;">setup</span> API tools?<br />&nbsp;&nbsp;&nbsp;&nbsp;2. how to <span style="color: red;">create</span> EC2 instance using API command line?<br />&nbsp;&nbsp;&nbsp;&nbsp;3. how to <span style="color: red;">grant permissions</span> to instance using API command line?<br />&nbsp;&nbsp;&nbsp;&nbsp;4. how to <span style="color: red;">terminate</span> instance using API command line?<br /><br />在開始之前，記得先去註冊AWS的帳號啊！（有一張信用卡就可以註冊了）<br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. Get certificate and Private key </span><br /><br />因為tools需要先拿到cert and private key，才可以讓developer對自己的account做操作，<br />所以得先拿到！<br />怎麼拿呢？<br />先到<a href="https://console.aws.amazon.com/iam/home?#security_credential">Security credentials</a>的頁面，<br />進去以後，請點選紅色框框中的按鈕『Create new certificate』（如下圖），<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-canxBzIKYD8/U2iwOCeE_SI/AAAAAAAAFK0/QT56bsjEeUc/s1600/Screen+Shot+2014-05-06+at+4.50.31+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-canxBzIKYD8/U2iwOCeE_SI/AAAAAAAAFK0/QT56bsjEeUc/s1600/Screen+Shot+2014-05-06+at+4.50.31+PM.png" height="246" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div>按下按鈕就建立好cert and private key了！就把cert and private key下載到『桌面』．<br />記得！！！一定要先下載private key！因為只有一次的機會！錯過就無法重新下載了！<br />cert也要一併下載下來．<br /><br /><br /><br /><span style="color: #e06666; font-size: 18px;">2. Download the API tools</span><br /><br />接著就去下載API tools，<br />先在home目錄底下建立一個.ec2的folder，<br />這folder會存放cert and private key，以及api tools，<br /><pre class="brush: bash">cd <br />mkdir .ec2  # create folder<br />cd .ec2 <br />wget http://s3.amazonaws.com/ec2-downloads/ec2-api-tools.zip # download tools<br />unzip ec2-api-tools.zip<br />mv ~/Desktop/*.pem . # move cert and private key<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: 18px;">3. Environment setup</span><br /><br />接著要設定環境變數，<br />打開你的.bash_profile<br /><pre class="brush: java">vim ~/.bash_profile<br /></pre><br />並且insert下列的內容，<br /><pre class="brush: java">export EC2_HOME=~/.ec2    <br />export PATH=$PATH:$EC2_HOME/bin<br />export EC2_PRIVATE_KEY=$EC2_HOME/pk-xxxxxxxxxx.pem   # remember to replace xxxx to your file name<br />export EC2_CERT=$EC2_HOME/cert-xxxxxxxxxxx.pem       # remember to replace xxxx to your file name<br />export JAVA_HOME=/System/Library/Frameworks/JavaVM.framework/Home/    # because API tools are written in java<br />export EC2_URL=https://ec2.us-west-2.amazonaws.com   <br /></pre><br />其實設定都還蠻淺顯易懂的，<br />EC2_URL比較需要特別說明，<br />這個超重要！為什麼呢？<br />因為你不設的話，你待會下某些指令都會找不到東西！指令還得帶上--region option才行！<br />為了省下麻煩，就在bash_profile設定吧！當然你可以把us-west-2改成你想要的region！<br /><br />最後記得要讓bash_profile生效！<br /><pre class="brush: java">source ~/.bash_profile<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">4. Gen key</span><br /><br />接著先建立key，這key是等等用來ssh連線到你的instance的！<br /><pre class="brush: java">ec2-add-keypair ec2-keypair<br /></pre>這指令會幫你gen key，gen完以後會顯示在console上，<br />請把它複製起來！（從-----BEGIN RSA PRIVATE KEY-----開始複製，一直到-----END RSA PRIVATE KEY-----）<br />然後建立一個ec2-keypair的檔案，把內容貼在裡面！<br /><pre class="brush: java">cd ~/.ec2<br />vim ec2-keypair<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">5. Create instance</span><br /><br />在create之前，你應該要知道你想要create哪一類型的instance！像是ubuntu, centos, amazon linux....etc.<br />所以要透過下面的指令去查有哪些instance，<br /><pre class="brush: java">ec2-describe-images -a --filter architecture=x86_64 &gt;&gt; ~/image_list<br /></pre>-a意思就是show all<br />然後--filter出architecture是x86_64的image！<br />因為其實資料蠻亂的，建議你還是output到一個file來看你想要create哪一種instance！<br />這裡我選擇了ami-6ac2a85a，這個是ubuntu14.04的instance！<br /><br />接著就可以create了！下面的option應該就不用多作說明了，有玩ec2的應該都知道<br /><pre class="brush: java">ec2-run-instances  ami-6ac2a85a  --key ec2-keypair  --region us-west-2  --instance-type t1.micro<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">6. Connect to instance</span><br /><br />一開始你想要ssh進去instance，一定是不行的！<br />因為預設的group permission是沒有開22 port的！<br />所以要用下面的指令去打開！<br /><pre class="brush: java">ec2-authorize default -p 22<br /></pre><br />打開以後就可以ssh進去了！<br /><pre class="brush: java">ssh -i ec2-keypair ec2-xxx-xxx-xxx-xxx.us-west-2.compute.amazonaws.com<br /></pre><br />喔！對了！如果你忘記自己instance的ip或者相關資訊，<br />可以透過下面指令來查！<br /><pre class="brush: java">ec2-describe-instances<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: 18px;">7. Terminate instance</span><br /><br />要terminate一個instance非常簡單！<br />你只要知道自己的instance id就好了！（如果忘記id是什麼，一樣用ec2-describe-instances去查！）<br /><pre class="brush: java">ec2-terminate-instances i-xxxxxxx<br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div>
      </div>

      <a href="/2014/05/06/getting-started-with-amazon-ec2-api" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Build a deb package from source</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">最近因為安全性的關係，<br />我要在ubuntu 10.04上面將openssl從0.9.8k更新至1.0.1e，<br />以及將openssh從5.3p1更新至6.2p2 <br />但偏偏這兩個較新的版本都沒有給10.04用的package....<br />所以這時候只好自己build了！<br />有人可能會覺得奇怪，為什麼要包成package安裝？<br />而不直接tar開source，然後make install就好？<br />因為我需要重複的更新很多次，很多檯機器！<br />如果在每一檯都去./configure, make, make install...那真的會很花時間！<br />所以最快的方式就是先在一檯機器上build package，<br />然後再把package拿到每一檯去安裝，<br />會快上許多！<br /><br />喔！對了！這邊教你的是怎麼build出一包debian package！<br />如果你想要把這包package撒出去給別人使用，建議你要加上sign key啦！<br />甚至如果你想要撒到launchpad上的話，更要加上sign key！<br />但這裡只會教怎麼build而已！<br /><br />恩，其實build還是很簡單！<br />難的是環境的準備跟環境的設定啊.....<br /><br /><br />在這裡會介紹兩種build debian package的方法！<br /><ol><li>checkinstall</li><li>debuild</li></ol><br /><br />這兩種的方式差蠻多的，<br />checkinstall它是用錄製的方式，<br />透過make install，然後錄下整個安裝過程，<br />再把打包成一個debian package！<br />而debuild可以想像成就是動態的去build，把所需的檔案通通包進去package！<br /><br /><span style="color: #e06666; font-size: 18px;">1. install tools</span><br /><br />先安裝所需的package，第一個是checkinstall，再來安裝ubuntu-dev-tools這個package，<br />ubuntu-dev-tools裡面就包含了debuild等相關需要的tools．<br /><pre class="brush: java">apt-get install checkinstall<br />apt-get install ubuntu-dev-tools  bzr-builddeb debhelper<br /></pre><br /><span style="color: #e06666; font-size: 18px;">2. download and decompress tarball</span><br /><br />把source code下載下來和解壓縮開，<br /><pre class="brush: java">cd ~<br />wget http://www.openssl.org/source/openssl-1.0.1e.tar.gz  // download ssl<br />tar xvzf openssl-1.0.1e.tar.gz<br /><br />wget http://openbsd.org.ar/pub/OpenBSD/OpenSSH/portable/openssh-6.2p2.tar.gz  // download ssh<br /><br />cd openssl-1.0.1e<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. Config and Compile source code</span><br /><br />這一步蠻重要的，<br />要進行config和make(compile)，<br />但！！！只有checkintall需要“先”config and compile！<br />先config，openssl的config還好，但openssh的config要稍微注意一點，<br />openssh的config要特別帶一個--sysconfdir，<br />這個參數是說明你將來的sshd_config, ssh_config, ssh_host_xxx_key要放在哪裡，<br />如果你沒有帶這個參數，預設應該是會存在/usr/etc/底下，老實說蠻奇怪的！<br />所以還是指定一下吧！<br />那因為前面剛剛說了，只有openssl需要先config，所以等等會再說openssh怎麼去設定config，<br />先設定openssl的config，<br /><pre class="brush: java">./config<br /></pre><br />進行make，make就是compile，把你的source code compile成binary，<br /><pre class="brush: java">make<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">4. Build package (checkinstall)</span><br /><br />前面說了build package，這裡會介紹兩種方法（其實蠻多種方法的），<br />我會先用checkinstall build ssl，然後用debuild build ssh，<br />首先是ssl，<br /><pre class="brush: java">checkinstall make install<br /></pre>checkinstall的原理就是會去錄製接在它後面那個command所作的事情，<br />所以我們後面接make install（就是安裝），<br />make install下下去以後就會真的去安裝這個package，<br />然後checkintall就會在旁邊錄起來！<br />checkinstall這個指令按下enter以後，會出現幾個preconfig的訊息，<br />你要先替這個package建立一些information，<br />第一個是會問你doc，這個就是直接y下去！（如下圖）<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-YP1vCg_L8Ms/Ux14puERFgI/AAAAAAAAFJ0/j4W5Spb3314/s1600/Screen+Shot+2014-03-10+at+3.15.30+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-YP1vCg_L8Ms/Ux14puERFgI/AAAAAAAAFJ0/j4W5Spb3314/s1600/Screen+Shot+2014-03-10+at+3.15.30+PM.png" height="148" width="640" /></a></div><br />接著是要你描述一下這個package是做什麼的（如下圖）<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-EMe13vp50Ps/Ux14ppgOv9I/AAAAAAAAFJg/p65kwREtHCc/s1600/Screen+Shot+2014-03-10+at+3.16.02+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-EMe13vp50Ps/Ux14ppgOv9I/AAAAAAAAFJg/p65kwREtHCc/s1600/Screen+Shot+2014-03-10+at+3.16.02+PM.png" height="72" width="400" /></a></div><br />最後就是這package的相關資訊，你可以改掉maintainer是誰，<br />改成自己email！（如下圖）<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-RzRww5SU91U/Ux14pvwqfLI/AAAAAAAAFJk/U1XMVtDKuog/s1600/Screen+Shot+2014-03-10+at+3.16.12+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-RzRww5SU91U/Ux14pvwqfLI/AAAAAAAAFJk/U1XMVtDKuog/s1600/Screen+Shot+2014-03-10+at+3.16.12+PM.png" height="298" width="400" /></a></div><br />那怎麼看有沒有成功？<br />因為你是下make install，<br />所以最後build的流程會去幫你安裝，<br />如果安裝失敗, 那你的package也不會存在！<br /><br />那有人可能只是單純想要build package，而不想要安裝這個package在這檯機器上，<br />那該怎麼辦？<br />checkinstall有額外的參數可以做這件事情，多帶一個--install就行！<br /><pre class="brush: java">checkinstall --install=no make install<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: 18px;">5. Build package (debuild)</span><br /><br />上面介紹了checkinstall的方法，<br />現在要介紹debuild的方式，<br />那這裡我們以opennssh為範例，<br />透過debuild比較算是debian的practice，<br />首先要先有debian的資料夾，<br />這資料夾下面有一堆林林種種的config file，甚至是init.d，<br />那我們難道要一個一個的設定這些config？<br />當然不用，可以透過dh_make去幫我們產生template，<br /><br />那可是透過dh_make也有點麻煩，就是要接一堆參數，<br />那好險Canonical有提供另一個tool(bzr)去幫我們handle這件事情，<br />透過bzr就可以幫我們產生debian/*底下的template，<br /><pre class="brush: java">cd ~<br />bzr dh-make openssh 6.2p2 openssh-6.2p2.tar.gz<br /></pre>bzr會問你這是一個single binary, indep binary, multiple binary, library, kernel module, kernel patch or cdbs?<br />就選single binary（如下圖），<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-rh1jjH_Zflk/Ux14qAh2qfI/AAAAAAAAFJs/4DvHSRPFXIw/s1600/Screen+Shot+2014-03-10+at+3.58.04+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-rh1jjH_Zflk/Ux14qAh2qfI/AAAAAAAAFJs/4DvHSRPFXIw/s1600/Screen+Shot+2014-03-10+at+3.58.04+PM.png" /></a></div><br /><br />dh-make會先幫你建立一個opepssh的資料夾，裡面其實就是下載的那個tarball解開！<br />進到openssh資料夾，你會發現裡面會有另外一個debian資料夾，<br />這個資料夾裡面通通都是build debian package所需要的file，<br />有幾個file蠻重要的，<br />像是control, changelog, docs，<br />這些就是dh_make幫我們建好的template，既然是template，<br />所以就有些欄位要改掉！不過都是一些基本的information，所以這裡就不一一介紹！<br /><br />接著就要開始build，<br />build其實是靠debian/rule來trigger，<br />rule裡面要放一些dh_autoconfiguration, dh_install, dh_xxxx.....etc，<br />一堆的command，<br />不過template已經幫我們建立好了dh  $@，我們就不用一一處理！<br /><br />在開始build之前，<br />有個比較dirty的事情要先做，<br />前面不是有說要設定--sysconfdir嗎？<br />debian的practice是透過override_dh_auto_configure去做，<br />override_dh_auto_configure會幫我們把要帶的參數再帶給./configure，<br />但偏偏我怎麼試都帶不過去，最後只好用dirty的方式，<br />就是去找到source code，去硬改sysconfdir的位置，<br />預設會是/etc，<br />但我想要放在/etc/ssh底下，<br />那個source code位置就在/usr/share/perl5/Debian/Debhelper/Buildsystem/autoconf.pm，<br />找到下面這行，把/etc再改成我要的...<br /><pre class="brush: java">push @opts, "--sysconfdir=/etc";<br /></pre>那因為這方法真的蠻dirty的，如果有哪位大大知道該怎麼正確的透過override_dh_auto_configure去設定，<br />歡迎告訴我～<br /><br /><br />最後就可以用debuild  build了<br />後面帶的參數意思就是不要sign source pacakge and .changes files，<br /><pre class="brush: java">debuild -uc -us -B<br /></pre><br /><br />最後說明一下另一個command，<br />這command可以來看package裡面有些什麼！<br /><pre class="brush: java">lesspipe openssh-6.2p2.deb<br /></pre>可以拿這command來簡單的驗證一下build有沒有成功！<br /><br /><br /><br /><br /></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/03/10/build-deb-package-from-source" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to build Android image?</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">因緣際會下，剛好有機會可以練習如何build android source code，<br />（是android source code！不是app！）<br /><br />不過練習完以後，發現其實build android真的很簡單！<br />難的在於prepare build environment.....<br />所以這篇會從頭做起，從一個完全乾淨的ubuntu 12.04開始做起！<br /><br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. install ubuntu 12.04</span><br /><br />第一步就是去下載<a href="http://www.ubuntu.com/download" target="_blank">ubuntu 12.04 64 bits</a>，<br />要裝server版或者是desktop版都可以，<br />安裝desktop版的好處就是你build好image的時候，<br />要測試很簡單！<br />像我是用server版build，因為沒有x-window，我也不想再裝！<br />就只好把build好的image抓出來，抓到我自己的mac上，<br />然後透過emulator來測試！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">2. install add-apt-repository</span><br /><br />剛安裝完的ubuntu預設是沒有add-apt-repository這個package的，<br />所以得手動安裝，請安裝下列兩項packages<br /><pre class="brush: java">sudo apt-get install software-properties-common<br />sudo apt-get install python-software-properties<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">3. install sun-java6-sdk</span><br /><br />那因為不能用openjdk build android，<br />所以得換成sun(oracle)的版本，<br /><pre class="brush: java">sudo add-apt-repository ppa:webupd8team/java<br />sudo apt-get update<br />sudo apt-get install oracle-java6-installer<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">4. install required packages</span><br /><br />安裝一些必要的packages，<br /><pre class="brush: java">sudo apt-get install git gnupg flex bison gperf build-essential \<br />  zip curl libc6-dev libncurses5-dev:i386 x11proto-core-dev \<br />  libx11-dev:i386 libreadline6-dev:i386 libgl1-mesa-glx:i386 \<br />  libgl1-mesa-dev g++-multilib mingw32 tofrodos \<br />  python-markdown libxml2-utils xsltproc zlib1g-dev:i386<br />sudo ln -s /usr/lib/i386-linux-gnu/mesa/libGL.so.1 /usr/lib/i386-linux-gnu/libGL.so<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">5.&nbsp;Configuring USB Access</span><br /><br />因為linux預設無法access到USB device，<br />所以得加一些udev的rule，<br />先在udev底下建立一個檔案,<br /><pre class="brush: java">sudo vim /etc/udev/rules.d/51-android.rules<br /></pre><br />然後貼入下列的內容！注意！！請把owner改成你自己的ubuntu user name！<br /><pre class="brush: java"># adb protocol on passion (Nexus One)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e12", MODE="0600", OWNER="ken"<br /># fastboot protocol on passion (Nexus One)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="0bb4", ATTR{idProduct}=="0fff", MODE="0600", OWNER="ken"<br /># adb protocol on crespo/crespo4g (Nexus S)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e22", MODE="0600", OWNER="ken"<br /># fastboot protocol on crespo/crespo4g (Nexus S)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e20", MODE="0600", OWNER="ken"<br /># adb protocol on stingray/wingray (Xoom)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="22b8", ATTR{idProduct}=="70a9", MODE="0600", OWNER="ken"<br /># fastboot protocol on stingray/wingray (Xoom)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="708c", MODE="0600", OWNER="ken"<br /># adb protocol on maguro/toro (Galaxy Nexus)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="04e8", ATTR{idProduct}=="6860", MODE="0600", OWNER="ken"<br /># fastboot protocol on maguro/toro (Galaxy Nexus)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e30", MODE="0600", OWNER="ken"<br /># adb protocol on panda (PandaBoard)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d101", MODE="0600", OWNER="ken"<br /># adb protocol on panda (PandaBoard ES)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="d002", MODE="0600", OWNER="ken"<br /># fastboot protocol on panda (PandaBoard)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d022", MODE="0600", OWNER="ken"<br /># usbboot protocol on panda (PandaBoard)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d00f", MODE="0600", OWNER="ken"<br /># usbboot protocol on panda (PandaBoard ES)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="0451", ATTR{idProduct}=="d010", MODE="0600", OWNER="ken"<br /># adb protocol on grouper/tilapia (Nexus 7)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e42", MODE="0600", OWNER="ken"<br /># fastboot protocol on grouper/tilapia (Nexus 7)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4e40", MODE="0600", OWNER="ken"<br /># adb protocol on manta (Nexus 10)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4ee2", MODE="0600", OWNER="ken"<br /># fastboot protocol on manta (Nexus 10)<br />SUBSYSTEM=="usb", ATTR{idVendor}=="18d1", ATTR{idProduct}=="4ee0", MODE="0600", OWNER=“ken"<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">6. install&nbsp;Repo</span><br /><br />接著要安裝Repo這個tool，<br />Repo是一個讓你可以輕鬆使用git的tool，<br /><br />先在你的home目錄建立一個bin目錄，<br /><pre class="brush: java">mkdir ~/bin<br />PATH=~/bin:$PATH<br /></pre><br />開始下載repo tool<br /><pre class="brush: java">curl http://commondatastorage.googleapis.com/git-repo-downloads/repo &gt; ~/bin/repo<br />chmod a+x ~/bin/repo<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">7. Initialize a Repo client and Download Android source</span><br /><br />安裝好repo以後，就開始來設定他，<br />首先先建立一個資料夾，這資料夾準備用來存android source code，<br /><pre class="brush: java">mkdir WORKING_DIRECTORY<br />cd WORKING_DIRECTORY<br /></pre><br />接著就init，其實就跟git差不多，<br />最後-b的意思就是checkout哪個branch的意思，<br /><pre class="brush: java">repo init -u https://android.googlesource.com/platform/manifest -b android-4.4.2_r2<br /></pre><br /><br />設定完repo以後，就開始下載android source吧！<br /><pre class="brush: java">repo sync<br /></pre><br /><span style="color: #e06666; font-size: 18px;">8.&nbsp;change the default shell environment</span><br /><br />完成下載以後，在開始build之前，還有一些要設定，<br />ubuntu的預設的shell是dash，<br />那據說用dash build會fail，<br />所以要把它換成bash，就使用下面的指令，<br />使用以後，就選No！就完成了！<br /><pre class="brush: java">sudo dpkg-reconfigure dash<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">9.&nbsp;Initialize build environment</span><br /><br />接著就要initialize你的build environment,<br />很簡單，靠下面一個script就可做到,<br /><pre class="brush: java">. build/envsetup.sh<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">10.&nbsp;Choose a Target</span><br /><br />接著就要選擇你要build的target，<br />有很多種可以選，可以來這看（<a href="http://source.android.com/source/building-devices.html">點我</a>）<br />那因為我們等等是用emulator去做測試，<br />所以我們是選擇aosp_arm-eng!<br /><pre class="brush: java">lunch aosp_arm-eng<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">11.&nbsp;build code</span><br /><br />接著就可以開始build，<br />直接下make就可以build，後面會帶一個參數是-jN，<br />N是一個數字，通常取決於你的hardware thread的數量！<br />build還蠻花時間的，我的機器在沒有做cache的情況下，build了差不多2小時..<br />所以耐心等待吧！<br /><pre class="brush: java">make -j4<br /></pre><br />build成功以後，應該會看到下面的字樣，<br /><pre class="brush: java">Install system fs image: out/target/product/generic/system.img <br />out/target/product/generic/system.img+ maxsize=588791808 blocksize=2112 total=576716800 reserve=5947392<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">12. Test</span><br /><br />接著就要來測試剛剛build好的image是否可以使用，<br />如果你是使用desktop的ubuntu，<br />理論上你只要下下面的指令就可以測試，<br /><pre class="brush: java">emulator<br /></pre><br />但剛好我是使用server版本去build...<br />我又懶得裝ubuntu-desktop，<br />我就只好抓回來我的mac環境來測試！<br />注意！前提是你的mac環境已經有android-sdk，而且你也把system.img也抓回來了！<br /><br />首先請先建立一個avd，就是emulator，<br />注意！emulator的api level要是19！<br />為什麼呢？<br />因為我們剛剛checkout branch的時候是4.4.2！<br />你可以利用下面的指令來建立一個avd，<br /><pre class="brush: java">cd ~/your_android_sdk_dir/tools<br />./android create avd -n test-emulator -t 15 -c 100M --abi armeabi-v7a<br /></pre><br />接著就把你的system.img複製到剛剛建立的avd資料夾下！<br />只要搬到該資料夾下，等emluator啟動時，就會試著去load那個system.img!<br /><pre class="brush: java">cp system.img ~/.android/test-emulator<br /></pre><br />啟動emulator<br /><pre class="brush: java">./emulator -avd test-emulator<br /></pre><br />理論上看到android字樣的開機畫面，應該就代表build成功了！<br /><br /><br /><br /><br /><br /><br /><br /><br /></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/02/24/how-to-build-android-image" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to Backup and Restore your MongoDB database?</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">這篇要講如何Backup和Restore MongoDB，<br />MongoDB本身提供了2種不同的backup/restore solutions，<br /><br /><ul><li>mongoexport/mongoimport</li><li>mongodump/mongorestore</li></ul><br />還有一些進階的，像是<a href="https://mms.mongodb.com/?pk_campaign=MongoDB-Org&amp;pk_kwd=Backup-Docs" target="_blank">MongoDB Management Service (MMS)</a>，<br />但這裡只介紹這2種比較基本的solutions，<br />那麼這兩種的差異在哪呢？<br />第一種的mongoexport/mongoimport其實不太算是backup/restore solution，<br />因為它只能用來backup collection中的data（collection可以想成relational database的table），<br />它無法backup整個db的狀態，<br />在官網中也說明了，<br />mongoexport/mongoimport在保存<a href="http://docs.mongodb.org/v2.2/reference/glossary/#term-bson" target="_blank">BSON</a>上是不可靠的，<br />所以mongoexport/mongoimport比較適合用在保存簡單的data，<br />但也可以勉強算是比較簡易型的backup/restore solution，<br />但儘量別拿來作為backup/restore的方式．原因前面說過了，<br />把它方法當作data的export和import就好．<br />如果想要備份較完整的db，那麼就要靠第二種mongodump/mongorestore，<br />下面分別是這兩種的使用方式．<br /><br /><span style="color: #e06666; font-size: 18px;">1. mongoexport/mongoimport</span><br /><br /><span style="color: #e06666; font-size: 16px;">1-1.Backup</span><br /><pre class="brush: java">mongoexport -h &lt;Host:Port&gt; -d &lt;DB_Name&gt; -c &lt;Collection_Name&gt; -u &lt;DB_User&gt; -p &lt;DB_Password&gt; -o &lt;Output_File_Name&gt;<br /></pre><br />-h：你的db uri和port number<br />-d：你要備份的database名稱<br />-c：要備份哪一個collection(table)<br />-u：db帳號<br />-p：db密碼<br />-o：要備份出來的檔案名稱<br /><br /><span style="color: #e06666; font-size: 16px;">1-2. Restore</span><br />備份成功以後，你可以試著drop那個collection，<br />接著在輸入下面的command，應該就會recover成功．<br /><pre class="brush: java">mongoimport -h &lt;Host:Port&gt; -d &lt;DB_Name&gt; -c &lt;Collection_Name&gt; -u &lt;DB_User&gt; -p &lt;DB_Password&gt; --file &lt;File_Name&gt;<br /></pre><br />參數大部分和backup一樣，<br />只有--file不同，<br />--file要接的是剛剛備份出來的檔案名稱，<br />輸入以後，看到下圖就代表recover成功了<br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-c9hAXACpEJQ/UvOcUq3HNFI/AAAAAAAAFI4/YbP5amWS_7k/s1600/Screen+Shot+2014-02-06+at+10.29.31+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-c9hAXACpEJQ/UvOcUq3HNFI/AAAAAAAAFI4/YbP5amWS_7k/s1600/Screen+Shot+2014-02-06+at+10.29.31+PM.png" /></a></div><br /><br /><br /><span style="color: #e06666; font-size: 18px;">2. mongodump/mongorestore</span><br /><br /><span style="color: #e06666; font-size: 16px;">2-1.Backup</span><br /><pre class="brush: java">mongodump -h &lt;Host:Port&gt; -d &lt;DB_Name&gt; -c &lt;Collection_Name&gt; -u &lt;DB_User&gt; -p &lt;DB_Password&gt; -o &lt;Directory&gt;<br /></pre><br />參數也和上面一樣，<br />但-o是要接目錄位置，mongodump會在該目錄底下建立一個folder來存backup的檔案，<br /><br /><span style="color: #e06666; font-size: 16px;">2-2. Restore</span><br /><pre class="brush: java">mongorestore -h &lt;Host:Port&gt; -d &lt;DB_Name&gt; -c &lt;Collection_Name&gt; -u &lt;DB_User&gt; -p &lt;DB_Password&gt; &lt;Directory&gt;<br /></pre><br />參數也一樣，<br />但少了-o，<br />請在後面直接接上存放backup db的directory．<br />輸入以後，<br />你會發現mongorestore不只會幫你recover data，連該collection原有的index也會幫你建好．<br /><br /><br /><br />結論，<br />第一種儘量別拿來做backup/restore，其實就連MongoDB官網也沒有把mongoimport/mongoexport歸類在backup/restore的類別下，<br />就把第一種當作data的export吧！<br />第二種就是完整的backup/restore solution，就像mysqldump一樣！<br /><br /><br /><br /></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/02/06/how-to-backup-and-restore-your-mongodb" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Handle long-running operations in Node.js</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;">由於Node.js是Single thread的關係，<br />所以並不適合用來處理<span style="color: red;">耗費CPU</span>或者需要<span style="color: red;">長時間</span>處理的操作，<br />想要處理cpu-intensive或者long-running computation，<br />還是要靠一些job server來解決會比較好（像是<a href="http://gearman.org/" target="_blank">gearman</a>），<br />那如果你不想靠其他的job server來做，<br />硬要用node.js本身來處理cpu-intensive或者long-running computation，<br />就要靠worker來處理！<br />這篇就要講怎麼使用worker．<br />這裡我們要用的workder module是<a href="https://github.com/audreyt/node-webworker-threads">webworker-threads</a>．<br /><br /><span style="color: #e06666; font-size: 18px;">1. install</span><br /><pre class="brush: java">npm install webworker-threads --save<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">2. implement a task.js</span><br /><br />首先，我們要先建立一個javascript，<br />而這隻javascript就是用來處理需要長時間的操作，<br />這裡我們就以fibonacci來作為長時間處理的example，<br /><pre class="brush: js">// fibonacci function<br />function fibo (n){                                                                                                               <br />    return n &gt; 1 ? fibo(n - 1) + fibo(n - 2) : 1;                <br />}                                                                <br />                                                                 <br />onmessage = function(event) {                                    <br />    postMessage('Result is : ' + fibo(event.data));                  <br />    self.close();                                                <br />};<br /></pre><br />這隻javascript有兩個function，<br />一個是fibo function，<br />另外一個就是onmessage，onmessage等等我們主程式會call到它，<br />然後onmessage裡面就會去call fibo function．<br /><br /><br /><span style="color: #e06666; font-size: 18px;">3. integrate with your main.js</span><br /><br />在這步就在你的main.js中使用<a href="https://github.com/audreyt/node-webworker-threads">webworker-threads</a>，以及呼叫我們剛剛寫的那隻task.js，<br /><pre class="brush: js">var express = require("express");<br />var app = express();<br />app.use(express.logger());<br /><br />// import the module <br />var worker_thread = require('webworker-threads');<br />var Worker = worker_thread.Worker;<br /><br />app.use(express.static(path.join(__dirname, 'view')));<br /><br />app.get('/fibo', function(req, resp) {<br /><br />    var worker = new Worker('task.js');<br /><br />    worker.onmessage = function(event) {<br />        console.log("The task said : " + event.data);<br />    };                                                                                                                            <br />    worker.postMessage(40);<br /><br />    resp.end('hello world ');<br />});<br /><br />var port = process.env.PORT || 5000;<br />app.listen(port, function() {<br />    console.log("Listening on " + port);<br />});<br /></pre><br />這個example，一樣有使用到express.js，<br />不知道怎麼使用的人可以去看<a href="http://blog.kenyang.net/2014/01/deploying-nodejs-application-to-heroku.html" target="_blank">這一篇：Deploying a Node.js application to Heroku</a><br />webworker-threads的使用方式很簡單，<br />只要先import這個module，<br />然後再呼叫Worker這個instance，<br />接著就可以去new一個worker出來，<br />然後就可以指定要worker做什麼事情，<br />這裡我們指定他去做task.js裡面的事情（new worker('task.js')）．<br /><br /><span style="color: #e06666; font-size: 18px;">4. test</span><br /><br />那要怎麼測試呢？<br />首先先把我們的main.js叫起來，<br /><pre class="brush: js">node main.js<br /></pre>成功叫起來以後，應該會在你的terminal中看到下面的字樣，<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-giyBWmviB8I/UuU-smEDo0I/AAAAAAAAFIA/iSg3TL2-s_Q/s1600/Screen+Shot+2014-01-27+at+12.58.24+AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-giyBWmviB8I/UuU-smEDo0I/AAAAAAAAFIA/iSg3TL2-s_Q/s320/Screen+Shot+2014-01-27+at+12.58.24+AM.png" /></a></div><br />接著就打開我們的browser，<br />然後輸入“http://0.0.0.0:5000/fibo”，<br />這時候browser應該很快的就show出hello world的字樣，<br />然後我們馬上回到terminal看，<br />你應該只會先看到request的log（如下圖），<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-s6pGcxYS6lI/UuVAEOs3t4I/AAAAAAAAFIQ/AZ083AEaBL8/s1600/Screen+Shot+2014-01-27+at+1.03.09+AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-s6pGcxYS6lI/UuVAEOs3t4I/AAAAAAAAFIQ/AZ083AEaBL8/s1600/Screen+Shot+2014-01-27+at+1.03.09+AM.png" /></a></div><br /><br />接著過了幾秒鐘以後才會看到fibo的計算結果（如下圖），<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-lhxjfM4sVvg/UuVAEK-Eg9I/AAAAAAAAFIM/pSvMrKChzJM/s1600/Screen+Shot+2014-01-27+at+1.04.35+AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-lhxjfM4sVvg/UuVAEK-Eg9I/AAAAAAAAFIM/pSvMrKChzJM/s1600/Screen+Shot+2014-01-27+at+1.04.35+AM.png" height="41" width="400" /></a></div><br />如果這裡我們沒有使用worker的話，而是直接call hibo，<br />你會發現很久才可以在browser中看到hello world的字樣！<br />且甚至你可以試試看開兩個browser，然後都去打“http://0.0.0.0:5000/fibo”，<br />你會發現第二個打的request會被hang住很久，因為是single thread的關係，<br />所以thread都在處理第一個request的fibo，處理完才會去處理第二個request！<br />因此想要在node.js中處理cpu-intensive或者long-running computation，<br />就使用worker的概念吧！<br /><br /><br /><br /></div>
      </div>

      <a href="/2014/01/27/handle-long-running-operations-in-nodejs" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>[Heroku] Getting Started with MongoDB and Node.js</h1>

      <div class="entry">
        <div style="font-size: 15px; line-height: 22px;"><a href="http://blog.kenyang.net/2014/01/deploying-nodejs-application-to-heroku.html">上一篇</a>已經講過怎麼在heroku上建立一個node.js的應用，<br />所以要開始進行這篇前，請先完成<a href="http://blog.kenyang.net/2014/01/deploying-nodejs-application-to-heroku.html">上一篇</a>的步驟<br />而這一篇要講如何在heroku上整合node.js和MongoDB，會實作一個簡單的ＣＲＵＤ！<br /><a href="http://www.mongodb.org/">MongoDB</a>是一種document based的database，<br />個人認為很適合用來做API Server，<br /><br />這裡建議大家先去下載mogodb來local，<br />是為了方便測試，不用每次都deploy至heroku上才可以測試mongodb，<br />我用的是mac，大家可以到官網看看怎麼安裝mongodb（<a href="http://docs.mongodb.org/manual/tutorial/install-mongodb-on-os-x/" target="_blank">官網安裝說明</a>）！<br /><br />那麼怎麼在Heroku上建立一個自己的mongodb呢？<br />得透過Add-ons來建立！（如下圖）<br />由於heroku它只是一個PaaS平台，你無法在上面真正的安裝自己“想要”的database，<br />因此你只能透過add-ons，而這些add-ons都是來自其他third-party tool！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-suR5k-nblxI/UtvJfKixZoI/AAAAAAAAFHs/BJvEGiypj3M/s1600/Screen+Shot+2014-01-19+at+8.47.12+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-suR5k-nblxI/UtvJfKixZoI/AAAAAAAAFHs/BJvEGiypj3M/s1600/Screen+Shot+2014-01-19+at+8.47.12+PM.png" height="59" width="640" /></a></div><br /><span style="color: red;">但！</span>透過add-ons建立mongodb之前，<br />請務必先通過account verification，那怎麼通過呢？<br />就是新增一張信用卡摟！<br />在自己的<a href="https://dashboard.heroku.com/account" target="_blank">account page</a>最下方有一個Billing選項，<br />在Billing選項填寫自己的信用卡資訊就完成了．<br /><br />完成verification以後，我們就可以到<a href="https://addons.heroku.com/">add-ons頁面</a>去選擇自己要的db，<br />可以從data stores選項看到有哪些db可以選，<br />而我們想要在上面使用mongodb的話，heroku有兩個provider<br />&nbsp; &nbsp; &nbsp;1. MongoLab<br />&nbsp; &nbsp; &nbsp;2. MongoHQ<br />在這篇我們使用<a href="https://addons.heroku.com/mongolab#dedicated-cluster">MongoLab</a>，其實我個人認為兩者差異性不大，<br />想看兩者detail差異性的可以去看他們各自的Pricing plan．<br /><br />接著我們就要開始進入主題了，<br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. create mongodb</span><br /><br />記得進入此步驟的前提是，你已經完成了<a href="http://blog.kenyang.net/2014/01/deploying-nodejs-application-to-heroku.html">上一篇</a>的deployment！<br />接著就進到我們app的folder裡面去，<br />透過下指令的方式來create monogdb！<br />這個指令下完以後，會建立一個free的mongodb，所以別擔心會被charge！<br /><pre class="brush: java">heroku addons:add mongolab <br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">2. install necessary module</span><br /><br />想要在node.js中connect mongodb，得透過其他的module，<br />就我所知有兩種選擇：<br />&nbsp; &nbsp; &nbsp;1. mongoose<br />&nbsp; &nbsp; &nbsp;2. mongodb<br />而我們先選擇mongoose，也沒為什麼，我單純覺得mongodb比較麻煩而已．<br />安裝指令，<br /><pre class="brush: java">npm install mongoose --save<br /></pre>為什麼會有--save？原因是下了--save以後，會自動幫我們把這個module加到package.json裡面！<br />不用再重新generate一次！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">3. create db schema</span><br /><br />在這步驟我們要建立我們的db schema，<br />所以先建立一個schema.js檔案，<br /><pre class="brush: js">vim schema.js<br /></pre><br />內容如下：<br /><pre class="brush: js">var mongoose = require( 'mongoose' );<br />var Schema   = mongoose.Schema;<br /><br />var Student = new Schema({<br />    user_id : String,<br />    name    : String<br />});<br /><br />mongoose.model('Student', Student);<br /></pre><br />這個schema.js會建立一個Student的schema！<br /><br /><br /><span style="color: #e06666; font-size: 18px;">4. development</span><br /><br />在這一步驟就要實作CRUD了，<br />在開始之前，我要先講express.js的一個優點，<br />express.js這個module可以輕鬆的隔離出production server和development環境出來，<br />什麼意思呢？來看下面例子就知道！<br /><pre class="brush: js">app.configure('development', function(){<br />    mongoose.connect( 'mongodb://localhost:27017' );<br />});<br />app.configure('production', function(){<br />    mongoose.connect( 'mongodb://' + process.env.MONGOLAB_URI );<br />});<br /></pre><br />上面例子中有兩種configuration，分別為development, production．<br />你可以看到在development的時候，我們是去連local的database，<br />而在production時，就會去連remote的那台database．<br />基本上你在自己的電腦上永遠都會是development，<br />那你可能會好奇，該怎麼讓heroku上吃到的config是production?<br />恩，很簡單，透過下面指令就可以，<br /><pre class="brush: java">heroku config:set NODE_ENV=production <br /></pre>下完這指令後，你在heroku上的application就會被restart了！<br /><br />好了，回到主題來，<br />接著就要開始實作CRUD了，<br />mongoose提供了很多方便的API讓我們可以直接對mogondb做select, update, insert等操作，<br />大家可以去<a href="http://mongoosejs.com/docs/api.html">官網</a>看看，<br />這裡我們用到了下面四個API，<br />&nbsp; &nbsp; &nbsp;1. save:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 就是insert<br />&nbsp; &nbsp; &nbsp;2. find: select all<br />&nbsp; &nbsp; &nbsp;3. findOneAndUpdate:<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 就是update，可以透過簡單的condition去做update，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 就像是傳統sql的where<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ex: update xxx set xxx=xxx where id = xxx;<br />&nbsp; &nbsp; &nbsp;4. findByIdAndRemove<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 透過id去delete<br /><br /><pre class="brush: js">var express = require("express");<br />var mongoose= require('mongoose');<br />require( './shcema' );<br /><br />var app = express();<br />app.use(express.logger());<br /><br /><br />app.configure('development', function(){<br />    mongoose.connect( 'mongodb://localhost:27017' );<br />});<br />app.configure('production', function(){<br />    mongoose.connect( 'mongodb://' + process.env.MONGOLAB_URI );<br />});<br /><br />var Student = mongoose.model('Student');<br /><br />// C: create<br />app.get('/insert', function(req, resp) {<br />    var s = new Student( {name: req.query.name} );<br />    s.save(function(err,student){<br />        resp.redirect('/select');<br />    });<br />});<br /><br />// R: read<br />app.get('/select', function(req, resp) {<br />    Student.find(function(err, students){<br />        resp.send(students);<br />    });<br />});<br /><br />// U: update<br />app.get('/update', function(req, resp) {<br />    var query = { name: req.query.old_name };<br />    Student.findOneAndUpdate(query, { name: req.query.new_name }, function(err, students){<br />        resp.redirect('/select');<br />    });<br />});<br /><br />// D: delete<br />app.get('/delete', function(req, resp) {<br />    Student.findByIdAndRemove(req.query.id, function(err, students){<br />        resp.redirect('/select?id='+req.query.id);<br />    });<br />});<br /><br />var port = process.env.PORT || 5000;<br />app.listen(port, function() {<br />    console.log("Listening on " + port);<br />});<br /></pre><br /><br />完成以後，接著就是下一步的deploy！<br /><br /><span style="color: #e06666; font-size: 18px;">5. deployment</span><br /><br /><pre class="brush: java">git add . <br />git cm -m 'add db'<br />git push<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">6. test</span><br /><br />完成deploy之後就可以測試了，<br />你也可以在local測試，但是記得在你自己local要安裝mongodb就是了．<br /><br /><b>新增：</b>首先先試試看新增 http://your-app-name.herokuapp.com/<span style="color: red;">insert</span>?name=hello_world<br /><b>查詢：</b>新增完成以後，在去查詢看看 （http://your-app-name.herokuapp.com/<span style="color: red;">select</span>）<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 應該會看到一筆剛剛新增的那筆資料，先把id記起來，等等要刪除用的！<br /><b>更新：</b>http://your-app-name.herokuapp.com/<span style="color: red;">update</span>?old_name=hello_world&amp;new_name=ken<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 更新成功以後，再去前面的查詢頁面看，應該會發現該筆資料的名稱變成ken了！<br /><b>刪除：</b>http://your-app-name.herokuapp.com/<span style="color: red;">delete</span>?id=xxxxxxxxxxxxxx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 這時候我們再去查詢頁面看，應該就沒有剛剛那筆資料了！<br /><br /><br /><br />這樣就完成了一個簡單的CRUD application，<br />這個例子為了快速做好POC，<br />所以簡略了一些，像是在做insert時，應該用post會比較好，<br />但因為在express.js之中要用post，還要額外的configuration，<br />且用get較容易demo，為了讓大家快速了解mongoDB怎麼操作，<br />所以就簡略了其他不必要的部分！<br /><br /><br /><br /><br /><br /><br /></div>
      </div>

      <a href="/2014/01/22/heroku-getting-started-with-mongodb-and" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Deploying a Node.js application to Heroku</h1>

      <div class="entry">
        <div style="font-size: 15px;line-height: 22px;">Node.js是近來很夯的一個javascript framework，<br />優點有even-driven, non-blocking IO...etc，<br />這裡就不贅述了，直接進入主題吧！<br /><br /><br />這篇假設大家已經有heroku帳號了，<br />就不教大家怎麼註冊，或者說明每個command了，<br />不會的可以去看<a href="http://blog.kenyang.net/2013/11/herokudeploy-python-applicaion.html">上一篇</a>．<br /><br />這篇主要教如何建立一個基本的node.js application，<br />下一篇會教如何結合mongodb，<br />而這篇會使用到:<br />&nbsp; &nbsp; &nbsp;1. npm (node.js的package manager)<br />&nbsp; &nbsp; &nbsp;2. express.js (web framework，你可以想像成flask, django, springmvc）<br /><ul></ul><br /><br /><br />進入正題吧！<br /><br /><span style="color: #e06666; font-size: 18px;">1. init</span><br /><br />先建立我們需要的環境，<br /><pre class="brush: java">mkdir test-app<br />cd test-app<br />git init <br />heroku create your-app-name<br /></pre><br /><span style="color: #e06666; font-size: 18px;">2. install express.js</span><br /><br />express.js需要透過npm來安裝，<br />那npm怎麼取得呢？現在只要你安裝node.js，<br />基本上就會幫你把npm裝好了，所以不用特別去裝！<br />使用npm安裝package有一個好處，<br />npm就像是virtualenv一樣，<br />它會為每個application建立一個獨立的環境，<br />每一個node.js application使用的package都是獨立的，彼此不會互相干擾！<br /><br />安裝指令：<br /><pre class="brush: java">npm install express.js<br /></pre><br /><span style="color: #e06666; font-size: 18px;">3. development</span><br /><br />先建立index.js這個檔案<br /><br /><pre class="brush: java">vim index.js<br /></pre><br />內容如下：<br /><pre class="brush: js">// include express module<br />var express = require("express");<br /><br />var app = express();<br />app.use(express.logger());<br /><br />app.get('/', function(req, resp) {<br />    resp.send("hello world");<br />});<br /><br />var port = process.env.PORT || 5000;<br />app.listen(port, function() {<br />    console.log("Listening on " + port);<br />});<br /><br /></pre><br /><span style="color: #e06666; font-size: 18px;">4. deployment</span><br /><br />首先要先建立一個檔案名為Procfile，<br />這檔案是讓node.js知道此process type，<br /><pre class="brush: java">vim Procfile<br /></pre><br />內容如下：<br /><pre class="brush: js">web: node index.js<br /></pre><br />接著建立一個package.json<br />這個檔案是記錄著你的application要用到哪些package，<br />但你不需要自己建立這個檔案，你可以透過npm來幫你generate這個file，<br />指令如下，<br /><pre class="brush: java">npm init<br /></pre><br />準備完上述兩個檔案後，就可以上傳至heroku了！<br /><pre class="brush: java">git add . <br />git commit -m 'first commit'<br />git push heroku master<br /></pre><br />完成以後就可以到你的application去看，（http://your-app-name.herokuapp.com/）<br />應該就會看到hello world字樣了．<br />在下一篇會講如何在heroku上整合mongodb．<br /><br /><br /></div><br /><br /><br /><br /><br />
      </div>

      <a href="/2014/01/19/deploying-nodejs-application-to-heroku" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to record the screen on Android?</h1>

      <div class="entry">
        <br /><br /><br />Now Android 4.4 or higher device can use tool to record screen.<br />It's useful for developer who want to demo their apps.<br /><br /><br /><span style="color: #e06666; font-size: 18px;">1. Download the Android SDK</span><br /><br /><a href="http://developer.android.com/sdk/index.html">link</a><br /><br /><br /><span style="color: #e06666; font-size: 18px;">2. open the terminal</span><br /><br /><br /><br /><span style="color: #e06666; font-size: 18px;">3. cd to the SDK path</span><br /><pre class="brush: java">cd ~/android-sdk-macosx/platform-tools<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">4. start recording</span><br /><pre class="brush: java">./adb shell screenrecord /sdcard/demo.mp4<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">5. stop recording </span><br /><br />Stop the screen recording by pressing Ctrl-C<br /><pre class="brush: java">control+C<br /></pre><br /><br /><span style="color: #e06666; font-size: 18px;">6. Get the video</span><br /><br />The video will be stored in you sd card.<br />Please reference the screenshot.<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-5RFy0c1X3DY/UsuepYc3j2I/AAAAAAAAFHY/-N7oRjt96-w/s1600/68644.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-5RFy0c1X3DY/UsuepYc3j2I/AAAAAAAAFHY/-N7oRjt96-w/s320/68644.jpg" height="400" width="225" /></a></div>
      </div>

      <a href="/2014/01/07/android-how-to-record-screen-on-mac" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Heroku：deploy a python application </h1>

      <div class="entry">
        恩，昨天心血來潮想deploy一個application到GAE (Google App Engine)上，<br />赫然發現GAE現在只支援JDK 7，說實在我很不想升上去！<br />且又想到要在新電腦上裝eclipse plugin for GAE很麻煩，<br />所以把念頭轉到了Amazon Web Service Elastic Compute Cloud (EC2)，<br />又赫然發現我的AWS帳號已經超過一年了...也就是說不能使用free-tier方案！<br /><br />好吧，只好換到heroku上了！<br />heroku比較像是GAE一樣，屬於PaaS平台，<br />但deploy方式比GAE方便多了！也快多了！<br />在Heroku上deploy方式是用git！<br />可以在上面deploy Ruby, node.js, Java, Python...等語言的application！<br /><br />這篇會用python來講解，<br />雖然我最熟java，但heroku預設好像是用maven來當build system，<br />對maven就沒那麼熟！且我實在很懶得設定那很複雜的xml....<br />所以退而求其次選python，<br />而剛好python是使用flask做framework，剛好也玩過這framework，<br />所以就使用python！<br /><br /><br /><br /><span style="color: #e06666; font-size: large;">Step 1：註冊</span><br /><br />先到<a href="https://id.heroku.com/signup/devcenter">https://id.heroku.com/signup/devcenter</a>註冊帳號，<br />蠻方便的，不需要填寫太多資料！<br /><br /><br /><span style="color: #e06666; font-size: large;">Step 2：安裝Heroku toolbelt</span><br /><br />先去<a href="https://toolbelt.heroku.com/">https://toolbelt.heroku.com/ </a>下載toolbelt，<br />因為我是使用mac，所以就下載mac版本的來安裝！<br /><br /><br /><span style="color: #e06666; font-size: large;">Step 3：Login Heroku</span><br /><br />打開你的terminal，<br />輸入下面指令，<br /><pre class="brush: java">heroku login<br /></pre>會要求你輸入heroku上註冊的email及密碼！<br />接著會把你local的ssh key上傳至heroku上去！<br /><br /><br /><span style="color: #e06666; font-size: large;">Step 4：在後台create app</span><br /><br />接著回到heroku的管理後台建立一個app，<br />如下圖，點選下圖中的Create a new app，<br /><span id="goog_67746771"></span><span id="goog_67746772"></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-rQj9LQoTBtk/UpRMRMoEQuI/AAAAAAAAFFc/GxSkzDPe7vw/s1600/Screen+Shot+2013-11-26+at+3.20.49+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-rQj9LQoTBtk/UpRMRMoEQuI/AAAAAAAAFFc/GxSkzDPe7vw/s640/Screen+Shot+2013-11-26+at+3.20.49+PM.png" height="264" width="640" /></a></div><br /><br /><br /><br />接著會popup一個dialog要以輸入這個app名稱（如下圖）！這個app名稱就會變成你的sub-domain，<br />假設我輸入hello-ken，那麼到時候我的app url就會是hello-ken.herokuapp.com！<br />輸入完以後請點選下圖中的create app．<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-lRf0S7DzRlA/UpRMAoxg2xI/AAAAAAAAFFE/WB5PH7lpm3Y/s1600/Screen+Shot+2013-11-26+at+3.21.04+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-lRf0S7DzRlA/UpRMAoxg2xI/AAAAAAAAFFE/WB5PH7lpm3Y/s640/Screen+Shot+2013-11-26+at+3.21.04+PM.png" height="356" width="640" /></a></div><br /><br /><br /><br />這樣就完成create app，接著會跟你說你的app information！如下圖．<br />請把下圖中的git資訊記下來！因為這就是你app的repo了！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-4hN8y4jZ6v8/UpRMAioGBBI/AAAAAAAAFFI/UoHgXI7a6Tg/s1600/Screen+Shot+2013-11-26+at+3.21.16+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-4hN8y4jZ6v8/UpRMAioGBBI/AAAAAAAAFFI/UoHgXI7a6Tg/s640/Screen+Shot+2013-11-26+at+3.21.16+PM.png" height="512" width="640" /></a></div><br /><br /><span style="color: #e06666; font-size: large;">Step 5：在local create app</span><br /><br />接著你就要把在heroku上的app clone下來，<br />指令如下，<br /><br /><pre class="brush: python">git clone git@heroku.com:hello-ken.git -o heroku<br /></pre><br />clone完成以後，你的目錄底下應該會有一個hello-ken資料夾！<br /><br /><br /><br /><span style="color: #e06666; font-size: large;">Step 6：安裝virtualenv</span><br /><br />virtualenv可以讓你在local模擬獨立的python環境！<br />然後你可以在你的環境中安裝任何python相關package，且不會影響到local system！<br />安裝指令：<br /><pre class="brush: java">curl -O https://pypi.python.org/packages/source/v/virtualenv/virtualenv-1.10.1tar.gz<br />tar xvfz virtualenv-1.10.1.tar.gz<br />cd virtualenv-1.10.1<br />sudo python setup.py install<br /></pre><br /><br /><span style="color: #e06666; font-size: large;">Step 7：建立一個獨立的env</span><br /><br />建立環境<br /><pre class="brush: java">virtualenv venv --distribute<br /></pre><br />activate環境，這裡要注意一點，如果你terminal關掉重開，那麼就要重新去source一次！<br /><pre class="brush: java">source venv/bin/activate<br /></pre><br /><br /><span style="color: #e06666; font-size: large;">Step 8：安裝Flask, gunicorn</span><br /><br />Flask是一個web framework，<br />gunicorn是一個web server．<br /><pre class="brush: java">pip install Flask gunicorn<br /></pre><br /><br /><span style="color: #e06666; font-size: large;">Step 9：寫第一個app</span><br /><br />在這個step就開始寫程式主體，<br /><pre class="brush: python">cd hello-ken<br />vim index.py<br /></pre><br /><br />需搭配Flask的格式！index.py的內容如下！<br />app.route的意思就是，當user request path爲/時，就執行hello這個method，<br /><pre class="brush: python">import os<br />from flask import Flask<br /><br />app = Flask(__name__)<br /><br />@app.route('/')<br />def hello():<br />    return 'Hello World!'<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: large;">Step 10：定義這個app的type</span><br /><br />我們必須要讓heroku知道這個app的type，<br />所以要建立一個檔案（Profile），<br /><pre class="brush: python">vim Profile<br /></pre><br />內容如下：<br /><pre class="brush: python">web: gunicorn index:app<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: large;">Step 11：local test</span><br /><br />完成上面的步驟以後，<br />其實就可以在local端測試，<br />在hello-ken目錄底下指令，<br /><pre class="brush: java">foreman start<br /></pre><br />接著就會在terminal中顯示你的test url，<br />只要打開browser就可以瀏覽了！<br /><br /><br /><span style="color: #e06666; font-size: large;">Step 12：declare requirements</span><br /><br />在這步驟要讓heroku知道我們application的requirement，<br />我們可以透過pip的指令去產生那個requirement檔案，<br />指令如下：<br /><pre class="brush: java">pip freeze &gt; requirements.txt<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: large;">Step 13：deploy app to Heroku</span><br /><br />在這步驟就要把我們剛剛的東西通通push上去heroku了！<br />但我們要先建立.gitignore檔案，<br />把一些不需要push上去的東西拿掉！<br /><pre class="brush: java">venv<br />*.pyc<br /></pre><br /><br />接著就add, commit, push吧！<br /><pre class="brush: java">git add .<br />git commit -m "first commit"<br />git push heroku master<br /></pre><br />順利push完以後，就可以到<span style="color: #e06666;">hello-ken</span>.herokuapp.com看看有沒有成功了！<br />（記得<span style="color: #e06666;">hello-ken</span>要換成你自己申請的app name）<br /><br /><br />接著之後的deploy都是靠git來完成！<br />真的是比GAE方便很多啊！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/11/26/herokudeploy-python-applicaion" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>ActionBarCompat 【Swipe to change tab】</h1>

      <div class="entry">
        <a href="http://blog.kenyang.net/2013/09/actionbarcompat-add-tab.html">上一篇ActionBarCompat 【Add Tab】</a>講到了，你們可能會覺得很奇怪，<br />為什麼不管點tab1還是tab2，<br />怎麼內容都一樣？<br />因為我們的確沒有透過FragmentTransaction把Fragment加進來！<br />最後的結論是說，要透過ViewPager去把Fragment加進來！<br /><br />所以這篇就是要教大家怎麼使用ViewPager，<br />使用ViewPager好處就是，使用者可以用swipe去換tab，<br /><br /><br /><span style="color: #e06666; font-size: large;">1. 首先請將你的class implement OnPageChangeListener 這個interface</span><br /><br /><pre class="brush: java">public class MainActivity extends ActionBarActivity implements TabListener,OnPageChangeListener {<br />    ....<br />}<br /></pre><br /><br /><span style="color: #e06666; font-size: large;">2. 增加對應的method</span><br /><br />因為在第一步的時候，你就已經implement一個interface進來，<br />所以在第二步驟我們必須增加下面的method<br /><br /><pre class="brush: java">@Override<br />public void onPageScrollStateChanged(int arg0) {}<br /><br />@Override<br />public void onPageScrolled(int arg0, float arg1, int arg2) {}<br /><br />@Override<br />public void onPageSelected(int iPosition) {<br />    getSupportActionBar().setSelectedNavigationItem(iPosition);<br />}<br /><br /></pre><br />我們在上面的onPageSeleced中實作了一段code，<br />它的目的就是當你swipe到該page，就顯示該page應顯示的Fragment！<br /><br /><br /><span style="color: #e06666; font-size: large;">3. 加入2個Fragment</span><br /><br />這步驟是新增兩個Fragment，<br />目的是為了要塞在tab裡面！<br />由於很簡單，就不貼example了！<br />反正就是兩個Fragment（先命名為FragmentTab1, FragmentTab2）<br /><br /><br /><br /><span style="color: #e06666; font-size: large;">4. 加入FragmentPagerAdapter</span><br /><br />FragmentPagerAdapter目的就是待會要餵給viewPager使用的，<br />這樣viewPager才知道捲動到哪頁的時候，要顯示哪個Fragment．<br />我們可以在getItem看到，<br />當iPosition為1的時候，意思就是卷到第一個tab了！<br />所以我們就在這new上面新增的FragmentTab1出來！<br /><br /><pre class="brush: java">public class HomeViewPagerAdapter extends FragmentPagerAdapter{<br /><br />    public HomeViewPagerAdapter(FragmentManager fm) {<br />        super(fm);<br />    }<br /><br />    @Override<br />    public Fragment getItem(int iPosition) {<br />        switch (iPosition) {<br />            case 0:<br />                return new FragmentTab1();<br />            case 1:<br />                return new FragmentTab2();<br />        }<br />        return null;<br />    }<br /><br />    @Override<br />    public int getCount() {<br />        return 2;<br />    }<br />}<br /></pre><br /><br /><br /><br /><br /><span style="color: #e06666; font-size: large;">5. 在layout中加入viewpager</span><br /><br /><pre class="brush: xml">&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;<br />    android:orientation=&quot;vertical&quot;<br />    android:layout_width=&quot;match_parent&quot;<br />    android:layout_height=&quot;match_parent&quot;&gt;<br /><br />    &lt;android.support.v4.view.ViewPager<br />        android:id=&quot;@+id/pager&quot;<br />        android:layout_width=&quot;match_parent&quot;<br />        android:layout_height=&quot;0dp&quot;<br />        android:layout_weight=&quot;1&quot; /&gt;<br /><br /><br />&lt;/LinearLayout&gt;<br /></pre><br /><br /><br /><span style="color: #e06666; font-size: large;">6. 取得layout中的viewpager</span><br /><br />在這步驟就是取得剛剛上步驟新增的viewpager，<br />然後對它作設定，<br />首先要先設定adapter，這裡就是餵給他我們上面的HomeViewPagerAdapter，<br />接著就是設定listener，這裡我們指定this，指定this的話就會去抓第二步驟implement的method！<br />當然你也可以自己new！<br />至於第三步與第四步是optional的！當然你也可以不要設定！<br />這兩步驟只是為了讓畫面好看一點，在tab1和tab2之間swipe的時候，中間會有一個style在！<br />但理論上，你們第三步與第四步都會錯，因為沒有圖也沒有設定dimension！<br /><pre class="brush: java">private ViewPager viewPager;<br /> <br />@Override<br />protected void onCreate(Bundle savedInstanceState) {<br />    super.onCreate(savedInstanceState);<br />    setContentView(R.layout.activity_main);<br />  <br />    viewPager = (ViewPager) findViewById(R.id.pager);<br />  <br />    if (viewPager!=null){<br />        viewPager.setAdapter(new HomeViewPagerAdapter(getSupportFragmentManager()));<br />        viewPager.setOnPageChangeListener(this);<br />        viewPager.setPageMarginDrawable(R.drawable.grey_border_inset_lr);  // optional<br />        viewPager.setPageMargin(getResources().getDimensionPixelSize(R.dimen.page_margin_width)); // optional  <br />    }<br />}<br /></pre><br /><br /><br /><br /><span style="color: #e06666; font-size: large;">7. hook onTabSelected </span><br /><br />理論上完成上面的步驟，<br />你應該就可以完成用swipe換tab了！<br />可是你可能會發現，當你直接點tab時，<br />tab並不會更換！<br />所以最後一步驟就是要實作這一塊！<br />還記得上一篇嗎？<br />我們有implement onTabSelected這個method！<br />在裡面加入下面的code吧！<br /><br /><pre class="brush: java">@Override<br />public void onTabSelected(Tab tab, FragmentTransaction arg1) {<br />    viewPager.setCurrentItem(tab.getPosition());<br />}<br /></pre><br /><br /><br />大功告成！<br />恩，下一篇會教大家怎麼去style自己的actionbar(if i have time..)<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/10/23/actionbarcompat-swipe-to-change-tab" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Arduino WiFi Shield</h1>

      <div class="entry">
        多虧於公司intern的實驗室，<br />我才有榮幸玩到Arduino的wifi套件！<br />不然一塊三千多塊，實在是買不下去阿！<br /><br />這篇主要教大家，<br />怎麼用這塊wifi shield去做到下列的事情<br /><br /><ol><li>scan network AP</li><li>connect to a network AP</li><li>send a request</li><li>create a WebServer using exists connection</li></ol><br /><br />恩，在開始之前，請先準備好環境！<br />注意！在我寫文章的這個時候！<br />arduino已經出到了1.0.5版！<br />最一開始我是用1.0.1版開發，但1.0.1版是沒有wifi的lib，<br />所以我自己去github把wifi的lib抓下來，再放在我的lib裡面！<br />的確！大部份功能都可以work！<br />除了建立webserver以外！<br />但是不要天真的以為用1.0.5版就可以建立webserver，<br />根據撞牆了幾個小時，發現要downgrade至1.0.2版才能建立webserver...<br />其實1.0.5版也可以，只是要<a href="http://arduino.cc/en/Hacking/WiFiShieldFirmwareUpgrading">做一些操作</a>！實在太麻煩！<br /><b>總而言之，請使用1.0.2</b><br /><b><br /></b> <b><br /></b> <b><br /></b><span style="color: #e06666; font-size: large;"> 1. 把wifi shield直接插在你的arduino板上！</span><br /><br />官網其實有備註，如果你是用比較舊的板子(UNO R3)，還要稍微接一下線！<br />請看這篇吧！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-G1GWplatYBs/UkksINfSL4I/AAAAAAAAFBc/BR8nhQWtOG8/s1600/wifi_jump2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="572" src="http://1.bp.blogspot.com/-G1GWplatYBs/UkksINfSL4I/AAAAAAAAFBc/BR8nhQWtOG8/s640/wifi_jump2.png" width="640" /></a></div><br /><br /><br /><span style="color: #e06666; font-size: large;">2. include necessary lib</span><br /><br /><pre class="brush: c">#include &lt;WiFi.h&gt;<br /></pre><br /><br /><span style="color: #e06666; font-size: large;">3. 開始寫code</span><br /><br /><span style="color: #e06666;">3.1 掃描附近所有的ap</span><br /><br /><pre class="brush: java">void setup(){<br />  Serial.begin(9600);<br />}<br /><br />void loop(){<br />  fnScanNetwork();<br />}<br /><br />void fnScanNetwork(){<br />  <br />  int iNum = WiFi.scanNetworks();<br />  Serial.print("=========number of available networks:");<br />  Serial.print(iNum);<br />  Serial.println("=========");<br />  <br />  // print the each SSID and Signal<br />  for (int i = 0; i&lt;iNum; i++) {<br />    Serial.print(WiFi.SSID(i));  // pring SSID<br />    Serial.print("\tSignal: ");<br />    Serial.print(WiFi.RSSI(i));  // print Signal<br />    Serial.print(" dBm");<br />    Serial.print("\tEncryption: ");<br />    Serial.println(WiFi.encryptionType(i));  // print Encryption Type<br />  }  <br />  <br />}<br /><br /></pre><br /><br />上面比較需要注意的大概就是WiFi.RSSI(i)，<br />這隻method就是回傳該ＡＰ訊號的強弱！<br />記得值越大訊號越強！<br /><br />再來就是WiFi.encryptionType(i)，<br />這是回傳該ＡＰ的加密形態是什麼？<br />內容如下：<br />* TKIP (WPA) = 2<br />* WEP = 5<br />* CCMP (WPA) = 4<br />* NONE = 7<br />* AUTO = 8<br /><br /><br /><span style="color: #e06666;">3.2 連線至某個ap</span><br /><br /><pre class="brush: java">char szSsid[] = "kerkerker";          //  network SSID (name) <br />char szPass[] = "safesync";   // network password<br /><br />int iStatus = WL_IDLE_STATUS;<br /><br />void setup(){<br />  Serial.begin(9600);<br />  fnConnectToAP();<br />}<br /><br />void loop(){<br />}<br /><br />void fnConnectToAP(){<br />  while ( iStatus != WL_CONNECTED) { <br />    Serial.println("Connecting to network...");<br />    Serial.print("SSID: ");<br />    Serial.println(ssid);<br />    delay(1000);<br />    iStatus = WiFi.begin(ssid, pass);  // connect<br />  }  <br />  <br />  Serial.print("Connected successfully. IP address:");<br />  IPAddress myAddress = WiFi.localIP();<br />  Serial.println(myAddress);  <br />}<br /><br /></pre><br />WiFi.begin這個method就是在進行連線！<br />如果成功的話會看到下面兩張圖！<br />首先你的wifi shield上的link那顆燈會變成綠色！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-221f35wff8E/UkkwP6muu9I/AAAAAAAAFBo/kX4A4LZOkM8/s1600/252107.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-221f35wff8E/UkkwP6muu9I/AAAAAAAAFBo/kX4A4LZOkM8/s320/252107.jpg" /></a></div><br />而你的Serial Monitor會長得像下面一樣！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-B-7VpWCGgrk/UkkwP-toM-I/AAAAAAAAFBs/4GKdzFbQJsY/s1600/Screen+Shot+2013-09-30+at+4.05.46+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="118" src="http://1.bp.blogspot.com/-B-7VpWCGgrk/UkkwP-toM-I/AAAAAAAAFBs/4GKdzFbQJsY/s400/Screen+Shot+2013-09-30+at+4.05.46+PM.png" width="400" /></a></div><br /><br /><br /><br /><span style="color: #e06666;">3.3 傳送一個request至一個server</span><br /><br />首先在setup裡面先連線至ap，<br />接著就送出一個request，<br />然後就在loop裡面進行讀資料的動作！<br />如果成功的話，你應該會在你的Serial Monitor看到一大堆回傳的資料才對！<br /><br /><pre class="brush: java">// connect to ap<br />int iStatus = WL_IDLE_STATUS;<br />char szSsid[] = "kerkerker";          //  network SSID (name) <br />char szPass[] = "safesync";   // network password<br /><br /><br />// send a request<br />char szServername[]="www.google.com";  // remote server we will connect to<br />WiFiClient client;<br /><br />void setup(){<br />  Serial.begin(9600);<br />  fnConnectToAP();<br />  fnSendRequest();<br />}<br /><br />void loop(){<br />  fnReadData();<br />}<br /><br />void fnSendRequest(){<br />  if (client.connect(szServername, 80)) {<br />    Serial.println("connected");<br />    <br />    // Send a HTTP request:<br />    client.println("GET /search?q=arduino HTTP/1.1");<br />    client.println("Host: www.google.com");<br />    client.println();<br />  }<br />    <br />}<br />void fnReadData(){<br />  while (client.available()) {<br />    char c = client.read();<br />    Serial.print(c);<br />  }<br />  <br />  // if the server's disconnected, stop the client:<br />  if (!client.connected()) {<br />    Serial.println();<br />    Serial.println("disconnecting from server.");<br />    client.stop();<br />  <br />    // do nothing forevermore:<br />    while(true);<br />  }  <br />}<br /><br /></pre><br /><br /><br /><span style="color: #e06666;">3.4 建立一個webserver供人連線</span><br /><br />輸入下列的code以後，接著只要用browser輸入你的ip，<br />就會看到Hello World了！<br /><br /><pre class="brush: java">// webserver<br />WiFiServer server(80);<br /><br />void setup(){<br />  Serial.begin(9600);<br />  fnConnectToAP();<br />//  fnSendRequest();<br />  fnStartServer();<br />}<br /><br />void loop(){<br />  fnWaitingRequest();<br />//  fnReadData();<br />}<br /><br /><br />void fnStartServer(){<br />  delay(1000);<br />  server.begin();<br />}<br /><br />void fnWaitingRequest(){<br />  WiFiClient client = server.available();<br />  <br />  if (client) {<br />    Serial.println("new client comming");<br />    <br />    boolean bCurrentLineIsBlank = true;<br />    while (client.connected()) {<br />      if (client.available()) {<br />        char c = client.read();<br />        Serial.write(c);<br />        // if you've gotten to the end of the line and the line is blank, the http request has ended,<br />        // so you can send a reply<br />        if (c == '\n' &amp;&amp; bCurrentLineIsBlank) {<br />          // send a standard http response header<br />          client.println("HTTP/1.1 200 OK");<br />          client.println("Content-Type: text/html");<br />          client.println("Connection: close");  // the connection will be closed after completion of the response<br />          client.println();<br />          client.println("&lt;!DOCTYPE HTML&gt;");<br />          client.println("&lt;html&gt;");<br />          client.print("Hello World ");<br /><br />          client.println("&lt;/html&gt;");<br />          break;<br />        }<br />        if (c == '\n') {<br />          // you're starting a new line<br />          bCurrentLineIsBlank = true;<br />        } else if (c != '\r') {<br />          // you've gotten a character on the current line<br />          bCurrentLineIsBlank = false;<br />        }<br />      }<br />    }<br />    // give the web browser time to receive the data<br />    delay(1);<br />    <br />    // close the connection:<br />    client.stop();<br />    Serial.println("client disonnected");<br />  }  <br />  <br />}<br /><br /><br /></pre><br />source code:&nbsp;<a href="https://github.com/Ken-Yang/ArduinoWiFiShield">https://github.com/Ken-Yang/ArduinoWiFiShield</a><br /><br />基本上蠻簡單的，<br />code也很好理解！<br />只是有些tricky的地方，<br />像是1.0.5版需要update firmware！<br />官網上也有很多豐富的example！<br />有空可以去看看！<br /><br /><br />如果有空，下一篇會教大家怎麼結合wifi＋遙控車！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/09/30/arduino-wifi-shield" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>ActionBarCompat 【Add Tab】</h1>

      <div class="entry">
        <a href="http://blog.kenyang.net/2013/09/actionbarcompat-basic.html">上一篇ActionBarCompat 【Basic】</a>教導大家怎麼使用Google提供的ActionBarCompat lib以後，<br />這篇要延續上篇實作的actionbar，來加入tabs！<br /><br />最早在android要使用tab的layout，<br />必須使用tabhost這個object！<br />但現在被deprecated了！<br />後來推薦使用Fragment去控制tabwidget ui object.<br />但這篇是要教大家怎麼直接用actionbar加入tabs，<br />相較前面的兩種方法，用actionbar比較簡單！<br /><br /><br /><span style="color: #e06666; font-size: large;">1. 首先請將你的class implement TabListener 這個interface</span><br /><br /><pre class="brush: java">public class MainActivity extends ActionBarActivity implements TabListener {<br />    ....<br />}<br /></pre><br /><br /><span style="color: #e06666; font-size: large;">2. 加入應有的method</span><br /><br />因為你前一步驟implement了一個interface，<br />那麼在你的Class之中，也應該要有該interface底下的method，<br />所以你的class一開始應該會紅紅的一條，代表error，<br />那麼你只要將滑鼠移至該class名稱上，eclipse就會有選項幫你直接加入該有的method，<br />或者你也可以自己直接加入，如下<br /><br /><pre class="brush: java">@Override<br /> public void onTabReselected(Tab arg0, FragmentTransaction arg1) {<br />  // TODO Auto-generated method stub<br />  <br /> }<br /><br /> @Override<br /> public void onTabSelected(Tab arg0, FragmentTransaction arg1) {<br />  // TODO Auto-generated method stub<br />  <br /> }<br /><br /> @Override<br /> public void onTabUnselected(Tab arg0, FragmentTransaction arg1) {<br />  // TODO Auto-generated method stub<br />  <br /> }<br /></pre><br /><br /><span style="color: #e06666; font-size: large;">3. 加入tab</span><br /><br />這邊是利用ActionBar去加入tab，<br />所以我們再加入之前應該先取得actiobar這個object，<br /><br /><pre class="brush: java">@Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br />  <br />  final ActionBar actionbar = getSupportActionBar();<br />  <br /> }<br /></pre><br />接著設定navigation mode，<br />這裡分成三種<br /><br /><ol><li><span class="s1">ActionBar</span><span class="s2">.</span><span class="s1">NAVIGATION_MODE_LIST &nbsp; &nbsp; （actionbar左上角會有spinner）</span></li><li><span class="s1">ActionBar</span><span class="s2">.</span>NAVIGATION_MODE_TABS &nbsp; &nbsp;（就是tabs）</li><li><span class="s1">ActionBar</span><span class="s2">.</span><span class="s1">NAVIGATION_MODE_STANDARD &nbsp; &nbsp;（什麼都不會有，只剩actionbar）</span></li></ol><br />所以理論上我們要設成第二種！<br /><br /><pre class="brush: java">@Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br />  <br />  final ActionBar actionbar = getSupportActionBar();<br />  <br />  actionbar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);<br />  <br /> }<br /></pre><br />最後一步就是加入tab了！<br /><br /><pre class="brush: java">@Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br />  <br />  final ActionBar actionbar = getSupportActionBar();<br />  <br />  actionbar.setNavigationMode(ActionBar.NAVIGATION_MODE_TABS);<br />  <br />  // add tab<br />  actionbar.addTab(actionbar.newTab().setText(R.string.tab1).setTabListener(this));<br />  actionbar.addTab(actionbar.newTab().setText(R.string.tab2).setTabListener(this));<br />  <br /> }<br /></pre><br /><br /><br />接著大家就可以deploy上去看看了！<br />應該就可以看到2個tab出現！<br />如下圖<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-rqHC2KsSH-s/UkaCTVBdQhI/AAAAAAAAFBM/mJ-vQUPR8qk/s1600/249261.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/-rqHC2KsSH-s/UkaCTVBdQhI/AAAAAAAAFBM/mJ-vQUPR8qk/s400/249261.jpg" width="225" /></a></div><br /><br />這時候大家可能會覺得很奇怪，<br />不管點tab1還是tab2，<br />怎麼內容都一樣？<br /><br />原因是因為你要在先前implement的method（onTabSelected）中，<br />透過FragmentTransaction把Fragment加進來！<br />好！這時候大家可能也會好奇一件事，我的Class明明是 extends ActionBarActivity，<br />怎麼可能在這個class之中把Fragment加進來？不是應該要透過FragmentActivity嗎？<br />恩，其實如果你們在往下層看，會發現ActionBarActivity這個class也是extends FragmentActivity！<br />所以自然而然可以在ActionBarActivity中把一個Fragment加進來！<br /><br /><span style="color: #e06666; font-size: x-large;">但是！！！！</span>在這裡我不會教你用這種方式！！！<br />為什麼？<br />其實在Google Standard之中，希望我們有tabs時，理應上要支援swipe to change tab！<br />那麼要怎麼做到呢？<br />就是靠ViewPager！<br />在<a href="http://blog.kenyang.net/2013/10/actionbarcompat-swipe-to-change-tab.html">下一篇ActionBarCompat 【Swipe to change tab】</a>中，會教大家怎麼用ViewPager去把Fragment加進來以及可以swipe！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/09/28/actionbarcompat-add-tab" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>ActionBarCompat  【Basic】</h1>

      <div class="entry">
        ActionBarCompat是Google近期推出的lib，<br />目的是讓3.0以下的裝置也能夠使用ActionBar，<br />其實在ActionBarCompat推出之前，<br />大部份的developer應該都是使用ActionBarSherlock作為backward compatibility的lib！<br /><br />但我一直都沒有把ActionBarSherlock拿來放在一個production的app，<br />原因是因為可能有一天它就失去支援，那到時候我就很麻煩，可能要跳進去自己改了！<br />但現在有了ActionBarCompat，且是Google推出的，支援度應該會較好！<br /><br />這篇就是教大家怎麼整合<b><span style="color: #e06666;">最基本</span>的</b>ActionBarCompat，<br />讓大家的app可以向下相容actionbar！<br /><br /><br />首先要先import ActionBarCompat這個lib，<br />而ActionBarCompat的source code會放在android sdk之中，<br />路徑應該為：<br /><pre class="brush: java">android-sdk-macosx/extras/android/support/v7/appcompat<br /></pre><br /><br />接著在你的project點選右鍵-&gt;選擇Properties-&gt;選擇Android<br />會看到下圖<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-BbRRDuvGkgk/UkPfnXPWqsI/AAAAAAAAFAo/gN_KGPSGGz0/s1600/Screen+Shot+2013-09-26+at+3.14.18+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/-BbRRDuvGkgk/UkPfnXPWqsI/AAAAAAAAFAo/gN_KGPSGGz0/s400/Screen+Shot+2013-09-26+at+3.14.18+PM.png" width="356" /></a></div><br /><br /><br />接著點選上圖中的Add按鈕，就會看到下圖，<br />看到下圖後，請選擇android-support-v7-appcompat，<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-HJ6D40_3tKw/UkPfm66QUSI/AAAAAAAAFAc/JI9qsLk3liU/s1600/Screen+Shot+2013-09-26+at+3.14.30+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="370" src="http://1.bp.blogspot.com/-HJ6D40_3tKw/UkPfm66QUSI/AAAAAAAAFAc/JI9qsLk3liU/s400/Screen+Shot+2013-09-26+at+3.14.30+PM.png" width="400" /></a></div><br /><br />選完以後就會看到下圖，請按下按鈕OK！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-LxJBrpfEnXE/UkPfmhwkTjI/AAAAAAAAFAY/jgJR4vAcx8g/s1600/Screen+Shot+2013-09-26+at+3.14.38+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-LxJBrpfEnXE/UkPfmhwkTjI/AAAAAAAAFAY/jgJR4vAcx8g/s1600/Screen+Shot+2013-09-26+at+3.14.38+PM.png" /></a></div><br /><br /><br />完成以後就能在你的project裡面使用actionbar了，只差一些設定了！<br /><br /><b><span style="color: #e06666; font-size: large;">1. 先換Style</span></b><br /><br />記得換掉values, values-v11, values-v14裡面所有的style.xml，<br />把AppBaseTheme的parent改成下列的example，<br />如果你不是一個新的project，你可能有自己的theme，那麼就把他的parent換成下面的吧！<br /><pre class="brush: xml">&lt;style name="AppBaseTheme" parent="@style/Theme.AppCompat.Light"&gt;<br />    &lt;/style&gt;<br /></pre><br /><br /><span style="color: #e06666; font-size: large;"><b>2. extend ActionBarActivity</b></span><br /><br />接著要把你主要的Activity換成extend ActionBarActivity，如下<br /><pre class="brush: java">package net.kenyang.practiceactionbarcompat;<br /><br />import android.os.Bundle;<br />import android.support.v7.app.ActionBarActivity;<br />import android.view.Menu;<br /><br />public class MainActivity extends ActionBarActivity {<br /><br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br /> }<br /><br /> @Override<br /> public boolean onCreateOptionsMenu(Menu menu) {<br />  // Inflate the menu; this adds items to the action bar if it is present.<br />  getMenuInflater().inflate(R.menu.main, menu);<br />  return true;<br /> }<br /><br />}<br /><br /></pre><br /><br /><b><span style="color: #e06666; font-size: large;">3. 修改menu/main.xml</span></b><br /><br />你的project應該會有一個預設的main.xml<br />那麼你需要做兩件事:<br /><br /><ul><li>將root element新增一個attribute</li><li>替<item> element新增一個attribute</item></li></ul><br />如下：<br /><pre class="brush: xml">&lt;menu xmlns:android="http://schemas.android.com/apk/res/android"<br />    xmlns:actionbar="http://schemas.android.com/apk/res-auto" &gt;<br /><br />    &lt;item<br />        android:id="@+id/action_settings1"<br />        android:icon="@drawable/ic_launcher"<br />        android:orderInCategory="0"<br />        actionbar:showAsAction="ifRoom"<br />        android:title="@string/action_settings"/&gt;<br />    &lt;item<br />        android:id="@+id/action_settings2"<br />        android:orderInCategory="100"<br />        android:showAsAction="never"<br />        android:title="@string/action_settings"/&gt;<br /><br />&lt;/menu&gt;<br /><br /></pre><br />注意上面的例子，<br />第一個item和第二個item有一個attribute不一樣！<br />就是showAsAction，一個是<span style="color: #e06666;">actionbar</span>，另一個是<span style="color: #e06666;">android</span>！<br />如果你想要這顆menu獨立顯示為一個action item的話，<br />請改成actionbar，否則用android的話，你永遠看不到那顆action item，<br />如果是android 3.0以上，它會被隱藏在下圖中右上角的點點點之中！<br />如果是android 2.x系列，就會在menu裡面！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Mc24rqhvxPo/UkQzX10BDoI/AAAAAAAAFA4/oE2eTw9x_zs/s1600/246815.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-Mc24rqhvxPo/UkQzX10BDoI/AAAAAAAAFA4/oE2eTw9x_zs/s400/246815.jpg" width="225" /></a></div><br /><br />所以請都改成actionbar:showAsAction！<br />最後請注意actionbar:showAsAction有很多個選項，<br />如ifRoom, never, always...etc<br />可以自己去試試看各自的差別！<br /><br /><br />只要完成上述三個步驟！<br />就完成一個很基本的actionbarcompat！<br />且可以向下相容至2.x的device上！！<br /><br /><br />在後面幾篇會告訴大家<br /><br /><ul><li>如何用actionbarcompat加入tabs！<a href="http://blog.kenyang.net/2013/09/actionbarcompat-add-tab.html">（這裡）</a></li><li>swipe to switch tabs.</li><li>style actionbar</li></ul><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/09/26/actionbarcompat-basic" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Using Raspberry PI as Wireless AP</h1>

      <div class="entry">
        <br />Before we start, please make sure your system requirements.<br /><br /><b>What's do you need?</b><br /><ol><li>A Raspberry PI</li><li>A boot SD card with default Raspberry PI image iso (Raspbian "wheezy")</li><li>A USB WiFi device which support "Access Point" mode and the driver is rtl8192cu</li></ol><br /><br /><b>1. Install the necessary packages </b><br /><pre class="brush: java">sudo apt-get install hostapd bridge-utils<br /></pre><br /><b>2. Configure </b><br /><pre class="brush: java">sudo vim /etc/default/hostapd<br /></pre>Add the following line to the bottom of the file.<br /><pre class="brush: java">DAEMON_CONF="/etc/hostapd/hostapd.conf"<br /></pre><br /><br />Modified the config file<br /><pre class="brush: java">sudo vim /etc/hostapd/hostapd.conf<br /></pre>Add the following lines to the file. <br />You can change the "ssid", "wpa_passphrase".<br />Most the others examples use nl80211 as their driver, but Raspberry PI don't have the driver (default).<br />Therefore I can't start the service hostapd.<br />However I found some people use rtl871xdrv and they have the related hostapd binary file that supports rtl driver.<br />So... I use rtl871xdrv.<br /><pre class="brush: java">interface=wlan0                                                                                                                 <br />driver=rtl871xdrv<br />ssid=KenRaspberryPiAP<br />hw_mode=g<br />channel=6<br />macaddr_acl=0<br />auth_algs=1<br />ignore_broadcast_ssid=0<br />wpa=2<br />wpa_passphrase=safesync<br />wpa_key_mgmt=WPA-PSK<br />wpa_pairwise=TKIP<br />rsn_pairwise=CCMP<br /></pre><br /><br /><br /><b>3. Change network interface setting </b><br /><pre class="brush: java">sudo vim /etc/network/interfaces<br /></pre><br /><br /><pre class="brush: java">auto lo<br />auto br0 <br />iface lo inet loopback<br />iface br0 inet dhcp<br />        bridge_fd 1<br />        bridge_hello 3<br />        bridge_maxage 10<br />        bridge_stp off <br />        bridge_ports eth0 wlan0<br /><br />allow-hotplug eth0<br />iface eth0 inet manual<br />allow-hotplug wlan0<br />iface wlan0 inet manual  <br /></pre><br /><br /><br /><b>4. Replace the hostappd binary</b><br /><br />Download<br /><pre class="brush: java">cd /usr/sbin<br />rm -f hostapd<br />wget http://dl.dropboxusercontent.com/u/13846584/hostapd<br /></pre><br />Change Permission<br /><pre class="brush: java">sudo chown root:root hostapd<br />sudo chmod 755 hostapd<br /></pre><br /><br /><br /><b>5. Reboot</b><br /><pre class="brush: java">sudo reboot now<br /></pre><br /><br />After reboot, you should see your own Raspberry PI Access Point(AP).<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/09/02/using-raspberry-pi-as-wireless-ap" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android GCM (Google Cloud Messaging)：Android Client Side</h1>

      <div class="entry">
        <a href="http://blog.kenyang.net/2013/07/android-gcm-google-cloud.html">前篇文章</a>已經說明過GCM，以及和前身C2DM的差異！<br /><br />這篇主要會講解Android端如何實作，其實和以前在C2DM時差不多<br />如果要看差異以及一些參數說明，可以到下面幾篇文章去看<br />第一篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm.html">參數說明</a><br />第二篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm_22.html">流程說明</a><br /><br /><br /><br />這裡就直接進入主題，<br />首先一樣要在Manifest檔案中，要有下列的permission，<br /><pre class="brush: xml">    &lt;permission android:name="net.kenyang.gcm.permission.C2D_MESSAGE" android:protectionLevel="signature" /&gt;<br />    &lt;uses-permission android:name="net.kenyang.gcm.permission.C2D_MESSAGE" /&gt;<br />    &lt;uses-permission android:name="com.google.android.c2dm.permission.RECEIVE" /&gt;<br />    &lt;uses-permission android:name="android.permission.INTERNET" /&gt;<br />    &lt;uses-permission android:name="android.permission.GET_ACCOUNTS" /&gt;<br />    &lt;uses-permission android:name="android.permission.WAKE_LOCK" /&gt;<br /></pre><br /><br />接著就是要新增一個receiver，<br />而receiver必須聆聽兩個事件，分別為receive以及registration！<br /><pre class="brush: xml">    &lt;receiver<br />        android:name="net.kenyang.gcm.GcmBroadcastReceiver"<br />        android:permission="com.google.android.c2dm.permission.SEND" &gt;<br />        &lt;intent-filter&gt;<br />            &lt;action android:name="com.google.android.c2dm.intent.RECEIVE" /&gt;<br />            &lt;action android:name="com.google.android.c2dm.intent.REGISTRATION" /&gt;<br />            &lt;category android:name="net.kenyang" /&gt;<br />        &lt;/intent-filter&gt;<br />    &lt;/receiver&gt;<br /></pre><br /><br />再寫code之前，請先確定你的eclipse有裝下面的兩個plugin，<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-yuDunk2TmxY/UdE32LO-2TI/AAAAAAAAE4M/bNuog0GEZj0/s632/Screen+Shot+2013-07-01+at+4.08.26+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-yuDunk2TmxY/UdE32LO-2TI/AAAAAAAAE4M/bNuog0GEZj0/s1600/Screen+Shot+2013-07-01+at+4.08.26+PM.png" /></a></div><br /><br />安裝完成以後，請去到你的sdk folder裡面找到下面兩個jar檔，並且include他們兩個！<br /><br /><ol><li>android-sdk-macosx/extras/google/gcm/gcm-client/dist/gcm.jar &nbsp;</li><li>android-sdk-macosx/extras/google/google_play_services/libproject/google-play-services_lib/libs/google-play-services.jar</li></ol><br /><br /><br />接著開始寫code，<br />android分為三個部分，<br /><br /><ol><li>向Google 註冊，並且取得registration id</li><li>傳送id給我們的server</li><li>準備接收資料</li></ol><br /><br />首先是註冊，記得改成你的sender_id！<br />sender_id就是你的project id，可以到<a href="https://code.google.com/apis/console">api console</a>去看你的id，<br />會有下圖，project number就是你的project id了！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-N3KeToOerFE/UdE67sRKpaI/AAAAAAAAE4c/0auECVD3lL4/s487/Screen+Shot+2013-07-01+at+4.19.48+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-N3KeToOerFE/UdE67sRKpaI/AAAAAAAAE4c/0auECVD3lL4/s487/Screen+Shot+2013-07-01+at+4.19.48+PM.png" /></a></div><br />記得把它填入sender_id中！<br /><br /><pre class="brush: java"> <br /><br />    GoogleCloudMessaging gcm;<br />    String SENDER_ID = "xxxxxxxxxxx";<br />    @Override<br />    protected void onCreate(Bundle savedInstanceState) {<br />        super.onCreate(savedInstanceState);<br />        setContentView(R.layout.activity_main);<br />  <br />        tvRegisterMsg = (TextView) findViewById(R.id.tvRegisterMsg);<br />        context = getApplicationContext();<br />  <br />        // initial GCM<br />        gcm = GoogleCloudMessaging.getInstance(this);<br /><br />        // register with Google.<br />        new AsyncTask&lt;Void,String,String&gt;() {<br />            @Override<br />            protected String doInBackground(Void... params) {<br />                String msg = "";<br />                try {<br />                    if (gcm == null) {<br />                        gcm = GoogleCloudMessaging.getInstance(context);<br />                    }<br />                    strRegId = gcm.register(SENDER_ID);<br />                    msg = "Device registered, registration id=" + strRegId;<br />                 <br />                    // send id to our server<br />                    sendRegIdToServer(strRegId);<br />                } catch (IOException ex) {<br />                    msg = "Error :" + ex.getMessage();<br />                }<br />                return msg;<br />            }<br /><br />            @Override<br />            protected void onPostExecute(String msg) {<br />                tvRegisterMsg.append(msg + "\n");<br />            }<br /><br />        }.execute(null, null, null);<br />    }<br /><br /></pre><br /><br /><br />接著是第二部分，把id傳送到我們的server，<br /><pre class="brush: java"> private void sendRegIdToServer(final String strId) {<br />  new AsyncTask&lt;Void,String,String&gt;() {<br />   @Override<br />   protected String doInBackground(Void... params) {<br />    String strResponseCode = &quot;&quot;;<br />    try {<br />     HttpRequestBase request =null;<br />     request = new HttpGet(new URI(&quot;http://your_server/storeRegId?id=&quot;+strId));<br /><br />     request.addHeader(&quot;User-Agent&quot;, &quot;Android&quot;);<br />     HttpResponse response =  Connection.connect((HttpGet)request);<br />     <br />     strResponseCode =  String.valueOf(response.getStatusLine().getStatusCode());<br />    } catch (ClientProtocolException e) {<br />     // TODO Auto-generated catch block<br />     e.printStackTrace();<br />    } catch (IOException e) {<br />     // TODO Auto-generated catch block<br />     e.printStackTrace();<br />    } catch (URISyntaxException e) {<br />     // TODO Auto-generated catch block<br />     e.printStackTrace();<br />    }<br />    <br />    return strResponseCode;<br />   }<br />   <br />   @Override<br />   protected void onPostExecute(String msg) {<br />    tvRegisterMsg.append(&quot;status code:  &quot; + msg + &quot;\n&quot;);<br />   }<br />   <br />  }.execute(null, null, null);<br /> }<br /><br /></pre><br />到了此步驟你在畫面上應該會看到registration_id和status code是200！<br />如果是上述的結果的話，就代表你向Google註冊成功了！以及也把registration id傳送給我們的server知道了！<br /><br />接著就來implement receiver的部分！<br />這個receiver會接收來自Google Server的資料，<br />並且把資料丟到我們的notification bar當中！<br /><br /><pre class="brush: java">public class GcmBroadcastReceiver extends BroadcastReceiver {<br /> static final String TAG = "GCMDemo";<br /> public static final int NOTIFICATION_ID = 1;<br /> private NotificationManager mNotificationManager;<br /> NotificationCompat.Builder builder;<br /> Context ctx;<br /><br /> @Override<br /> public void onReceive(Context context, Intent intent) {<br />  GoogleCloudMessaging gcm = GoogleCloudMessaging.getInstance(context);<br />  ctx = context;<br />  String messageType = gcm.getMessageType(intent);<br />  if (GoogleCloudMessaging.MESSAGE_TYPE_SEND_ERROR.equals(messageType)) {<br />   sendNotification("Send error: " + intent.getExtras().toString());<br />  } else if (GoogleCloudMessaging.MESSAGE_TYPE_DELETED .equals(messageType)) {<br />   sendNotification("Deleted messages on server: " + intent.getExtras().toString());<br />  } else {<br />   sendNotification("Received: " + intent.getExtras().toString());<br />  }<br />  setResultCode(Activity.RESULT_OK);<br /> }<br /><br /> // Put the GCM message into a notification and post it.<br /> private void sendNotification(String msg) {<br />  mNotificationManager = (NotificationManager) ctx.getSystemService(Context.NOTIFICATION_SERVICE);<br /><br />  PendingIntent contentIntent = PendingIntent.getActivity(ctx, 0,<br />    new Intent(ctx, Main.class), 0);<br /><br />  NotificationCompat.Builder mBuilder = new NotificationCompat.Builder(ctx)<br />    .setSmallIcon(R.drawable.ic_launcher)<br />    .setContentTitle("GCM Notification")<br />    .setStyle(new NotificationCompat.BigTextStyle().bigText(msg))<br />    .setContentText(msg);<br /><br />  mBuilder.setContentIntent(contentIntent);<br />  mNotificationManager.notify(NOTIFICATION_ID, mBuilder.build());<br /> }<br />}<br /></pre><br /><br />完成上述以後你就可以開始測試！<br />只要打開瀏覽器，然後輸入你的site，（http://your_site/<b>send</b>），<br />接著你的device上應該就會收到訊息了！<br />訊息會是一個json格式！<br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/07/01/android-gcm-google-cloud_1" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android GCM (Google Cloud Messaging)：Server Side</h1>

      <div class="entry">
        GCM (Google Cloud Messaging）其實就是<a href="http://blog.kenyang.net/2011/12/android-c2dm.html">C2DM</a> 的前身，<br />先前就有寫過四篇文章來講解C2DM，<br />分別有：<br />第一篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm.html">參數說明</a> （舊版C2DM）<br />第二篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm_22.html">流程說明</a> （舊版C2DM）<br />第三篇在講<a href="http://blog.kenyang.net/2012/03/android-c2dm-sever.html"><span class="s1">server</span>端的實作</a> （舊版C2DM）<br />第四篇在講<a href="http://blog.kenyang.net/2012/03/android-c2dm-android.html"><span class="s1">android</span>端的實作</a> （舊版C2DM）<br /><br /><br /><br />其實新版的GCM和C2DM只有些微的差別，因此在migrate時只需要小小變化，<br /><br />甚至更為方便！<br />除了方便以外，而GCM多了一項新功能，<br />就是讓你的server可以與Google Server建立一個persistent TCP connection，<br />其目的就是為了讓你使用XMPP，而此Server稱作Cloud Connection Server（CCS)<br /><br /><br />當然我們也可以用傳統的HTTP Server，而這兩者個差異，可以看這篇<a href="http://developer.android.com/google/gcm/ccs.html">文章</a>．<br /><br /><br />而本篇文章主要是告訴大家如何implement server side，<br />以及怎麼和Google Server做溝通！<br />這裡語言主要會以Python為主！<br />然後web-framework是使用flask，<br />web server是nginx+uwsgi<br /><br />如果要看Android Client Side，請至（<a href="http://blog.kenyang.net/2013/07/android-gcm-google-cloud_1.html">http://blog.kenyang.net/2013/07/android-gcm-google-cloud_1.html</a>）<br /><br /><br />在開始之前，還要告訴大家GCM有個最方便的地方，<br />還記得C2DM在傳資料給Google Server時，需要帶一個header<br />而這個header必須儲存Google Client Login的auth token．<br />我一直覺得這非常非常之愚蠢！！<br />等於我如果要做到automation，我還要有一套機制去使用Google Client Login API去login google，實在太不方便！<br />但現在不用了！！！<br />取而代之的是用API Key！（這才是根本之道啊）<br /><br />至於怎麼申請API Key呢？<br /><ol><li>請先來到<a href="https://code.google.com/apis/console/">Google API Console</a></li><li>點選左邊的Services</li><li>找到Google Cloud Messaging for Android</li><li>把它打開</li><li>接著點選左邊API Access</li><li>點選按鈕『Create new Server Key』</li><li>點選按鈕『Create』</li><li>接著就會看到下圖中的API key，請記起來！</li></ol><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/---a7cZjAEeA/UdEpYeGYlxI/AAAAAAAAE30/f0KjxHr6zuI/s1104/Screen+Shot+2013-07-01+at+3.06.20+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/---a7cZjAEeA/UdEpYeGYlxI/AAAAAAAAE30/f0KjxHr6zuI/s1600/Screen+Shot+2013-07-01+at+3.06.20+PM.png" /></a></div><br /><br /><br /><br />接著要開始寫Server Side<br />Server Side分為兩個角色！<br /><ol><li>Android Device會傳送自己本身的registration id上來給Server，此時Server必須儲存此id</li><li>把data和id一併送到Google Server去，這時候Google Server就會自動push data至對應到該id的device上</li></ol><br /><br />首先是接收registration id的部分！因為我偷懶，我收到id以後就寫到一個file裡面去<br />正規做法應該是存在database之類的，但我這邊為了方便，所以先存在一個file裡去！<br /><br /><pre class="brush: python">@app.route("/storeRegId",methods=['GET'])<br />def storeRegId():                                                                                                          <br />    id = request.args.get('id') <br />    <br />    with open("regIdList","w") as f:<br />        f.write("%s" % id) <br /><br />    return 'id %s' % id<br /></pre><br />接著就是傳送data給Google Server的部分！<br />請注意把下面的API_KEY換成您自己的！<br />這個範例傳送的資料會有兩筆，分別是last name以及first name！<br />當然你可以增加或者減少！反正就是JSON format！<br /><br /><pre class="brush: python">@app.route("/send")                                                                                                        <br />def send():<br /><br />    # remember place your API Key<br />    API_KEY = 'xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx'<br /><br />    params = {}<br />        <br />    # put the data you want to send to device <br />    params['data']={ 'last name': 'yang','first name': 'ken'}<br /><br />    # get registration id, this registration id will be mapped to a device.<br />    f = open ("regIdList","r")<br />    regId = f.read() <br />    f.close()<br /><br />    params['registration_ids']=[regId]<br />    params = json.JSONEncoder().encode(params)<br /><br /><br />    headers = { "Content-type":     "application/json",<br />                "Authorization":    "key="+API_KEY}<br /><br />    conn = httplib.HTTPSConnection("android.googleapis.com")  <br /><br />    # method,url,body,header<br />    conn.request('POST','/gcm/send', params,headers)<br />    res = conn.getresponse() <br /><br />    conn.close()  <br />    result = {'msg':res.status}<br />    return jsonify(result)<br /><br /></pre><br /><br /><br />這樣就完成了Server side的部分！<br />將在下一篇教大家怎麼implement Android part！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/07/01/android-gcm-google-cloud" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android DatePicker scroll problem.</h1>

      <div class="entry">
        在Android 4.0.4機器上的&nbsp;DatePicker<b><span style="font-size: large;">一定</span></b>會發生scroll的小問題，<br />（但是4.2.3不會發生！而我推測或許3.x以上～4.0.4以下的device都會發生）<br /><br /><br />如下圖，<br />你會發現經過scrolling以後，在年/月/日的三個欄位，位置都怪怪的<br />原因是因為在做position時，那個event是被parent截取到！<br />但理應上應該是DatePicker截取到才對！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-2NithchKCw8/Ub_SFw-EClI/AAAAAAAAEy4/BDCPKYAElb8/s1600/Screenshot_2013-06-18-11-18-47.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://4.bp.blogspot.com/-2NithchKCw8/Ub_SFw-EClI/AAAAAAAAEy4/BDCPKYAElb8/s640/Screenshot_2013-06-18-11-18-47.png" width="360" /></a></div><br /><br />所以workaround就是，自己定義一個class，以及extend DatePicker！<br />然後去取消parent截取event！<br /><br /><pre class="brush: java">public class CustomDatePicker extends DatePicker {<br />    <br />    public CustomDatePicker(Context context, AttributeSet attrs) {<br />        super(context, attrs);<br />    }<br /><br />    public CustomDatePicker(Context context) {<br />        super(context);<br />    }<br /><br />    @SuppressLint("NewApi")<br />    @Override<br />    public boolean onInterceptTouchEvent(MotionEvent ev) {<br />        /*<br />         * Prevent parent component intercept touch event.<br />         * because only happened on Android 3.x ~ 4.0.4, so we need to check the current os version.<br />         */<br />        if (android.os.Build.VERSION.SDK_INT &gt;= android.os.Build.VERSION_CODES.HONEYCOMB){<br />            if (ev.getActionMasked() == MotionEvent.ACTION_DOWN) {<br />                ViewParent p = getParent();<br />                if (p != null){<br />                    // disallow its parent intercept touch event.<br />                    p.requestDisallowInterceptTouchEvent(true);<br />                }<br />            }<br />        }<br /><br />        return false;<br />    }<br /><br />}<br /></pre><br /><br />而使用方式就是在你的layout.xml中指定我們上方定義的class，<br /><pre class="brush: xml">&lt;view android:id="@+id/share_expires" <br />     android:layout_width="fill_parent" <br />     android:visibility="gone"<br />     android:layout_height="wrap_content" <br />     class="net.kenyang.util.CustomDatePicker" &gt;<br /> &lt;/view&gt;  <br /></pre><br /><br />這樣就能解決scrolling的問題！<br /><br />
      </div>

      <a href="/2013/06/18/android-datepicker-scroll-problem" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android remove dedicated menu icon.</h1>

      <div class="entry">
        If you want to remove Action overflow button on newest apps (above 3.0),<br />please set your targetSdkVersion as 14.<br /><br /><pre class="brush: xml">&lt;uses-sdk android:minSdkVersion="7" <br />          android:targetSdkVersion="14" /&gt;<br /></pre><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-dc0MqLyM5So/Ua2xBjdSkMI/AAAAAAAAExY/bipZIap6ZDs/s1600/old_menu.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="41" src="http://1.bp.blogspot.com/-dc0MqLyM5So/Ua2xBjdSkMI/AAAAAAAAExY/bipZIap6ZDs/s320/old_menu.png" width="320" /></a></div><br /><br /><br />Cause Android decides whether to show the overflow button on the bottom bar based on which API level you used.<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/06/04/android-remove-dedicated-menu-icon" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Nginx + Flask + uWSGI Deployment</h1>

      <div class="entry">
        <br /><div class="p1"></div><div>I am gonna to deploy a simple web server on my raspberry pi, cause the pi's resource has limitation.</div><div>So I use the following lightweight package:</div><ol><li>Flask is a microframework for Python</li><li>Nginx is a fast and lightweight web server for serving static files. (like image, html, css...etc)</li><li>uWSGI：Unfortunately Nginx can't not be used for serving dynamic language. (like php, python.) &nbsp;Therefore python needs to depend on uWSGI to interact with Nginx.</li></ol><div><br /></div><br /><span style="font-size: large;">1. Installation</span><br /><pre class="brush: perl">apt-get install nginx # install nginx<br />apt-get install uwsgi # instal uwsgi<br />apt-get install uwsgi-plugin-python # cause uwsgi can support many language so we need to indicate which lanague we want to use. <br />apt-get install python-flask # install flask<br /></pre><br /><br /><span style="font-size: large;">2. Configuration</span><br /><pre class="brush: perl"># config nginx<br />cd /etc/nginx/sites-available/<br />vim default<br /></pre><br />Please paste the following config to your config file.<br /><pre class="brush: perl">server {<br />    listen   80; ## listen for ipv4; this line is default and implied<br />    server_name ken;<br />    keepalive_timeout 300;<br />    location / { <br />        include         uwsgi_params;<br />        uwsgi_pass      unix:///tmp/uwsgi.sock;<br />        uwsgi_param         UWSGI_PYHOME    /var/www;   # your web application's path<br />        uwsgi_param         UWSGI_CHDIR     /var/www;   # your web application's path<br />        uwsgi_param         UWSGI_MODULE    api;        # Main dispatcher ( so we will have api.py )<br />        uwsgi_param         UWSGI_CALLABLE  app;<br />    }   <br />    error_page          404     /404.html;<br />}     <br /><br /></pre><br /><br /><pre class="brush: perl"># config uwsgi<br />cd /etc/uwsgi/apps-available/<br />vim uwsgi.conf<br /></pre><br />Please paste the following config to your config file.<br /><pre class="brush: java">[uwsgi]                                                                                                                    <br />plugins=python ; support python<br />vhost=true<br />socket=/tmp/uwsgi.sock <br />chmod-socket = 666  ; the socket permission<br />uid=root<br />gid=root<br /><br /></pre><br /><pre class="brush: perl"># make a soft link<br />ln -s /etc/uwsgi/apps-available/uwsgi.conf /etc/uwsgi/apps-enabled/uwsgi.ini<br /></pre><br /><br /><br /><br /><span style="font-size: large;">3. Implement the dispatcher </span><br /><br /><pre class="brush: perl">vim /var/www/api.py   # implement the dispatcher <br /></pre><br /><br />api.py <br /><pre class="brush: python">from flask import Flask,jsonify                                                                                            <br /><br />app = Flask(__name__)<br /><br />@app.route("/hello")<br />def hello():<br />    result = {'msg':'Hello World!'}<br />    return jsonify(result)<br /><br />@app.route("/")<br />def index():<br />    result = {'msg':'Index!'}<br />    return jsonify(result)<br /><br />if __name__ == "__main__":<br />    app.debug = True<br />    app.run('0.0.0.0', debug=True)<br /></pre><br /><pre class="brush: perl"># restart service<br />service nginx restart<br />service uwsgi restart<br /></pre><br /><br /><br /><span style="font-size: large;">4. verify </span><br /><br />1. open browser <br />2. key in your ip<br />&nbsp; &nbsp; &nbsp; ex: http:192.169.1.1/<br />3. your will see <br /><pre class="brush: xml">{<br />    "msg": "Index!"<br />}<br /></pre><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/05/02/nginx-flask-uwsgi-deployment" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android BroadcastReceiver detecting outgoing phone call</h1>

      <div class="entry">
        Android BroadcastReceiver是一種類似“pending”在背景的服務，<br />它可以用來監聽、接收某些事件（action），例如開機完成、收到簡訊、電池快沒電等等之類。<br />以及可以用來作為訊息的傳遞！<br />而為什麼會說類似pending呢？<br />因為BroadcastReceiver的lifecycle，並不是一直常駐的，<br />是只有onReceive被call時，才會存在，當return之後，system會判斷是否要unactive！<br /><br /><br />BroadcastReceiver可以監聽兩種類型的事件：<br />1. 系統事件<br />2. 自己定義的事件<br />這裡將會實作出這兩種兼聽方式！<br /><br /><br /><br />首先這裡將實作一個receiver會去監聽以下<b>系統</b>事件<br />1. 撥打電話<br />2. 螢幕打開<br />3. 螢幕關閉<br /><br /><br />首先先實作一個BroadcastReceiver，如下：<br /><pre class="brush: java">public class ReceiverDetect extends BroadcastReceiver {<br /> @Override<br /> public void onReceive(Context context, Intent intent) {<br />  String strAction = intent.getAction();<br />  Log.e("kencyang", "action:" + strAction);<br />  <br />  // if you make a phone call...<br />  if (strAction.equals(Intent.ACTION_NEW_OUTGOING_CALL)){<br />   String number = getResultData();<br />   Log.e("kencyang", "number:" +number);<br />  }<br /> }<br />}<br /><br /><br /></pre><br /><br />接著我們必須去access 額外的permission才能接收到使用者撥打電話的事件，<br /><br /><pre class="brush: xml">&lt;uses-permission android:name="android.permission.PROCESS_OUTGOING_CALLS"&gt;&lt;/uses-permission&gt;<br /></pre><br />當然你要在你的AndroidManifest.xml中的<application>加入剛剛實作的BroadcastReceiver，<br /></application><br /><pre class="brush: xml">&lt;receiver android:name="ReceiverDetect"&gt;<br />&lt;/receiver&gt;<br /></pre><br />接著我們將手動地去註冊這個Receiver要接收什麼事件，<br />以及註冊這個Receiver，<br />而這些動作我們可以在MainActivity中實作，<br /><pre class="brush: java">public class MainActivity extends Activity {<br /><br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br />  <br />  IntentFilter ifilter = new IntentFilter();<br />  ifilter.addAction(Intent.ACTION_NEW_OUTGOING_CALL);  // if make a phone call<br />  ifilter.addAction(Intent.ACTION_SCREEN_OFF);    // if screen turn off<br />  ifilter.addAction(Intent.ACTION_SCREEN_ON);     // if screen turn on<br />  <br />  ReceiverDetect r = new ReceiverDetect();<br />  registerReceiver(r, ifilter);<br /> }<br />}<br /></pre><br />接著就deploy到手機上吧！<br />可以試試看打一通電話，以及開關螢幕，<br />然後打開你的ddms，應該就可以看到下列的log，<br /><br /><a href="http://1.bp.blogspot.com/-9BYyZHibK-c/UVK9eUxeFrI/AAAAAAAAEmA/u53pJRT8KoQ/s1600/Screen+Shot+2013-03-27+at+5.26.17+PM.png" imageanchor="1"><img border="0" height="70" src="http://1.bp.blogspot.com/-9BYyZHibK-c/UVK9eUxeFrI/AAAAAAAAEmA/u53pJRT8KoQ/s640/Screen+Shot+2013-03-27+at+5.26.17+PM.png" width="640" /></a><br /><br /><br /><br /><br />這樣就完成了監聽系統事件，<br />接下來要講如何監聽一個自己定義的事件，<br />其實和監聽系統事件沒有太大的差別，<br />我們只是增加了一組action！<br />以及教你怎麼send出一個broadcast，讓你的receiver收到！<br />一樣在MainActivity中，增加下列的code：<br /><pre class="brush: java"> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br />  <br />  IntentFilter ifilter = new IntentFilter();<br />  ifilter.addAction("i am hungry");<br />  <br />  ReceiverDetect r = new ReceiverDetect();<br />  registerReceiver(r, ifilter);<br />  <br />  <br />  Button btnSend = (Button) findViewById(R.id.button1);<br />  <br />  // click button will send a broadcast, then our receiver will receive the action<br />  btnSend.setOnClickListener(new OnClickListener() {<br />   @Override<br />   public void onClick(View v) {<br />    Intent intent = new Intent();<br />    intent.setAction("i am hungry");<br />    sendBroadcast(intent);<br />   }<br />  });<br />  <br /> }<br /><br /></pre><br /><br />然後deploy上去，<br />按下button以後，應該會看到下圖中的log！<br /><br /><a href="http://2.bp.blogspot.com/-gd9epuS6-js/UVK85ieHAzI/AAAAAAAAEl4/UVRRQC7V4os/s1600/Screen+Shot+2013-03-27+at+5.33.54+PM.png" imageanchor="1"><img border="0" height="62" src="http://2.bp.blogspot.com/-gd9epuS6-js/UVK85ieHAzI/AAAAAAAAEl4/UVRRQC7V4os/s640/Screen+Shot+2013-03-27+at+5.33.54+PM.png" width="640" /></a><br /><br /><br /><br /><br />這樣就完成了BroadcastReceiver的基本實作！<br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/03/27/android-broadcastreceiver" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Fragment Activity</h1>

      <div class="entry">
        <br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-KxkFprmwl1k/UUGuGS_GmCI/AAAAAAAAElU/wCXiluz1MB0/s1600/fragments.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="368" src="http://1.bp.blogspot.com/-KxkFprmwl1k/UUGuGS_GmCI/AAAAAAAAElU/wCXiluz1MB0/s640/fragments.png" width="640" /></a></div><br /><br /><br />Android Fragment是3.0之後的版本才推出，<br />其主要目的是為了讓tablet更能夠有效地利用螢幕空間，<br />可以看到上面的圖片，<br />右邊是傳統的device，可以看到在List點擊以後，會去start Activity B，<br />然後跳離List頁面！<br />而左邊的tablet的行為就不一樣，而是點選List以後在右邊跳出Activity B！<br /><br /><br />運用Fragment還有個好處，<br />寫一次code就可以在tablet和handset裝置上有不同的user experience！<br />（有前提）<br /><br /><br />開始之前要先說明二件事情，<br />第一件事情，<br />Fragment一定要依附在Activity裡面！<br />簡言之，必須透過Activity去load Fragment進來！<br /><br />第二件事情，<br />一開始我們就有說過Fragment只能使用在3.0以上的裝置，<br />以下是不行的，那麼該怎麼辦呢？<br />Google有推出compatibility的lib使用！<br />所以如果想要你的app也能夠在2.x的裝置上面跑，<br />又希望能夠在大尺寸螢幕上的裝置有好的user experience的話，就要把這lib include進來！<br />但是！！！當然不是單單include進來就好了！<br />寫法還是有點點點點點點稍微的不同！<br />這篇會說明不同的點在哪邊！<br /><br /><br />而把fragment load進來大概分兩種方法！<br />1. 靜態（預設load）<br />2. 動態地載入<br /><br /><br /><br /><span style="font-size: large;"><b>先講第一種靜態！</b></span><br /><br />首先你要先定義一個layout，這layout是fragment裡面的樣式，<br />這裡先取名為fragment.xml，如下：<br /><pre class="brush: xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"<br />    android:layout_width="match_parent"<br />    android:layout_height="match_parent"<br />    android:orientation="vertical" &gt;<br /><br />    &lt;TextView<br />        android:id="@+id/textView1"<br />        android:layout_width="wrap_content"<br />        android:layout_height="wrap_content"<br />        android:text="Fragment" /&gt;<br /><br />&lt;/LinearLayout&gt;<br /></pre><br /><br />接著你就要有一個Fragment，如下：<br />Fragment基本上有自己的lifecycle，而且還蠻多的（相較於activity）<br />雖然他有自己的lifecycle，不過我們剛剛說過Fragment必須被Activity load進來，<br />所以他的lifecycle會跟隨於Activity！<br /><pre class="brush: java">package net.kenyang.practicefragment;<br /><br /><br />import android.os.Bundle;<br />import android.support.v4.app.Fragment;// 如果要向下相容至2.x，請import這項，如果不向下，就import下面被註解的那項<br />//import android.app.Fragment;<br />import android.view.LayoutInflater;<br />import android.view.View;<br />import android.view.ViewGroup;<br /><br />public class FragmentA extends Fragment {<br /> @Override<br /> public void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br /> }<br /> @Override<br /> public View onCreateView(LayoutInflater inflater, ViewGroup container,<br />   Bundle savedInstanceState) {<br />  <br />  // 取得剛剛上步驟的layout(fragment.xml)<br />        return inflater.inflate(R.layout.fragment, container, false);<br /> }<br />}<br /><br /></pre><br /><br /><br /><br />完成上述兩個步驟以後，<br />你得先建立一個activity的layout！<br />如下：<br /><pre class="brush: xml">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"<br />    xmlns:tools="http://schemas.android.com/tools"<br />    android:layout_width="match_parent"<br />    android:orientation="horizontal"<br />    android:layout_height="match_parent"<br />    tools:context=".MainActivity" &gt;<br /><br />    &lt;TextView<br />        android:id="@+id/textView1"<br />        android:layout_weight="1"<br />        android:layout_width="wrap_content"<br />        android:layout_height="wrap_content"<br />        android:text="@string/hello_world" /&gt;<br /><br />    &lt;fragment<br />        android:id="@+id/first"<br />        android:name="net.kenyang.practicefragment.FragmentA"<br />        android:layout_weight="2"<br />        android:layout_width="match_parent"<br />        android:layout_height="match_parent" /&gt;<br /><br />&lt;/LinearLayout&gt;<br /></pre><br /><br />可以看到這xml當中有一個以往2.x沒有的element，就是fragment，<br />這個就是用來靜態地load fragment的！<br />而這element中還有一個attribute，就是 android:name，<br />這attribute是最重要的，請填入我們剛剛的Fragment name，記得要連接package name才行！<br /><br /><br /><br />接著就是來寫Activity了！<br />如下：<br /><pre class="brush: java">package net.kenyang.practicefragment;<br /><br />import android.os.Bundle;<br />import android.support.v4.app.FragmentActivity;<br /><br />//public class MainActivity extends Activity { // above 3.0<br />public class MainActivity extends FragmentActivity { // below 3.0<br /><br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br /> }<br /><br />}<br /><br /></pre><br /><br />這Activity中其實跟以往的沒有太大差別！<br />唯一差別在於第7和第8行！<br />如註解所說，如果你要向下相容，請使用FragmentActivity才行！<br /><br /><br />完成上述的實作就完成靜態的loading！<br /><br /><br /><br /><br /><b><span style="font-size: large;">現在要講動態的！</span></b><br /><br />首先先把上述activity的layout改成下述的設定：<br /><pre class="brush: xml">&lt;LinearLayout xmlns:android="http://schemas.android.com/apk/res/android"<br />    xmlns:tools="http://schemas.android.com/tools"<br />    android:layout_width="match_parent"<br />    android:id="@+id/llParent"<br />    android:orientation="horizontal"<br />    android:layout_height="match_parent"<br />    tools:context=".MainActivity" &gt;<br /><br />    &lt;Button<br />        android:id="@+id/btnAdd"<br />        android:layout_width="wrap_content"<br />        android:layout_height="wrap_content"<br />        android:text="Add" /&gt;<br />&lt;/LinearLayout&gt;<br /></pre><br /><br />這個xml只是多了一個button，<br />以及在LinearLayout中加入了id，<br />加入id的目的是為了等等要把FragmentA丟入某一個指定的view中，<br />所以得知道該view的id！<br /><br /><br />接著就在MainActivity中，設定動態載入吧！<br /><pre class="brush: java">package net.kenyang.practicefragment;<br /><br />import android.os.Bundle;<br />import android.support.v4.app.Fragment;<br />import android.support.v4.app.FragmentActivity;<br />import android.support.v4.app.FragmentManager;<br />import android.support.v4.app.FragmentTransaction;<br />import android.view.View;<br />import android.view.View.OnClickListener;<br />import android.widget.Button;<br /><br />//public class MainActivity extends Activity { // above 3.0<br />public class MainActivity extends FragmentActivity { // below 3.0<br /> <br /> private Button btnAdd = null;<br /><br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.activity_main);<br />  <br />  btnAdd = (Button) findViewById(R.id.btnAdd);<br />  btnAdd.setOnClickListener(new OnClickListener() {<br />   @Override<br />   public void onClick(View v) {<br />    FragmentManager fragmentManager = getSupportFragmentManager();  // 取得FragmentManager（如果不向下相容，就不用加Support）<br />    FragmentTransaction fragmentTransaction = fragmentManager.beginTransaction();<br />    FragmentA f = new FragmentA();  // 把上面的FragmentA new出來！<br />    fragmentTransaction.add(R.id.llParent, f);  // 丟入到llParent之中<br />    fragmentTransaction.commit(); // 必須commit以後才會真正add<br />   }<br />  });<br />  <br /> }<br /><br />}<br /><br /></pre><br /><br /><br />完成上述步驟就可以動態載入了！<br /><br /><b><span style="color: red; font-size: large;">但是</span></b>！儘管你學會了這兩種方式，其實還是做不出第一張圖的效果！<br />看起來好像點了左邊的button，就可以在右邊add一個Fragment進來！<br />的確達到了在tablet上優化User Experience的效果！<br />但你會發現...如果你放在一般的device上面，還是像跟圖一中的左邊區塊一樣！！<br />並不是右邊的效果！那不是反而在一般device上的UX會比較差嗎？<br /><br />這是因為你還得善用layout以及layout-large才能完成！<br />就..在下一篇講解吧！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/03/14/android-fragment-activity" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Raspberry Pi 安裝OS</h1>

      <div class="entry">
        <br />這篇的操作是以mac os為主，且是以command line進行安裝！<br /><br /><br /><br /><span style="font-size: large;">1. 首先先去<a href="http://www.raspberrypi.org/downloads/">官網下載</a>image下來</span><br />只有幾種可以選擇！<br />不過網路上也有很多customized的image可以下！（例如：android）<br /><br /><br /><br /><span style="font-size: large;">2. 下載以後先確認image的完整性吧！</span><br /><pre class="brush: java">shasum ~/Downloads/2012-12-16-wheezy-raspbian.zip<br /></pre>看看結果是不是跟官網的結果一樣！如果是的話，就沒問題拉！！<br />（我下載了好多次，超多次都下失敗...建議選個北美的載點）<br /><br /><br /><span style="font-size: large;">3. 接著解開下載的壓縮檔吧！</span><br /><pre class="brush: java">unzip ~/Downloads/2012-12-16-wheezy-raspbian.zip<br /></pre>解開以後會是一個.img檔案，<br />如：2013-02-09-wheezy-raspbian.img<br /><br /><br /><span style="font-size: large;">4. 查看自己的SD Card 在哪（記得插上sd card）</span><br /><pre class="brush: java">df -h<br /></pre>先看看自己的SD Card的Filesystem名稱！<br />我的是：/dev/disk1s1<br /><br /><br /><span style="font-size: large;">5. 先umount</span><br /><pre class="brush: java">sudo diskutil unmount /dev/disk1s1<br /></pre><br /><br /><span style="font-size: large;">6. 複製image到sd card中！</span><br />這裡很重要！<br />這裡可不是手動複製喔！！！！<br />要用到dd指令進行複製！<br />還有一點很重要！！記得是要寫在raw device上！<br />記得第四步驟嗎？你看到的filesystem name是<span style="color: red;">disk1s1</span>！<br />但我們要寫在<span style="color: red;">rdisk1</span>！別寫錯了！<br /><pre class="brush: java">sudo dd bs=1m if=2013-02-09-wheezy-raspbian.img of=/dev/rdisk1<br /></pre><br /><br /><br /><br />完成上述六步驟就完成安裝了！！！<br />把你的sd card插上pi吧！<br />插上電源以後，完成開機！<br />你在df一次，<br />你會發現很奇怪！<br />假設你是用8G的sd card，你會發現df以後，只有2g差不多而已！<br />那是因為你還沒有expand！由於手動expand很麻煩！<br />所以pi有內建的script可以幫你自動expand！<br />只要下下面的指令：<br /><pre class="brush: java">raspi-config<br /></pre>下了以後會看到下圖！請選第二個選項，並按下enter！<br />就完成expand了！<br />在df一次應該就可以看到正確的size！<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-WSgKkKjKhaI/UTNvkbMy0FI/AAAAAAAAElE/QqJHuxWD0E0/s1600/Screen+Shot+2013-02-27+at+11.29.41+AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/-WSgKkKjKhaI/UTNvkbMy0FI/AAAAAAAAElE/QqJHuxWD0E0/s640/Screen+Shot+2013-02-27+at+11.29.41+AM.png" width="640" /></a></div><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/03/03/raspberry-pi-os" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Facebook Login (v3.0)</h1>

      <div class="entry">
        先前介紹過怎麼在Android上實作用Facebook login的機制（<a href="http://blog.kenyang.net/2012/01/androidfacebook-login-api.html">這裡</a>），<br />不過最近發現Facebook SDK改版了很久，先前我介紹的是2.0，<br />現在是3.0了，原本想說是小幅變動，應該不用再寫篇文章來介紹！<br />但看了一下<a href="https://developers.facebook.com/docs/tutorials/androidsdk/3.0/upgrading-from-2.0-to-3.0/">Change log</a>，發現變很大！<br /><br />而且看了一下Facebook SDK的source code，也發現大幅變更了！<br />此外，現在Facebook SDK有import&nbsp;android-support-v4.jar，<br />原因是因為在Android 3.x以上的機器會使用到Fragments......<br />為了backward compatibility，向下支援2.x，所以會import.....<br />可想而知，也多了很多東西，<br />先前2.0我在用的時候，也頂多6個Class....<br />現在是多了更多，且好多個package，甚至多了很多style.xml！<br />所以如果現在用我之前的方法，直接把Class拉進去我們的project，<br />那麼一定會出現很多error，因為現在不只要拉code了，還要拉很多圖片，style.xml！！<br />所以還是用最正統的方法吧！直接include近來！<br /><br /><br /><h2><b><span style="font-size: large;">1. 首先先去下載SDK (<a href="https://developers.facebook.com/android/">載點</a>）</span></b></h2><br /><b><span style="font-size: large;">2. 解壓縮</span></b><br /><br /><br /><span style="font-size: large;"><b>3. import Facebook SDK source code進來</b></span><br />import進來以後會看到很多個project，基本上請勾選FacebookSDK就好！<br />就是下圖中的第二個！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-K_tc8zpI-Fw/UScSM-weCDI/AAAAAAAAEjs/G63E0RlqPzM/s1600/Screen+Shot+2013-02-22+at+2.40.47+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="568" src="http://4.bp.blogspot.com/-K_tc8zpI-Fw/UScSM-weCDI/AAAAAAAAEjs/G63E0RlqPzM/s640/Screen+Shot+2013-02-22+at+2.40.47+PM.png" width="640" /></a></div><br /><br /><br /><span style="font-size: large;"><b>4. 建立一個新的Project</b></span><br />建好以後在Project上點選右鍵-&gt;Properties-&gt;Android，<br />會看到下圖，<br />請在Library的欄位點選Add按鈕，<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-GyvhXdxRhdg/UScS5UbcfEI/AAAAAAAAEj4/eyDsqqUi3mk/s1600/Screen+Shot+2013-02-22+at+2.44.12+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/-GyvhXdxRhdg/UScS5UbcfEI/AAAAAAAAEj4/eyDsqqUi3mk/s400/Screen+Shot+2013-02-22+at+2.44.12+PM.png" width="373" /></a></div><br /><br />按完以後，會彈出一個視窗，應該會有一個Project供你選擇，<br />就是下圖中的FacebookSDK，請選擇該Project．<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-JYv6LYphvFA/UScS5SPRMdI/AAAAAAAAEj0/kWmMfbgQ3zQ/s1600/Screen+Shot+2013-02-22+at+2.44.29+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/-JYv6LYphvFA/UScS5SPRMdI/AAAAAAAAEj0/kWmMfbgQ3zQ/s400/Screen+Shot+2013-02-22+at+2.44.29+PM.png" width="373" /></a></div><br />選完以後就完成import進來了，就可以準備來寫code，<br />但寫code之前，還要做一些必要的設定...<br /><br /><br /><span style="font-size: large;"><b>5. &nbsp;產生hashkey </b></span><br />產生的方法，在<a href="http://blog.kenyang.net/2012/01/androidfacebook-login-api.html">前一篇文章</a>就講過！<br />詳細的參數說明可以看那邊！<br />基本上你複製下面的指令即可完成！(only on mac)<br /><pre class="brush: java">keytool -exportcert -alias androiddebugkey -keystore ~/.android/debug.keystore | openssl sha1 -binary | openssl base64<br /></pre>下了這行指令以後，他會要你敲密碼！<br />基本上不要敲，直接按下enter即可！<br />產生key以後，把key複製下來！<br /><br />然後去到你的facebook app後台(https://developers.facebook.com/apps)<br />然後Create new app,<br />Create完成以後，會看到下圖！<br />請看到下圖中的三個橘色框框，<br />第一個是App ID，請一定要記起來！<br />第二個是key hash，把你剛剛產生的hashkey貼上去吧！<br />第三個是Facebook Login（以前沒有），請把它enable吧！<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-wBFq5eaJMUI/UScV7_X-4YI/AAAAAAAAEkg/JE5bZXQahG4/s1600/Screen+Shot+2013-02-22+at+2.55.10+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-wBFq5eaJMUI/UScV7_X-4YI/AAAAAAAAEkg/JE5bZXQahG4/s640/Screen+Shot+2013-02-22+at+2.55.10+PM.png" width="635" /></a></div><br /><br /><br /><b><span style="font-size: large;">6. 設定</span></b><br />首先先打開/res/values/strings.xml！<br />然後新增一個element，叫做app_id！<br />如下：<br /><pre class="brush: xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;resources&gt;<br />	&lt;string name="app_id"&gt;438511916228708&lt;/string&gt; <br />&lt;/resources&gt;<br /></pre><br />接著打開AndroidManifest.xml，<br />新增一個permission！如下：<br /><pre class="brush: xml">&lt;uses-permission android:name="android.permission.INTERNET"/&gt;<br /></pre><br />然後在新增一個activity，如下<br /><pre class="brush: xml">&lt;activity android:name="com.facebook.LoginActivity"/&gt;<br /></pre><br />新增一個meta-data，如下<br /><pre class="brush: xml">&lt;meta-data android:name="com.facebook.sdk.ApplicationId" android:value="@string/app_id"/&gt;<br /></pre><br />完成上述三個步驟以後就可以來寫code了！<br /><br /><br /><br /><b><span style="font-size: large;">7. 開始寫code</span></b><br /><br />首先先在onActivityResult進行丟丟登入結果的動作，<br />如下：<br /><pre class="brush: java">	@Override<br />	protected void onActivityResult(int requestCode, int resultCode, Intent data) {<br />		super.onActivityResult(requestCode, resultCode, data);<br />		Session.getActiveSession().onActivityResult(this, requestCode,resultCode, data);<br />	}<br /></pre>要寫在onActivityResult的原因是因為，你要用Facebook login時，都會跳到另一個Activity（如上的LoginActivity）進行輸入email &amp; pwd！<br />輸入完以後，才會回到我們自己的Activity！<br /><br />接下來要寫呼叫Login的，<br />你可以直接寫在onCreate的地方，就是一開這個app就進行fb登入！<br />如下：<br /><pre class="brush: java">	@Override<br />	protected void onCreate(Bundle savedInstanceState) {<br />		super.onCreate(savedInstanceState);<br />		setContentView(R.layout.activity_main);<br />		Session.openActiveSession(this, true, new Session.StatusCallback() {<br />			@Override<br />			public void call(Session session, SessionState state,Exception exception) {<br />				if (session.isOpened()) {<br />					Log.e("kenyang",session.getAccessToken()); // get token<br />				}<br />			}<br />		});<br />	}<br /></pre><br /><br />只要有取得token，這樣就完成登入了！！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/02/22/android-facebook-login-v30" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>結合Arduino + ultrasonic sensor偵測距離</h1>

      <div class="entry">
        Arduino有很多有趣的擴充shield，<br /><div>像是ethernet, wifi, bluetooth, 溫度測量, 溼度測量等等之類的！</div><div><br /></div><div>這篇要講的是整合ultrasonic sensor，</div><div>透過這顆sensor去算出與前面障礙物的距離，</div><div>他的原理就是透過聲波去偵測，</div><div>發出一段聲波，然後根據<b>回傳回來的時間</b>來判斷出距離！</div><div><br /></div><div><br /></div><div>我使用的ultrasonic sensor是HC-SR04這顆，</div><div>這顆有4隻pin腳，</div><div>分別為</div><div><ul><li>VCC</li><li>Trig</li><li>Echo</li><li>GND</li></ul>VCC和GND就不需要多講了！就是正電與負電！自己接上去吧！</div><div>要講的是Trig和Echo這兩隻pin腳！</div><div>Trig的作用在於發出聲波，</div><div>Echo的作用就是取得回音的時間，</div><div>所以可以知道Trig作為output，</div><div>Echo作為Input！</div><div><br /></div><div>然後把這兩隻pin腳也接在arduino上去，</div><div>在我的範例中，我是把Trig接在pin4，</div><div>Echo接在pin3，</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-fISl2ety5_s/UOvpNtL7GVI/AAAAAAAAEik/0bQBDCRyG9Q/s1600/IMG_20130108_173350.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="480" src="http://1.bp.blogspot.com/-fISl2ety5_s/UOvpNtL7GVI/AAAAAAAAEik/0bQBDCRyG9Q/s640/IMG_20130108_173350.jpg" width="640" /></a></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div>下面為sample！</div><div><pre class="brush: java">int iOutputPin = 4; // trig<br />int iInputPin = 3;  // echo<br />long lCm;<br />void setup(){<br />  <br />  Serial.begin(9600);<br />  pinMode(iInputPin,INPUT);<br />  pinMode(iOutputPin,OUTPUT);<br />}<br /><br />void loop(){<br />  <br />  digitalWrite(iOutputPin, HIGH);<br />  delayMicroseconds(10); // 意思是發出訊號10microsecond，10是根據一個公式得出的．<br />  digitalWrite(iOutputPin, LOW);  <br />  <br />  int distance = pulseIn(iInputPin, HIGH);  <br />  if (distance &lt; 0) lCm = 0;<br />  else lCm = distance / 58; // 除以58也是根據一個公式而來，除58單位就會變成cm<br />  Serial.print(lCm);<br />  Serial.print("cm ");<br />  Serial.println("");<br />  delay(500);  <br />}<br /></pre></div><div><br /><br /><br /><br />deploy上去以後，打開console，應該可以看到下圖． <br />ＰＳ：如果你的ultrasonic senso只有三根pin腳...那就代表你的trig和echo都為同一隻，<br />只要在code中互換pinMode就一樣可以正常使用了！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-WK0qGO3aqHM/UOvr6T-OV8I/AAAAAAAAEjA/l5dmyUNw_WI/s1600/Screen+Shot+2013-01-08+at+5.51.52+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="454" src="http://1.bp.blogspot.com/-WK0qGO3aqHM/UOvr6T-OV8I/AAAAAAAAEjA/l5dmyUNw_WI/s640/Screen+Shot+2013-01-08+at+5.51.52+PM.png" width="640" /></a></div><br /></div>
      </div>

      <a href="/2013/01/08/arduino-ultrasonic-sensor" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Java Integer Pool</h1>

      <div class="entry">
        Integer是Java中的wrapper type（reference type）！<br /><br />簡單地說它是一個類別，每當你使用它一次就會有一個新的object產生！<br />因為所有的wrapper type 都屬於immutable的！<br />拿String的例子來說，<br /><pre class="brush: java">String strA = "hi";<br />strA = "hello";<br /></pre>上面這個例子實質上在記憶體裡面是有2個object產生！<br />因為他是immutable！<br /><br />Integer也是一樣！<br />但這篇要講的是Integer的一個pool機制！<br />pool機制是為了效能所存在！<br />直接從下面的例子來看<br /><br /><pre class="brush: java">Integer iA = 100;<br />Integer iB = 100;<br />System.out.println(iA==iB); // true<br /><br /><br />Integer iA = 128;<br />Integer iB = 128;<br />System.out.println(iA==iB); // false<br /><br /><br />Integer iA = new Integer(100);<br />Integer iB = new Integer(100);<br />System.out.println(iA==iB); // false<br /><br />int iA = 128;<br />int iB = 128;<br />System.out.println(iA==iB); // true<br /></pre><br />大家可能會覺得奇怪，為什麼第二個範例和第三個會是false<br />因為對於wrapper type來說，使用==符號比較的話，是在比較其記憶體位址！！！<br />並不是在比較value！<br /><br />那大家可能也會覺得奇怪，那為什麼第一個就是true?<br />因為Integer有一個pool機制（String也有pool機制）！<br />而這個pool裡面存放的value為-128~127！<br />也就是說當value在-128~127之間的話，都會從pool中存取，<br />並不會重新產生一個object！<br /><br />那大家可能也會覺得那麼第三個例子為什麼是false?<br />value是100阿！有在pool範圍內！<br />那是因為已經使用new了！竟然使用new，就會配置一塊新的記憶體給它！<br /><br /><br />第四個範例的value超過pool了，<br />但結果還是true的原因是因為第四個範例並不是wrapper type!<br />而是primitive type！<br />primitive type的比較符號==就是在比value！<br /><br /><br />那麼可能有人會好奇什麼時候使用int或Integer，<br />恩，Integer他是屬於類別，因此他會有比較fancy的method使用，<br />當你可能得對你的value做一些較複雜的操作時或許就可以使用Integer！<br /><br />還有就是當你有使用Collection時，<br />記得請使用wrapper type！<br />雖然說java目前都有支援<a href="http://blog.kenyang.net/2012/01/java-unboxingboxing.html">auto-boxing</a>的機制，儘管你傳入primitive，<br />java都會幫你轉成wrapper type！<br />但這個轉換的機制是很會消耗效能的！<br />因此在這種情況也請使用wrapper type！<br /><br /><br /><br /><br />上面有提到String也有pool機制，<br />但String pool並沒有範圍限制！<br />只要你使用過的String都會被放置在pool之中！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2013/01/05/java-integer-pool" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Arduino bluetooth</h1>

      <div class="entry">
        先前講過arduino的基本介紹，<br />這篇要講如何綁上bluetooth shield到arduino上面！<br /><br /><br />首先要先介紹bluetooth shield上的pin腳，<br />先看到下圖，下圖中右邊有一排pin腳，<br />主要會用到前面4隻pin腳，<br />而4隻pin腳依序為：<br /><br /><ol><li>5V：供電的(+)</li><li>TX：傳送訊號</li><li>RX：接收訊號</li><li>GND：接地線(-)</li></ol><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-myo8iSxgbSQ/UOAPRwyFaBI/AAAAAAAAEho/wkEGI3LJIjw/s1600/IMG_20121230_175016.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="480" src="http://2.bp.blogspot.com/-myo8iSxgbSQ/UOAPRwyFaBI/AAAAAAAAEho/wkEGI3LJIjw/s640/IMG_20121230_175016.jpg" width="640" /></a></div><br /><br /><br />而arduino板上也一定會有上述對應的pin腳，<br />基本上都插上去就可以，<br />不過有一點比較特別，<br />在於RX/TX的點，<br />Arduino板上的TX要接到Bluetooh shield上的RX，<br />Arduino板上的RX反而接到Bluetooth shield上的TX，<br /><br />可以看到參考下面的表，<br /><table border="1px"><tbody><tr> <td><br />Arduino</td> <td><br />Bluetooth Shield</td> </tr><tr> <td>RX</td> <td>TX</td> </tr><tr> <td>TX</td> <td>RX</td> </tr><tr> <td>5V</td> <td>5V</td> </tr><tr> <td>GND</td> <td>GND</td> </tr></tbody></table><br /><br />對了，基本上arduino板上的RX/TX都是預設pin0和pin1！<br />至少uno和duemilanove這兩塊板子上都是！<br />所以就差在對應上的pin0和pin1吧！<br />（當然你也可以插在別的pin腳上，但是在寫code時就得稍為設定）<br /><br /><br />差上去以後，基本上你的bluetooth shield會一直閃紅燈，<br />一直閃一直閃，直到有人連結上這台bluetooth上，紅燈才會恆亮！<br /><br />接著來寫個sample測試！<br /><br /><pre class="brush: java">int iLedPin        = 13;<br />void setup(){<br />  // define the PIN as OUTPUT <br />  pinMode(iLedPin        ,OUTPUT);  <br />  <br />  // using baud rate 9600 to listen.<br />  Serial.begin(9600);<br />}<br /><br />void loop(){<br />  while (Serial.available()){<br />    char cCmd = Serial.read();<br />    if (cCmd =='o'){<br />      digitalWrite(iLedPin,HIGH);<br />    }else if (cCmd == 'c'){<br />      digitalWrite(iLedPin,LOW);<br />    }<br />  }<br />}<br /></pre><br /><br /><br />把上述的code deploy進去arduino以後，<br />就可以用你的電腦來測試了！<br /><br /><br />不管你是windows,osx,linux，只要你的OS連接到藍牙以後，<br />都會被模擬成serial port！<br />所以如果你用的是linux或者mac，<br />你會發現在你的/dev/底下多了一個device，<br />像我的就是/dev/tty.KENarduino-DevB，<br />那麼就可以用下列的指令連結到你的藍牙了，<br /><pre class="brush: java">sudo cu -s 9600 -l /dev/tty.KENarduino-DevB <br /></pre><br /><br />如果連結成功應該會在你的terminal上看到下列字樣<br /><pre class="brush: java">Connected<br /></pre><br />那麼就代表你成功連結到藍牙裝置，就可以透過藍牙下指令給arduino了！<br />最後可以試著輸入o和c，然後觀察你的pin13那顆led有無變化！<br /><br /><br /><br /><br /><br /><br />ＰＳ：如果你用的是windows，直接去載putty吧！透過putty去連結藍芽，只要輸入你的藍牙是COM幾就可以連線！<br /><br /><br /><br />
      </div>

      <a href="/2013/01/03/arduino-bluetooth" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android: startService vs bindService</h1>

      <div class="entry">
        這篇要說明<br /><ul><li>startService</li><li>bindService</li></ul>這兩者的差別！<br /><br />其實在我之前的筆記有關<a href="https://developer.android.com/guide/components/services.html">Service</a>的文章，都是使用startService！<br />並沒有使用bindService！<br />一方面是因為startService簡單很多！<br />再來也是最近才發現有bindService！<br />應該是說我原本以為startService的行為與bindService差不多！<br />但實際找答案以後才知道不是這樣的！<br /><br /><br />這裡就不多作說明如何使用startService或者bindService！<br />主要會說明這兩者差異性！<br />如果要看如何使用可以看之前的筆記：<br /><br /><ol><li><a href="http://blog.kenyang.net/2012/03/android-c2dm-android.html">Android C2DM (四)：實作之Android篇</a></li><li><a href="http://blog.kenyang.net/2010/11/android-detect-screen-on-and-screen-off.html">android detect screen on and screen off</a></li><li><a href="http://blog.kenyang.net/2010/08/android-sdcard.html">android 偵測 sdcard</a></li></ol><div><br /></div><br />先去看Google的定義，對於startService，Google定義如下<br /><blockquote><b>Once started, a service can run in the background indefinitely, even if the component that started it is destroyed. Usually, a started service performs a single operation and does not return a result to the caller. For example, it might download or upload a file over the network. When the operation is done, the service should stop itself.</b></blockquote>簡言之用startService啟動，這個service是不會跟隨著啓動他的component消滅！且原則上是不能與UI互動的！（原則上）<br /><br /><br />而對於bindService，定義如下：<br /><blockquote><b>A bound service offers a client-server interface that allows components to interact with the service, send requests, get results, and even do so across processes with interprocess communication (IPC). A bound service runs only as long as another application component is bound to it. Multiple components can bind to the service at once, but when all of them unbind, the service is destroyed.</b></blockquote>用bindService起來的話，則此service可以跟該component進行溝通！甚至可以做到 IPC！<br /><br />小結：<br />bindService和startService最主要的差異在於其本身的lifecycle！<div>以及bindService可以用來做IPC！簡單的說就是可以讓你的service和UI溝通！<br /><br /></div><div>這裡就用一個project來說明吧！<br /><div><br />先建立一個new project！<br />在這project中建立一個Activity，並指定它為launcher！<br />然後在建立一個Service！內如如下：<br /><pre class="brush: java">public class Services extends Service {<br /><br /> @Override<br /> public IBinder onBind(Intent intent) {<br />  // TODO Auto-generated method stub<br />  Log.d("TestService","onBind");<br />  return null;<br /> }<br /> <br /> @Override<br /> public int onStartCommand(Intent intent, int flags, int startId) {<br />  Log.d("TestService","onStartCommand");<br />  return super.onStartCommand(intent, flags, startId);<br /> }<br /> @Override<br /> public ComponentName startService(Intent service) {<br />  Log.d("TestService","startService");<br />  return super.startService(service);<br /> }<br /> <br /> @Override<br /> public void onCreate() {<br />  super.onCreate();<br />  Log.d("TestService","onCreate");<br /> }<br /> <br /> @Override<br /> public void onDestroy() {<br />  super.onDestroy();<br />  Log.d("TestService","onDestroy");<br /> }<br /><br /> @Override<br /> public boolean onUnbind(Intent intent) {<br />  Log.d("TestService","onUnbind");<br />  return super.onUnbind(intent);<br /> }<br /> <br />}<br /></pre><br />可以看到上面的Service中並沒有做任何處理！<br />只有簡單的Log！<br />目的只是要讓我們瞭解startService和bindService的lifecycle差異性！<br /><br />首先先來講startService，<br />我們先在onCreate中start！如下：<br /><pre class="brush: java">@Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  <br />  startService(new Intent(this,Services.class));<br /> }<br /></pre><br />然後按下run，在開啟DDMS來觀看log！<br />會發現印出了”onCreate"-&gt;"onStartCommand"！<br /><br />這時候按下back鍵來destroy這個activity，你會發現什麼都沒有印出來！<br />也就是說這個service仍在background執行！（你得手動stop）<br /><br />這時候我們換成bindService來看看，如下：<br /><pre class="brush: java">@Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  <br />  bindService(new Intent(this,Services.class),null,Context.BIND_AUTO_CREATE);<br /> }<br /></pre><br />一樣按下run！再看一下ＬＯＧ！<br />會發現印出“onCreate"-&gt;"onBind"！<br /><br />再按下back鍵，會發現...印出了！<br />“onUnbind"-&gt;"onDestroy"<br /><br /><br /><br />總結上面兩項的差異，<br />會發現使用bindService時，<br />這個service的lifecycle是跟隨著bind它的object！<br />所以當該object被destroy，自然而然這個service也被destroy！<br /><br />而使用startService，<br />就不是這樣了！這個service就是獨立的！不屬於任何一個object！<br />得靠stopService來停止！（任何一個Activity中都可以stop）<br /><br /><br />註：bindService的使用方式比較特別！<br />多帶了幾個參數！<br />在這個例子我們第二個參數設為null！<br />其實這參數是要傳入一個ServiceConnection的物件！<br />而ServiceConnection是一個Interface，這個Interface中<br />會有兩個callback function！<br />主要是用來monitor 這個service的state！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></div>
      </div>

      <a href="/2012/11/25/android-startservice-vs-bindservice" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android: r cannot be resolved to a variable</h1>

      <div class="entry">
        <span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">早上發生了一個很有趣的事情...</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">因為最近新版的Android</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">&nbsp;SDK非常的雞婆！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">如果一開始預設選的sdk是4.x以上，</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">re</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">s/</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">底下會多了一個value-v11, value-v14住兩個資料夾，</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">這裡面都是放一些layout/</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">theme！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"><br /></span> <span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">這些layout就是根據不同的SDK version去gen出來的！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">其實它的目的就是要你吃它新推出</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">的action bar的概念！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">但是如果你把project default sdk version改成2.x！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">那就慘了！因為2.X SDK不認得那是什麼！！！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">所以你的R.java會一直buil</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">d不出來！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">soloution就是把那兩個資料夾砍了！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">還有一點</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">！在layout裡面以前有一個attribute是fill_</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">parent！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">但在某個版本SDK被deprecated！改成</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">match_parent！！！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"><br /></span> <span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">而4.X就是用match_pa</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">rent！</span><br /><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">如果改回2.X sdk就要把match_parent改成fill_paren</span><wbr style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;" /><span class="word_break" style="background-color: white; color: #333333; display: inline-block; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;"></span><span style="background-color: white; color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; font-size: 13px; line-height: 17px;">t！</span><br /><br /><br /><br />
      </div>

      <a href="/2012/11/19/android-r-cannot-be-resolved-to-variable" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Google Analytics for Android - EasyTrack </h1>

      <div class="entry">
        <a href="https://www.google.com/analytics/web/">Google Analytics</a>是一套分析工具！<br />最初只有ＷＥＢ版才有，可以分析你的流量、人口分布、瀏覽器來源等等之類的資訊！<br />但現在已有了<a href="https://developers.google.com/analytics/devguides/collection/android/v2/">Android</a> &amp; iOS等其他版本，<br />可以利用這套API去分析使用者在你app上的使用情況．<br />（例如：在這個Activiy待了多久，或者做了怎樣的行為，點了哪些button等等之類的，甚至可以有exception report）<br /><br /><br />這篇主要會說明在Android上面如何使用！<br />在這篇會先講解簡單的EasyTrakcer的部分！<br />EasyTrakcer顧名思義就是很簡單的意思！<br />有好有壞！好的是你可以快速implement，<br />壞的是彈性較小！<br /><br /><br /><br />在開始實作之前，你得先去Google Analytics上開一個project for android，<br />目的是為了申請一個ID ！<br />網址：<a href="https://www.google.com/analytics/web/">https://www.google.com/analytics/web/</a><br /><br />進來此網站之後，會見到下圖，<br />(1) &nbsp;請點選下圖中的New Account<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-Dxkod0pGeq4/UJxdp3jg3II/AAAAAAAAEfU/Qj7JmF9xBao/s1600/0.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="234" src="http://3.bp.blogspot.com/-Dxkod0pGeq4/UJxdp3jg3II/AAAAAAAAEfU/Qj7JmF9xBao/s640/0.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table><br /><br />(2) &nbsp;接著會看到下圖，請點選“應用程式”（預設是網站）<br /><div>接著就輸入自己的應用程式名<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-U0rDuWSvaw8/UJxdrj63k2I/AAAAAAAAEfk/RMHvNLVQvgM/s1600/1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="286" src="http://3.bp.blogspot.com/-U0rDuWSvaw8/UJxdrj63k2I/AAAAAAAAEfk/RMHvNLVQvgM/s640/1.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><br />(3) &nbsp;完成上述步驟以後，你就會得到自己的Google Analytics ID，</div><div>這ID要記起來！因為待會再Android</div><div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-lEh6Ua6CVAI/UJxds0IAtZI/AAAAAAAAEfo/MJQjdZKRnek/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="556" src="http://4.bp.blogspot.com/-lEh6Ua6CVAI/UJxds0IAtZI/AAAAAAAAEfo/MJQjdZKRnek/s640/2.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖三</td></tr></tbody></table><br /><br /><br /><br />完成上述的申請以後！<br />(1) 接著要先去下載Google Analytics SDK (<a href="https://developers.google.com/analytics/devguides/collection/android/resources">Here</a>)<br /><br />(2) 解壓縮出來<br /><br />(3) 開一個Android Project<br /><br />(4) 把lib include至Android Project中<br />&nbsp; &nbsp; &nbsp;在Project中點選右鍵選擇properties<br />&nbsp; &nbsp; &nbsp;接著會見到下圖，點選下圖中右方的紅色框框Java Build Path<br />&nbsp; &nbsp; &nbsp;然後點選下圖中上方的紅色框框Libraries<br />&nbsp; &nbsp; &nbsp;再點選下圖中有方紅色框框的Add External JARS...<br />&nbsp; &nbsp; &nbsp;然後找到你剛剛下載的lib，把它加進來就好！<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-aGK_Oeia2Hg/UJxgQJ9HNPI/AAAAAAAAEgE/WPQna3wVp_Y/s1600/Screen+Shot+2012-11-09+at+9.31.08+AM.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="358" src="http://1.bp.blogspot.com/-aGK_Oeia2Hg/UJxgQJ9HNPI/AAAAAAAAEgE/WPQna3wVp_Y/s640/Screen+Shot+2012-11-09+at+9.31.08+AM.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖四</td></tr></tbody></table><br />(5) 把剛剛include進來的jar export出來！（如下圖）</div><div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-AXA_hPFjM3g/UJxgRE5lXfI/AAAAAAAAEgI/zAIK41K29fc/s1600/Screen+Shot+2012-11-09+at+9.31.35+AM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="352" src="http://2.bp.blogspot.com/-AXA_hPFjM3g/UJxgRE5lXfI/AAAAAAAAEgI/zAIK41K29fc/s640/Screen+Shot+2012-11-09+at+9.31.35+AM.png" width="640" /></a></div><br /><br /><br /><br /><br /><br /><div class="p1">(7) 加入下列兩項permission<br /><pre class="brush: xml">&lt;uses-permission android:name="android.permission.INTERNET" /&gt;<br />&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;<br /><br /></pre></div></div><br /><br />(8) 接著在project中/res/value底下建立一個analytics.xml<br />內容如下：<br /><pre class="brush: xml">&lt;?xml version="1.0" encoding="utf-8" ?&gt;<br /><br />&lt;resources&gt;<br />  &lt;!--Replace ID with your tracking ID--&gt;<br />  &lt;string name="ga_trackingId"&gt;UA-XXXX-Y&lt;/string&gt;<br /><br />  &lt;!-- use for debug --&gt;<br />  &lt;bool name="ga_debug"&gt;true&lt;/bool&gt;<br /> <br />  &lt;!--Enable Activity tracking--&gt;<br />  &lt;bool name="ga_autoActivityTracking"&gt;false&lt;/bool&gt;<br /><br />&lt;/resources&gt;<br /><br /></pre><br />註：<br />ga_trackingId記得填寫自己剛剛申請的那個id<br />ga_debug的意思是使用debug模式，可以讓你在local端看到一些track的資訊！<br />如果你沒有設置這個attributes，你可能要等很久很久，你的Google Analytics後台管理頁面才會更新資訊.....<br />所以還是設定一下吧！<br />ga_autoActivityTracking這個property也很重要，如果設為true的話，在initial tracker時，tracker會自動發出一個request，這個requset就包含了device name, screen resolution, os等等之類的資訊！在這我們先設為false，一切以手動的方式進行track！<br /><br />(9) 開始寫code，<br /><pre class="brush: java">private Tracker tracker  = null; // use for track event, exception..etc.<br /> private Context cxt   = null;<br /> private int iDispatchTime  = 3; // determine how long send the information to Google<br /> private double dSampleRate  = 100;  // determine how much information to be send <br /> <br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.main);<br />  cxt = this;<br />  <br />  EasyTracker.getInstance().setContext(cxt); // initial<br />  <br />  // start a Tracker, you must to do this thing otherwise you can't send any tracker to Google.<br />  EasyTracker.getInstance().activityStart((Activity)cxt); // Add this method.<br />  <br />  // 取得一個tracker<br />  tracker = EasyTracker.getTracker();<br />  <br />  // 設定Sample Rate, sample rate用意在於如果你的app很多人使用，<br />  // 那麼你可以自己設定有百分之幾的device資訊會被送出Google<br />  // 這裡設定100%，也就是說所有device都會送出資訊<br />  tracker.setSampleRate(dSampleRate);<br />  <br />  // 設定dispatch time<br />  // 這裡預設為3秒,也就是說每次trackEvent, trackException一次<br />  // 都會在3秒以後送出（當然你可以手動進行dipatch)<br />  GAServiceManager.getInstance().setDispatchPeriod(iDispatchTime);<br />  <br />  <br />  // track event<br />  tracker.trackEvent("UI_ACTION", "buttonClick", "labelCreatedByKen", 0l);<br />  <br />  // track view, 追蹤這個activity使用者停留了多久之類的<br />  tracker.trackView("trackViewHomePage");<br />  <br />  // track exception, 這裡是手動的track exception<br />  // 你可以把trackException放在try{}cathc(){};之中<br />  tracker.trackException("ExceptionCreatedByKen", false);<br />  <br /> }<br /></pre><br /><br />完成以後你可以利用DDMS進行debug，<br />你可以用來看這些track(trackEvent, trackView,trackExeption)送出了那些資訊<br />大概會看到下面那張圖！<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-BywlH9TcOc0/UKjIMzVBY6I/AAAAAAAAEgo/q6FIZcZuLSU/s1600/Screen+Shot+2012-11-18+at+7.31.19+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="242" src="http://4.bp.blogspot.com/-BywlH9TcOc0/UKjIMzVBY6I/AAAAAAAAEgo/q6FIZcZuLSU/s640/Screen+Shot+2012-11-18+at+7.31.19+PM.png" width="640" /></a></div><br /><br /><br /><br />而在Google Analytics的後台就會看到上面送出的那些資訊！<br />如下圖！<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-6cfIImlH8IY/UKjI8wzRvFI/AAAAAAAAEgw/S8amYNJZcXY/s1600/Screen+Shot+2012-11-18+at+7.37.11+PM.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="50" src="http://3.bp.blogspot.com/-6cfIImlH8IY/UKjI8wzRvFI/AAAAAAAAEgw/S8amYNJZcXY/s640/Screen+Shot+2012-11-18+at+7.37.11+PM.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">trackEvent</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-5ENuqzoe-iE/UKjI9Qfgn7I/AAAAAAAAEg4/DkvcbgIbzDs/s1600/Screen+Shot+2012-11-18+at+7.37.26+PM.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="112" src="http://2.bp.blogspot.com/-5ENuqzoe-iE/UKjI9Qfgn7I/AAAAAAAAEg4/DkvcbgIbzDs/s640/Screen+Shot+2012-11-18+at+7.37.26+PM.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">trackView</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-yhHyh90Fc6g/UKjI98iTrZI/AAAAAAAAEhA/-vlpKVWqca8/s1600/Screen+Shot+2012-11-18+at+7.37.49+PM.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="72" src="http://3.bp.blogspot.com/-yhHyh90Fc6g/UKjI98iTrZI/AAAAAAAAEhA/-vlpKVWqca8/s640/Screen+Shot+2012-11-18+at+7.37.49+PM.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">trackExcpetion-1</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-wnVzemAc0CU/UKjI-kckbiI/AAAAAAAAEhI/GDtgDoJv6FM/s1600/Screen+Shot+2012-11-18+at+7.37.59+PM.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="102" src="http://1.bp.blogspot.com/-wnVzemAc0CU/UKjI-kckbiI/AAAAAAAAEhI/GDtgDoJv6FM/s640/Screen+Shot+2012-11-18+at+7.37.59+PM.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">trackException-2</td></tr></tbody></table><br />trackException有兩張圖，因為trackException會記錄著是那個version的app發生exception的！<br />所以如果你有很多個version，你會在第一張圖看到很多個version，<br />因為這個是test app，所以目前只有一個1.0，點進去以後就會看到詳細的exception資訊了！（如第二張圖）<br /><br /><br /><br /><br />上面code之中有講到trackException，大家可能會有點confused，<br />因為如果你在開發app時，error handling做不好的時候，可能會導致app crash！<br />那麼屬於這邊的exception 該怎麼抓到呢？<br />恩！在Google Analytics也有提供這樣的功能！<br />只要在上面的xml檔當中加入下面的element即可！<br /><br /><pre class="brush: xml">&lt;!--Enable automatic exception tracking--&gt;<br />  &lt;bool name=&quot;ga_reportUncaughtExceptions&quot;&gt;true&lt;/bool&gt;  <br /></pre><br /><br />上面就是一些稍微進階的Google Analytic的使用方式！<br /><br /><br /><br />
      </div>

      <a href="/2012/11/18/google-analytics-for-android-easytrack" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Install Android NDK on MAC</h1>

      <div class="entry">
        <span style="font-family: Verdana, sans-serif;">這篇主要講怎麼<u>安裝</u>以及<u>使用</u><a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a>,</span><br /><span style="font-family: Verdana, sans-serif;">Android NDK簡單地說，就是讓您能夠在你的app當中使用C/C++進行implementation,</span><br /><span style="font-family: Verdana, sans-serif;">它可以把您寫的C/C++ build出一個share object檔案 (*.so) 讓Java call！類似windows中的dll檔！</span><br /><span style="font-family: Verdana, sans-serif;">當然你也可以在JNI call Java method，也就是說是雙向的！</span><br /><span style="font-family: Verdana, sans-serif;">而使用NDK的</span><span style="font-family: Verdana, sans-serif;">好處是大概有下面兩個（我只能想到這兩個..）</span><br /><ol><li><span style="font-family: Verdana, sans-serif;">效能較好（depends on situation)</span></li><li><span style="font-family: Verdana, sans-serif;">可以控制到底層的裝置</span></li></ol><br /><u><span style="font-family: Verdana, sans-serif;"><br /></span></u> <span style="font-family: Verdana, sans-serif;">不過在Android官網也指出</span><br /><blockquote class="tr_bq"><span style="font-family: Verdana, sans-serif;"><span style="background-color: #f9f9f9; color: #222222; line-height: 19px;">”you should understand that&nbsp;</span><span style="background-color: #f9f9f9; color: #222222; line-height: 19px;">the NDK will not benefit most apps“</span></span></blockquote><span style="font-family: Verdana, sans-serif;">所以使用時機要自己斟酌，但我知道蠻多game都是用NDK去implement！</span><br /><span style="font-family: Verdana, sans-serif;">因為需要太多memory，靠自己free效能會較好！</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;">首先先講<a href="http://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a>的安裝以及使用方法！</span><br /><br /><span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（1） 下載</b></span><br /><span style="font-family: Verdana, sans-serif;">下載頁面在<a href="http://developer.android.com/tools/sdk/ndk/index.html#Downloads">http://developer.android.com/tools/sdk/ndk/index.html#Downloads</a></span><br /><span style="font-family: Verdana, sans-serif;">請選擇符合你自己ＯＳ的版本！</span><br /><span style="font-family: Verdana, sans-serif;">（如果你使用的是windows！請先下載<a href="http://www.cygwin.com/">cygwin</a>，至於cygwin是什麼，前面很多篇文章已經敘述過，這裡不多加敘述）</span><br /><br /><span style="color: red; font-size: large;"><b>（2）解壓縮</b></span><br /><span style="font-family: Verdana, sans-serif;">此篇是用mac，因此就下載osx的版本吧！</span><br /><span style="font-family: Verdana, sans-serif;">下載下來以後就進行解壓縮．</span><br /><span style="font-family: Verdana, sans-serif;">基本上其實就完成了！</span><br /><span style="font-family: Verdana, sans-serif;">在NDK r4之前還需要跑一隻setup script，但之後的就不用了！</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;">其實解壓縮之後裡面就有很多doc可以看！不過都是英文！</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（3）建立jni資料夾</b></span><br /><span style="font-family: Verdana, sans-serif;">在你的$project/底下建立一個jni資料夾！如下：</span><br /><span style="font-family: Verdana, sans-serif;"><project>$project/jni</project></span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（4）撰寫C/C++</b></span><br /><span style="font-family: Verdana, sans-serif;">在$project<project>/jni底下開始寫C/C++的code了！</project></span><br /><span style="font-family: Verdana, sans-serif;">先建立一個檔案叫做test-jni.c，</span><br /><span style="font-family: Verdana, sans-serif;">內容如下：</span><br /><pre class="brush: c">#include &lt;string.h&gt;<br />#include &lt;jni.h&gt;<br /><br />jstring<br />Java_net_kenyang_jni_RunJNI_getText( JNIEnv* env,<br />                                                  jobject thiz )<br />{<br />    return (*env)-&gt;NewStringUTF(env, "Hello from JNI !");<br />}<br /></pre><span style="font-family: Verdana, sans-serif;">jstring是return type</span><br /><span style="font-family: Verdana, sans-serif;">而</span><span style="font-family: Verdana, sans-serif;"><span style="color: red;">Java</span>_<span style="color: blue;">net_kenyang_jni</span>_<span style="color: #38761d;">RunJNI</span>_<span style="color: #b45f06;">getText</span>是這個method的命名規則！</span><br /><span style="font-family: Verdana, sans-serif;">這是JNI的規則，所以請遵守！</span><br /><br /><span style="font-family: Verdana, sans-serif;">開頭一律Java_<span style="color: blue;">自己的package名稱_</span><span style="color: #38761d;">Class名稱_</span><span style="color: #b45f06;">method名稱</span></span><span style="font-family: Verdana, sans-serif;"><br /></span><span style="font-family: Verdana, sans-serif;">你可以改成自己的！但記得後面的步驟也要記得改！ </span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（5）建立Android.mk</b></span><br /><span style="font-family: Verdana, sans-serif;">一樣在$project/jni底下建立Android.mk檔案</span><br /><span style="font-family: Verdana, sans-serif;">Android.mk這個檔案是用來告訴NDK等等要去build哪些resource！</span><br /><span style="font-family: Verdana, sans-serif;">而我們目前只有一隻test-jni.c，所以檔案內容如下：</span><br /><pre class="brush: c">LOCAL_PATH := $(call my-dir)<br /><br />include $(CLEAR_VARS)<br /><br />LOCAL_MODULE    := test-jni<br />LOCAL_SRC_FILES := test-jni.c<br /><br />include $(BUILD_SHARED_LIBRARY)<br /><br /></pre><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;"><br /></span> <span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（6）開始build *.so檔案</b></span><br /><span style="font-family: Verdana, sans-serif;">先開啓你的terminate，然後cd到$project/jni底下</span><br /><span style="font-family: Verdana, sans-serif;">直接在該目錄底下</span><span style="font-family: Verdana, sans-serif;">用NDK的tool進行build！</span><br /><span style="font-family: Verdana, sans-serif;">這樣就會產生一個.so檔！</span><br /><span style="font-family: Verdana, sans-serif;">這個檔案會放在$project/lib/armeabi底下！</span><br /><span style="font-family: Verdana, sans-serif;">檔名一定會是lib開頭，.so結尾！</span><br /><span style="font-family: Verdana, sans-serif;">也就是說在這個範例build出來的.so檔案名稱為libtest-jni.so</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <span style="font-family: Verdana, sans-serif;">而build指令如下：</span><br /><pre class="brush: c">cd xxx/project/jni<br />xxx/ndk/ndk-build<br /></pre><br /><br /><span style="font-family: Verdana, sans-serif;"><br /></span> <br /><span style="color: red; font-family: Verdana, sans-serif; font-size: large;"><b>（7）開始寫code</b></span><br /><span style="font-family: Verdana, sans-serif;">在你的android project中直接建立一個activity（名稱為RunJNI）</span><span style="font-family: Verdana, sans-serif;">，</span><br /><span style="font-family: Verdana, sans-serif;">我們將在這個activity中進行呼叫剛剛用c建立的method，</span><br /><span style="font-family: Verdana, sans-serif;">ＣＯＤＥ如下：</span><br /><pre class="brush: java">public class RunJNI extends Activity {<br /> // 宣告一個native method（就是剛剛用c寫的）<br /> private native String getText();<br /> <br /> // 載入剛剛的.so檔案！（這裡不需要加上lib，直接去掉就好<br />    static {<br />        System.loadLibrary("test-jni");<br />    }<br /><br /><br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  setContentView(R.layout.run_jni);<br />  <br />  TextView tv = (TextView) findViewById(R.id.textView1);<br />  <br />  // 呼叫method,把method回傳的字給textView進行設定<br />  tv.setText(getText());<br />  <br /> }<br />}<br /><br /></pre><br /><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><span style="font-family: Verdana, sans-serif;">完成上面7個步驟就完成了！</span><br /><span style="font-family: Verdana, sans-serif;">直接點選run應該就可以看到下面畫面！&nbsp;</span><br /><span style="font-family: Verdana, sans-serif;"><br /></span><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-jnrxKIWQCPs/UIekOU43QAI/AAAAAAAAA6k/3LdoMLKSWq0/s1600/Screenshot_2012-10-24-16-18-19.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-jnrxKIWQCPs/UIekOU43QAI/AAAAAAAAA6k/3LdoMLKSWq0/s640/Screenshot_2012-10-24-16-18-19.png" width="360" /></a></div><span style="font-family: Verdana, sans-serif;"><br /></span><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u><u><span style="font-family: Verdana, sans-serif;"><br /></span></u> <span style="font-family: Verdana, sans-serif;"><br /></span> <br /><pre></pre><pre></pre>
      </div>

      <a href="/2012/10/24/install-android-ndk-on-mac" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Amazon EC2 regenerate key</h1>

      <div class="entry">
        <div class="separator" style="clear: both; text-align: left;">前天要上去自己的EC2上的某台機器，</div><div class="separator" style="clear: both; text-align: left;">但發現access key 放在另一台筆電上，剛好那台筆電在公司......</div><div class="separator" style="clear: both; text-align: left;">又有急切需求要上去看一些config，</div><div class="separator" style="clear: both; text-align: left;">偏偏EC2的access key只能被download一次 （就是一開始建立intance的時候）</div><div class="separator" style="clear: both; text-align: left;">所以當下我根本無法上到我的機器看！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">只好把目前的instance 複製一份image出來，</div><div class="separator" style="clear: both; text-align: left;">然後在利用那份image建立一個新的instance！</div><div class="separator" style="clear: both; text-align: left;">利用這個方法來取得新key，又可以存取到一模一樣設定的機器！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">操作如下！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">1. 首先先把自己的正在running的instance stop！</div><div class="separator" style="clear: both; text-align: left;">接著點選該instance -&gt; 點選menu bar上的Instance actions -&gt; 選擇Create Image</div><div class="separator" style="clear: both; text-align: left;">如下圖所示</div><div class="separator" style="clear: both; text-align: left;"><a href="http://3.bp.blogspot.com/-tEXKoyzIJO8/UH-WKKaLMCI/AAAAAAAAA5g/72bF6M5Ccvk/s1600/Screen+Shot+2012-10-17+at+8.52.06+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em; text-align: center;"><img border="0" height="396" src="http://3.bp.blogspot.com/-tEXKoyzIJO8/UH-WKKaLMCI/AAAAAAAAA5g/72bF6M5Ccvk/s640/Screen+Shot+2012-10-17+at+8.52.06+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">2. 填寫Image名稱 - &gt;點選Yes, Create</div><div class="separator" style="clear: both; text-align: left;">如下圖&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-j0mnSS1-YYo/UH-WK8P2-OI/AAAAAAAAA5k/zqwCo572WI0/s1600/Screen+Shot+2012-10-17+at+8.52.17+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="392" src="http://1.bp.blogspot.com/-j0mnSS1-YYo/UH-WK8P2-OI/AAAAAAAAA5k/zqwCo572WI0/s640/Screen+Shot+2012-10-17+at+8.52.17+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">3. 完成上述步驟以後，就複製完成了！</div><div class="separator" style="clear: both; text-align: left;">接著就要建立一個新的instance！</div><div class="separator" style="clear: both; text-align: left;">這邊的流程跟建立一般的instance沒什麼不同！<br />只不過要選擇自己複製好的image，如下圖所示．</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-iD0okdXyl4E/UH-WMQRgr6I/AAAAAAAAA50/QKNLhmCVN2M/s1600/Screen+Shot+2012-10-17+at+8.52.53+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="416" src="http://4.bp.blogspot.com/-iD0okdXyl4E/UH-WMQRgr6I/AAAAAAAAA50/QKNLhmCVN2M/s640/Screen+Shot+2012-10-17+at+8.52.53+PM.png" width="640" /></a></div><br /><br />4. 到了Create Key Pair這步驟以後，記得建立一個新的Key Pair!<br />不要使用舊的key pair! （因為沒辦法下載了！）<br />所以要選擇建立新的，就可以下載這支新的key!<br />如下圖所示！<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-n2M3lEl_QwM/UH-WNKVNeqI/AAAAAAAAA58/kGMc4m91bvQ/s1600/Screen+Shot+2012-10-17+at+8.56.55+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="436" src="http://1.bp.blogspot.com/-n2M3lEl_QwM/UH-WNKVNeqI/AAAAAAAAA58/kGMc4m91bvQ/s640/Screen+Shot+2012-10-17+at+8.56.55+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">完成上述步驟就有一台和先前舊的那台一模一樣的機器了！</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><br />
      </div>

      <a href="/2012/10/18/amazon-ec2-regenerate-key" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Objetive-C memory (retain)</h1>

      <div class="entry">
        恩，最近在寫Objective-C，<br />遇到了memory的一些問題，<br />也好險我有個好mentor可以問！<br /><br /><br />從Java跳過來這讓我有點點小混淆！<br />還記得我先前講過<a href="http://blog.kenyang.net/2012/01/java.html">Java複製物件</a>的問題嗎？<br />在Java中直接將instance化的物件，直接給予另一個物件！<br />這樣的情形中，這兩個物件是指向同個物件的！<br />假設我有兩個物件，分別為Ａ、Ｂ！<br />如果Ａ裡面的attribute變了！那麼Ｂ也會變！<br /><br />當然這樣的情形在Objective C也是一樣的！<br />但是Objective C有個method，就是retain!<br />還有一個特殊的機制叫做reference counting<br />retain也是把原本的物件給另一個物件！<br />這兩個物件也是指向同一個物件！<br />而reference counting就是當這個物件被copy或者retain時，<br />他的reference count都會加1! <br />（retain 是原有物件會+1，copy是新的物件+1，copy就類似java的clone）<br /><br /><br />但我一開始遇到了一個寫法上的confused，一開始一直在想這兩種差別！<br />code如下<br /><pre class="brush: c">    Book *b1 = [[Book alloc]init]; // retain count=1沒問題<br />    Book *b2 = b1; // retain count還是1，這我大概理解，就是把b2指向b1<br />    Book *b3 = [b1 retain]; // retain count變2<br />    [b1 setVal:20];  // 如果把b1物件中的value設值20，b2, b3也都會變<br /><br /></pre><br />這時候如果把b2, b3的Val都印出來，也都會是20！<br />那麼我就在思考了這兩種的差異！<br /><br />最後也大概知道了！<br />因為b2和b1算是共享同個物件！<br />如果這時候developer把[b1 release]掉！<br />b2也不能使用了！！<br />很容易發生bad access的問題！<br />所以大部份時候都要使用retain來進行物件的存取！（目前還想不到使用b2的方法用途）<br />以避免原有物件被release出來以後，現有的新物件才不會crash掉！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/10/06/objetive-c-memory-retain" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Xcode 4.5 key binding (delete current line)</h1>

      <div class="entry">
        最近剛拿到了mba, 開始在進行ios &amp; mac的study！<br />所以一定要用到xcode！<br />xcode真的是蠻強大的，像是analysis memory leak的工具！<br />但一直用習慣eclipse的我，還是有點點小小不習慣，<br />例如在eclispe可以刪除目前游標所在的一整行或者是複製一整行！<br />在eclispe可以透過hot key去操作！很方便！ 在Eclipse裡面就有這些選項可以讓開發者設定！<br /><br />但是在Xcode沒有預設的hot key可以“直接”做到！<br />得透過一連串的hot key去做到，例如先按下cmd+d -&gt; cmd+x (隨便舉例的）<br />簡單的說無法透過一個步驟就去做到（例如cmd+d)<br /><br />但好險我們可以自行設定一個combine的組合鍵來完成上述的動作！<br /><br />首先先開啓terminal！<br />然後切換到下面的目錄<br /><pre class="brush: java">cd /Applications/Xcode.app/Contents/Frameworks/IDEKit.framework/<br /></pre><br />然後可以下ls -al看一下該目錄底下的目錄結構，<br />你會看到如下圖的結構！<br />你會發現有兩個Link指向Versions這個資料夾！<br />你的資料夾的權限應該是r--r--r--x！<br />只有讀的權限！<br />但我們等等要修改該目錄底下的檔案，所以先把權限設777吧！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-QGMemXTaciw/UG0hjhyKxMI/AAAAAAAAA40/Do8-tulYvUw/s1600/Screen+Shot+2012-10-04+at+1.43.40+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="158" src="http://3.bp.blogspot.com/-QGMemXTaciw/UG0hjhyKxMI/AAAAAAAAA40/Do8-tulYvUw/s640/Screen+Shot+2012-10-04+at+1.43.40+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">指令如下：</div><div class="separator" style="clear: both; text-align: left;"></div><pre class="brush: java">chmod 777 Versions<br /></pre><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">改變以後我們在進到裡面的目錄！</div><div class="separator" style="clear: both; text-align: left;">如下：</div><div class="separator" style="clear: both; text-align: left;"></div><pre class="brush: java">cd ./Current/Resources<br /></pre><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">然後Xcode的預設key binding設定檔就在該目錄底下</div><div class="separator" style="clear: both; text-align: left;">接著就用vim去修改設定檔案吧！</div><div class="separator" style="clear: both; text-align: left;"></div><pre class="brush: java">sudo vim ./IDETextKeyBindingSet.plist <br /></pre><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">打開以後會看到一大串的xml格式，基本上只要在下面dist中間加入入即可！</div><div class="separator" style="clear: both; text-align: left;"></div><pre class="brush: xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<br />&lt;plist version="1.0"&gt;<br />&lt;dict&gt;<br /><br />&lt;/dict&gt;<br />&lt;/plist&gt;<br /></pre><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">所以加入以後，就會變成下面的樣子！</div><div class="separator" style="clear: both; text-align: left;"></div><pre class="brush: xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />&lt;!DOCTYPE plist PUBLIC "-//Apple//DTD PLIST 1.0//EN" "http://www.apple.com/DTDs/PropertyList-1.0.dtd"&gt;<br />&lt;plist version="1.0"&gt;<br />&lt;dict&gt;<br />        &lt;dict&gt;<br />                &lt;key&gt;DeleteCurrentLine&lt;/key&gt;<br />                &lt;string&gt;moveToBeginningOfLine:, deleteToEndOfLine:&lt;/string&gt;<br />        &lt;/dict&gt;<br /><br />&lt;/dict&gt;<br />&lt;/plist&gt;<br /></pre><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;">這個例子是刪除目前游標行，</div><div class="separator" style="clear: both; text-align: left;"><key>裡面就是這個指令的名稱 （別亂取，待會 要在Xcode裡面進行這個指令的快捷鍵）</key></div><div class="separator" style="clear: both; text-align: left;"><string>裡面就是這個指令的一連串指令，我們可以看到有下面兩個</string></div><div class="separator" style="clear: both; text-align: left;"></div><br /><ul><li>moveToBeginningOfLine（意思是移到這行的最前面）</li><li>deleteToEndOfLine（意思是從游標位置開始刪除，刪除到這行的最後面）</li></ul><br /><br /><div class="separator" style="clear: both; text-align: left;">透過上述的指令就可以進行刪除一整行，</div><div class="separator" style="clear: both; text-align: left;">接著就打開Xcode吧！</div><div class="separator" style="clear: both; text-align: left;">1) 先進到Preferences裡面！</div><div class="separator" style="clear: both; text-align: left;">2) 選擇Key Binding！</div><div class="separator" style="clear: both; text-align: left;">3) 然後在搜尋筐中輸入你剛剛上面xml檔案中填入的key名稱</div><div class="separator" style="clear: both; text-align: left;">4) 基本上你就可以找到你剛剛設定的檔案！就可以修改他的快捷鍵了！像下圖的案例就是以cmd+d來進行刪除一整行</div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-yMPP_tk9GHk/UG0neA6heoI/AAAAAAAAA5I/4ba3gfFjV4o/s1600/Screen+Shot+2012-10-04+at+2.06.51+PM.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="244" src="http://3.bp.blogspot.com/-yMPP_tk9GHk/UG0neA6heoI/AAAAAAAAA5I/4ba3gfFjV4o/s640/Screen+Shot+2012-10-04+at+2.06.51+PM.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div>
      </div>

      <a href="/2012/10/04/xcode-45-key-binding-delete-current-line" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Nginx+Apache+PHP</h1>

      <div class="entry">
        <br />大部分在架設網站的人都會採用<a href="http://en.wikipedia.org/wiki/LAMP_(software_bundle)">LAMP</a>的方式!<br />就是傳統的Linux+Apache+MySQL+PHP。<br />但由於這種方式對一般人來說已經是過於簡單了，<br />甚至已經有一鍵包...只要一直按"下一步"就可以完成安裝...<br />所以在這就不多做介紹。<br /><br /><br />在這要介紹一個比較特別的架構叫做L<b><span style="color: red;">N</span></b>AMP，<br />LNAMP和之前的差不多，但多了一個<a href="http://en.wikipedia.org/wiki/Nginx">Nginx</a>。<br />Nginx和Apache一樣是web server，<br />但在這邊我們將在我們的Linux Server上同時安裝二個Web Server(Nginx、Apache)。<br />然後利用<a href="http://en.wikipedia.org/wiki/Reverse_proxy">reverse proxy</a>的概念來結合這二個Web Server，<br /><br /><br />由於Nginx在處理靜態網頁、文件的效能較好，<br />而Apache一直以來都算是一個穩定的Web Server，但Apache很耗CPU、memory。<br />但是Nginx並不支援PHP，因此我們可以結合這兩個Web Server的特性來架設我們的網站!<br /><br /><br /><br />首先先看到下面那張圖，這張圖是我們網站的架構!<br />我們可以看到圖中的兩個粉紅色區塊，<br />這兩個區塊都是web server。<br />而在這邊我會把Nginx的port設為80，<br />Apache的port改為8080。<br /><br />當User request <span style="color: red; font-weight: bold;">http://www.example.com/index.</span><b style="color: blue;"><span style="font-size: large;">html&nbsp;</span></b>的時候，<br />我們就會透過Nginx response給User! &nbsp;(就是下圖中左邊的區塊)<br />但是當User request&nbsp;&nbsp;<span style="color: red; font-weight: bold;">http://www.example.com/index.</span><b style="color: blue;"><span style="font-size: large;">php&nbsp;</span></b>的時候，<br />我們一樣一開始會透過Nginx，可是Nginx會透過reverse proxy的機制，<br />reverse給Apache進行處理!!! &nbsp;(就是下圖中右邊的區塊)<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-M0aRrq3UJB4/UFfWndIaGNI/AAAAAAAAA3s/wGHyUqa4gF4/s1600/UntitledDocument.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="448" src="http://4.bp.blogspot.com/-M0aRrq3UJB4/UFfWndIaGNI/AAAAAAAAA3s/wGHyUqa4gF4/s640/UntitledDocument.png" width="640" /></a></div><br /><br />透過上圖中的機制可以有效的快速response user，<br />也可以減輕Server的負擔!<br />甚至可以減輕MySQL的負擔!<br />記得以前在某公司當intern的時候，<br />由於該公司的某項服務在當時似乎是國內前幾大的，<br />然後他們某項服務就是利用rewrite的概念，盡量不會有Dynamic Page，<br />他們系統每一陣子會把Dynamic Page的內容rewite成一個Static Page，<br />這樣他們的User都會去request 該Static Page，<br />而不會去request Dynamic Page，同時也減輕了DB的負擔!<br /><br /><br />講完架構以後，<br />接著要教大家怎麼把Nginx+Apache同時架起來!<br />我的環境是Ubuntu，<br />在這我就不教大家怎麼install Apahce和PHP了...應該是common sense!<br /><br />進行說明設定Nginx之前，<br />如果你已經將Apache安裝起來了，那請先把你的Apache port改成8080。<br />因為Nginx等等會使用80。<br /><br /><br />完成上述步驟，就來安裝Nginx，<br /><div><pre class="brush: java">sudo apt-get install nginx<br /></pre></div><br />安裝完成以後，如果你去request自己網站底下的某隻.php<br />例如：www.example.com/index.php<br />那麼是跑不起來的，因為Nginx並不支援任何的Dynamic Language（php, perl, jsp...etc)<br />所以要把有關Dynamic Page的任何request reverse proxy至apache去！<br /><br /><br />所以就要進行設定，首先要把nginx的port改為80<br /><pre class="brush: java">cd /etc/nginx/sites-available  #先切換至nginx的設定目錄底下<br />sudo vim default #修改設定檔<br /></pre><br />打開設定檔以後，記得在Server{}裡面加入下面的設定，<br /><br /><pre class="brush: java">listen 80 #預設是mark起來的，把最前面的#號拿掉就好，如果沒有這行就自己加吧!<br /><br /># 下面這段的意思是，當遇到.php檔名的就把它轉向至8080<br />location ~ \.php$ {<br />    proxy_pass  http://127.0.0.1:8080;<br />}<br /></pre><br />上面的設定主要就是過濾掉.php，<br />把php通通交給apache進行處理，<br />當然你也可以做更細部的過濾設定，<br />例如.jpg、.css、.js等等之類的靜態檔案都cached起來，<br />不要進行不必要的request。<br />例如<br /><pre class="brush: java">location ~* \.(jpg|png)$ {<br />    expires  30d;  # cached 30天的意思<br />}<br /></pre><br /><br />完成上面的設定以後，<br />就將Nginx重開吧!<br /><pre class="brush: java">sudo /etc/init.d/nginx restart<br /></pre><br /><br /><br />基本上重開以後，應該就完成LNAMP的架構了!<br /><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><br /></div><br />
      </div>

      <a href="/2012/09/18/nginxapachephp" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>使用Google OAuth 2.0 存取Google API</h1>

      <div class="entry">
        這篇文章主要是教學如何使用Google OAuth，<br />然後利用OAuth給的token去存取gmail帳號!<br /><br /><br />至於OAuth是甚麼就不多做介紹...<br />可以去WIKI看 &nbsp;<a href="http://en.wikipedia.org/wiki/OAuth">http://en.wikipedia.org/wiki/OAuth</a><br />簡言之，是一個公開的標準認證機制!<br /><br /><br />而使用Google OAuth大概可以<b>粗</b>分為下列步驟：<br /><br /><ol><li>在Google Console註冊一個Application&nbsp;</li><li>取得Google回傳的Access Token（基本上到這步驟，代表登入成功）</li><li>傳送Access Token至某隻Google API取得Google的資料</li></ol><div><br /></div><div><br /></div><div><span style="font-size: large;"><b>【在Google Console註冊一個Application 】</b></span></div><div><br /></div><div>在這步驟要先去Google Console頁面上去註冊一個application，</div><div>然後再為這個application申請一組client id。</div><div><br /></div><div><br /></div><div>首先要先去這個站(<a href="https://code.google.com/apis/console/b/0/#project:1007457656912:access">https://code.google.com/apis/console/b/0/#project:1007457656912:access</a>)，</div><div>點進去以後大概會見到下圖，</div><div>見到下圖(圖一)以後，就先點選下圖(圖一)中左邊的API Access，</div><div>注意! 一定要點! 點了以後，下圖(圖一)中右邊的區塊才會出現Create an OAuth 2.0 client ID的按鈕!</div><div>出現右邊的區塊以後，就點選Create an OAuth 2.0 client ID的按鈕!</div><div><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-JwE3gg-xhO0/UFP6oNVniUI/AAAAAAAAA2Y/NZyW3v_WnJE/s1600/1.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="222" src="http://4.bp.blogspot.com/-JwE3gg-xhO0/UFP6oNVniUI/AAAAAAAAA2Y/NZyW3v_WnJE/s640/1.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table><br /></div><div><br /></div><div>如果你曾經註冊過一個application，那就不會看到上圖(圖一)的頁面，</div><div>但大同小異! 還是會有一個按鈕(Create another client ID...)</div><div>點選以後就會直接見到圖三，而不會見到下圖(圖二)</div><div><br /></div><div>而如果沒有註冊過application的，就會見到下圖(圖二)。</div><div>下面的頁面主要輸入產品名稱即可!&nbsp;</div><div>輸入以後就按下下圖(圖二)Next</div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-Z5YnmHWrUEM/UFP6oyszkmI/AAAAAAAAA2c/wXleTWsGzrU/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="418" src="http://4.bp.blogspot.com/-Z5YnmHWrUEM/UFP6oyszkmI/AAAAAAAAA2c/wXleTWsGzrU/s640/2.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><br /><br /><br />點選上圖(圖二)中的Next以後，就會見到下圖(圖三)，<br />這個頁面很重要!<br />這頁面要填寫你的Domain Name以及接收access token的頁面!<br />但預設的狀況你只能填寫Domain Name，如下圖(圖三)的紅色框框!<br />而藍色框框中的URI(https://www.example.com/oauth2callback) 就是接收access token的頁面!<br />當然，如果你想要填寫自己接收access token的頁面，也是可以自己改!<br />只要點選下圖(圖三)中的綠色框框(more options)即可!<br />點選以後就會見到下圖(圖四)<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-DHKQZ6fpmus/UFP6ph8cJAI/AAAAAAAAA2k/g0lDMWSBCwI/s1600/3.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="484" src="http://1.bp.blogspot.com/-DHKQZ6fpmus/UFP6ph8cJAI/AAAAAAAAA2k/g0lDMWSBCwI/s640/3.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖三</td></tr></tbody></table><br /><br />下圖(圖四)就是點選上圖(圖三)的more options才會看到的頁面。<br />你可以看到下圖(圖四)有個紅色框框，在那裏面就可以修改自己接收access token的頁面!<br />填寫完成以後，記得按下圖片中(圖三或圖四)下面的Create client ID按鈕!<br />點了才會完成。<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-ih5kYbLFT5U/UFP6qA5qAFI/AAAAAAAAA2s/hLs7GqI05no/s1600/4.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="542" src="http://2.bp.blogspot.com/-ih5kYbLFT5U/UFP6qA5qAFI/AAAAAAAAA2s/hLs7GqI05no/s640/4.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖四</td></tr></tbody></table><div><br /></div><div>完成以後，會看到下圖(圖五)的頁面!</div><div>這頁面也很<b>重要</b>!!!!</div><div>因為Google 會給你一組Client ID和Client Sercet，</div><div>這兩個資訊在後面進行auth的時候會用到!</div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-A2KWXvQ1bdM/UFP_HVzeA6I/AAAAAAAAA3E/wxYHfaoH-hs/s1600/5.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="196" src="http://4.bp.blogspot.com/-A2KWXvQ1bdM/UFP_HVzeA6I/AAAAAAAAA3E/wxYHfaoH-hs/s640/5.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖五</td></tr></tbody></table><div><br /></div><div><br /></div><div><div><span style="font-size: large;"><b>【取得Google回傳的access token 】</b></span></div><div><br /></div><div>在這步驟就要進行coding了。</div></div><div>詳細的說明文件可以參考(<a href="https://developers.google.com/accounts/docs/OAuth2Login">https://developers.google.com/accounts/docs/OAuth2Login</a>)</div><div><br /></div><div><br /></div><div>先大致說明一下流程，可以參考下圖。</div><div>流程一：</div><div>　　User會先點選一個URL，</div><div>　　而這URL會連結至Google 登入頁面，</div><div>　　User得先輸入帳號＆密碼進行登入，</div><div>　　（這過程都是在Google Server上進行，我們的Server端是不會取得到User的密碼的）</div><div>流程二：</div><div>　　如果User輸入的帳號密碼正確，那麼Google就會把Access Token傳回去至我們的Server，</div><div>流程三：</div><div>　　發一個request給Google API，</div><div>　　把Google回傳給我們的token傳至Google API以存取我們想要存取的資訊！</div><div><div>流程三：</div><div>　　接收Google 回傳的資訊</div></div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-Dyrbs33OyVg/UFQCALNi6GI/AAAAAAAAA3Y/3mwvlUpTA1s/s1600/loginflow.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="450" src="http://4.bp.blogspot.com/-Dyrbs33OyVg/UFQCALNi6GI/AAAAAAAAA3Y/3mwvlUpTA1s/s640/loginflow.png" width="640" /></a></div><div><br /></div><div><br /></div><div>恩，接著要開始寫code了。</div><div>如上面所述，我們要有一個接收access token的頁面!<br />以及一個讓User點擊的連結（這個連結會redirect至Google登入頁面）<br />而這個連結也會帶著幾個參數！<br />如下</div><br /><div><pre class="brush: html"><a href="https://accounts.google.com/o/oauth2/auth?scope=https://www.googleapis.com%2Fauth%2Fuserinfo.email+https://www.googleapis.com%2Fauth%2Fuserinfo.profile&amp;state=/profile&amp;redirect_uri=http://www.example.com/oauth2callback&amp;response_type=code&amp;client_id=xxxxxxxxxxxxxxxxxxx"><br />使用Google登入<br /></a><br /><br /></pre></div><br /><div>參數說明：<br /><b><span style="color: red;">scope</span></b>：意思是你要利用這個token存取那些Google API，這邊我們要存取USER資訊，所以就是如上述sample所示。<br /><b><span style="color: red;">state</span></b>：這是一個optional 的參數，可以填任意字串<br /><b><span style="color: red;">redirecut_uri</span></b>：這個參數很<b>重要，</b>意思是如果user輸入帳密正確以後，Google要redirect至哪一個接收access_token的頁面，基本上這個參數的value就是如上圖中（圖四）你所填的值！<br /><b><span style="color: red;">response_type</span></b>：這個參數的value一定要填寫code！code的意思是我們接收的頁面是用server-side接收response! 預設還有另一個value（token)，但token代表的是我們是利用Javascript去進行接收！但此sample是用JSP/Servlet的Servlet來接收！所以就填寫code!<br /><b><span style="color: red;">client_id</span></b>：就填寫自己的client_id!!!<br /><br />基本上user點選上述的Link以後，<br />會見到登入頁面！<br />登入完成以後就會redirect至oauth2callback去了！<br />並且會reponse一個參數給我們！參數名稱為code<br /><br /></div><div>而這邊我已JSP/Servlet為例!<br />所以我先建立一個名字為oauth2callback的Servlet，<br />這個Servlet會用來接收Google回傳給我們的參數(code)，<br />然後這支Servlet會再發出一個request，並且帶著參數code。<br />然後Google就會回傳給我們access_token</div><div><br /></div><div><pre class="brush: java">@Override<br /> protected void doGet(HttpServletRequest req, HttpServletResponse resp)<br />   throws ServletException, IOException {<br />   <br />  // Google取得access_token的url<br />  URL urlObtainToken =  new URL("https://accounts.google.com/o/oauth2/token");<br />  HttpURLConnection connectionObtainToken =  (HttpURLConnection) urlObtainToken.openConnection();<br />    <br />  // 設定此connection使用POST<br />  connectionObtainToken.setRequestMethod("POST");<br />  connectionObtainToken.setDoOutput(true);<br />   <br />  // 開始傳送參數 <br />  OutputStreamWriter writer  = new OutputStreamWriter(connectionObtainToken.getOutputStream());<br />  writer.write("code="+req.getParameter("code")+"&amp;");   // 取得Google回傳的參數code<br />  writer.write("client_id=xxxxxxxxxxxxxxxxxx&amp;xxxx&amp;");   // 這裡請將xxxx替換成自己的client_id<br />  writer.write("client_secret=xxxxxxxxxxxxxxxxxxx&amp;");   // 這裡請將xxxx替換成自己的client_serect<br />  writer.write("redirect_uri=xxxxxxxxxxxxxxxxxxxx&amp;");   // 這裡請將xxxx替換成自己的redirect_uri<br />  writer.write("grant_type=authorization_code");  <br />  writer.close();<br />  <br />  // 如果認證成功<br />  if (connectionObtainToken.getResponseCode() == HttpURLConnection.HTTP_OK){<br />   StringBuilder sbLines   = new StringBuilder("");<br />   <br />   // 取得Google回傳的資料(JSON格式)<br />   BufferedReader reader = <br />       new BufferedReader(new InputStreamReader(connectionObtainToken.getInputStream(),"utf-8"));<br />   String strLine = "";<br />   while((strLine=reader.readLine())!=null){<br />    sbLines.append(strLine);<br />   }<br />  <br />   try {<br />       // 把上面取回來的資料，放進JSONObject中，以方便我們直接存取到想要的參數<br />    JSONObject jo = new JSONObject(sbLines.toString());<br />    <br />    // 印出Google回傳的access token<br />    resp.getWriter().println(jo.getString("access_token")); <br />   } catch (JSONException e) {<br />    e.printStackTrace();<br />   }<br />  }<br /> }<br /><br /></pre></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div>如果完成上述步驟，基本上就代表user的帳號密碼是正確!<br />那意思就是說，如果你的網站想要導入讓user使用Google帳號進行登入的話，<br />完成上述步驟就OK了!<br /><br />當然，如果你想要取得更進一步的user資訊，<br />只要利用上述得到的access_token，然後把這個token帶給Google API即可獲得資訊!<br />例如想要得到User的email，即可利用下列的API，<br /><b>https://www.googleapis.com/oauth2/v1/userinfo</b><br />但是要餵給他參數!<br />CODE如下：<br /><br /><br /></div><div><pre class="brush: java">URL urUserInfo =   <br />     new URL("https://www.googleapis.com/oauth2/v1/userinfo?access_token="+jo.getString("access_token")); <br /> HttpURLConnection connObtainUserInfo =  (HttpURLConnection) urUserInfo.openConnection();<br />  <br />  <br /> //如果認證成功<br /> if (connObtainUserInfo.getResponseCode() == HttpURLConnection.HTTP_OK){<br />  StringBuilder sbLines   = new StringBuilder("");<br />   <br />  // 取得Google回傳的資料(JSON格式)<br />  BufferedReader reader = <br />   new BufferedReader(new InputStreamReader(connObtainUserInfo.getInputStream(),"utf-8"));<br />  String strLine = "";<br />  while((strLine=reader.readLine())!=null){<br />   sbLines.append(strLine);<br />  }<br />  <br />  try {<br />   // 把上面取回來的資料，放進JSONObject中，以方便我們直接存取到想要的參數<br />   JSONObject jo = new JSONObject(sbLines.toString());<br />    <br />   // 印出Google回傳的"emailtoken<br />   resp.getWriter().println(jo.getString("email")); <br />    <br />  } catch (JSONException e) {<br />   e.printStackTrace();<br />  }<br /> }<br /><br /></pre></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div>
      </div>

      <a href="/2012/09/15/google-oauth-20-google-api" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Arduino 基本教學</h1>

      <div class="entry">
        Arduino 是一塊Open Source電路板，<br />開發者可以利用這塊板子去做到一些電子器材的控制，<br />例如：開燈、關燈，甚至可以在Arduino上裝上sensor，<br />然後根據sensor的資料來做處理！例如接上了光敏電阻這個sensor，<br />我們就可以判斷目前光的亮度，就可以根據不同亮度做不同的回應。<br />詳細資料可以去官網看：<a href="http://arduino.cc/en/">http://arduino.cc/en/</a><br /><br /><br />這篇主要教大家怎麼寫一個簡單的應用，<br />在後面會教大家怎麼接上藍芽模組，然後透過無線的方式和Arduino溝通！<br />基本上要做到下列的事項<br /><br /><ol><li>購買Arduino電路板</li><li>下載Arduino IDE開發工具</li><li>在電腦上安裝Arduino的Driver</li><li>寫個簡單應用並部屬上去Arduino</li></ol><br /><b><span style="font-size: large;">【第一步、購買Arduino】</span></b><br />在開發前，大家一定要有一塊Arduino電路板，<br />基本上在Y拍就買得到了，一塊基本的價格大概在600~1000左右！<br />因為其實Arduino板子有分很多種，且有的還算是加強版！<br />但都大同小異。<br />我買的板子是Duemilanove版本，如圖！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-sN72o_XlMx8/UBMQ_RihaGI/AAAAAAAAAzM/oPSP0dbtwpk/s1600/IMG_20120728_054118.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="300" src="http://3.bp.blogspot.com/-sN72o_XlMx8/UBMQ_RihaGI/AAAAAAAAAzM/oPSP0dbtwpk/s400/IMG_20120728_054118.jpg" width="400" /></a></div><br /><br /><span style="font-size: large;"><b>【第二步、下載Arduino IDE】 </b></span><br />接著得去下載開發工具，<br />才能寫程式，並燒到Arduino上面去。<br />下載網址：<a href="http://arduino.cc/en/Main/Software">http://arduino.cc/en/Main/Software</a> <br />下載下來以後，就解壓縮出來即可。<br /><br /><br /><br /><b><span style="font-size: large;">【第三步、安裝Driver】 </span></b><br />接著把Arduino接上電腦，如下圖，<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-uI9qyEXk_dc/UBMRHlyanXI/AAAAAAAAAzU/X9oEw4_uJ24/s1600/IMG_20120728_054835.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://4.bp.blogspot.com/-uI9qyEXk_dc/UBMRHlyanXI/AAAAAAAAAzU/X9oEw4_uJ24/s320/IMG_20120728_054835.jpg" width="320" /></a></div>基本上你的電腦應該找不到Driver，<br />這時候就【我的電腦點選右鍵】→【點選管理】→【點選裝置管理員】<br />基本上應該就會看到無法辨識的設備，<br />在該設備上點選右鍵，選擇內容。<br />然後接著就自己去尋找Driver的路徑，<br />而Driver就在第二步下載下來的檔案當中，<br />在解壓縮出來的資料夾當中\arduino-1.0.1\drivers。<br />安裝完成以後，請記得自己的Serial Port！！（像我的就是21，如下圖）<br />因為等等會透過此Port把程式燒進去。<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-GKGHJUHOiFY/UBMQj7W04pI/AAAAAAAAAy8/S6_wfgFsgOs/s1600/5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="80" src="http://3.bp.blogspot.com/-GKGHJUHOiFY/UBMQj7W04pI/AAAAAAAAAy8/S6_wfgFsgOs/s320/5.png" width="320" /></a></div><br /><br /><b><span style="font-size: large;">【第四步、寫個應用】 </span></b><br />首先先打開Arduino IDE，<br />就在第二步中解壓縮的資料夾當中，<br />檔名為arduino.exe。<br />打開以後會見到下圖。<br />而白色的區塊就是你可以寫code的地方。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-EC2IyUkb088/UBMQgIqu-RI/AAAAAAAAAyc/v4FIcmZiuD8/s1600/1.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/-EC2IyUkb088/UBMQgIqu-RI/AAAAAAAAAyc/v4FIcmZiuD8/s320/1.JPG" width="238" /></a></div><br /><br />接著得點選Tool→Board，如下圖<br />先選擇你購買的Arduino電路板版本，像我是Duemilanove，<br />所以就選這個！<br />如果你選錯，基本上是無法upload到Arduino板子上去的！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-ietO9fuZtq0/UBMQg-gdhrI/AAAAAAAAAyk/HQrNWqlh35o/s1600/2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="315" src="http://4.bp.blogspot.com/-ietO9fuZtq0/UBMQg-gdhrI/AAAAAAAAAyk/HQrNWqlh35o/s640/2.png" width="640" /></a></div><br />接著就選擇第三步中的Serial Port，像我是21，所以就選21，<br />如下圖。<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-sO6zqPybv8k/UBMQhURq0aI/AAAAAAAAAys/hA9qnuPy9-8/s1600/3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="366" src="http://2.bp.blogspot.com/-sO6zqPybv8k/UBMQhURq0aI/AAAAAAAAAys/hA9qnuPy9-8/s640/3.png" width="640" /></a></div><br /><br />接著就可以開始寫程式了，<br />首先我先說明一下，基本上你們購買的Arduino板子上，<br />一定會有一個小小的LED燈，<br />而這LED燈是連接到pin腳為13的pin上。如下圖<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-JUr-DuoAbdg/UBMQvAyNtDI/AAAAAAAAAzE/t-fzi8X4vFE/s1600/IMG_201207228_054118.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="480" src="http://2.bp.blogspot.com/-JUr-DuoAbdg/UBMQvAyNtDI/AAAAAAAAAzE/t-fzi8X4vFE/s640/IMG_201207228_054118.jpg" width="640" /></a></div><br /><br />而我們現在就要寫一個程式去開關該led燈。<br />CODE如下：<br /><pre class="brush: java">// 先宣告Pin腳位置<br />int iPinLed = 13;<br />void setup() {           <br />  // 宣告該Pin腳是output  <br />  pinMode(iPinLed, OUTPUT);     <br />}<br />void loop() {<br />  // 開始寫資料，寫HIGH進去就是讓它亮<br />  digitalWrite(iPinLed, HIGH); <br />  delay(1000);        <br />　// 寫LOW進去就是讓它暗<br />  digitalWrite(iPinLed, LOW);   <br />  delay(1000);             <br />}<br /></pre><br />基本上Arduino的程式分了兩個區塊<br /><br /><ol><li>setup</li><li>loop</li></ol>setup就是傳統的main，也可以想成是constructor，<br />loop就是會一直執行的部分，可以想成for迴圈。<br />而上述的程式中，我們先宣告了一個整數(iPinLed)，代表pin腳的位置，<br />接著在setup中把它宣告成是做輸出的動作，也就是說我們會透過這個pin腳餵資料給led<br />然後就進入loop，第一行就是讓led變亮，<br />接著就delay一秒鐘，<br />之後又把led關掉。<br />又停了一秒。<br />不斷的重複上述步驟。<br />而程式的結果如下列影片。<br />LED燈會一閃一閃的！<br /><br /><div class="separator" style="clear: both; text-align: center;"><object width="320" height="266" class="BLOG_video_class" id="BLOG_video-e338391bc4bf5307" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="//www.youtube.com/get_player" /><param name="bgcolor" value="#FFFFFF" /><param name="allowfullscreen" value="true" /><param name="flashvars" value="flvurl=http://redirector.googlevideo.com/videoplayback?id%3De338391bc4bf5307%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1450516984%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3DA0FC7A3189FB9ED0BD788D826D17DE4490654.6B757629731B92C0E7FB6DCC6A08B8FA46E3D406%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3De338391bc4bf5307%26offsetms%3D5000%26itag%3Dw160%26sigh%3DEKWSP7lBmNlXqcU-3ib3oa3O_Tk&amp;autoplay=0&amp;ps=blogger" /><embed src="//www.youtube.com/get_player" type="application/x-shockwave-flash" width="320" height="266" bgcolor="#FFFFFF" flashvars="flvurl=http://redirector.googlevideo.com/videoplayback?id%3De338391bc4bf5307%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1450516984%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3DA0FC7A3189FB9ED0BD788D826D17DE4490654.6B757629731B92C0E7FB6DCC6A08B8FA46E3D406%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3De338391bc4bf5307%26offsetms%3D5000%26itag%3Dw160%26sigh%3DEKWSP7lBmNlXqcU-3ib3oa3O_Tk&amp;autoplay=0&amp;ps=blogger" allowfullscreen="true" /></object></div><br /><br /><br /><br />&nbsp;從上述的例子來看或許有點過於單調，<br />但就像本文一開始所說的，<br />Arduino可以接上許多裝置，然後透過Arduino控制該裝置。<br />像此文就是透過Arduino去控制單一LED。<br />你可以想像如果你有一百顆LED，你也可以通通接上 Arduino&nbsp;，<br />然後透過Arduino去控制那一百顆LED。<br /><br />然後在後面的文章將會介紹怎麼透過Arduino去控制機器手臂。<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/07/28/arduino" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Bluetooth API</h1>

      <div class="entry">
        這篇主要教大家怎麼用Bluetooth API去<br /><br /><ol><li><span style="background-color: white;">搜尋裝置</span></li><li><span style="background-color: white;">連結</span><span style="background-color: white;">裝置</span></li><li><span style="background-color: white;">傳送指令至裝置上</span></li></ol><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;">首先要先宣告下列三個物件與常數，</span><br /><pre class="brush: java">private static BluetoothAdapter mBluetoothAdapter = null; // 用來搜尋、管理藍芽裝置<br />private static BluetoothSocket mBluetoothSocket = null; // 用來連結藍芽裝置、以及傳送指令<br />private static final UUID MY_UUID = UUID.fromString("00001101-0000-1000-8000-00805F9B34FB"); // 一定要是這組<br />private static  OutputStream mOutputStream = null;<br />private final int REQUEST_ENABLE_BT=1;<br /></pre><br />第一個物件是用來判斷android的藍芽是否有開啟，<br />或者可不可以用，以及利用該物件去搜尋裝置。<br />第二個物件是用來連結藍芽裝置的，<br />第三個常數是固定的，因為連線是用serial port，所以固定用這組。<br />第四個是等等用來傳指令的outputStream<br /><br /><br />接著下面的code，是用來做init的動作<br /><pre class="brush: java">mBluetoothAdapter = BluetoothAdapter.getDefaultAdapter();<br />if (mBluetoothAdapter == null) {<br />    // 如果裝置不支援藍芽<br />    Toast.makeText(this, "Device doesn't support bluetooth", Toast.LENGTH_SHORT).show();<br />    return;<br />}<br />        <br />// 如果藍芽沒有開啟<br />if (!mBluetoothAdapter.isEnabled()) {<br />    // 發出一個intent去開啟藍芽，<br />        Intent mIntentOpenBT = new Intent(BluetoothAdapter.ACTION_REQUEST_ENABLE);<br />        startActivityForResult(mIntentOpenBT, REQUEST_ENABLE_BT);<br />}<br /></pre><br />上段的第二個if當中，如果你手機的藍芽未開啟，<br />會進到if，進到if以後就會發出一個intent request去開啟藍芽，<br />基本上會看到下面的畫面，會詢問你是否要開啟藍芽。<br />如果按下Yes，接著會在onActivityResult接收到。<br />這裡就不多做說明。<br />這裡假設手機的藍芽已經開啟。<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-6t-85UEG1tk/UBLP9Y52t2I/AAAAAAAAAxs/LrjonTfTQB0/s1600/Screenshot_2012-07-28-01-26-28.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-6t-85UEG1tk/UBLP9Y52t2I/AAAAAAAAAxs/LrjonTfTQB0/s400/Screenshot_2012-07-28-01-26-28.png" width="225" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />接著下段code是去判斷這台手機裡面，<br />是否有已經配對過的藍芽裝置，<br />當然，你也可以在for迴圈中判斷是否有你要連結的裝置名稱，<br />有的話，就可以直接在這裡連結至裝置。<br />但這裡假設我們要連結的裝置還沒有配對過<br /><pre class="brush: java">// 取得目前已經配對過的裝置<br />Set&lt;bluetoothdevice&gt; setPairedDevices = mBluetoothAdapter.getBondedDevices();<br />        <br />// 如果已經有配對過的裝置<br />if (setPairedDevices.size() &gt; 0) {<br />    // 把裝置名稱以及MAC Address印出來<br />    for (BluetoothDevice device : setPairedDevices) {<br />        mArrayAdapter.add(device.getName() + "\n" + device.getAddress());<br />    }<br />}</pre><br /><br /><br />接下來我們要註冊一個BroadcastReceiver，主要是用來接收【搜尋到附近藍芽裝置】的訊息<br /><pre class="brush: java">// 註冊一個BroadcastReceiver，等等會用來接收搜尋到裝置的消息<br />IntentFilter filter = new IntentFilter(BluetoothDevice.ACTION_FOUND);<br />registerReceiver(mReceiver, filter); <br />mBluetoothAdapter.startDiscovery(); //開始搜尋裝置<br /></pre><br /><br /><br /><br />接著要宣告上段code使用到的BroadcastReceiver，<br /><pre class="brush: java">private final BroadcastReceiver mReceiver = new BroadcastReceiver() {<br />        public void onReceive(Context context, Intent intent) {<br />            // 當收尋到裝置時<br />            if (BluetoothDevice.ACTION_FOUND.equals(intent.getAction())) {<br />                // 取得藍芽裝置這個物件<br />                BluetoothDevice device = intent.getParcelableExtra(BluetoothDevice.EXTRA_DEVICE);<br />                <br />                // 判斷那個裝置是不是你要連結的裝置，根據藍芽裝置名稱判斷<br />                if (device.getName().equals("MY_DEVICE_ID")){<br />                    try {<br />                        // 一進來一定要停止搜尋<br />                        mBluetoothAdapter.cancelDiscovery(); <br />             <br />                        // 連結到該裝置<br />                        mBluetoothSocket = device.createInsecureRfcommSocketToServiceRecord(MY_UUID);<br />                        mBluetoothSocket.connect();<br />             <br />                        // 取得outputstream<br />                        mOutputStream = mBluetoothSocket.getOutputStream();<br />             <br />                        // 送出訊息<br />                        String message = "hello";<br />                        mOutputStream.write(message.getBytes());<br />             <br />                        } catch (IOException e) {<br />      <br />                        }<br />                }<br />           <br />            }<br />       }<br />};</pre><br /><br /><br />在上段code中的連結到該裝置的code，基本上會看到下圖，<br />要你輸入配置碼，輸入以後，就可以連結到該裝置，<br />並且可以傳送訊息到你的藍芽裝置上去了。<br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-WVTTM4fboYw/UBLTl693CnI/AAAAAAAAAyI/Dt1_NfeKrxg/s1600/Screenshot_2012-07-28-01-34-31.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/-WVTTM4fboYw/UBLTl693CnI/AAAAAAAAAyI/Dt1_NfeKrxg/s400/Screenshot_2012-07-28-01-34-31.png" width="225" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />最後，記得要在關閉程式，或者暫停時，<br />把連線關掉!<br /><pre class="brush: java">@Override<br />protected void onPause() {<br />    super.onPause();<br />    try {<br />        if (mBluetoothSocket.isConnected()){<br />            mBluetoothSocket.close();<br />        }<br />        unregisterReceiver(mReceiver);<br />    } catch (IOException e) {<br />        e.printStackTrace();<br />    }<br />}<br /></pre><br /><br /><br /><br />恩，下一篇會教學大家怎麼用Android透過藍芽連結到Arduino電路板上去。
      </div>

      <a href="/2012/07/28/android-bluetooth-api" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>在Amazon EC2-  send gmail 問題</h1>

      <div class="entry">
        用Java寄MAIL不是這篇的重點，<br />反正主要是用JavaMail API就是了!<br />code 如下，就不多做說明：<br /><pre class="brush: java">            final String MAIL_HOST = "smtp.gmail.com";   // gmail的smtp<br />            final String GMAIL_ACCOUNT = "XXXXX@gmail.com";  //gmail account<br />            final String GMAIL_PASSWORD = "XXXXX";    // gmail pwd<br />            final String strRecipients = "xxx@gmail.com"; // 收件人<br />            final String strSender = "ejustmake@gmail.com";  // 寄件人名稱<br />            Security.addProvider(new com.sun.net.ssl.internal.ssl.Provider());<br /><br />            Properties props = new Properties();<br />            props.setProperty("mail.transport.protocol", "smtp");<br />            props.setProperty("mail.host", MAIL_HOST);<br />            props.put("mail.smtp.auth", "true");<br />            props.put("mail.smtp.port", "465");<br />            props.put("mail.smtp.socketFactory.port", "465");//smtp PORT 528好像也可以<br />            props.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");<br />            props.put("mail.smtp.socketFactory.fallback", "false");<br />            props.setProperty("mail.smtp.quitwait", "false");<br />            <br />            <br />   // Authenticate的動作 <br />            Session session = Session.getDefaultInstance(props,<br />                    new javax.mail.Authenticator() {<br />                        protected PasswordAuthentication getPasswordAuthentication() {<br />                            String account = GMAIL_ACCOUNT;<br />                            String pass = GMAIL_PASSWORD;<br />                            return new PasswordAuthentication(account, pass);<br />                        }<br />            });<br />            <br /><br />            MimeMessage message = new MimeMessage(session);<br />            message.setstrSender(new InternetAddress(strSender));<br />            message.setSubject("Mail標題", "UTF-8");<br />            message.setContent(strBody, "text/html;charset=utf-8");//這裡用text/html就可以傳網頁的內容！<br /><br />            message.setstrRecipients(Message.RecipientType.TO, InternetAddress.parse(strRecipients));<br />            Transport.send(message);<br /><br /></pre><br /><br />然後這段code在任何一台host上，甚至local上都可以run，<br />但是打包成war搬上去ec2以後就出現AuthenticationFail問題.....<br />恩，主要問題是被Google擋住了！<br />因為我用的帳號平常是在台灣進行登入！<br />可是搬上去ec2以後...因為主機是在美國，<br />所以變成IP變成從美國登入...<br />會被擋住，但是GOOGLE會發一封MAIL給你，<br />內容如下圖，反正就是詢問這是不是你，如果是你，<br />就點下圖中的紅色框框，點了以後按照步驟做，<br />然後再用你的應用程式登入一次，就成功了！<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-EAIGVKFlLZ4/UApcPcfDdNI/AAAAAAAAAxY/QBBUCnqIQpk/s1600/Untitled.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="348" src="http://1.bp.blogspot.com/-EAIGVKFlLZ4/UApcPcfDdNI/AAAAAAAAAxY/QBBUCnqIQpk/s640/Untitled.png" width="640" /></a></div><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/07/21/amazon-ec2-send-gmail" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Eclipse 安裝 AWS Plugin</h1>

      <div class="entry">
        Amazon有推出一套plugin for eclipse，<br />可以讓使用者在eclipse開發Java Application或者J2EE，<br />然後deploy上去<a href="http://aws.amazon.com/elasticbeanstalk/">AWS Elastic Beanstalk</a>!<br /><br /><br />當然你也可以自己在本機寫好，<br />然後用FTP將project上傳到你的EC2上面去!<br />利用這樣的方式去執行!<br />但這邊提供一個利用Eclipse Deploy上去的方法!<br /><br /><br />而<a href="http://aws.amazon.com/elasticbeanstalk/">AWS Elastic Beanstalk</a>是Amazon推出的PaaS平台!<br />開發者一樣不用去管Infrastructure!<br />但是當你Deploy上去，Amazon可是會自動幫你create一個EC2的唷!<br />所以還是要注意費用!<br />不過這個EC2的AMI是選用Amazon Linux AMI，這個AMI也是有Free Usage Tier的!<br />但還是要注意一下別超過配額!<br /><br />至於詳細的<a href="http://aws.amazon.com/elasticbeanstalk/">AWS Elastic Beanstalk</a>介紹可以去官網看!<br />或者等待我下一篇的介紹吧!<br /><br />這篇主要介紹如何安裝Plugin至Eclipse上!<br />這裡建議您使用<a href="http://www.eclipse.org/downloads/packages/eclipse-ide-java-ee-developers/indigosr2">Eclipse J2EE</a>的版本比較方便後面的開發!<br />當然你也可以使用Eclipse Classic 的版本，(我自己是使用Classic)<br />只是就要去安裝<a href="http://www.eclipse.org/webtools/">WTP</a>!<br /><a href="http://www.eclipse.org/webtools/">WTP</a>是一個plugin可以讓你在Eclipse Classic版本中開發Java Web(jsp, jsf..etc)!<br />這裡就不另作說明了!<br /><br />首先先開啟你的 Eclipse，<br />然後點選Help-&gt; Install New Software<br />如下圖!<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-wXc4vSgX09c/T4Gy4Ji5f3I/AAAAAAAAAoQ/u0Acnq9OzcU/s1600/1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://1.bp.blogspot.com/-wXc4vSgX09c/T4Gy4Ji5f3I/AAAAAAAAAoQ/u0Acnq9OzcU/s1600/1.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">接著點選下圖中的Add，然後輸入AWS Plugin的位置!&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-UaE0V39l554/T4Gy4uBPv5I/AAAAAAAAAoU/eI0qyIepiuc/s1600/2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="376" src="http://3.bp.blogspot.com/-UaE0V39l554/T4Gy4uBPv5I/AAAAAAAAAoU/eI0qyIepiuc/s640/2.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div>&nbsp;接著就勾選下圖中的AWS Toolkit for Eclipse，然後進行安裝!<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-40QC3p8asfw/T4Gy5RZ8i6I/AAAAAAAAAog/jRrWgBM811s/s1600/3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="582" src="http://4.bp.blogspot.com/-40QC3p8asfw/T4Gy5RZ8i6I/AAAAAAAAAog/jRrWgBM811s/s640/3.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">安裝完成，會在Toolbar上看到Amazon的圖示!&nbsp;點選一下!&nbsp;</div><div class="separator" style="clear: both; text-align: left;">可以看到很多選項!</div><div class="separator" style="clear: both; text-align: left;">像是New AWS Java Project，</div><div class="separator" style="clear: both; text-align: left;">或者Show AWS Explorer View等等之類的!</div><div class="separator" style="clear: both; text-align: left;">但我們要先選擇Preferences，</div><div class="separator" style="clear: both; text-align: left;">要先設定一些資訊!</div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-2WRl0SM--AE/T4Gy6SMm3cI/AAAAAAAAAok/8AK7c_9x7hU/s1600/4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://1.bp.blogspot.com/-2WRl0SM--AE/T4Gy6SMm3cI/AAAAAAAAAok/8AK7c_9x7hU/s400/4.png" width="357" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;"><br /></div>&nbsp;首先我們要先建立一個Account，<br />在Account Name輸入你在AWS的帳號!<br />然後輸入你的Access Key Id以及Secret Access Key!<br />如果忘記的人可以來這<a href="https://aws-portal.amazon.com/gp/aws/securityCredentials?">https://aws-portal.amazon.com/gp/aws/securityCredentials?</a>看!<br />或者點選下圖中的"find your existing AWS security credentials."去找<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-2Nh2ITQpFeo/T4Gy7FwgmXI/AAAAAAAAAow/r-U7W2PI4A0/s1600/5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="510" src="http://3.bp.blogspot.com/-2Nh2ITQpFeo/T4Gy7FwgmXI/AAAAAAAAAow/r-U7W2PI4A0/s640/5.png" width="640" /></a></div><br /><br /><br />設定完成以後，就可以跟你的AWS連結上了!<br />我們可以點選<span style="text-align: left;">Show AWS Explorer View來看看我們AWS上的設定!</span><br /><span style="text-align: left;">點選以後，會出現下圖! 你可以用來觀看AWS上的設定!</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-5ZjBoPCmE4Q/T4Gy8L53P3I/AAAAAAAAAo0/J4BBK7uH0qE/s1600/6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/-5ZjBoPCmE4Q/T4Gy8L53P3I/AAAAAAAAAo0/J4BBK7uH0qE/s1600/6.png" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div>&nbsp;這裡我們點選Amazon EC2-&gt;Instances<br />會出現下圖! 像我AWS上面擁有兩個Instance，所以就會出現兩個!<br />當然你也可以在此Dilaog中去stop或者start甚至是reboot這個instance!<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-pH-O8Xl0Xh0/T4Gy8-iuh4I/AAAAAAAAAo8/bZQxo1WM02c/s1600/7.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-pH-O8Xl0Xh0/T4Gy8-iuh4I/AAAAAAAAAo8/bZQxo1WM02c/s1600/7.png" /></a></div><br /><br />完成上面的步驟就代表安裝成功了!<br />下一篇會說明如何Deploy一個Project上去<a href="http://aws.amazon.com/elasticbeanstalk/">AWS Elastic Beanstalk</a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/04/09/eclipse-aws-plugin" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Amazon SimpleDB 操作 (Java)</h1>

      <div class="entry">
        <a href="http://aws.amazon.com/simpledb/">SimpleDB </a>是Amazon提供的一種NoSQL DATABASE!<br />詳細說明去官網看吧!<br /><br /><br />這篇主要會教大家如何<br />建立一張table，<br />新增資料<br />刪除資料<br />查詢資料<br /><br /><br />首先要先宣告一些必備的參數，<br /><pre class="brush: java">// 你的table name(在Relational Database叫做table，這裡叫做domain)<br />  final String DOMAIN_NAME = "member";<br />  <br />  // 取得憑證，這檔案預設在/src底下<br />  AWSCredentials credentials = new PropertiesCredentials(getClass().getClassLoader().getResourceAsStream("AwsCredentials.properties"));<br />  <br />  // 宣告一個SimpleDB<br />  AmazonSimpleDB sdb = new AmazonSimpleDBClient(credentials);<br />     <br /></pre><br />接著就建立一個table，<br /><pre class="brush: java">// 建立一個table(在Relational Database叫做table，這裡叫做domain)<br />  sdb.createDomain(new CreateDomainRequest(DOMAIN_NAME));<br /></pre><br /><br />在SimpleDB的新增分成兩種方式!<br />一種是一筆一筆的新增，<br />另一種是批次的新增!(一次新增多筆)<br />有玩過GAE的大概知道，其實GAE也是這樣!<br />多筆的話就是用一個list存放資料!<br /><br />在這邊先介紹一次新增多筆的!<br /><pre class="brush: java">// 先宣告一個List，List擺放的型態為ReplaceableItem，這型態意思是如果table裡面已經有一筆Ken的資料，那麼就取代掉那筆，不會多一筆<br />  List&lt;ReplaceableItem&gt; listAddData = new ArrayList&lt;ReplaceableItem&gt;();<br /><br /><br />  // 第一筆資料<br />  // 先new一個Item，Item Name是Ken，然後這個item有四個attribute!分別是Sex, Tel, Mail, Nickname<br />  listAddData.add(new ReplaceableItem("Ken").withAttributes(<br />       new ReplaceableAttribute("Sex", "boy", true),<br />       new ReplaceableAttribute("Tel", "09123456", true),<br />       new ReplaceableAttribute("Mail", "xxx@kenyang.net", true),<br />       new ReplaceableAttribute("Nickname", "KenYang", true)));<br /> <br />  // 第二筆<br />  listAddData.add(new ReplaceableItem("Sam").withAttributes(<br />       new ReplaceableAttribute("Sex", "boy", true),<br />       new ReplaceableAttribute("Tel", "09123456", true),<br />       new ReplaceableAttribute("Mail", "xxx@kenyang.net", true),<br />       new ReplaceableAttribute("Nickname", "SamYang", true)));<br /><br /><br />  // 接著就新增吧!記得要指定Domain name!<br />  sdb.batchPutAttributes(new BatchPutAttributesRequest(DOMAIN_NAME, listAddData));<br /><br /></pre><br /><br /><br />接著要介紹新增一筆的! 其實大同小異，只是要宣告一個PutAttributesRequest來擺放資料!<br />一個PutAttributeRequest就代表一筆資料!<br /><pre class="brush: java">PutAttributesRequest dataAttribute = new PutAttributesRequest().withDomainName(DOMAIN_NAME).withItemName("John"); <br />     <br />  dataAttribute.getAttributes().add(        <br />       new ReplaceableAttribute()<br />           .withName("Sex")<br />           .withValue("girl")<br />           .withReplace(true));<br />     <br />  dataAttribute.getAttributes().add(        <br />       new ReplaceableAttribute()<br />           .withName("Tel")<br />           .withValue("0987123")<br />           .withReplace(true));<br />  <br />  dataAttribute.getAttributes().add(        <br />       new ReplaceableAttribute()<br />           .withName("Mail")<br />           .withValue("xxx@gmail.com")<br />           .withReplace(true));<br />     <br />  dataAttribute.getAttributes().add(        <br />       new ReplaceableAttribute()<br />           .withName("Nickname")<br />           .withValue("JohnYang")<br />           .withReplace(true));     <br />     <br />  sdb.putAttributes(dataAttribute);     <br /><br /></pre><br /><br /><br />接下來要介紹刪除! 這邊是介紹一次刪除多筆的!<br />一樣是用一個List去存放要刪除的Item Name!<br />至於刪除單筆，也跟上述方法一樣! 這裡就不多作介紹!<br /><pre class="brush: java">List&lt;DeletableItem&gt; listDeleteData = new ArrayList&lt;DeletableItem&gt;();<br />  listDeleteData.add(new DeletableItem().withName("Ken"));<br />  listDeleteData.add(new DeletableItem().withName("Sam"));<br />  // 所以Ken和Sam這兩筆資料會被刪除<br />  sdb.batchDeleteAttributes(new BatchDeleteAttributesRequest(DOMAIN_NAME,listDeleteData));<br /><br /></pre><br /><br />最後要介紹查詢了!<br /><pre class="brush: java">// 注意，傳統的SQL指令，都是用單引號(')，但是這裡要用(`)<br />     String selectExpression = "select * from `" + DOMAIN_NAME + "` ";<br />     SelectRequest selectRequest = new SelectRequest(selectExpression);<br />     SelectResult sr = sdb.select(selectRequest);<br />  <br />     for (Item item : sr.getItems()) {<br />          response.getWriter().println(item.getName());<br />          response.getWriter().println(item.getAttributes().get(0).getValue());<br />     }<br /><br /></pre><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/04/08/amazon-simpledb-java" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Amazon ElasticBeanstalk Health Check URL</h1>

      <div class="entry">
        今天Deploy上去ElasticBeanstalk 以後...<br />一直發生error!<br />status一直是紅燈!<br />連都不能連....<br />查了一下!<br />原來Amazon會去check我的首頁!<br />如果首頁有出現任何error，那麼我的service就會被中斷連不上去!<br />剛好我今天首頁有error code.. 所以就被中斷連不上去!<br /><br />更正以後就沒事了!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/04/07/amazon-elasticbeanstalk-health-check" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>用SSH免key連線至Amazon EC2</h1>

      <div class="entry">
        <br />有用過EC2的應該都知道，<br />一定要有key才能使用SSH連線!<br />就算你有帳號, 密碼都會被拒絕連線!<br /><br />這篇要教大家不用使用key!<br />直接輸入帳號、密碼就可以登入!<br /><br /><br />首先先使用SSH連線至EC2上去，<br />如果不知道怎麼連線的，可以去我<a href="http://blog.kenyang.net/2012/04/puttyamazon-ec2.html">上一篇教學</a>看!<br />連線以後，建立一個新的使用者!<br />指令如下:<br /><pre class="brush: java">sudo adduser kenyang<br /></pre><br />輸入完，會要你輸入密碼以及一些相關資訊!<br />接著如果你想要讓kenyang這個帳號也可以使用sudo的話!<br />就要輸入下列指令<br /><pre class="brush: java">sudo visudo<br /></pre>接著，就去修改裡面的設定檔案，<br />請加入下列指令，<br /><pre class="brush: java">kenyang ALL=(ALL) ALL<br /></pre>儲存以後就離開!<br /><br />然後接著就是要設定ssh可以使用帳密登入了!<br />請先使用vim開啟設定檔案!<br />指令如下：<br /><pre class="brush: java">sudo vim /etc/ssh/sshd_config<br /></pre>打開以後，找到下圖中的那一行！(PasswordAuthentication)<br />將它改成yes!<br />接著儲存離開！<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-qMhbdGHZlO4/T36EB23MRsI/AAAAAAAAAoI/phZ3fQRlV7Q/s1600/9.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="251" src="http://2.bp.blogspot.com/-qMhbdGHZlO4/T36EB23MRsI/AAAAAAAAAoI/phZ3fQRlV7Q/s400/9.png" width="400" /></a></div><br />然後就重開ssh，指令如下：<br /><pre class="brush: java">sudo /etc/init.d/ssh restart<br /></pre><br /><br />完成以後，你就能使用帳號、密碼登入了！<br />不用每次都要附上Key這麼麻煩！！！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/04/06/sshkeyamazon-ec2" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>使用PuTTY連線至Amazon EC2</h1>

      <div class="entry">
        其實在講這篇之前，<br />似乎應該先教大家怎麼在EC2上建立一個Instance，<br />不過其實建立Instance沒有太大的難度，<br />所以這裡就省略了!<br /><br /><br />不過在建立一個Instance時，<br />需注意下列幾點<br />1. 將ssh開啟!<br />2. 將EC2給我們的key-pair下載下來! &nbsp;(例如：kenyang.pem）<br />3. 記下我們instance的public DNS！（例如：ec2-xxxx-xxx-xxx-xxx.compute-1.amazonaws.com）<br /><br />如果你是用linux，可以直用command去連線！<br />如下：<br /><pre class="brush: java">ssh -i kenyang.pem ubuntu@ec2-xxxx-xxx-xxx-xxx.compute-1.amazonaws.com<br /></pre><br /><br />在window上就可以利用<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">putty</a>進行ssh連線！<br />所以請先去下載<a href="http://www.chiark.greenend.org.uk/~sgtatham/putty/download.html">putty</a>!<br />以及也一併下載<span style="background-color: white;">PuTTYgen，</span><span style="background-color: white;">PuTTYgen是用來將.pem檔轉換成.ppk！</span><br /><span style="background-color: white;">putty只吃這個格式！</span><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;">下載完成PuTTY以及PuTTYgen以後</span><br />請先開啟<span style="background-color: white;">PuTTYgen這個軟體!</span><br />開啟以後，請點選conversations-&gt;Import Key<br />如下圖!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-IfgB1X_iVBA/T356N8RG-FI/AAAAAAAAAn0/rt5E9D2dIFg/s1600/7.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="386" src="http://2.bp.blogspot.com/-IfgB1X_iVBA/T356N8RG-FI/AAAAAAAAAn0/rt5E9D2dIFg/s400/7.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">Import完以後，畫面會像下圖一樣!</div><div class="separator" style="clear: both; text-align: left;">接著就按下下圖中的按鈕(Save private key)</div><div class="separator" style="clear: both; text-align: center;"><br /></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-pLecpQwJjo8/T356Or0Nj_I/AAAAAAAAAn8/DzY1esC9cuI/s1600/8.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="391" src="http://2.bp.blogspot.com/-pLecpQwJjo8/T356Or0Nj_I/AAAAAAAAAn8/DzY1esC9cuI/s400/8.png" width="400" /></a></div><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;">接著就可以打開</span><span style="background-color: white;">PuTTY!</span><br /><span style="background-color: white;">然後把我們的DNS輸入到Host Name!</span><br /><span style="background-color: white;">然後再點選左邊的SSH，把它點開!</span><br /><span style="background-color: white;">如下圖!</span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-4MCL2gBF-i4/T356MLFp2eI/AAAAAAAAAno/MzCCSW5RTSE/s1600/5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="382" src="http://1.bp.blogspot.com/-4MCL2gBF-i4/T356MLFp2eI/AAAAAAAAAno/MzCCSW5RTSE/s400/5.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">點開以後，點選Auth，再點選Browse，找到我們剛剛儲存的.ppk檔以後，</div><div class="separator" style="clear: both; text-align: left;">就點選Open，就能進行連線了!</div><div class="separator" style="clear: both; text-align: left;">如下圖!</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-wwUxc0Gmsdo/T356NFY_4oI/AAAAAAAAAns/I5dURUTtbXQ/s1600/6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="388" src="http://1.bp.blogspot.com/-wwUxc0Gmsdo/T356NFY_4oI/AAAAAAAAAns/I5dURUTtbXQ/s400/6.png" width="400" /></a></div><span style="background-color: white;"><br /></span><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;"><br /></span><br /><span style="background-color: white;"><br /></span>
      </div>

      <a href="/2012/04/06/puttyamazon-ec2" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Cloud Foundry 環境建置與開發</h1>

      <div class="entry">
        <a href="http://www.cloudfoundry.com/">Cloud Foundry</a>是一個Open Source的PaaS平台!<br />還蠻有趣的!<br />你可以在自己的電腦上架起一個vm，<br />然後變成一個PaaS平台!<br />這裡就不多做說明了!<br />想知道細節可以去<a href="http://www.cloudfoundry.com/">Cloud Foundry官方網站看</a><br /><br /><br /><br />這篇主要會涉及到<br /><br /><ol><li>註冊，以及申請domain</li><li>所需軟體下載以及環境安裝</li><li>與Server連結</li><li>掛載VM</li><li>Deploy上去</li></ol><br /><br /><span style="font-size: x-large;"><b>【註冊以及申請domain】</b></span><br /><br />首先要先來<a href="http://my.cloudfoundry.com/signup">http://my.cloudfoundry.com/signup</a>註冊，<br />註冊大概一天以後，就可以收到approve mail!!<br />這個MAIL會把密碼寄給你! &nbsp; 是亂數產生的!<br /><br />收到密碼以後就去登入，<a href="https://my.cloudfoundry.com/micro">https://my.cloudfoundry.com/micro</a><br />登入後，會到管理介面，要你輸入一個sub-domain，<br />如下圖!<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-B4RjU2KETUE/T30qKGLoHPI/AAAAAAAAAmc/yJVaE_vqbIY/s1600/7.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="340" src="http://2.bp.blogspot.com/-B4RjU2KETUE/T30qKGLoHPI/AAAAAAAAAmc/yJVaE_vqbIY/s640/7.png" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">輸入完以後，按下create，會回傳給你一組token，如下圖</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-6TqIO_KXTZw/T30qKsgsW7I/AAAAAAAAAmk/Sms5dreYS5k/s1600/8.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="235" src="http://1.bp.blogspot.com/-6TqIO_KXTZw/T30qKsgsW7I/AAAAAAAAAmk/Sms5dreYS5k/s640/8.png" width="640" /></a></div><br /><br /><br /><br /><br /><br /><br /><b style="font-size: xx-large;">【軟體下載以及安裝】</b><br /><br />這邊的步驟稍嫌多了點!<br />除了要下載IDE以外，還要下載CloudFoundry提供給你的VM映像檔!<br />所以這段落會分為三節進行說明<br /><br /><br /><b><span style="font-size: large;">&nbsp; &nbsp; 【下載STS以及安裝Cloud Foundry Plugin】</span></b><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 首先去<a href="http://www.springsource.org/downloads/sts">下載STS</a>(Springsource Tool Suite)，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;這是以Eclipse為base的IDE開發工具!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;可以用它來開發SpringMVC相關project，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;因為CloudFoundry上有支援Spring的架構!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;所以我們用STS這套做開發!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;當然也可以用Eclipse，it depends on you.<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;因為CloudFoundry上也支援普通的Java Web，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;所以不一定要用STS!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;但不管你用STS，還是Eclipse，下面的安裝plugin步驟都是相同的!<br /><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;如果你下載完成STS，就把它解壓縮!(和ECLIPSE一樣)<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;壓縮完就能執行!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;打開以後!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;點選Help-&gt; Install New Software，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;然後輸入這串網址：&nbsp; http://dist.springsource.com/snapshot/TOOLS/nightly/cloudfoundry<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;然後就點選Next<br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;如下圖!!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-H6Vv56Lexdc/T30t6gejpdI/AAAAAAAAAmw/yrpVMZAFHKY/s1600/9.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="598" src="http://1.bp.blogspot.com/-H6Vv56Lexdc/T30t6gejpdI/AAAAAAAAAmw/yrpVMZAFHKY/s640/9.png" width="640" /></a></div><br /><br /><br /><br /><br /><br /><b><span style="font-size: large;">&nbsp; &nbsp; 【與Cloud Foundry Server連結】</span></b><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;安裝完成以後，應該會看見一個視窗，叫做server，如下圖!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;如果看不見的人，可以到Window-&gt;Show View &nbsp;底下去找!&nbsp; &nbsp; &nbsp; <br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-_39AkrHYZJQ/T30u-IoeaPI/AAAAAAAAAm4/OekM4XlcNOg/s1600/10.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/-_39AkrHYZJQ/T30u-IoeaPI/AAAAAAAAAm4/OekM4XlcNOg/s1600/10.png" /></a></div><br /><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;接著在上圖中的視窗，點選右鍵，選擇New-&gt;Server，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;之後會出現下圖中的視窗! 請點選Cloud Foundry!!!!&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;然後點選Next，<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-BlCaba6pxXk/T30vunG-tMI/AAAAAAAAAnA/nLTlpqGQ7Tg/s1600/11.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-BlCaba6pxXk/T30vunG-tMI/AAAAAAAAAnA/nLTlpqGQ7Tg/s640/11.png" width="568" /></a></div><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;點選上圖中的Next，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;會出現下圖中的視窗，請你輸入你的EMAIL以及Password!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;而URL請先選擇VWware Cloud Foundry- https://api.cloudfoundry.com這個!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;這個選項，就是會把這個Server與Clound Foundry做個連結，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;如果你將你的project上傳到這個server，且你的project name為ken的話!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;將來的網址就是ken.cloudfoundry.com!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 你可能會覺得很訝異，上面create的sub-domain呢?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 該怎麼上傳到那個sub-domain上面去?<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 就是在URL那裏選擇Microcloud那個選項!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;但是，你現在做的話，是無法與你的sub-domain server做連結!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;還要一連串的設定，所以請先選擇預設的!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 輸入完Email和Password以後，請按下Validate Account，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 通過以後，就按下Finish吧!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-av4wvNkdUyM/T30vvXQeyPI/AAAAAAAAAnI/0fMVOHaGnrk/s1600/12.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://2.bp.blogspot.com/-av4wvNkdUyM/T30vvXQeyPI/AAAAAAAAAnI/0fMVOHaGnrk/s640/12.png" width="628" /></a></div><br /><br /><br /><br /><b><span style="font-size: large;">&nbsp; &nbsp; 【建立一個Project】</span></b><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;接著在你的STS中，找到一個Dashboard的視窗!如下圖!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;如果找不到，請點選下圖中橘色框框圈起來的按鈕，按一下就會出現了!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;之後點選下圖中的Spring Template Project，如下圖中的紅色框框!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;按下以後，請選擇Spring MVC Project，然後按下next，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;就輸入Project Name，以及Package Name，<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;我這裡是預設輸入CloudFoundryUsingSpringMVC!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 這個Project預設內容想也知道，一定是pring HelloWorld，<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-qKXIBpwKWYs/T30zKJdq8WI/AAAAAAAAAnQ/DqZude6cdrc/s1600/13.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="398" src="http://2.bp.blogspot.com/-qKXIBpwKWYs/T30zKJdq8WI/AAAAAAAAAnQ/DqZude6cdrc/s640/13.png" width="640" /></a></div>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br /><b><span style="font-size: large;">&nbsp; &nbsp; 【Delpoy至Cloud Foundry Server上】</span></b><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;建立完成以後，就將你的Project拖曳至Server上!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;如下圖!<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-fxaKFsFN34U/T3005XmLksI/AAAAAAAAAnY/oNk2cWI7f70/s1600/14.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://3.bp.blogspot.com/-fxaKFsFN34U/T3005XmLksI/AAAAAAAAAnY/oNk2cWI7f70/s400/14.png" width="220" /></a></div><br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;拖曳完成以後，你會發現你的Server下面會掛載Project<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 接著在Project上點選右鍵，就可以選擇要Deploy，還是Stop了!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;Deploy以後! 如果成功! 你就可以在瀏覽器輸入網址了!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;網址會是：你的project_name.cloudfoundry.com（cloudfoundryusingspringmvc.cloudfoundry.com）<br /><br /><br /><br /><b><span style="font-size: large;">&nbsp; &nbsp; 【掛載VM，此VM就是我們的Server】</span></b><br />&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 這個章節在講掛載Cloud Foundy提供給我們的VM檔案!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;再掛載之前，請先去下載<a href="http://www.vmware.com/products/player/">VMware Player</a>!!!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;當然也可以用workstation，只是Player是free的!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;下載完player以後，請安裝! 安裝完以後!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;就去解壓縮Cloud Foundry提供給我們的檔案!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;資料夾裡面會有一個micro.vmx<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;點兩下就打開了!<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;接著就會見到下圖，請選擇1進行設定!<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-ZczmJ0ou-74/T30qHkqNdPI/AAAAAAAAAls/cIGJm7lPFq4/s1600/1.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="331" src="http://1.bp.blogspot.com/-ZczmJ0ou-74/T30qHkqNdPI/AAAAAAAAAls/cIGJm7lPFq4/s400/1.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;輸入完1以後就會見到下圖，請輸入密碼!<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-m73LtbkU3xU/T30qIIKgyEI/AAAAAAAAAlw/XfLYyBSZtu0/s1600/2.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="328" src="http://2.bp.blogspot.com/-m73LtbkU3xU/T30qIIKgyEI/AAAAAAAAAlw/XfLYyBSZtu0/s400/2.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;"><span style="text-align: -webkit-auto;">&nbsp;</span><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;輸入完密碼以後就會見到下圖，請選擇DHCP，當然也可以選擇static，但DHCP比較方便!</span>&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-P9wbtVnjlNU/T30qIUOKbHI/AAAAAAAAAl8/egN9M2bHVzs/s1600/3.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="331" src="http://2.bp.blogspot.com/-P9wbtVnjlNU/T30qIUOKbHI/AAAAAAAAAl8/egN9M2bHVzs/s400/3.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;"><span style="text-align: -webkit-auto;">&nbsp;</span><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;輸入完以後就會見到下圖，會問你有沒有HTTP proxy，預設是none，</span></div><div class="separator" style="clear: both; text-align: left;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; 如果有proxy的人就輸入，沒有<span style="text-align: -webkit-auto;">就按下enter吧!</span>&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-HOKU30Rr_R8/T30qI4I8CMI/AAAAAAAAAmE/D_qc7yO8nEo/s1600/4.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="327" src="http://4.bp.blogspot.com/-HOKU30Rr_R8/T30qI4I8CMI/AAAAAAAAAmE/D_qc7yO8nEo/s400/4.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;"></div><div class="separator" style="clear: both;"><span style="text-align: -webkit-auto;">&nbsp;</span><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;輸入完以後就會見到下圖，會叫你輸入你的domain的token!!!&nbsp;</span></div><div class="separator" style="clear: both;"><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;&nbsp;</span><span style="text-align: -webkit-auto;">就是上面create domain以後回傳給你的token，</span></div><div class="separator" style="clear: both;"><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;&nbsp;</span><span style="text-align: -webkit-auto;">請將他輸入!會問你有沒有HTTP proxy</span></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-Gy8zoEInNyM/T30qJZ_GHpI/AAAAAAAAAmM/tQUW1lGN--Y/s1600/5.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="332" src="http://1.bp.blogspot.com/-Gy8zoEInNyM/T30qJZ_GHpI/AAAAAAAAAmM/tQUW1lGN--Y/s400/5.png" width="400" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: left;"><span style="text-align: -webkit-auto;">&nbsp;</span><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;輸入完以後就會見到下面的兩張圖，代表成功掛載了!</span></div><div class="separator" style="clear: both; text-align: left;"><span style="text-align: -webkit-auto;">&nbsp;</span><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;但是先別關掉喔!!!</span></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-K-Ls1fOjCvw/T30qJzzjyzI/AAAAAAAAAmU/dlyyyvtkttI/s1600/6.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="330" src="http://3.bp.blogspot.com/-K-Ls1fOjCvw/T30qJzzjyzI/AAAAAAAAAmU/dlyyyvtkttI/s400/6.png" width="400" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-DOT8RiwykpY/T3035-jo1UI/AAAAAAAAAng/f7bIFcU2uMg/s1600/16.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="333" src="http://1.bp.blogspot.com/-DOT8RiwykpY/T3035-jo1UI/AAAAAAAAAng/f7bIFcU2uMg/s400/16.png" width="400" /></a></div><br /><br /><br /><div class="separator" style="clear: both; text-align: left;"><b><span style="font-size: large;">&nbsp; &nbsp; 【與自己的Server連結】</span></b><span style="text-align: -webkit-auto;">&nbsp;</span><span style="text-align: -webkit-auto;">&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><span style="text-align: -webkit-auto;">&nbsp;</span></div>&nbsp; &nbsp; &nbsp; &nbsp; <br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;這邊一樣跟上面【與Cloud Foundry Server連結】章節一樣!<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;只是URL選擇micro，然後輸入自己的domain!!<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;最後要重新register一個帳號喔!!!!<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;註冊完以後，就完成於自己的server連結了!<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;至於如何deploy，跟上面一樣!!!!<br />&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;只是網址就變成：project_name.domain.cloudfoundry.me　（cloudfoundryusingspringmvc.kenyang.cloudfoundry.me）<br /><br /><br />
      </div>

      <a href="/2012/04/05/cloud-foundry" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android錯誤訊息：Unable to instantiate activity</h1>

      <div class="entry">
        <span style="font-family: Courier, monospace;">今天放在market上的app，</span><br /><span style="font-family: Courier, monospace;">收到一個error report，</span><br /><span style="font-family: Courier, monospace;">report的title是java.lang.ClassNotFoundException in com.meetatcorner.android</span><br /><span style="font-family: Courier, monospace;"><br /></span><br /><span style="font-family: Courier, monospace;">發現問題在</span><span style="background-color: white; font-family: Arial, sans-serif;">PathClassLoader.findClass()，（找不到class）</span><br /><span style="font-family: Arial, sans-serif;">原來在AndroidManifest.xml中，如果你某個activity設置為HOME以及LAUNCHER，</span><br /><span style="font-family: Arial, sans-serif;">但你的activiy element中的name attribute是</span><span style="font-family: Arial, sans-serif;">下面的宣告方式的話，</span><br /><span style="font-family: Arial, sans-serif;">＂可能＂會出錯，</span><br /><pre class="brush: xml">&lt;activity android:name=".SelectLoginMode" &gt; <br /><br /><br /></pre>是＂可能＂會出錯！！因為在大部分的裝置上執行都沒有問題！！！<br />但今天卻發生了！　但為了夜長夢多，還是改成完整路徑吧！<br />應該改成如下<br /><pre class="brush: xml">&lt;activity android:name="com.meetatcorner.android.SelectLoginMode" &gt; <br /><br /><br /></pre>
      </div>

      <a href="/2012/04/04/androidunable-to-instantiate-activity" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android C2DM (四)：實作之Android篇</h1>

      <div class="entry">
        <span style="color: red; font-size: large;">這篇是舊版的，已經被deprecated，新版為GCM，新版的實作請看</span><br /><a href="http://blog.kenyang.net/2013/07/android-gcm-google-cloud_1.html"><span style="color: blue; font-size: large;">新版的Android篇</span></a><br /><br /><br /><br /><br /><span style="font-size: large;"><b>這篇主要在說明Android端的實作</b></span><br /><span style="font-size: large;"><b>第一篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm.html">參數說明</a></b></span><br /><span style="font-size: large;"><b>第二篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm_22.html">流程說明</a></b></span><br /><span style="font-size: large;"><b>第三篇在講<a href="http://blog.kenyang.net/2012/03/android-c2dm-sever.html">server端的實作</a></b></span><br /><br /><br />這篇主要會完成下列項目：<br /><ol style="background-color: white; color: #333333; font-family: Verdana, Arial, sans-serif; font-size: 13px; line-height: 16px; text-align: left;"><li>基本的manifest設定(加入receiver,permission)。</li><li>向C2DM 註冊。</li><li>接收自C2DM Sever回傳的registration id&nbsp;並傳送 Registration Id 到我們的Server，以及<span style="background-color: white;">接收Message</span></li></ol><div style="text-align: left;"><span style="color: #333333; font-family: Verdana, Arial, sans-serif; font-size: x-small;"><span style="line-height: 16px;"><br /></span></span></div><div style="text-align: left;"><span style="color: #333333; font-family: Verdana, Arial, sans-serif; font-size: x-small;"><span style="line-height: 16px;"><br /></span></span></div><div style="text-align: left;"><b style="background-color: white; color: #333333; font-family: Verdana, Arial, sans-serif; font-size: large; line-height: 16px;">【1. &nbsp;設定Manifest資料 】</b>&nbsp;<span style="color: #333333; font-family: Verdana, Arial, sans-serif; font-size: x-small;"><span style="line-height: 16px;"><br /></span></span></div><div style="text-align: left;"><span style="color: #333333; font-family: Verdana, Arial, sans-serif;"><span style="line-height: 16px;">這步驟，分了兩個部分!</span></span><br /><span style="color: #333333; font-family: Verdana, Arial, sans-serif;"><span style="line-height: 16px;">第一個就是要先加入一個receiver，</span></span><br /><span style="color: #333333; font-family: Verdana, Arial, sans-serif;"><span style="line-height: 16px;">記得下面的category android:name，</span></span><br /><span style="color: #333333; font-family: Verdana, Arial, sans-serif;"><span style="line-height: 16px;">裡面的value要改成自己的package name</span></span><br /><span style="color: #333333; font-family: Verdana, Arial, sans-serif;"><span style="line-height: 16px;">如下：</span></span></div><pre class="brush: xml">&lt;!-- 用來接收C2DM Server的receiver，且要有send的permssion --&gt;<br />        &lt;receiver android:name=".C2DMReceiver" android:permission="com.google.android.c2dm.permission.SEND"&gt;<br />            &lt;!-- Receive the actual message --&gt;<br />           &lt;intent-filter&gt;<br />               &lt;action android:name="com.google.android.c2dm.intent.RECEIVE" /&gt;<br />               &lt;category android:name="net.kenyang.android" /&gt;<br />           &lt;/intent-filter&gt;<br />           <br />           &lt;!-- Receive the registration id --&gt;<br />           &lt;intent-filter&gt;<br />               &lt;action android:name="com.google.android.c2dm.intent.REGISTRATION" /&gt;<br />               &lt;category android:name="net.kenyang.android" /&gt;<br />           &lt;/intent-filter&gt;<br />       &lt;/receiver&gt;<br /><br /></pre><br /><br />第二部分就是加入應有的permission，<br /><pre class="brush: xml">&lt;!-- 下面的net.kenyang記得要改成自己的package name --&gt;<br />&lt;permission   android:name="net.kenyang.android.permission.C2D_MESSAGE" android:protectionLevel="signature" /&gt;<br />&lt;uses-permission  android:name="net.kenyang.android.permission.C2D_MESSAGE" /&gt;<br />&lt;uses-permission  android:name="com.google.android.c2dm.permission.RECEIVE" /&gt;<br />&lt;uses-permission android:name="android.permission.INTERNET"/&gt;<br /><br /></pre><br /><b style="background-color: white; color: #333333; font-family: Verdana, Arial, sans-serif; font-size: large; line-height: 16px; text-align: left;"><br class="Apple-interchange-newline" />【2. &nbsp;向C2DM註冊 】</b><span style="text-align: left;">&nbsp;</span><br /><br />這一步驟就是啟動C2DM，並告訴C2DM要註冊，<br /><pre class="brush: java">Intent registrationIntent = new Intent("com.google.android.c2dm.intent.REGISTER");<br />registrationIntent.putExtra("app", PendingIntent.getBroadcast(SelectLoginMode.this, 0, new Intent(), 0)); // boilerplate<br />registrationIntent.putExtra("sender", "xxxxx@gmail.com"); // 記得這邊要填入當初你在第三篇註冊的MAIL<br />startService(registrationIntent);<br /><br /></pre><br /><b style="background-color: white; color: #333333; font-family: Verdana, Arial, sans-serif; font-size: large; line-height: 16px; text-align: left;">【3. &nbsp;接收與傳送資料 】</b><span style="text-align: left;">&nbsp;</span><br /><br />這一步驟就是寫一個receiver，<br />這個receiver會<br /><br /><ol><li>接收C2DM傳來的registration id，</li><li>也會接收C2DM傳來的message(這個message就是我們Server傳給C2DM的message)</li><li>並且將registration id傳送到我們第三篇實作的server上面去</li></ol><br /><br />我們先在receiver中寫一個函數將registration id傳送至我們第三篇實作的server上面去，<br />server只要收到，就會傳送資料到C2DM上!<br /><pre class="brush: java">private void fnRegistrationDone(final String strRegistrationId){<br />  try{<br />   Thread thread = new Thread(new Runnable() {<br />    <br />    @Override<br />    public void run() {<br />     HttpURLConnection conn = (HttpURLConnection) new URL("http://c2dm.kenyang.net/registration").openConnection();<br />     conn.setDoOutput(true);  <br />     conn.setUseCaches(false);  <br />     conn.setRequestMethod("GET");  // 因為在GAE上面的servlet，我是用get method<br />     conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");  <br />     conn.setRequestProperty("Content-Length", strRegistrationId.getBytes().length); // 告訴c2dm要傳送的資料長度<br />      <br />     // 送出資料<br />     OutputStream out = conn.getOutputStream();  <br />     out.write(strRegistrationId.getBytes());  <br />     out.close();  <br />      <br />     conn.fnClose();<br />     // 到這，一個註冊就完成，接著就是等著收資料<br />          <br />    }<br />   });<br />   thread.start();<br /><br />  }catch (Exception e) {<br />  }<br />  <br /> }<br /><br /></pre><br /><br />接著開始寫接收資料(registration_id, message)的code，如下：<br /><pre class="brush: java">@Override<br /> public void onReceive(Context context, Intent intent) {<br />  <br />  // 接收到C2DM的訊息<br />  if (intent.getAction().equals("com.google.android.c2dm.intent.REGISTRATION")) {<br />      <br />   String strRegistrationId = intent.getStringExtra("registration_id"); <br />   // 如果註冊失敗<br />      if (intent.getStringExtra("error") != null) {<br />          <br />    Log.d("Ken.yang", "c2dm registration fail");<br />    <br />   // Registration 成功<br />      } else if (strRegistrationId != null) {<br />       // 把registration_id傳到我們server(呼叫我們上面寫的函數)<br />       fnRegistrationDone(strRegistrationId);<br />        <br />      }<br />   <br />  } else if (intent.getAction().equals("com.google.android.c2dm.intent.RECEIVE")) {<br />   <br />   // 接收來自C2DM的MESSAGE，這message就是我們server傳給C2DM的 (可以看第三篇)<br />   if (intent.getExtras().containsKey("keyHello")){<br />    strValue =  intent.getExtras().getString("keyHello");<br />    Log.d("Ken.yang", "C2DM=== receive" + strValue);<br />   }<br />  }<br /> }<br /> <br /><br /></pre><br />完成上面步驟，就完成c2dm了！<br />也可以收到訊息了！！！！<br />因為我們<a href="http://blog.kenyang.net/2012/03/android-c2dm-sever.html">第三篇</a>server上傳送的訊息是fromKen，<br />所以這裡收到的也是fromKen!!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/03/25/android-c2dm-android" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android C2DM (三)：實作之Sever篇</h1>

      <div class="entry">
        <span style="color: red; font-size: large;">這篇是舊版的，已經被deprecated，新版為GCM，新版的實作請看</span><br /><a href="http://blog.kenyang.net/2013/07/android-gcm-google-cloud.html"><span style="color: blue; font-size: large;">新版的Server篇</span></a><br /><br /><br /><br /><br /><br />最後一篇進入到了Android C2DM的coding了!!<br />哈! 這篇存在草稿也三個月了..........<br />今天終於有一點點時間來修改!<br /><br /><br /><span style="font-size: large;"><b>第一篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm.html">參數說明</a></b></span><br /><span style="font-size: large;"><b>第二篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm_22.html">流程說明</a></b></span><br /><span style="font-size: large;"><b>這篇專注於server端的實作</b></span><br /><span style="font-size: large;"><b>下一篇才會專注於<a href="http://blog.kenyang.net/2012/03/android-c2dm-android.html">android端的實作</a></b></span><br /><br /><br /><br /><br />OK，<br />在coding之前，請先去<a href="http://code.google.com/android/c2dm/signup.html">Google官網註冊你的app</a>，<br />比較要注意的是下面兩項<br /><div><ol><li><span style="background-color: white; font-family: Arial, sans-serif; font-size: 13px; font-weight: bold;">Package name of your Android app&nbsp;</span><span class="ss-required-asterisk" style="background-color: white; color: #c43b1d; font-family: Arial, sans-serif; font-size: 13px; font-weight: bold;">*</span></li><li><span style="background-color: white; font-family: Arial, sans-serif; font-size: 13px; font-weight: bold;">Role (sender) account email&nbsp;</span><span class="ss-required-asterisk" style="background-color: white; color: #c43b1d; font-family: Arial, sans-serif; font-size: 13px; font-weight: bold;">*</span></li></ol></div>第1項，是指你的Android app的package name，這裡一定要填對，不然C2DM Server不知道送到哪個app去。<br />第2項，是指用來傳遞訊息的帳號，也就是開發者的帳號，這裡的建議是不要用個人帳號，建議新申請另一個帳號來使用。<br /><br />完成上面註冊動作以後，就可以開始coding了!<br />網路上的code教學都是拿<a href="http://code.google.com/android/c2dm/index.html#Examples">Google官網上面放的範例（JumpNote）</a>，<br />我覺得這樣不太native，畢竟這是別人寫的app！<br />所以我直接講最基本的流程！<br /><br /><br />接下來的code大概會分成下面幾種：<br /><br /><ol><li>實作Server端：使用Google Client Login API取得Auth token，並且存起來。</li><li>實作Server端：Sending Message to C2DM Server。</li><li>Android端：基本的設定。</li><li>Android端：向C2DM 註冊，並且取得registration id。</li><li>Android端：傳送 Registration Id 到我們的Server</li></ol><br />因為其實有點多，所以就分成兩篇來打，<br />一篇為Sever篇，就是此篇！<br />另一篇為Android篇，就是下篇！<br /><br /><span style="font-size: large;"><b>【1.&nbsp; 使用<a href="https://developers.google.com/accounts/docs/AuthForInstalledApps">Google Client Login API</a>取得Auth token&nbsp;】</b></span><br /><br />因為得把token傳至C2DM Server，<br />C2DM Sever才知道你有登入，且是合格的。<br /><br />至於Google Client Login API的流程在這就不贅述，<br />就直接實做! 但大家可以去<a href="https://developers.google.com/accounts/docs/AuthForInstalledApps">Google Client Login API官網</a>看!!!<br /><br />這裡我是架在<a href="http://code.google.com/intl/zh-TW/appengine/">Google App Engine</a>上，把<a href="http://code.google.com/intl/zh-TW/appengine/">GAE</a>當作我們的Sever。<br />由於auth token可以重複使用，<br />所以我們可能可以每段時間去執行ClientLogin，<br />並取得auth token!<br />這時候就可以用GAE的cron，可能設定每天去登入一次以取得token。<br /><br />而Client Login的code如下：<br /><pre class="brush: java">String strClientLoginUrl = "https://www.google.com/accounts/ClientLogin"; // client login的url<br />String strAccountType = "accountType=HOSTED_OR_GOOGLE&amp;";// 你要登入的帳號型態，這裡就輸入HOSTED_OR_GOOGLE<br />String strEmail = "Email=test@gmail.com&amp;";     // 你的email!!<br />String strPasswd= "Passwd=123456&amp;";            // 你的密碼<br />String strService= "service=ac2dm&amp;";           // 你登入以後，要拿這token存取Google哪個Service，這裡是ac2dm<br />String strSource= "source=KenYang-AndroidC2DM-1.0";// 這個只是用來identify你的application，格式要companyName-applicationName-versionID<br /><br /><br />HttpURLConnection conn = (HttpURLConnection) new URL(strClientLoginUrl).openConnection();<br />conn.setDoOutput(true);  <br />conn.setUseCaches(false);  <br />conn.setRequestMethod("POST");  // 設定request Method為POST<br />conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");  <br /><br /><br />// 送出資料<br />OutputStream out = conn.getOutputStream();  <br />String strPostData = strAccountType+strEmail+strPasswd+strService+strSource;<br />out.write(strPostData.getBytes());  <br />out.close();  <br /><br />// 取得response code，成功的話就是200<br />resp.getWriter().println(conn.getResponseCode()+ "&lt;/br&gt;");<br /><br />// 把資料讀進來並且印出來<br />BufferedReader reader = new BufferedReader(new InputStreamReader(conn.getInputStream(),"utf-8"));<br />String strLine = "";<br />while((strLine=reader.readLine())!=null){<br /> resp.getWriter().println(strLine+"&lt;/br&gt;");<br />}<br /><br /><br /><br /></pre><br />正常來說，如果你帳號沒有問題，<br />或者密碼沒有輸入錯誤，<br />或者的確有這帳號存在！<br />那麼response code會是200!<br />就代表登入成功!<br />此時就要取得auth token。<br /><br />印出來的資料如下：<br /><pre class="brush: java">SID=DQAAAGgA...7Zg8CTN<br />LSID=DQAAAGsA...lk8BBbG<br />Auth=DQAAAGgA...dk3fA5N<br /></pre><br />這時候，只要取得最後那一行資料即可！<br />就是Auth那一行！！！<br />然後把Auth存起來！<br />這裡我是先存在GAE的datastore！<br />以利待會使用!<br /><br /><br /><br /><br /><span style="font-size: large;"><b>【2.&nbsp;&nbsp;傳送資料至C2DM Server&nbsp;】</b></span><br /><br />至於傳送甚麼資料，可以來這<a href="http://%E3%80%901.%20%20%E4%BD%BF%E7%94%A8google%20client%20login%20api%E5%8F%96%E5%BE%97auth%20token%20%E3%80%91%20%20%E5%9B%A0%E7%82%BA%E5%BE%97%E6%8A%8Atoken%E5%82%B3%E8%87%B3c2dm%20server%EF%BC%8C/">官網</a>看詳細參數說明!<br />這邊就簡單地說明幾種"必需"的參數!<br /><br /><ol><li><span style="background-color: white; color: #007000; font-family: monospace; font-size: 14px; line-height: 17px; text-align: left;">registration_id</span>&nbsp;：android 裝置的id，一定要傳這資料給C2DM Server，C2DM才知道訊息要傳給誰，至於這個值，是來自android device的!</li><li><span style="background-color: white; color: #007000; font-family: monospace; font-size: 14px; line-height: 17px; text-align: left;">collapse_key</span>&nbsp;：這個value可以是隨意的值，這個參數的用意是怕android device的狀態是離線狀態，一旦狀態恢復為連線，避免使用者突然收到大量訊息!(這個參數可以每次都不一樣，也可以每次都一樣)</li><li><span style="background-color: white; color: #007000; font-family: monospace; font-size: 14px; line-height: 17px; text-align: left;">data.&lt;key&gt;</span>&nbsp;：這個參數就是你要傳給android device的訊息了! 型態為key-value。如data.keyName=value</li><li><span style="background-color: white; color: #007000; font-family: monospace; font-size: 14px; line-height: 17px; text-align: left;">GoogleLogin auth</span>&nbsp;：這個不是要post的參數，而是要送出的header值! 而值就是上面存在datastore裡面的Auth!</li></ol><br /><br /><br />實際的code如下：<br /><pre class="brush: java">String strSendUrl = "https://android.apis.google.com/c2dm/send";  // c2dm的url<br />String strRegistrationId = "registration_id="+req.getParameter("device_token")+"&amp;"; // 接收來自android傳來的參數<br />String strCollapse= "collapse_key=1&amp;";    // 這個參數上面說明了<br />String strAuth = "xxxxxx";                 // 從datastore撈出來的值，這裡就不寫有關datastore的操作了<br />String strData  = "data.keyHello=fromKen";    // 你要送的訊息<br /><br />String strPostData = strRegistrationId+strCollapse+strData;<br /><br />HttpURLConnection conn = (HttpURLConnection) new URL(strSendUrl).openConnection();<br />conn.setDoOutput(true);  <br />conn.setUseCaches(false);  <br />conn.setRequestMethod("POST");  <br />conn.setRequestProperty("Content-Type", "application/x-www-form-urlencoded");  <br />conn.setRequestProperty("Authorization", "GoogleLogin auth=" + strAuth);  // 設定header<br />conn.setRequestProperty("Content-Length", Integer.toString(strPostData.getBytes().length)); // 告訴c2dm要傳送的資料長度<br /><br />// 送出資料<br />OutputStream out = conn.getOutputStream();  <br />out.write(strPostData.getBytes());  <br />out.close();  <br /><br />// 看response code, 200為OK<br />resp.getWriter().println(conn.getResponseCode()+ "&lt;/br&gt;&lt;/br&gt;"); <br /><br /></pre><br /><br /><br /><br />完成上面的步驟，server端就完成了！<br />但還要完成android端，才能真正收到訊息！<br />下一篇會專注於android端的實作<br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/03/23/android-c2dm-sever" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>C# 控制 Webcam 【using Emgu】</h1>

      <div class="entry">
        這篇似乎是我歷年來第一篇有關M$的筆記.........<br />真是寫得有點心不甘情不願XD<br />畢竟本人真的是沒有很喜歡M$的東西，<br />當然不是因為M$不好，M$也有它好的一面，<br />只能說或許是習慣問題....<br /><br />OK，進入正題，<br />這篇主要是去說明如何利用C#去控制你的網路攝影機，<br />且是使用Emgu這套dll，<br />甚麼是Emgu呢?<br />他和OpenCV有點關聯，<br />OpenCV相信不管是Java, C, C++等language的開發者，都了解OpenCV是甚麼!?<br />簡單說，OpenCV是一套強大的影像處理library，由INTEL開發，<br />非常強大，甚至你可以利用OpenCV去做到OCR，很方便。<br />也由於OpenCV沒有支援C#，那C#要怎麼使用OpenCV呢?<br />就是靠<a href="http://www.emgu.com/wiki/index.php/Main_Page">Emgu</a>，<a href="http://www.emgu.com/wiki/index.php/Main_Page">Emgu</a>是一套允許OpenCV的function在C#等語言中被使用。<br /><br />但我們這邊並不會使用到OpenCV的功能，<br />就是簡單的介紹Emgu很基本的功能，<br />就是存取攝影機，<br />首先先去<a href="http://sourceforge.net/projects/emgucv/files/emgucv/2.3.0/">下載Emgu，並且安裝</a>，<br />安裝完成以後就可以開始寫程式....<br /><br />看你是要開啟一個WPF專案，還是一個Window Form專案，<br />建議你開啟Window Form，因為到時Webcam回傳回來的image型態，<br />可以直接在 Window Form中的pictureBox裡面使用。<br /><br />開啟以後，就在你的專案中加入reference，<br />加入以下四個dll，dll的位置就是在你安裝Emgu位置的bin底下：<br /><br /><ol><li>Emgu.CV.dll</li><li>Emgu.CV.ML.dll</li><li>Emgu.CV.UI.dll</li><li>Emgu.Util.dll</li></ol><br />加入以後，請先儲存你的專案，<br />儲存以後請在你安裝Emgu位置的bin底下找到兩個dll，<br /><br /><ol><li>opencv_core231.dll</li><li>opencv_highgui231.dll</li></ol><br />把這兩個dll放置到你的專案的/bin/Debug/底下。<br />因為Emgu.CV.dll會使用到上述兩個dll。<br /><br /><br />完成上述動作以後就開始寫code，<br />先import會使用到的lib，如下:<br /><pre class="brush: c-sharp">using Emgu.CV;<br />using Emgu.CV.Structure;<br /></pre><br /><br />先宣告一個Capture物件，如下:<br /><pre class="brush: c-sharp">private Capture cap = null;                 // Webcam物件<br /></pre>這個物件就是用來連結到你的webcam。<br /><br /><br />接著在Form1_Load event中，<br />連結到攝影機以及建立一個event用來抓取畫面，如下:<br /><pre class="brush: c-sharp">private void Form1_Load(object sender, EventArgs e)<br />{<br />     cap = new Capture(0); // 連結到攝影機0，如果你有兩台攝影機，第二台就是1<br />     Application.Idle += new EventHandler(Application_Idle); // 在Idle的event下，把畫面設定到pictureBox上(當然你也可以用timer事件)<br />}<br /></pre><br /><br />接下來要寫抓取畫面event的code，<br /><pre class="brush: c-sharp">        void Application_Idle(object sender, EventArgs e)<br />        {<br />             Image&lt;Bgr, Byte&gt; frame = cap.QueryFrame(); // 去query該畫面<br />             pictureBox1.Image = frame.ToBitmap(); // 把畫面轉換成bitmap型態，在餵給pictureBox元件<br />        }<br /></pre><br /><br />完成以後按下F5執行，應該就可以順利取得攝影機畫面瞜!<br /><br /><br /><br />
      </div>

      <a href="/2012/03/04/c-webcam-using-emgu" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Out of Memory (OOM)</h1>

      <div class="entry">
        呼，這篇文章放在我的草稿已經有兩個月了，<br />一直遲遲沒有完成，<br />一來是家裡太忙，<br />一來也是因為最近都在搞Kinect和Nxt Robot的應用(千百個不願意)<br />今天決定花點時間把這篇文章修完，<br />其實有很多篇都在草稿，有十幾篇要寫完，但先挑選這篇，<br />畢竟OOM是個很嚴重的問題。<br /><br /><b style="font-size: x-large;">【</b><span style="font-size: large;"><b>何謂OOM呢?</b></span><b style="font-size: x-large;">】</b><br />OOM (Out of Memory)，就是溢存的意思，<br />白話點就是超出記憶體大小了，<br />每個APP，都會有配置一定大小的heap size，<br />但這個heap size在每支設備上都不同，<br />像在Nexus one就是24mb，HTC Sensation只有16mb，<br />大小都不一定的，所以我們在寫app時，<br />必須做好記憶體的控管，<br /><br />有些人可能會納悶，不是用JAVA寫的嗎?<br />JAVA無法對記憶體有更進一步的操作(配置、釋放)阿，<br />怎麼做好記憶體的控管呢?<br />恩，沒有錯。<br /><br /><span style="font-size: large;"><b>【那OOM的問題會發生在哪?】</b></span><br />就是在圖片的使用!!!!!!<br />你每調用一張圖片，在android上都會做到auto scale的動作，<br />在做auto scale的動作是用C去配置記憶體的，<br />因此就會占用記憶體，<br />如果沒有做好控管，就會發生溢存!<br />那怎麼做好控管呢?<br /><br /><br />你們有時會發現有些APP好大喔，<br />有部分原因可能是引用其他外部的lib，<br />很少是因為程式碼寫太多....<br />大部分的問題就是在圖片太多，且太大，<br />沒有好好善用draw9patch，<a href="http://blog.kenyang.net/2010/05/draw-9-patch.html">何謂draw9patch可以來這看</a><br />當然draw9patch並不適用所有的案例，<br />甚至連根據dpi的不同，放圖片在不同的資料夾，<br />這方法我也覺得不適用所有案例，<br />我大多都還是去取得螢幕大小，自己去做到裁切圖片的動作，<br />個人覺得這樣是最精準的(畢竟android device實在太多..................)。<br /><br /><br />網路上有些解法是，<br />在做重新裁切或者取得圖片的動作時，<br />把圖片品質設小一點。<br />當然這也是一種解法啦。<br />但個人看法，認為這解法治標不治本，<br />怎麼說呢? 畢竟如果圖片一多，<br />OOM的問題還是會發生。<br /><br /><br />所以最根本的解法在於recycle!<br />但是recycle的時機很重要，<br />畢竟如果圖片還在使用中就進行recycle的話，<br />可是會發生crash的。<br /><br />我的建議是在Android Life Cycle中的onDestroy中進行recycle，<br />此時最為保險。當然如果你能保證你的圖片用不到了，就可以進行recycle了。<br />不一定要照我的建議而做。<br /><br /><br />這裡有個情境，假設我有4個畫面，A,B,C,D。<br />A有按鈕跳到B<br />B有按鈕跳到C<br />C有按鈕跳到D<br />每個畫面都有一張不同的背景圖，<br />怎麼設背景圖呢?<br />大部分人會在layout.xml中去做設定，<br />或者會在程式中設定，<br />如下：<br /><pre class="brush: java">linearLayout.setBackgroundDrawable(getResources().getDrawable(R.drawable.bg_normal));<br /></pre>這樣看似沒有甚麼問題，<br />但如果ABCD畫面換來換去，經過多次換來換去以後，<br />這時候heapSize就會越來越小....<br />最後就會發生OOM!<br /><br />所以較好的做法就是在lifecycle中的onCreate中，<br />去做init的動作，<br />先宣告二個全域的變數<br />一個是用來存圖片的BitmapDrawable<br />一個是放置圖片的LinearLayout，如下：<br /><pre class="brush: java">private LinearLayout llBackgroundPanel = null;<br />private BitmapDrawable bmpDrawImg  = null;<br /><br /></pre><br />接著在onCreate中去呼叫一個自己寫好的函數（fnSetBackground)<br />這個函數就是用來設背景圖片的，如下:<br /><pre class="brush: java">@Override<br />public void onCreate(Bundle savedInstanceState) {<br />    super.onCreate(savedInstanceState);<br />    setContentView(R.layout.a);<br />    fnSetBackground(); // 呼叫函數<br />}<br /><br /></pre><br />而函數內容如下：<br /><pre class="brush: java">public void fnSetBackground(){<br />    // 先取得LinearLayout<br />    llBackgroundPanel = (LinearLayout) findViewById(R.id.llBackgroundPanelChangePwd);<br />    // 取得該張圖片，並放置在變數bmpDrawImg中<br />    bmpDrawImg = new BitmapDrawable(getResources().openRawResource(R.drawable.bg_normal));<br />    // 最後就是設定圖片<br />    llBackgroundPanel.setBackgroundDrawable(bmpDrawImg);<br />}<br /></pre><br />完成上面步驟，只是設置圖片而已，<br />還是無法解決OOM的問題，下面才是解決的方式，<br />在lifecycle中的onDestroy中去進行清空，<br /><pre class="brush: java">@Override<br />protected void onDestroy() {<br />    super.onDestroy();<br />    // 每個Drawable被加到VIEW上面都會產生一個callback，所以在recycle圖片之前，必須先把callback設成null<br />    // 設成null以後，背景圖片自然就會不見，就會變成黑的背景。bmpDrawImg的狀態就會是沒有被使用中。<br />    llBackgroundPanel.getBackground().setCallback(null); <br /> <br />    // 先判斷bmpDrawImg 是否為null，如果不是null，且bmpDrawImg 還沒有被recycle的話就進行recycle<br />    if (null != bmpDrawImg &amp;&amp; !bmpDrawImg.getBitmap().isRecycled()){<br />        bmpDrawImg.getBitmap().recycle();<br />    }<br />    System.gc();<br />}<br /></pre><br /><br />照著上面的方法實作就能避免掉OOM的問題，<br />我寫在destroy的原因在於，<br />android lifecycle的特性，<br />當你A按下按鈕到B，<br />這時候在B畫面中按下返回按鈕(back)，<br />是不是就回到A了呢?<br />第一次按下返回按鈕，B會去調用onDestroy這個method，<br />如果這時候沒有進行recycle，那麼那塊記憶體空間就不會被釋放，<br />就會被占用著....<br />如果沒有進行RECYCLE，<br />久而久之，你持續返回A，又跳到B，重複著這動作好幾次，<br />圖片就被產生好幾次，<br />很快就會發生OOM，至於多快，就視你的圖片大小瞜!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/02/20/android-out-of-memory-oom" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Java 物件複製的問題</h1>

      <div class="entry">
        不知道大家有沒有發現，<br />把物件A，設值給B，<br />當B的值改，A也會改!?!?!?!?!?<br /><br />如下：<br /><pre class="brush: java">ArrayList&lt;String&gt; A = new ArrayList&lt;String&gt;();<br />A.add("KenYang");<br />ArrayList&lt;String&gt; B= A;<br /><br /><br /></pre><br />這時候如果我們去印出B的長度，<br /><pre class="brush: java">System.out.println(B.size());<br /></pre>那會是甚麼？<br />答案會是1，這無庸置疑，很基本的常識。<br /><br /><br />可是如果我把B的第0項刪除，在印出B的長度呢?<br /><pre class="brush: java">B.remove(0);<br /></pre>不用想，一定變成0。<br /><br /><br />那這時候，A的長度呢? 一般人可能會以為是1，<br />在C++的觀念，的確如此，的確會是1，<br />但在java不是...<br />可以印出來看看!<br /><pre class="brush: java">System.out.println(A.size());<br /></pre>答案會是0!<br /><br /><br />這是為什麼呢? 為什麼只是修改了B的值，<br />A也變了??<br /><br />這是因為，在java中，非primitive的資料型態，<br />都屬於物件，都是參考!!! (<a href="http://blog.kenyang.net/2011/11/c-reference.html">甚麼是參考? 可以去我先前PO的文章看看</a>)<br />簡單的說就是別名。<br />但Java的參考概念就很像C++的pointer!!! (記錄著該物件的位址)<br /><br /><br />下面用圖片來解釋，上面code的行為，<br />下面圖一的行為就是，<br /><br />先宣告A，再設值進去。<br />我們可以從圖發現，A是去參考記憶體位址為0000的物件!!!!<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-U2_4ISSIT8I/TwnkV2GNi6I/AAAAAAAAAlA/LHK5y-mMxcU/s1600/1.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="320" src="http://1.bp.blogspot.com/-U2_4ISSIT8I/TwnkV2GNi6I/AAAAAAAAAlA/LHK5y-mMxcU/s320/1.png" width="310" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table><br /><br />那麼這時候，把A的值丟給B呢?<br />在記憶體中的表現會是怎樣?<br />A=B;<br />如圖二。<br />會發現B，也是去參考記憶體位址為0000的物件!!!<br />A和B都是記錄著該物件的記憶體位址!!!<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-MEHF6mbBeSo/TwnkWXT0s5I/AAAAAAAAAlE/6fMbQ6iVgwQ/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="357" src="http://1.bp.blogspot.com/-MEHF6mbBeSo/TwnkWXT0s5I/AAAAAAAAAlE/6fMbQ6iVgwQ/s400/2.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><br /><br />所以從圖中應該可以了解上面的行為了吧?<br />為什麼B把第0項刪除，<br />結果A也變了呢?<br />就是因為在JAVA非primitive都是參考的關係!!!<br /><br />嗯! 那有人可能會疑問!!!<br />咦? String 也是非primitive的資料型態阿<br />可是為什麼下面的例子，B改，A卻沒改呢?<br /><br /><br />這就要用到先前某篇講解<a href="http://blog.kenyang.net/2012/01/java-unboxingboxing.html">java拆箱(unboxing)、裝箱(boxing)</a>的概念了!<br />那關java拆箱(unboxing)、裝箱(boxing)的甚麼事呢?<br />還是不了解為什麼兩個都是String的物件，怎麼B改，A卻沒改呢?<br />來看下面的小例子，<br /><pre class="brush: java">String A = "ken";<br />String B = A;<br />B = "yang";<br />System.out.println(A);<br /></pre>為什麼不是印出yang呢?<br />都是primitive阿，<br />原因就是自動裝箱(auto-boxing)，<br />上面的行為，在Compiler中，<br />B="yang" <br />會被轉換成<br />B = new String("yang");<br />這時候他就是全新的物件了!<br />因此不會改到原本的值!!!!!<br /><br /><br /><br />在Java中的複製，<br />想要做到真正的複製，<br />得靠clone了。<br />clone有機會再說吧!<br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/01/09/java" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Java 拆箱(unboxing)、裝箱(boxing)</h1>

      <div class="entry">
        <br /><br /><br />這篇要講到java拆箱(unboxing)、裝箱(boxing)、自動裝箱(auto-boxing)、自動拆箱(auto-unboxing)的概念了，<br />我舉個小例子來說明何謂拆箱(unboxing)、裝箱(boxing)、自動裝箱(auto-boxing))、自動拆箱(auto-unboxing)，<br />我用Integer和int來說明。<br /><pre class="brush: java">Integer A = new Integer(10);  // 裝箱<br />int B = A.intValue();   // 拆箱<br />B = A;    // 自動拆箱<br />A = 20;    // 自動裝箱</pre>上面的行為在Compilr中，<br /><span style="color: #38761d;"><b>A = 20;</b></span> 會被自動轉換成 <b><span style="color: #38761d;">A = new Integer(20);</span></b><br />我們稱之為自動裝箱。<br /><br /><b><span style="color: #38761d;">B=A; </span></b>&nbsp;會被自動轉換成<b><span style="color: #38761d;"> B = A.intValue();</span></b><br />稱之為自動拆箱<br /><br /><br />簡單的說，<br />把primitive轉成物件，稱之為裝箱，<br />把物件轉乘primitive，稱之為拆箱。<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/01/09/java-unboxingboxing" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android：Facebook Login API  (v2.0)</h1>

      <div class="entry">
        <span style="color: red; font-size: large;"><u>(此篇為舊版的2.0 SDK，不建議使用了！<a href="http://blog.kenyang.net/2013/02/android-facebook-login-v30.html">請看這篇使用最新的3.0 SDK</a>)</u></span><br /><br /><br />前面有介紹過怎麼在<a href="http://blog.kenyang.net/2012/01/facebook-login.html">網站上，導入Facebook Login</a>，<br /><div>這篇要介紹如何在Android 裝置上，實作Facebook Login!!</div><div><b><br /></b></div><div><span style="font-size: large;">【<b>第一步】</b></span></div><div>首先先來到<a href="https://developers.facebook.com/apps">FB Developer後台</a>，並點選Create New App(右上角)，</div><div><br /></div><div><b><span style="font-size: large;">【第二步】</span></b></div><div><a href="https://github.com/facebook/facebook-android-sdk/downloads">下載Facebook SDK</a></div><div><br /></div><div><b><span style="font-size: large;">【第三步】</span></b></div><div>這步驟主要是在你的project中，include Facebook的lib，這裡大概分兩種方式，</div><div>第一種，就是在你已經create好的project上，點右鍵→點properties→選擇Android，</div><div>然後最下方有一個Library，然後就可以點選add，再去第二步驟下載的Facebook SDK中找到lib即可。</div><div>第二種就是在第二步驟下載的SDK中，</div><div>找到 &nbsp;SDK\\facebook\src，</div><div>底下應該有一個com資料夾，把資料夾拉進去你的project即可，</div><div>（我比較喜歡第二種）</div><div>第二種的，你拉進去以後，會看到下面的畫面！（圖一）<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-vFuxNuVQx6g/TwmBkQlhEXI/AAAAAAAAAk0/K2yBv6TaRjw/s1600/Capture.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="335" src="http://2.bp.blogspot.com/-vFuxNuVQx6g/TwmBkQlhEXI/AAAAAAAAAk0/K2yBv6TaRjw/s400/Capture.JPG" width="400" /></a></div><br /><br /><br /><br /></div><div><br /></div><div><b><span style="font-size: large;">【第四步】</span></b> </div><div>先去下載<a href="http://sourceforge.net/projects/gnuwin32/files/openssl/0.9.8h-1/">OpenSSL</a>，因為待會會用到它來encode hash key，</div><div>下載以後解壓縮出來。</div><div><br /></div><div><b><span style="font-size: large;">【第五步】</span></b></div><div>記得之前有教過大家，怎麼用keytool產生key吧?(在<a href="http://blog.kenyang.net/2010/05/android-map-key.html">教學map</a>的時候有講到)</div><div>這裡一樣得利用keytool工具，</div><div>大家先打開cmd，</div><div>並且切換目錄至你的java sdk資料夾底下的bin!!! (是java sdk唷)</div><div>底下就會有一個keytool.exe</div><div><br /></div><div><br /></div><div><b><span style="font-size: large;">【第六步】 </span></b></div><div>先看到下面的指令範例以及說明，</div><div><br /></div><div>指令範例：</div><div>keytool -exportcert -alias <span style="color: red;">your_key_alias</span> -keystore<span style="color: red;">&nbsp;path_of_keystore</span>&nbsp;| <span style="color: red;">path_of_OpenSSL</span>&nbsp;sha1 -binary |&nbsp; <span style="color: red;">path_of_OpenSSL</span>&nbsp;&nbsp;base64 </div><div><br /></div><div>指令說明：</div><div><div><span style="color: red;">your_key_alias</span>&nbsp;：是你key的alias</div><div><span style="color: red;">path_of_keystore</span>&nbsp;：是你keystore的位置，如果這裡你是用.android底下預設的debug.keystore，那如果你Export Sign一個Android App時，是用另一把keystore，到時候如果上傳至market，你的FB登入可能就不能使用，所以必須用同一把，以Android App為主。</div><div>(但是!!!! 如果你是在本機開發測試，尚未上傳至market之前，大部分人應該都是直接點選eclipse上的綠色箭頭，然後部屬到Android裝置上吧? 如果是這樣，你的key，還是得用.android底下的預設keystore，因為按下Eclipse上的綠色箭頭，就是用預設的keystore打包的!!! 也就是說你得有兩把keysotre，一把是測試用，一把是正式上線用)</div><div><span style="color: red;">path_of_OpenSSL</span>&nbsp;：剛剛下載的OpenSSL位置</div></div><div><br /></div><div><br /></div><div>真實指令（這是我的喔，你複製貼上是沒用的，要改成自己的）</div><div>keytool -exportcert -alias <span style="color: red;">helloKen</span> -keystore <span style="color: red;">E:\myProject\M@C\key.keystore</span> | <span style="color: red;">C:\openssl-0.9.8h-1-bin\bin\openssl</span> sha1 -binary | <span style="color: red;">C:\openssl-0.9.8h-1-bin\bin\openssl</span> base64</div><div><br /></div><div>完成上面以後，你應該會得到2個key，一個是測試用，一個是正式上線時用的！</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><b><span style="font-size: large;">【第七步】</span></b> </div><div>去Facebook Developer後台，輸入上面的2把key，</div><div>如下圖中的紅色框框，請於Native Android App中填入喔（圖二）</div><div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-TZRDzSaDacc/TwmBj-0c62I/AAAAAAAAAkw/tMRZeBopk-4/s1600/Captur2e.JPG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="515" src="http://3.bp.blogspot.com/-TZRDzSaDacc/TwmBj-0c62I/AAAAAAAAAkw/tMRZeBopk-4/s640/Captur2e.JPG" width="640" /></a></div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><b><span style="font-size: large;">【第八步】</span></b> </div><div>開始寫程式了!!</div><div>首先必須加入一個permission，</div><div>如下</div><div><pre class="brush: xml">&lt;uses-permission android:name="android.permission.INTERNET"/&gt;<br /></pre></div><div><br /></div><div>接著宣告一個Facebook的物件!<br />且必須是global的喔!<br />如下：<br /><pre class="brush: java">Facebook facebook = new Facebook("YOUR_APP_ID");<br /></pre><br /><br />下面就是登入的code，看你要寫在哪，例如：按下按鈕去登入（btn.setOnClickListener)，或者一進畫面就登入（onCreate）<br /><pre class="brush: java">facebook.authorize(this, new DialogListener() {  <br />       @Override<br />       public void onComplete(Bundle values) {} //登入成功會返回至此method<br /><br />       @Override<br />       public void onFacebookError(FacebookError error) {}<br /><br />       @Override<br />       public void onError(DialogError e) {}<br /><br />       @Override<br />       public void onCancel() {}<br />});<br /><br /></pre><br /><br /><br /><br />最後還有一個步驟！因為上面的code會去trigger一個視窗出來，也就是換畫面，<br />執行完，還會再返回，所以在原本的Actitivy中的onActivityResult中，必須加入下段code，<br /><br /><pre class="brush: java">@Override<br />    public void onActivityResult(int requestCode, int resultCode, Intent data) {<br />        super.onActivityResult(requestCode, resultCode, data);<br /><br />        facebook.authorizeCallback(requestCode, resultCode, data);<br />    }<br /><br /></pre><br /><br /></div><div><br /></div><div><br /></div><div>這樣就完成了一個在Android上實作Facebook Login！</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /><br /></div>
      </div>

      <a href="/2012/01/08/androidfacebook-login-api" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android EditText remove focus</h1>

      <div class="entry">
        只要頁面中有用到EditText&nbsp;<edittext>的，</edittext><br />只要跑到那個頁面，一定會被自動focus，也就是說鍵盤會自動彈開!<br />要取消focus，只要在你layout中的root element加上下面兩個屬性，<br />(root element就是最外圍的那個element，預設都是LinearLayout）<br /><br /><br />android:focusable="true"<br />android:focusableInTouchMode="true"<br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2012/01/07/android-edittext-remove-focus" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>實作Facebook Login 【新版】</h1>

      <div class="entry">
        今天發現前陣子有使用到Facebook登入的案子，<br />突然掛了! 不能使用Facebook登入了....<br />去查了一下，原來Facebook API改版....<br />老實說，我覺得這樣機制很差....應該也保留舊有機制，而不是連通知都沒有就改版了!<br /><br />Ok, fine! 其實也沒有太大差別!<br />主要是改一些參數名稱!<br />至於前面的註冊手續都相同! 可以來<a href="http://blog.kenyang.net/2011/02/implement-facebook-login.html">前一篇</a>看!<br /><br /><br />至於coding實作如下，<br />一樣得嵌入js檔，<br /><pre class="brush: html">&lt;script src="http://connect.facebook.net/en_US/all.js"&gt;&lt;/script&gt;<br /></pre><br />接著一樣要init，但是多了一個參數，就是oauth，以及從以前的response.session改成response.authResponse<br /><pre class="brush: javascript">&lt;script&gt;<br /> //先做init的動作，輸入自己的app id<br /> FB.init({ <br />    appId:'你自己的app id', <br />    cookie:true, <br />    status:true, <br />    xfbml:true,<br />    oauth : true // 多了這個參數<br /> });<br /> <br /><br /><br /><br /> //下面是實作一個登入的function<br />function fnLoginFb(){<br />    FB.login(function(response) {<br />        //先判斷是否已經登入了，如果是，就直接<br />        if (response.authResponse){  <br />            FB.api('/me', function(response) {<br />                alert(response.email);<br />            });<br />        //下面是沒有登入時才會做的，會去subscribe一個event，就是去監聽一個login event（也就是說login成功以後，會接收到訊息）<br />        }else{<br />            FB.Event.subscribe('auth.login', function(response) {<br />                if (response.authResponse) {<br />                    FB.api('/me', function(response) {<br />                        alert(response.email);<br />                    });          <br />                }<br />            }); <br />        }<br /><br />    }, {scope:'email'});<br /><br />} <br /><br /><br /><br />&lt;/script&gt;<br /></pre><br />然後下面就是實作FB登入的按鈕了!<br /><pre class="brush: html"><div id="fb-root"><br /></div><br /><a href="http://www.blogger.com/blogger.g?blogID=866973865356001297#"><img src="/images/fb_login.jpg" /></a> <br /><br /></pre><br /><br />
      </div>

      <a href="/2012/01/06/facebook-login" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Galaxy Nexus 使用心得</h1>

      <div class="entry">
        Galaxy Nexus 購入了算是第二天！<br /><br />玩了兩天，來PO點心得!<br />到底Android 4.0 ICS和先前Android 2.3以下的裝置，到底有甚麼差別!<br />以及介紹ICS比較特殊的地方!<br /><br />這邊拿Nexus One做比較! &nbsp;(恩，都原生機! 這樣才有比較介面差別的意義!)<br />底下的照片主要是拿參加GOOGLE ADL送的Flyer拍的...<br />畫質有點差，有些我沒有對焦，但能表達我要表達的意思就好了~"~<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-yox8rKgQO3I/Tv3NBYCIGmI/AAAAAAAAAg8/u_gJS7__zeg/s1600/1.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="346" src="http://4.bp.blogspot.com/-yox8rKgQO3I/Tv3NBYCIGmI/AAAAAAAAAg8/u_gJS7__zeg/s640/1.jpg" width="640" /></a></div><span style="text-align: center;">側面照，其實Nexus One(上)，比較厚! 以重量來說，Nexus One也比較重! 跟外殼材質也有相關! 畢竟Galaxy Nexus(下)並不是用金屬材質，但老實說，我還是覺得Nexus One摸起來的質感比較好!</span><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: left;">接著來看Nexus One和Galaxy Nexus在我手上的樣子，因為不少人擔心Galaxy Nexus螢幕很大，一手無法掌握!!!&nbsp;</div><div class="separator" style="clear: both; text-align: left;">恩，我在男生中的手算大了，算是可以一手hold住Galaxy Nexus，</div><div class="separator" style="clear: both; text-align: left;">但老實說要一手Key 文字，跟Nexus One比起來，的確會有點ㄍㄧㄥ。</div><div class="separator" style="clear: both; text-align: left;">下面是圖片，可以看一下實際拿起來的樣子!</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-dpXQug1cD2U/Tv3M9CeCFPI/AAAAAAAAAgw/xb-_o50zypg/s1600/5.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-dpXQug1cD2U/Tv3M9CeCFPI/AAAAAAAAAgw/xb-_o50zypg/s640/5.jpg" width="480" /></a></div><div class="separator" style="clear: both; text-align: center;">用右手拿Galaxy Nexus</div><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-tgLb6p1dCTU/Tv3NHSmWPpI/AAAAAAAAAhE/LtrOR6f_ewE/s1600/6.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-tgLb6p1dCTU/Tv3NHSmWPpI/AAAAAAAAAhE/LtrOR6f_ewE/s640/6.jpg" width="480" /></a></div><div class="separator" style="clear: both; text-align: center;">要去點最左邊的ㄅ鍵時，跟Nexus One相比，的確有點點ㄍㄧㄥ，更別說要碰到左上角了!</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;">下面是拿Nexus One的樣子</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-DrvycCvQeG4/Tv3NMkBODII/AAAAAAAAAhM/tqXw7ExGeOg/s1600/7.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-DrvycCvQeG4/Tv3NMkBODII/AAAAAAAAAhM/tqXw7ExGeOg/s640/7.jpg" width="480" /></a></div><div class="separator" style="clear: both; text-align: center;">恩，相較起來，Nexus One在我手中變小好多XD &nbsp;應該是A CUP(誤) &nbsp;</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-9xbp5LNVemA/Tv3NY0VME6I/AAAAAAAAAhk/eNQ90Dtt6WI/s1600/8.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://4.bp.blogspot.com/-9xbp5LNVemA/Tv3NY0VME6I/AAAAAAAAAhk/eNQ90Dtt6WI/s640/8.jpg" width="480" /></a></div><div class="separator" style="clear: both; text-align: center;">可以看到我輕易地碰到ㄅ鍵，也可以輕易地碰到左上角!</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: large;"><b>下面要介紹ICS比較特別之處!!!</b></span></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: large;"><b><br /></b></span></div><div class="separator" style="clear: both; text-align: center;"><span style="font-size: large;"><b><br /></b></span></div><div class="separator" style="clear: both; text-align: left;">記得Android 2.3以下的裝置，想要擷取手機畫面，必須用Android SDK裡面的DDMS去擷取嗎? 這對一個不懂技術的人來說，的確是一大門檻! 而iPhone就不用，iPhone可以輕易地擷取手機畫面!</div><div class="separator" style="clear: both; text-align: left;"><b><span style="font-size: large;">但是!!!!! </span></b>Android 4.0 ICS 有了這項功能了!!!!!!</div><div class="separator" style="clear: both; text-align: left;">只要同時按下音量減少鍵(手機左方)，以及電源鍵(手機右方)</div><div class="separator" style="clear: both; text-align: left;">下面是操作圖</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-Y8Of4c5aQvA/Tv3M6gtgxoI/AAAAAAAAAgg/y-8Plp5OSw8/s1600/2.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/-Y8Of4c5aQvA/Tv3M6gtgxoI/AAAAAAAAAgg/y-8Plp5OSw8/s400/2.jpg" width="300" /></a></div><div class="separator" style="clear: both; text-align: center;">按下手機音量減少鍵(手機左方)</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-c-Chrep96M4/Tv3M52cXkRI/AAAAAAAAAgc/aoJ9_o23dEQ/s1600/3.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-c-Chrep96M4/Tv3M52cXkRI/AAAAAAAAAgc/aoJ9_o23dEQ/s400/3.jpg" width="300" /></a></div><div class="separator" style="clear: both; text-align: center;">以及同時按下手機電源鍵(手機右方)</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-g0j0aQwT4vI/Tv3M8W3WQaI/AAAAAAAAAgs/KKkC2jeOsow/s1600/4.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="400" src="http://2.bp.blogspot.com/-g0j0aQwT4vI/Tv3M8W3WQaI/AAAAAAAAAgs/KKkC2jeOsow/s400/4.jpg" width="300" /></a></div><div class="separator" style="clear: both; text-align: center;">同時按下以後，就會出現此圖，白色框框裡面就是你擷取的圖!! 此範例是擷取我的桌面XD 是Amanda Seyfried!!!!!!!!!!! &gt;//////&lt;</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><b><span style="font-size: large;">接下來要介紹ICS!!!</span></b></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-AJs_jgwPFaQ/Tv3NUtIP11I/AAAAAAAAAhc/rc6KA_bKYAo/s1600/9.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-AJs_jgwPFaQ/Tv3NUtIP11I/AAAAAAAAAhc/rc6KA_bKYAo/s640/9.png" width="360" /></a></div><div class="separator" style="clear: both; text-align: center;">看到上圖有三個框框，紅、橘、藍!</div><div class="separator" style="clear: both; text-align: center;"><span style="color: red;">紅色框框</span>是Android 2.3以下裝置沒有的!這是虛擬鍵盤，從左到右，分別是BACK, Home, Task，在Android 2.3以下的手機上面，通通都有實體按鍵(BACK,Home,Menu,Search)，偏偏這幾種按鍵，每一家廠商都放得不一樣，有些可能是HOME先，有些可能是BACK先，有些還沒有SEARCH，某支手機還很智障設置了facebook的按鍵..................... 老實說，這對Android系統來說，不是件好事，這樣的usability非常不好!!!! 拜託別荼毒這些end user，end user只會覺得，【靠，android很爛耶，怎都亂擺】! 殊不知，這些都是那些廠商搞得鬼.......所以ICS直接內建了虛擬按鍵，我想就是為了解決這些第三方廠商不統一設置按鍵的問題吧!</div><div class="separator" style="clear: both; text-align: center;">(咦? 我很納悶，現在有實體鍵盤的裝置，將來要更新ICS時，那...不就有兩個鍵盤了嗎? 不過說不定這些廠商又去改Android Kernel，又把虛擬鍵盤改掉.....)</div><div class="separator" style="clear: both; text-align: center;"><span style="color: orange;">橘色框框</span>算是navigation bar了，有用過iPhone的都知道，使用者可以將APP拖曳到下方，這樣可以方便我們快速使用，現在ICS也有了! 等等會有圖說明!&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><span style="color: blue;">藍色框框</span>，哈! 我覺得這是ICS很失敗的地方耶! 這塊是search bar....是不能刪除的== 它永遠都在那!!</div><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-n9wK8rUc1g0/Tv3NZo9r36I/AAAAAAAAAhs/2Lsfs0a53sA/s1600/10.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-n9wK8rUc1g0/Tv3NZo9r36I/AAAAAAAAAhs/2Lsfs0a53sA/s640/10.png" width="360" /></a></div><div class="separator" style="clear: both; text-align: center;">這張圖，我們可以看到，我可以將APP拖曳到下方的navigation bar，方便我們快速使用!!! 超方便! 但可惜只能放四個!&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><br /></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-tsGYxpKPgRI/Tv3Nju98fLI/AAAAAAAAAh0/LBzzZz_fer0/s1600/11.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-tsGYxpKPgRI/Tv3Nju98fLI/AAAAAAAAAh0/LBzzZz_fer0/s640/11.png" width="360" /></a></div><div class="separator" style="clear: both; text-align: center;">喔，對了，iPhone有分類的功能，就是可以將2個以上的app放在一個資料夾裡面，現在ICS也有了!!! 可以看到這張圖，我把一個名稱為Utility的資料夾，放在navigation bar裏頭!! 點開以後就是圖中的樣子!!&nbsp;</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-3ziKAy2ycgw/Tv3Nng869RI/AAAAAAAAAiA/XzQrij67H6M/s1600/12.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-3ziKAy2ycgw/Tv3Nng869RI/AAAAAAAAAiA/XzQrij67H6M/s640/12.png" width="360" /></a></div><div class="separator" style="clear: both; text-align: center;">可以看到這張圖的桌面，我就放了三個資料夾</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-UPPYZPdbRvs/Tv3NnnJCEwI/AAAAAAAAAh8/K3JB1jxCNPg/s1600/13.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://2.bp.blogspot.com/-UPPYZPdbRvs/Tv3NnnJCEwI/AAAAAAAAAh8/K3JB1jxCNPg/s640/13.png" width="360" /></a></div><div class="separator" style="clear: both; text-align: center;">點開某一個，展開來就是長這樣</div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-RE5fUIU8sfg/Tv3Npb4pKyI/AAAAAAAAAiM/lzA_9EURJhg/s1600/Screenshot_2011-12-30-22-20-43.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-RE5fUIU8sfg/Tv3Npb4pKyI/AAAAAAAAAiM/lzA_9EURJhg/s640/Screenshot_2011-12-30-22-20-43.png" width="360" /></a></div><div class="separator" style="clear: both; text-align: center;">喔，對了，上面有講到Task這個按鍵，在虛擬鍵盤中的最右方，它的作用就是，點了你可以看到最近執行過的程式!!!!</div><br /><br /><br /><br />用的這幾天，我對ICS還算滿意瞜!!! 至少我很愛它的分類和navigation bar功能!!!<br />可能是桌面是Amanda Seyfried...也因此讓我更愛它吧!(誤)<br /><br /><br /><br /><br />
      </div>

      <a href="/2011/12/30/galaxy-nexus_30" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Galaxy Nexus 不專業開箱文</h1>

      <div class="entry">
        <br /><div class="separator" style="clear: both; text-align: left;"><span style="text-align: -webkit-auto;">&nbsp;嘿!期待已久的Galaxy Nexus終於入手了!</span></div><div class="separator" style="clear: both; text-align: left;"><span style="text-align: -webkit-auto;">下面是開箱文喔! 相片是拿我去參加Google ADL送的Flyer照的!</span></div><div class="separator" style="clear: both; text-align: left;"><span style="text-align: -webkit-auto;">最後還有臉部解鎖的影片 (解鎖很快!!)</span></div><div class="separator" style="clear: both; text-align: -webkit-auto;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-fOgQC_AQllw/TwUpCSaeY_I/AAAAAAAAAjI/c_sr1YLHTW4/s1600/IMAG0004.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="345" src="http://4.bp.blogspot.com/-fOgQC_AQllw/TwUpCSaeY_I/AAAAAAAAAjI/c_sr1YLHTW4/s640/IMAG0004.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;">手機盒子，和贈送的Android公仔盒子</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-atMy6dWL7vM/TwUpIP8VGNI/AAAAAAAAAjQ/nd4co5kVNS8/s1600/IMAG0005.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="346" src="http://2.bp.blogspot.com/-atMy6dWL7vM/TwUpIP8VGNI/AAAAAAAAAjQ/nd4co5kVNS8/s640/IMAG0005.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;">打開以後才發現，裡面還有一個盒子，且竟然是第一代的</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-rrlUydg_0mA/TwUpNh5s2AI/AAAAAAAAAjY/SQ9G4thVWs8/s1600/IMAG0006.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="346" src="http://2.bp.blogspot.com/-rrlUydg_0mA/TwUpNh5s2AI/AAAAAAAAAjY/SQ9G4thVWs8/s640/IMAG0006.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;">在打開才發現，這隻我已經有了! 囧</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-JViJOBLQV_w/TwUpS1GsHEI/AAAAAAAAAjg/oIsmvOGE-mc/s1600/IMAG0007.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="346" src="http://3.bp.blogspot.com/-JViJOBLQV_w/TwUpS1GsHEI/AAAAAAAAAjg/oIsmvOGE-mc/s640/IMAG0007.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;">手機正面照</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-MeJxdMnzwDk/TwUpZeLl_YI/AAAAAAAAAjo/YK13GZu9IDE/s1600/IMAG0008.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="346" src="http://4.bp.blogspot.com/-MeJxdMnzwDk/TwUpZeLl_YI/AAAAAAAAAjo/YK13GZu9IDE/s640/IMAG0008.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;">手機背面照! 好有質感</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-pa0S5t8PZL0/TwUpftqk66I/AAAAAAAAAjw/PJHrpF8p8CI/s1600/IMAG0009.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://3.bp.blogspot.com/-pa0S5t8PZL0/TwUpftqk66I/AAAAAAAAAjw/PJHrpF8p8CI/s640/IMAG0009.jpg" width="346" /></a></div><div class="separator" style="clear: both; text-align: center;">配件(電池，耳機，USB傳輸線)</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-lo12_cZQp94/TwUpk6YNxRI/AAAAAAAAAj4/1HHxjcfkChE/s1600/IMAG0010.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://4.bp.blogspot.com/-lo12_cZQp94/TwUpk6YNxRI/AAAAAAAAAj4/1HHxjcfkChE/s640/IMAG0010.jpg" width="346" /></a></div><div class="separator" style="clear: both; text-align: center;">電池轉接頭</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-15LhVOCylc4/TwUpqXgdGQI/AAAAAAAAAkA/ZN-FF_WuLKg/s1600/IMAG0011.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://4.bp.blogspot.com/-15LhVOCylc4/TwUpqXgdGQI/AAAAAAAAAkA/ZN-FF_WuLKg/s640/IMAG0011.jpg" width="346" /></a></div><div class="separator" style="clear: both; text-align: center;">拿在手上的樣子，原本以為會太大! 發現也還好!</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-OLaJS_thgTY/TwUpvBaWUKI/AAAAAAAAAkI/Un_UJwSiwwI/s1600/IMAG0012.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://4.bp.blogspot.com/-OLaJS_thgTY/TwUpvBaWUKI/AAAAAAAAAkI/Un_UJwSiwwI/s640/IMAG0012.jpg" width="346" /></a></div><div class="separator" style="clear: both; text-align: center;">開機照</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-34JajX74fxQ/TwUp0F747wI/AAAAAAAAAkQ/qrJe_sdMH-c/s1600/IMAG0013.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://2.bp.blogspot.com/-34JajX74fxQ/TwUp0F747wI/AAAAAAAAAkQ/qrJe_sdMH-c/s640/IMAG0013.jpg" width="346" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-oWaz4rpDcR4/TwUp5AQcIWI/AAAAAAAAAkY/69f4f62j_xY/s1600/IMAG0015.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="http://1.bp.blogspot.com/-oWaz4rpDcR4/TwUp5AQcIWI/AAAAAAAAAkY/69f4f62j_xY/s640/IMAG0015.jpg" width="346" /></a></div><div class="separator" style="clear: both; text-align: center;">開機比N1快多了</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-0ex63Y8YuSA/TwUp9hcsSVI/AAAAAAAAAkg/erbPCx7w2uk/s1600/IMAG0019.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="346" src="http://3.bp.blogspot.com/-0ex63Y8YuSA/TwUp9hcsSVI/AAAAAAAAAkg/erbPCx7w2uk/s640/IMAG0019.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: center;">和它爺爺(Nexus One)的合照! 莫名感傷</div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/-DG5lp931w8E/TwUqCz0ViBI/AAAAAAAAAko/0ZEXRID5-w0/s1600/IMAG0021.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="346" src="http://2.bp.blogspot.com/-DG5lp931w8E/TwUqCz0ViBI/AAAAAAAAAko/0ZEXRID5-w0/s640/IMAG0021.jpg" width="640" /></a></div><div class="separator" style="clear: both; text-align: -webkit-auto;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody></tbody></table><br />下面是臉部解鎖的影片! 解鎖很快! 不到一秒鐘!<br /><br /><div class="separator" style="clear: both; text-align: center;"><object width="320" height="266" class="BLOG_video_class" id="BLOG_video-5af4af26afcbc42d" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,40,0"><param name="movie" value="//www.youtube.com/get_player" /><param name="bgcolor" value="#FFFFFF" /><param name="allowfullscreen" value="true" /><param name="flashvars" value="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D5af4af26afcbc42d%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1450516984%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3DB77A8BFAB96ED1CDD2154A7CA38ABD95B9FB0CD.1AEC74EB8962CF913C1F9DADA7378CE6C3E13A62%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D5af4af26afcbc42d%26offsetms%3D5000%26itag%3Dw160%26sigh%3DOhz3m_ijbPZNqNXgqnpcd2zDdGk&amp;autoplay=0&amp;ps=blogger" /><embed src="//www.youtube.com/get_player" type="application/x-shockwave-flash" width="320" height="266" bgcolor="#FFFFFF" flashvars="flvurl=http://redirector.googlevideo.com/videoplayback?id%3D5af4af26afcbc42d%26itag%3D5%26source%3Dblogger%26app%3Dblogger%26cmo%3Dsensitive_content%253Dyes%26ip%3D0.0.0.0%26ipbits%3D0%26expire%3D1450516984%26sparams%3Did,itag,source,ip,ipbits,expire%26signature%3DB77A8BFAB96ED1CDD2154A7CA38ABD95B9FB0CD.1AEC74EB8962CF913C1F9DADA7378CE6C3E13A62%26key%3Dck2&amp;iurl=http://video.google.com/ThumbnailServer2?app%3Dblogger%26contentid%3D5af4af26afcbc42d%26offsetms%3D5000%26itag%3Dw160%26sigh%3DOhz3m_ijbPZNqNXgqnpcd2zDdGk&amp;autoplay=0&amp;ps=blogger" allowfullscreen="true" /></object></div><br /><br /><br />最後可以來<a href="http://blog.kenyang.net/2011/12/galaxy-nexus_30.html">這篇看我的使用心得</a><br /><br />
      </div>

      <a href="/2011/12/28/galaxy-nexus" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android HttpURLConnection 上傳檔案 (multipart/form-data)</h1>

      <div class="entry">
        在Android實作(模擬)一個form，<br />不管method是用POST或者GET傳遞普通參數(type="text/password/hidden")，都很簡單!<br /><br />那要傳遞type="fiile"的呢?<br />也就是說要上傳一個檔案呢?<br />在Android裡面就稍嫌複雜了一點點點點!<br /><br />這篇將會結合使用camera，將上傳照相完以後的相片!<br />至於怎麼<a href="http://blog.kenyang.net/2010/10/android-camera.html">取得camera的照完相的照片</a>，可以去看我先前PO的教學! <a href="http://blog.kenyang.net/2010/10/android-camera.html">來這看!</a><br />這邊就不多說怎麼取得，就假設已經取得照片了!<br /><br />我們知道在HTML裡，要上傳含有file的參數，<br />&lt;form&gt;必須加上enctype="multipart/form-data"<br /><br />在實作之前，必須說明一下發出這個form的request的格式會怎樣!<br /><pre class="brush: xml">--==============<br />Content-Disposition: form-data; name="image"; filename="image.jpg"<br />Content-Type: image/jpeg<br /><br />!@#!FAWE@#$!A=fj2j12r<br />--==============--<br /><br /></pre><b><span style="font-size: large;"><br /></span></b><br /><b><span style="font-size: large;"><br /></span></b><br /><b><span style="font-size: large;">第一行是<span style="color: #38761d;">--==============</span>，</span></b><br />是由--加上boundary組成的<br />boundary很重要! 是用來區隔參數的!!<br />也就是說，如果裡有很2個參數，<br />那這2個參數前面都會有這一行!!!<br />對了，boundary可以自己設定，但是前提是要告訴server你的boundary是甚麼!<br />等等會說明到! 這裡的boundary假設是===========<br /><br /><br /><b><span style="font-size: large;">第二行Content-Disposition: form-data; name="image"; filename="image.jpg"</span></b><br />這是宣告你的參數名稱，以及他的當案名稱<br /><br /><br /><b><span style="font-size: large;">第三行Content-Type: image/jpeg</span></b><br />是宣告你的file是甚麼型態，因為我們這邊是拿圖片說明，<br />所以就是jpeg。<br /><br /><br /><span style="font-size: large;"><b>第四行是空白行，</b></span><br />在你寫入參數之前，前面一定是一行空白行<br /><br /><br /><b><span style="font-size: large;">第五行!@#!FAWE@#$!A=fj2j12r</span></b><br />這行就是資料行了，開始寫入資料，因為是上傳圖片，<br />所以這樣看一定是亂碼!<br />如果今天type不是file，是text，<br />那麼就會是明文!<br /><br /><br /><span style="font-size: large;"><b>第六行<span style="color: #38761d;">--==============--</span></b></span><br />最後一個參數傳遞完，一定要加上這一行，<br />告訴server，傳完了!<br /><br /><br /><br />了解格式後，現在就來實作，<br />而在Android的實作如下，<br /><pre class="brush: java">	// 先取得圖片<br />	// uriFilePath是當初設定照相完，要存在哪<br />	// 如果忘記可以去看文章上面說的教學文<br />	FileInputStream fileInputStream = new FileInputStream(new File(uriFilePath.getPath()));<br /><br />	final String BOUNDARY 	= "==================================";<br />	final String HYPHENS 	= "--";<br />	final String CRLF 		= "\r\n";<br />	URL url 				= new URL("http://xxx.xxx.xxx/uploadImage");	<br />	HttpURLConnection conn 	= (HttpURLConnection) url.openConnection();<br />	conn.setRequestMethod("POST");						// method一定要是POST<br />	conn.setDoOutput(true);<br />	conn.setDoInput(true);<br />	conn.setUseCaches(false);	<br />	<br />	// 把Content Type設為multipart/form-data<br />	// 以及設定Boundary，Boundary很重要!<br />	// 當你不只一個參數時，Boundary是用來區隔參數的	<br />	conn.setRequestProperty("Content-Type", "multipart/form-data; boundary=" + BOUNDARY);<br />	<br />	<br />	// 下面是開始寫參數<br />	String strContentDisposition = "Content-Disposition: form-data; name=\"image\"; filename=\"image\"";<br />    String strContentType = "Content-Type: image/jpeg";<br />	DataOutputStream dataOS = new DataOutputStream(conn.getOutputStream());<br />	dataOS.writeBytes(HYPHENS+BOUNDARY+CRLF);		// 寫--==================================<br />	dataOS.writeBytes(strContentDisposition+CRLF);	// 寫(Disposition)<br />	dataOS.writeBytes(contentType+CRLF);			// 寫(Content Type)<br />	dataOS.writeBytes(CRLF);		<br />	<br />	int iBytesAvailable = fileInputStream.available();<br />	byte[] byteData = new byte[iBytesAvailable];<br />    int iBytesRead = fileInputStream.read(byteData, 0, iBytesAvailable);<br />	while (iBytesRead &gt; 0) {<br />		dataOS.write(byteData, 0, iBytesAvailable);	// 開始寫內容<br />		iBytesAvailable = fileInputStream.available();<br />		iBytesRead = fileInputStream.read(byteData, 0, iBytesAvailable);<br />	}<br />	dataOS.writeBytes(CRLF);	<br />	dataOS.writeBytes(HYPHENS+BOUNDARY+HYPHENS);	// (結束)寫--==================================--		<br />	file.close();<br />	dataOS.flush();<br />	dataOS.close();<br /><br /></pre><br />這樣完成了!!<br /><br />
      </div>

      <a href="/2011/12/27/android-httpurlconnection-multipartform" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android C2DM (二)：流程</h1>

      <div class="entry">
        <span style="font-size: large;"><b>前一篇在講<a href="http://blog.kenyang.net/2011/12/android-c2dm.html">參數說明</a></b></span><br /><span style="font-size: large;"><b>這篇專注於流程說明</b></span><br /><span style="font-size: large;"><b>第三篇在講<a href="http://blog.kenyang.net/2012/03/android-c2dm-sever.html">Server端的實作</a></b></span><br /><span style="font-size: large;"><b>第四篇在講<a href="http://blog.kenyang.net/2012/03/android-c2dm-android.html">Android端的實作</a></b></span><br /><br />Android C2DM的實作步驟大概分為下列三項：<br /><ul><li><b>Enabling C2DM </b>：在Android Device上啟動C2DM準備receive訊息。</li><li><b>Sending a message</b>：Server傳遞訊息至Device</li><li><b>Receiving a message</b>：Android上收來自C2DM Server的訊息</li></ul><div>下面是個三項的說明流程，</div><div><br /></div><div><b><span style="font-size: large;">1. Enabling C2DM</span></b></div><div><ol><li>首先要先啟動一個registration Intent到C2DM的SERVER (com.google.android.c2dm.intent.REGISTER)，且這Intent必須但兩個參數，第一個是<span style="color: red;">SENDER ID</span>，第二個是<span style="color: red;">application ID</span>。<a href="http://blog.kenyang.net/2011/12/android-c2dm.html">參數說明請看這。</a></li><li>如果這個registration成功了，C2DM的Server會回傳(broadcast)一個<span style="color: red;">registration ID</span>，這時候Android applicaiton要把這<span style="color: red;">registration ID</span>先存起來，待會用。(Google可能會一段時間就去refresh這個registration ID）</li><li>完成註冊以及取得<span style="color: red;">resgistration ID</span>以後，Android App必須把此ID傳到自己的server上去。Server一樣得把這ID存起來。</li></ol></div>註：register ID會存活直到你unregister，或者直到Google refresh為止。<br /><br /><br /><br /><div><span style="font-size: large;"><b>2. Sending a message</b></span></div><div><ol><li>在send a message之前，必須確認<b>Android app</b>和<b>Sever</b>上已經有<span style="color: red;"> resgistration&nbsp;&nbsp;ID</span>了，以及Sever必須有<span style="color: red;">ClientLogin authorization token</span>. 至於怎麼取得這個token，可以去看<a href="http://code.google.com/apis/accounts/docs/AuthForInstalledApps.html">Google官網說明</a></li><li>完成上面的以後，首先，Sever必須先send訊息至C2DM Sever上</li><li>Google收到以後，會先存起來，以免Android device是inactive的狀態。</li><li>當Device是online的狀態，Google就會send訊息至device上。</li></ol><div><br /></div></div><br /><br /><div><span style="font-size: large;"><b>3. Receiving a Message</b></span></div><div><ol><li>首先Android OS會先收到這則Message， </li><li>接著Android OS會把這則訊息，會根據package name發送到含有註冊com.google.android.c2dm.intent.RECEIVE的app上去</li><li>最後，該app就會從自己註冊的RECEIVER的Intent裡收到message，就可以處理資料了。</li></ol><br /><br /><span style="font-size: large;"><br /></span></div><span style="font-size: large;"><b>下一篇會講如何去實作。</b></span><br /><span style="font-size: large;"><b><br /></b></span><br /><span style="font-size: large;"><b><br /></b></span><br /><span style="font-size: large;"><b><br /></b></span><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/12/24/android-c2dm_22" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android C2DM (一)：元件參數說明</h1>

      <div class="entry">
        <b><span style="font-size: large;">這篇為參數說明!</span></b><br /><b><span style="font-size: large;">下一篇為<a href="http://blog.kenyang.net/2011/12/android-c2dm_22.html">流程說明</a></span></b><br /><span style="font-size: large;"><b>第三篇在講<a href="http://blog.kenyang.net/2012/03/android-c2dm-sever.html">Server端的實作</a></b>&nbsp;</span><br /><span style="font-size: large;"><b>第四篇在講<a href="http://blog.kenyang.net/2012/03/android-c2dm-android.html">Android端的實作</a></b></span><br /><br /><br /><style type="text/css">table.sample {  width: 600px;  border-width: 1px;  border-spacing: 2px;  border-style: solid;  border-color: black;  border-collapse: collapse;  background-color: white; } table.sample .header {  width: 150px;  text-align: left;  border-width: 1px;  padding: 1px;  border-style: solid;  border-color: black;  background-color: white; } table.sample .content {  border-width: 1px;  padding: 1px;  border-style: solid;  border-color: black;  background-color: white; } </style><br />Android <a href="http://code.google.com/android/c2dm/">C2DM </a>(Android Cloud to Device Messaging)<br />C2DM是一個framework，用來負責做messaging的，<br />讓開發者可以從自己的web server傳遞訊息至Android的device上，<br />是一種push的概念!<br />詳細介紹就去官網看吧!<br />這邊主要介紹如何實作，因為發現網路上幾乎都是大陸人在教學，<br />沒有甚麼台灣人在PO教學，所以來PO一下。<br /><br />先介紹三個元件(腳色)<br /><table border="1" cellpadding="4" class="sample"><tbody><tr> <th bgcolor="#99CCFF" colspan="2">Component</th> </tr><tr> <td class="header">Mobile Device</td>      <td class="content">搭載著android 2.2以上的手機</td> </tr><tr> <td class="header">Third-Party Application Server</td>      <td class="content">開發者自己建立的server，它將傳遞訊息給C2DM Server，C2DM再傳遞給Mobile Device。必須建立一個與C2DM Server溝通的管道</td> </tr><tr> <td class="header">C2DM Servers </td>      <td class="content">屬於Mobile Device與Third-Party Application Server之間的中間腳色，負責與這兩個溝通</td> </tr></tbody></table><br />所需的憑證 <br /><table border="1" cellpadding="4" class="sample"><tbody><tr> <th bgcolor="#99CCFF" colspan="2">Credentials</th> </tr><tr> <td class="header">Sender ID</td>      <td class="content">開發者的email帳號，這個email帳號會用來註冊一個C2DM的process</td> </tr><tr> <td class="header">Application ID</td>      <td class="content">簡單的說是package name</td> </tr><tr> <td class="header">Registration ID</td>      <td class="content">由C2DM servers所發行給device，device拿到此id，必須再傳給Third-Party Application Server(就是我們自己建立的)，server會根據此id判斷是否被認可。</td> </tr><tr> <td class="header">Google User Account</td>      <td class="content">每隻device上，必須登入Google 帳號</td> </tr><tr> <td class="header">Sender Auth Token</td>      <td class="content">上面四項都是和device相關的，這個是和server相關的，server必須存有ClientLogin Auth token，用來存取Google的service，至於怎麼取得token很簡單，只要向Google的server發出request，就會回傳給你，可以去<a href="http://code.google.com/apis/accounts/docs/AuthForInstalledApps.html#Using">Google ClientLogin的官網</a>看，或者可以去我<a href="http://blog.kenyang.net/2011/12/telnet-post.html">之前發的文</a>看怎麼用telen發出一個request。這篇將不多做說明。</td> </tr></tbody></table><br /><br /><br /><span style="font-size: x-large;"><b>詳細的流程說明請看<a href="http://blog.kenyang.net/2011/12/android-c2dm_22.html">下一篇</a>。</b></span><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/12/24/android-c2dm" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Life Cycle （二）詳細講解</h1>

      <div class="entry">
        <a href="http://blog.kenyang.net/2011/11/android-lifecycle.html">前一篇</a>已經簡略的說明Android Activity Life Cycle，<br />這篇將詳細說明Activity在Android 裡記憶體life cycle的呈現，<br /><br /><br /><br />假設我有2個 Activity&nbsp;，分別是A(主畫面)、B(子畫面)，<br />A中有一個按鈕，可以換頁面到B<br /><pre class="brush: java">startActivity(new Intent(A.this, B.class));</pre><br /><br />B中有一個按鈕，可以換頁面到A<br /><pre class="brush: java">startActivity(new Intent(B.this, A.class));</pre><br /><br /><br />且A為app進入點<br /><pre class="brush: java">&lt;intent-filter &gt;<br />  &lt;action android:name="android.intent.action.MAIN" /&gt;<br />  &lt;category android:name="android.intent.category.LAUNCHER" /&gt;<br />&lt;/intent-filter&gt;<br /><br /></pre><br /><br />執行此app時，記憶體的表現會如下圖： <br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-dlbPjhqBxWg/TuubZRYATLI/AAAAAAAAAaQ/fGxJXl8DYm8/s1600/a4.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/-dlbPjhqBxWg/TuubZRYATLI/AAAAAAAAAaQ/fGxJXl8DYm8/s320/a4.png" width="281" /></a></div><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-pNjJbp9rEKM/TuuawgdQ18I/AAAAAAAAAZ4/KlNmWLLs2Wg/s1600/a1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="http://3.bp.blogspot.com/-pNjJbp9rEKM/TuuawgdQ18I/AAAAAAAAAZ4/KlNmWLLs2Wg/s1600/a1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="http://3.bp.blogspot.com/-pNjJbp9rEKM/TuuawgdQ18I/AAAAAAAAAZ4/KlNmWLLs2Wg/s1600/a1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><br /></a><a href="http://3.bp.blogspot.com/-pNjJbp9rEKM/TuuawgdQ18I/AAAAAAAAAZ4/KlNmWLLs2Wg/s1600/a1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="326" src="http://3.bp.blogspot.com/-pNjJbp9rEKM/TuuawgdQ18I/AAAAAAAAAZ4/KlNmWLLs2Wg/s400/a1.png" width="400" /></a></div><br />如果這時候在A畫面按下換頁面至B的按鈕，<br />則記憶體的狀態如下圖<br />A會先去call onPause-&gt;onStop<br />注意!!! 並沒有onDestroy，A這個物件是還存在的<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />如果這時候在B畫面按下手機上的"【返回】按鈕，<br />則記憶體的狀態如下圖<br />B會先去call onPause -&gt; onStop -&gt; <span style="color: blue;">onDestroy</span><br />注意!!! 這裡有onDestroy，此時B物件是被銷毀的，<br />這個情況應該是正常的life cycle，<br />可是有些人會用換頁的方式(startActivity)回到上一個畫面，<br />在我的觀念裡，會不建議這樣的行為，繼續往下看!<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-qoMJj_xRCBc/TuuaxIEhKqI/AAAAAAAAAZ8/DCLpAMb1RSQ/s1600/a2.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="276" src="http://1.bp.blogspot.com/-qoMJj_xRCBc/TuuaxIEhKqI/AAAAAAAAAZ8/DCLpAMb1RSQ/s400/a2.png" width="400" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />如果這時候在B畫面，而且想要回到A畫面，<br />B畫面(下圖)中左上角，有一個自己做的返回按鈕，<br />則此時這返回按鈕的code為<br /><pre class="brush: java">startActivity(new Intent(B.this, A.class));</pre><br />當使用者按下這個按鈕時！<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-GIwwGSk0eqI/TuueLiXlvBI/AAAAAAAAAaY/eVsiQXL-Lqk/s1600/device-2011-12-17-033450.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="400" src="http://4.bp.blogspot.com/-GIwwGSk0eqI/TuueLiXlvBI/AAAAAAAAAaY/eVsiQXL-Lqk/s400/device-2011-12-17-033450.png" width="240" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />則此時記憶體的狀態如下圖！<br />B會進入到onStop的狀態！<br />且會有一個新的A畫面（橘色）!!!<br />則此時舊的A畫面（藍色）就會存在記憶體裡，暫時無法回收....<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-SjVEDlL6_8o/Tuuax056yzI/AAAAAAAAAaE/lgui8Dzhe0Y/s1600/a3.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="281" src="http://1.bp.blogspot.com/-SjVEDlL6_8o/Tuuax056yzI/AAAAAAAAAaE/lgui8Dzhe0Y/s400/a3.png" width="400" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />因此不建議用這種方式回到上一個畫面，<br />會講這篇的原因，是為了稍後的另一篇，<br />要講解Bitmap recycle和 Out of Memory (OOM)的問題！<br />在做recycle時，得去考慮到整體life cycle的問題才行！<br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/12/17/android-life-cycle" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Googe App Engine (GAE) 設定 Domain</h1>

      <div class="entry">
        恩，最近蠻常在GAE上面綁一個DOMAIN，<br />雖然蠻常操作，可是每次都還是要想一下，才想起來該怎麼用。<br /><br /><br />在GAE上大概分兩種設定domain，<br /><br /><ol><li>透過Google Apps去買Domain (這種方式在綁domain很簡單)</li><li>自己已經有domain了，想要只到我的GAE上去</li></ol><br />第一種很簡單，就不贅述，<br />第二種也沒難到哪去，只是要在我們買domain(例如：xxx.com)的地方新增一筆cname<br />且還要用我們的domain(例如：xxx.com)去申請Google Apps。<br />然後再verify我們的擁有權！<br /><br /><br />流程大概如下：<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-qEmR5Tyxz_Y/TuoWXEpiqkI/AAAAAAAAAYs/WcCJj8COmWU/s1600/1.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://2.bp.blogspot.com/-qEmR5Tyxz_Y/TuoWXEpiqkI/AAAAAAAAAYs/WcCJj8COmWU/s400/1.PNG" width="127" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟一】<br />先登入到你的ＧＡＥ後台，然後點選你要設定的那個application id，然後在去點選圖中紅色的框框（Application Settings）</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-KTRHVJtpp20/TuoWX8OQx5I/AAAAAAAAAY0/nxKNCYtdeIQ/s1600/2.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="83" src="http://2.bp.blogspot.com/-KTRHVJtpp20/TuoWX8OQx5I/AAAAAAAAAY0/nxKNCYtdeIQ/s640/2.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟二】<br />點選以後，會看到此張圖，請再點選此圖中的Add Domain</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-MieCzRbjvew/TuoWYtq9HlI/AAAAAAAAAY4/Ge8dRcYBi54/s1600/3.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="192" src="http://4.bp.blogspot.com/-MieCzRbjvew/TuoWYtq9HlI/AAAAAAAAAY4/Ge8dRcYBi54/s640/3.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟三】<br />點完按鈕以後會看到此張圖，請先點選圖中的紅色框框（要先用自己的domain去註冊Google Apps）<br />ps: 綠色框框等等會用到</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-8iiXp1bzKxQ/TuoWZs9PFOI/AAAAAAAAAZA/xYSnfvTTIPg/s1600/4.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="252" src="http://2.bp.blogspot.com/-8iiXp1bzKxQ/TuoWZs9PFOI/AAAAAAAAAZA/xYSnfvTTIPg/s640/4.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟四】<br />點選以後會看到此圖，請在圖中的輸入框輸入您的domain，（例如：xxx.com）<br />填寫完以後，請點選Submit按鈕<br />點完按鈕以後，會要求你輸入資料<br />輸入完就點選送出</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-dHi6mQ5lY4M/TuoWaklmzHI/AAAAAAAAAZM/2i4VjcDnr9U/s1600/5.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="266" src="http://1.bp.blogspot.com/-dHi6mQ5lY4M/TuoWaklmzHI/AAAAAAAAAZM/2i4VjcDnr9U/s640/5.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟五】<br />之後會看到此畫面，會要求您驗證domain<br />有很多種驗證方式，這邊就不教了，因為很簡單。</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-xWMZNlkcZds/TuoXsWT16xI/AAAAAAAAAZs/RHOgXrSgADM/s1600/6.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="310" src="http://4.bp.blogspot.com/-xWMZNlkcZds/TuoXsWT16xI/AAAAAAAAAZs/RHOgXrSgADM/s400/6.PNG" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟六】<br />記得步驟三的綠色框框嗎？請回到那，並在那個框框輸入您的domain名稱（例如：xxx.com）<br />接著就會看到這個畫面，就輸入步驟四時填入的管理者帳號資訊</td></tr></tbody></table><div class="separator" style="clear: both; text-align: center;"></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-aU7kdYBZpOQ/TuoWcGmszhI/AAAAAAAAAZY/fdXkABFfnxY/s1600/7.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="232" src="http://2.bp.blogspot.com/-aU7kdYBZpOQ/TuoWcGmszhI/AAAAAAAAAZY/fdXkABFfnxY/s640/7.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟七】<br />登入成功以後就會看到此畫面，就點選此圖中的紅色框框<br />輸入您的sub-domain名稱，（例如：www）<br />接著你就會有一列資料是www.xxx.com</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-FJQhQeOM4bo/TuoWc5xTM4I/AAAAAAAAAZg/vv1drEI-9lM/s1600/8.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="171" src="http://4.bp.blogspot.com/-FJQhQeOM4bo/TuoWc5xTM4I/AAAAAAAAAZg/vv1drEI-9lM/s640/8.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">【步驟八】<br />最後一步了，去到您購買domain的管理後台，這邊是以hinet為主，在後台上新增一筆cname，<br />且value為ghs.google.com<br />主機名稱（sub-domain）就是剛剛步驟七填寫的值</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/12/15/googe-app-engine-gae-domain" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>如何用Telnet POST資料</h1>

      <div class="entry">
        有極少數的網站開發者，<br />在處理有關input資料時，只會在client端進行validate（用Javascript），<br />往往忽略了server端的驗證。<br /><br />如果這時候，hacker寫個小軟體利用telnet發送一個post到你的server，<br />那就爆了!<br />當然，hacker也可以直接寫個form，然後action是對你的server，<br />這樣就避掉client端的js，只不過這邊要說明怎麼用telnet去發出一個request。<br /><br /><br /><br />假設對方做一個輸入mail的page，<br />然後該page有驗證，如果你輸入不是mail的格式，<br />就不會將資料傳到他的server，以及新增至DB。<br />這時候我們就可以利用telnet，跳過他前端的驗證機制!<br /><br /><br />首先打開你的cmd!<br /><br />接著輸入下圖中的指令：<br /><br /><a href="http://4.bp.blogspot.com/-3Q5xiAZwjPY/TuZIO7ov11I/AAAAAAAAAYU/Q2RQKz0vGIg/s1600/1.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="48" src="http://4.bp.blogspot.com/-3Q5xiAZwjPY/TuZIO7ov11I/AAAAAAAAAYU/Q2RQKz0vGIg/s400/1.PNG" width="400" /></a><br /><br /><br /><br /><br /><br />恩，上圖中的網址，記得改成連線的網址，圖中只是範例，<br />你連不到的！<br /><br />連到以後，按下鍵盤的&nbsp;<span class="Apple-style-span" style="font-size: large;">CTRL+]</span>　按鍵<br />接著輸入下圖中的指令，set localecho，輸入完成，按2下enter，<br />這段的目的是讓你等等輸入指令時看得到自己在輸入甚麼，<br />如果沒有這段，等等輸入指令，你是看不到自己在打啥！<br /><br /><a href="http://3.bp.blogspot.com/-OipJ3-j6jOI/TuZIPZO6UBI/AAAAAAAAAYY/iCJeMLTTC1o/s1600/2.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="151" src="http://3.bp.blogspot.com/-OipJ3-j6jOI/TuZIPZO6UBI/AAAAAAAAAYY/iCJeMLTTC1o/s400/2.PNG" style="cursor: move;" width="400" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />接著就可以輸入發送POST的指令了！可以看下圖！<br />建議你，先在記事本上打一打，再貼上，因為在CMD輸入錯了，<br />是不能按DELETE或者Backspace的<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-CjCQk5V-DRk/TuZIP39S0WI/AAAAAAAAAYg/RWNn_jH76UM/s1600/3.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="169" src="http://1.bp.blogspot.com/-CjCQk5V-DRk/TuZIP39S0WI/AAAAAAAAAYg/RWNn_jH76UM/s640/3.png" width="640" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />第一行，記得是POST，然後/yyyy，就是你要收資料的page，要改成自己的喔!<br />第二行，HOST就是主機名稱，<br />第三行，就是告訴server，會有表單的資料傳遞過來<br /><form>第四行，content-lengh，就是你要傳的資料有多長，因為我們的資料是mail=88811，所以是10<br />第五行，就是response完，連線就斷掉。<br /><br />上面都是http header，當然還有很多，你可以自己偽造!<br />例如cookie、date等等之類的!<br />記得header與data之間要空一行空白，<br />接著才可以輸入資料<br />就是圖中的mail=88811。<br />這樣就完成了，你就輸入一個不是正確mail格式的mail給他!<br />且如果他 server沒有進行驗證，這時候就錯誤了!<br />當然你可以把mail的問題放大，可能是sql injection，或者是XSS之類的問題!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></form><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/12/13/telnet-post" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Chrome 防範XSS機制</h1>

      <div class="entry">
        <span class="Apple-style-span" style="background-color: white; color: red; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; white-space: pre-wrap;">Refused to execute a JavaScript script. Source code of script found within request.</span><br /><br /><br />恩，今天再做一個準備Demo何謂XSS攻擊的網頁，<br />發現用Chrome開啟該網頁時，所有的攻擊都無效!!!!!!<br />去看了一下Console，發現出現了下列的訊息<br /><br /><span class="Apple-style-span" style="background-color: white; color: red; font-family: Consolas, 'Lucida Console', monospace; font-size: 12px; white-space: pre-wrap;">Refused to execute a JavaScript script. Source code of script found within request.</span><br /><div>才知道原來在Chrome裡面，只要request裡面含有JS code的，且只要有print出來的，都會被擋掉!!!</div><div><br /></div><div>不知道是在第幾版才有的，感覺Chrome太聰明也不是好事，</div><div>認為還是有些事情是developer該懂的，</div><div>當然!!! 這樣的機制對end user來說是好事! 至少不會被攻擊!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div>
      </div>

      <a href="/2011/12/12/chrome-xss" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Hadoop DataNode 無法啟動</h1>

      <div class="entry">
        好久沒碰Hadoop，今天要重新跑一次project，<br />發現怪怪的，怎麼連都連不上，<br />就連到server上，<br />下了指令jps，看一下是否都正常啟動，<br />發現DataNode沒有啟動!<br /><br />找了一下解決方式，<br />把預設的hadoop.tmr.dir資料夾先砍掉，假設我放在/appKen/hadoop/tmp<br />那就下指令：rm -rf tmp (rf意思是底下所有資料都砍掉)<br /><br />再來就是重新format NameNode，<br />指令：hadoop namenode -format<br /><br />接著就在啟動一次，<br />指令：start-all.sh<br /><br /><br /><br />
      </div>

      <a href="/2011/12/08/hadoop-datanode" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android ListView cacheColorHint</h1>

      <div class="entry">
        <br />在Android中實作ListView的時候，<br />如果要customize一個畫面比較漂亮的ListView，<br />可能會用到Background，如下圖（圖一）<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-GDs-YW3SsIo/Tt6rsL-FQMI/AAAAAAAAAYE/JKRq0y4sLek/s1600/p1.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto; text-align: left;"><img border="0" height="400" src="http://3.bp.blogspot.com/-GDs-YW3SsIo/Tt6rsL-FQMI/AAAAAAAAAYE/JKRq0y4sLek/s400/p1.png" width="240" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />但是如果再做上下滾動的時候你會發現，背景圖片不見了!<br />背景會變成黑色!　且還會有點卡卡的感覺。<br />如下圖（圖二）。<br /><br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-3JAqS4L3IQc/Tt6rtFwR9CI/AAAAAAAAAYI/ueVgGYgFiSg/s1600/p2.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://4.bp.blogspot.com/-3JAqS4L3IQc/Tt6rtFwR9CI/AAAAAAAAAYI/ueVgGYgFiSg/s400/p2.png" width="240" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />原因在於Android在ListView 的Background會做一個Optimization的動作，<br />就是利用一個attributes，<span class="Apple-style-span" style="background-color: white; color: #007000; font-family: monospace; font-size: 13px; line-height: 13px;">android:cacheColorHint</span><br />default值就是現在的顏色dark，<br />為了要關掉這個Optimization，只要把<span class="Apple-style-span" style="background-color: white; color: #007000; font-family: monospace; font-size: 13px; line-height: 13px;">android:cacheColorHint</span>改成如下，<br /><span class="Apple-style-span" style="background-color: white; color: #007000; font-family: monospace; font-size: 13px; line-height: 13px;">android:cacheColorHint="#00000000"</span><br />這樣就不會發生上述的問題了。<br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/12/08/android-listview-cachecolorhint" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Lifecycle （一）入門講解</h1>

      <div class="entry">
        每次都會有點忘記這個lifecycle，<br />總是只記得大概，詳細都會忘記==<br />然後就要自己用LOG來看甚麼情況下會進到這些狀態。<br />這次就乾脆整理一下記錄起來。<br /><br />當activity進行換頁時，會先進入 &nbsp; &nbsp; &nbsp;onPause() -&gt; onStop()<br />按下手機上返回按鈕時，會先進入&nbsp;onPause()&nbsp;-&gt; onStop()&nbsp;-&gt; onDestroy()<br />按下手機HOME按鈕時，會先進入&nbsp;onPause()&nbsp;-&gt; onStop()<br /><br />當先前已經按過HOME鈕，再次點APP，會進入到 &nbsp;onRestart()<br />當先前換頁，再按下返回鈕，也會進入到&nbsp;onRestart()<br />當先前按下返回鈕，再點APP，則會進入到 onCreate()<br /><br />其實GOOGLE有一張自己的流程圖拉，<br />只是我覺得光看流程圖，還是無法知道實際情況發生時，會進到那些狀態。<br />但就搭配著圖看瞜!<br /><br />這篇是比較基本的，想看Activity在Memory中的流程可以看這篇，<a href="http://blog.kenyang.net/2011/12/android-life-cycle.html">點我點我點我</a><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-HX46mAOTqII/Tsq4Bh4g6BI/AAAAAAAAAX8/QvddYPeG8fA/s1600/Untitled.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/-HX46mAOTqII/Tsq4Bh4g6BI/AAAAAAAAAX8/QvddYPeG8fA/s1600/Untitled.png" /></a></div><br />
      </div>

      <a href="/2011/11/22/android-lifecycle" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Java Thread: run() vs start()</h1>

      <div class="entry">
        Java Thread: run() vs start()<br /><br />剛在寫ANDROID，在使用到 audioRecord，所以用到了thread!<br />突然忘記要用run呢? 還是要用start?<br />查了一下資料，才找出差異性。<br /><br /><br />使用run呢，他是循序性的，也就是說他會跑完run裡面的程式，才會跳脫。<br />而start不是。<br />用個簡單的範例說明一下：<br /><pre class="brush: java">Thread t1 = new Thread(new Runnable() {<br /> @Override<br /> public void run() {<br />  for (int i = 0; i &lt; 1000; i++) {<br />   System.out.println("t1");<br />  }<br />});<br /><br />Thread t2 = new Thread(new Runnable() {<br /> @Override<br /> public void run() {<br />  for (int i = 0; i &lt; 1000; i++) {<br />   System.out.println("t2");<br />  }<br /> }<br />});<br /><br /></pre>上面我們宣告了2個thread，一個是t1，一個是t2。<br />都做完一千次才會停止。<br />他們分別會去印出自己是t1還是t2。<br />&nbsp;如果我們是使用run，如下： <br /><pre class="brush: java">t1.run();<br />t2.run();<br /></pre><br />那麼印出來的值一定是像下面一樣<br />&nbsp;<span class="Apple-style-span" style="color: red;">t1 -&gt; t1</span><span class="Apple-style-span" style="color: red;">&nbsp;</span><span class="Apple-style-span" style="color: red;">-&gt; t1 -&gt; .........t1 -&gt; </span><span class="Apple-style-span" style="color: blue;">&nbsp;t2 -&gt; t2 -&gt; ......t2</span><span class="Apple-style-span" style="color: red;">　</span><br />會先印完1000次的t1，才開始印1000次的t2。    但如果我們是使用start，如下：<br /><pre class="brush: java">t1.start();<br />t2.start();<br /></pre><br />結果就會相互交叉，<br />可能是<span class="Apple-style-span" style="color: red;">t1</span>-&gt;<span class="Apple-style-span" style="color: red;">t1</span>-&gt;<span class="Apple-style-span" style="color: blue;">t2</span>-&gt;<span class="Apple-style-span" style="color: red;">t1</span>-&gt;<span class="Apple-style-span" style="color: blue;">t2</span>..........<br />以此類推。<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/11/18/java-thread-run-vs-start" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>C++: Reference (參考)</h1>

      <div class="entry">
        C++: Reference (參考)<br /><br /><a href="http://blog.kenyang.net/2011/11/c-pointer.html">前面一篇講了pointer</a>，這篇要講只有C++才有的reference，<br />C是沒有reference的，相較於pointer，reference顯得平易近人多了!<br />reference有個很大的特性，它的意思是<b>別名(alias)</b>的意思!<br />reference不像pointer記錄著變數的記憶體位置，它只是變數的<span class="Apple-style-span" style="font-size: large;"><b>別名</b></span>!<br /><br />下面用個簡單的例子講解：<br /><br /><pre class="brush: c++">int iValue = 2;<br />int &amp;iReference = iValue;<br />cout &lt;&lt; iReference &lt;&lt; endl;   //會印出2<br />cout &lt;&lt; &amp;iReference &lt;&lt; endl;  //會印出iValue 的記憶體位置<br />cout &lt;&lt; &amp;iValue &lt;&lt; endl;　　　 //會印出iValue本身自己的記憶體位置<br /></pre><br />上面的範例宣告了一個整數變數（iValue)，和一個參考變數（iReference) 第一行會先印出2，<br />因為前面說過參考只是別名， 意思就是說iReference是iValue的別名，<br />在白話一點iReference等於iValue，<br />所以第二行會印出iReference(也就是iValue)的記憶體位置，假設印出0x28ff44（每台電腦都不一定是這個值）<br />第三行就是印出iValue自己的記憶體位置，所以！！！它也會印出0x28ff44!! 跟第二行一樣!!&nbsp;(因為他們兩個相等咩)<br /><br />reference跟pointer不一樣的還有幾點，<br />reference一定要有初始值!!!<br />取值不需要加上*!!<br /><br />不過其實參考使用的時機大部分是用在函數時， 因為是別名，所以可以避免複製大量的變數到函數去(就算是pointer函數，也會複製)<br />下面是一個簡單的參考函數範例：<br /><br /><pre class="brush: c++">void fnReference(int &amp;iValue){<br />     iValue = iValue +1;<br />     cout &lt;&lt; iValue &lt;&lt; endl;        <br />}<br />main(){  <br />          <br />     int iValue = 2;<br />     fnReference(iValue);<br />     cout &lt;&lt; iValue &lt;&lt; endl;<br />        <br />     system("pause");<br />     return 0; <br />}<br /></pre><br /><br />在上面的範例我們宣告了一個函數（fnReference），其傳遞參數為參考型態（&amp;iValue）<br />在主程式中(main)，傳遞了單純的整數變數進去，<br />跟pointer不一樣，pointer是傳記憶體位置進去，<br />參考就直接傳普通的變數進去，<br />我們在函數中把傳遞進去的參數+1，然後印出，會印出3，<br />回到主程式以後，在印出iValue，一樣會印出3。<br />因為我們是傳遞參考，這就是call by reference！<br /><br />最後，reference還有一個跟pointer不一樣的點！<br />就是reference不能用來進行運算!!!!!<br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/11/17/c-reference" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>C++: pointer (指標)</h1>

      <div class="entry">
        學C/C++，我想pointer(指標)是最大的門檻吧!<br />這也是大部分人學C/C++，最痛的東西吧!<br />這篇就稍微的講解pointer!<br /><br />pointer是專門用來儲存<b>某變數</b>的<b>記憶體位置</b>!<br />每宣告一個pointer時，就會配置一塊<b>4 bytes</b>的記憶體空間，<br />專門用來儲存某變數的記憶體位置。<br />下面用簡單的code來說明，<br /><pre class="brush: c++">int iValue = 10;<br />int *iPointer = &amp;iValue;<br /><br />printf("iPointer的value=%d \r\n"            ,  *iPointer);      //取值要用* <br />printf("iPointer儲存value的address=%X \r\n" ,  iPointer);       //沒有*就是印出本身儲存的記憶體位置   <br />printf("iPointer本身的address=%X \r\n"      ,  &amp;iPointer);      //取得記憶體位置都是用&amp; <br />printf("iValue  本身的address=%X \r\n"      ,  &amp;iValue);        //取得記憶體位置都是用&amp; <br />printf("iPointer的size=%d \r\n"             ,  sizeof(iPointer));  <br />printf("iValue的size=%d \r\n"               ,  sizeof(iValue));    <br /><br /><br /></pre><br /><br /><br />下面為執行結果以及說明，：<br /><table border="1"><tbody><tr style="background-color: grey; font-size: 16px; font-weight: bold;">           <td align="center" width="35%">output</td>           <td align="center">&nbsp;&nbsp; 說明</td>     </tr><tr><td width="30%">&nbsp;&nbsp; iPointer的value=10</td><td>印出儲存的記憶體位置本身的value，前面說過pointer是用來儲存記憶體位置，<br />如果要取得該記憶體位置的value，就是利用*</td>      </tr><tr><td width="30%">&nbsp;&nbsp; iPointer儲存value的address=28FF3C</td><td>印出iPointer儲存的資訊（記憶體位置）</td>      </tr><tr><td width="30%">&nbsp;&nbsp; iPointer本身的address=28FF38</td><td>iPointer自己的記憶體起始位置在哪</td>      </tr><tr><td width="30%">&nbsp;&nbsp; iValue &nbsp;本身的address=28FF3C</td><td>第四行就是印出iValue本身的記憶體起始位置，會發現跟第二行一樣，因為iPointer就是儲存這個資訊</td>      </tr><tr><td width="30%">&nbsp;&nbsp; iPointer的size=4</td><td>印出iPointer的大小，前面說過，每個pointer的大小都為4 bytes，不論型態為和</td>      </tr><tr><td width="30%">&nbsp;&nbsp; iValue的size=4</td><td>印出iValue本身的大小，因為是interger，所以為4 bytes</td>      </tr></tbody></table><br /><br />上面為基本用法。<br />pointer也很常用來做字串的處理。<br />原因是用指標處理字串較省記憶體空間，也比較彈性，<br />我們可以宣告一個字串指標指向一個字串常數，<br />下面是個簡單的範例：<br /><pre class="brush: c++">char *pValue[2]     = {"Ken","Yang"};<br />char szValue[2][10] = {"Ken","Yang"};<br />printf("szValue的value=%s \r\n"   ,  szValue[0]);     <br />printf("pValue的value=%s \r\n"  ,  pValue[0]);    <br />printf("szValue的size=%d \r\n"   ,  sizeof(szValue));     <br />printf("pValue的size=%d \r\n"  ,  sizeof(pValue));    <br /><br /></pre><br /><br />下面為執行結果以及說明，顏色相同的為該對應的結果及說明：<br />&lt;table border="1" 　width="70%"&gt;<tbody><tr style="background-color: grey; font-size: 16px; font-weight: bold;">           <td align="center" width="35%">output</td>           <td align="center">&nbsp;&nbsp; 說明</td>     </tr><tr><td width="30%">&nbsp;&nbsp;szValue的value=Ken</td><td>印出儲存在陣列0的value</td>      </tr><tr><td width="30%">&nbsp;&nbsp;pValue的value=Ken</td><td>印出儲存在指標陣列0的value</td>      </tr><tr><td width="30%">&nbsp;&nbsp;szValue的size=20</td><td>字元陣列的大小為20</td>      </tr><tr><td width="30%">&nbsp;&nbsp;pValue的size=8</td><td>指標陣列的大小為8</td>      </tr></tbody><br />可以發現陣列以及指標陣列的第0項，都是ken阿，可是大小卻都不一樣!<br />陣列的大小為20，而指標陣列為8<br />這就是為什麼使用指標會較為省空間的原因，且也較為彈性<br />因為字串指標是可以更改值的，可是字元陣列是不行的。<br /><br />指標還有個特性，就是可以用來做運算，<br />可以看下面簡單的範例，<br /><pre class="brush: c++">char *pString = "Ken";<br />cout &lt;&lt; pString &lt;&lt; endl;<br />cout &lt;&lt; *(pString+1) &lt;&lt; endl;<br />cout &lt;&lt; sizeof(pString) &lt;&lt; endl;<br />cout &lt;&lt; sizeof(*(pString+1)) &lt;&lt; endl;<br />cout &lt;&lt; &amp;pString &lt;&lt; endl;<br /><br /></pre><br />上面的例子，第一行我們先宣告字串指標，然後指定一個字串常數給他，<br />第二行就是印出value來(會印出Ken)<br />第三行就是進行指標的運算(會印出e，如果我們改成+2，就變成n)<br />第四行是印出大小，會印出4，因為說過指標的長度都固定為4<br />第五行也是印出大小，差別是印出該位置的字元大小，那就一定是1了<br />第六行就是印出該記憶體位置了，會發現字串指標跟前面講的變數指標(int, double..之類的)存取value或者存取記憶體的方式都不太同。<br /><br /><br />最後要講的是指標函數，用個簡單的範例來說明，<br /><pre class="brush: c++">void fnPointer(int *pValue){<br />     *pValue=*pValue+1;<br />     cout &lt;&lt; pValue &lt;&lt; endl;    //印出記憶體位置<br />}<br />main(){  <br />     int iValue = 2; <br />     cout &lt;&lt; &amp;iValue &lt;&lt; endl;<br />     fnPointer(&amp;iValue);   //傳遞int變數的記憶體位置進去<br />     cout &lt;&lt; iValue &lt;&lt; endl;<br />}<br /></pre><br />我們先宣告一個函數，那個函數裡的參數是pointer型態，<br />那麼使用方式就是傳遞某變數的記憶體位置進去即可，<br />因為我們說過指標是用來存某變數的記憶體位置!!!<br />所以就是傳遞記憶體位置進去。<br />然後我們再函數fnPointer裡面對value進行+1的動作，<br />然後在印出傳遞進來pointer的記憶體位置，<br />而主程式則是先印出iValue的記憶體位置，<br />在印出iValue的值。<br />會發現，主程式跟函數印出來的記憶體位置都相同!!<br />且在函數裡面進行+1以後，最後在main印出的value會變成3。<br />如果有些人可能會認為還是印出2，代表對pointer的概念還是不太了解(囧)，因為是pointer，還是存取到原本的變數啊!<br />所以也是對原本的變數做操作!!!<br />印出2的方式我們稱為call by value，<br />但印出3的方式我們稱為call by address!<br />還有一種是call by reference!<br />後面一篇會講道!<br /><br /><br />以上是pointer一些簡單的介紹!<br /><a href="http://blog.kenyang.net/2011/11/c-reference.html">下一篇會介紹c++才有的參考(reference)</a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/11/16/c-pointer" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android 強制安裝至 sd card</h1>

      <div class="entry">
        下指令讓"所有"&nbsp;android app強制安裝到sd card中，<br />其實這個指令我還蠻常用到的，蠻常幫朋友下的。<br />但是每次都會稍微忘記!<br />所以記錄一下。<br /><br />首先要先下載<a href="http://dl.google.com/android/android-sdk_r15-windows.zip">android sdk</a>，<br />下載以後，解壓縮放置您要放的目錄，<br />這裡假設放置在C槽，假設目錄名稱為android-sdk，<br />然後將手機插上USB線!<br />接著打開cmd (命令提示字元)，<br />cd到C槽底下的android sdk目錄，在cd到platform-tools底下，<br />完整指令為<br /><pre class="brush: java">cd android-sdk/platform-tools<br /></pre><br />接著利用底下的adb.exe去執行強制安裝至sd card的指令，<br />指令如下：<br /><pre class="brush: java">adb shell pm setInstallLocation 2<br /></pre><br />2：代表讓所有app可以安裝至sd card<br />0：就是初始值，可以自己選擇<br />1：強制安裝在ROM裡面<br /><br />所以如果要恢復初始值的話，指令如下：<br /><pre class="brush: java">adb shell pm setInstallLocation 0<br /></pre><br />
      </div>

      <a href="/2011/11/09/android-sd-card" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Integer.valueOf的Cache機制</h1>

      <div class="entry">
        <br /><br /><br />如果有一個Integer的物件要宣告，<br />大部分的人宣告方式會是如下<br /><pre class="brush: java">Integer a = new Integer(2);<br /></pre><br />但如果其value是介於-128~127之間，<br />某些時刻可以使用下面的宣告方式<br /><pre class="brush: java">Integer a = Integer.valueOf(2);<br /></pre><br />在<b><u>某些條件下</u></b>，速度較快一點點點!!<br />為什麼呢??  我們來看下面的例子!<br /><br /><pre class="brush: java">/*<br /> * 如果不是用new Integer()去賦予值，<br /> * 如果是下方的宣告方式，都會去call Integer.valueOf()這個method<br /> * 也就是說下方的宣告方式，a=2 如同 a=Integer.valueOf(2)<br /> */<br />Integer a = 3;<br />Integer b = 3;<br />System.out.println( a==b ); //印出來會是什麼? <br /></pre><br />如果你的答案是<span class="Apple-style-span" style="color: purple; font-size: x-large;">false</span>，只能說不完全錯<br />因為你的想法，可能是認為==是用來比較2個物件的位址是否相同。<br />如果你是這樣想，那你觀念對了，可是就是忽略掉了valueOf的cache機制。<br />這算是一個陷阱。<br /><br />如果你的答案是<span class="Apple-style-span" style="background-color: white;"><span class="Apple-style-span" style="color: purple; font-size: x-large;">true</span></span>，只能說不完全對<br />因為得取決於你的想法，<br /><br /><ol><li>如果你認為因為a是3，b也是3，3等於3阿，所以是true，那就大錯特錯了。你的觀念需要加強。因為==是比較2個物件的位置是否相同，也就說用來判斷是否為同個物件，並不是判斷value是否相同。</li><li>如果你是認為因為==是比較位置，且知道valueOf有cache機制，所以為true，那你答對了。</li></ol><br />因為在call valueOf這個method時，<br />此method裡面會有判斷是否要調用cache的code，<br />如下，<br /><pre class="brush: java">public static Integer valueOf(int i) {<br />    if(i &gt;= -128 &amp;&amp; i &lt;= IntegerCache.high)<br />        return IntegerCache.cache[i + 128];<br />    else<br />        return new Integer(i);<br />}<br /></pre><br />也就是說如果value是介於-128~127之間，<br />就會掉入到if裡面，而IntegerCache為一個class，<br />在使用這個class時就會去new 256個Integer的物件，並放入cache中，<br />所以在上面的例子a跟b的value都是3，<br />自然會調用同一塊cache，所以用==在比較時，他們的記憶體位置自然為同一塊。<br />因此答案為TRUE。<br /><br />最後!!!<br />或許有人會覺得奇怪，cache會去new 256個Integer物件耶!!<br />這樣用valueOf怎麼會比較快呢??<br />上面有說到<b style="text-decoration: underline;">某些條件下</b>，該條件就是，<br />如果是<span class="Apple-style-span" style="font-size: large;"><b>大量</b></span>宣告的話，此時調用valueOf比較快的條件就成立了。<br /><br /><br />我們可以寫一小段code來判斷執行時間，如下<br /><pre class="brush: java">long lStart = System.nanoTime();<br />for (int i = 0; i &lt; 1000000000 ; i++) {<br /> Integer a = new Integer(3);<br />}<br />long lEnd = System.nanoTime()-lStart;<br /><br />System.out.println((float) lEnd/1000000000);<br /><br />lStart = System.nanoTime();<br />for (int i = 0; i &lt; 1000000000 ; i++) {<br /> Integer a = Integer.valueOf(3);<br />}<br />lEnd = System.nanoTime()-lStart;<br />System.out.println((float) lEnd/1000000000);<br /></pre><br />可以發現上面的例子，<br />用new Integer的方法大概都快要1秒鐘，差不多為0.6秒，<br />但調用Integer.valueOf()的方法大概0.003秒，<br />當然其實人感覺不太到差異啦。<br />只是說硬要評比的話，valueOf的方法較為快。<br />但記得!! 必須符合大量資料的前提才成立。<br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/10/27/integervalueofcache" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>切割子網域（subnet）</h1>

      <div class="entry">
        在<a href="http://blog.kenyang.net/2011/01/ip.html">前一篇</a>中，提到了<a href="http://blog.kenyang.net/2011/01/ip.html">IP分級以及網域</a>的概念。<br /><br />在這篇中，將說明切割子網域的概念！<br /><br />IP分級是為了管理方便，但今天假設我們有一個Class A的IP，<br /><br />我們不可能將一個Class A的IP僅僅設定一個區網！很浪費！<br /><br />且該區網底下也很容易發生壅塞的情形！效能會不好<br /><br />那麼這時候就得運用切割子網域的概念！<br /><br /><br />假設我們有個Class C的IP（192.168.0.0～192.168.0.255），<br /><br />且我們要將該Class C的IP切割成4個子網域！<br /><br />那麼該怎麼做？<br /><br />我們知道Class C的IP的<b>net_id</b>有24個！<br /><br />先假設我們要將一個Class C的IP細切割成4個子網域！<br /><br />那麼我們可以跟<b>host_id</b>借<span class="Apple-style-span" style="color: red;">2</span>個bits！（2的<span class="Apple-style-span" style="color: red;">2</span>次方，所以是借<span class="Apple-style-span" style="color: red;">2</span>個）<br /><br />也就是說<b>net_id</b>變成26個！<br /><br />如：11000000.101010000.00000000.<span class="Apple-style-span" style="color: red;">0</span><span class="Apple-style-span" style="color: red;">0&nbsp;</span>000000（192.168.0.0）<br /><br />這樣就會有<span class="Apple-style-span" style="color: red;">00, 01, 10, 11 </span>這樣就會有4種組合，<br /><br />這樣就可以切成4個子網域了！！<br /><br />而每個子網域，就會剩下2的6次方個ip（64）。<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/10/24/class-c" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Integrate CAPTCHA to your site (without plugin)-【2】</h1>

      <div class="entry">
        在前一篇<a href="http://blog.kenyang.net/2011/05/integrate-captcha-to-your-site-using.html">筆記</a>有提到如何利用plugin去顯示一個驗證碼(captcha)的功能，<br /><br />而這篇是要教導大家如何用另一種方法(AJAX API)去顯示驗證碼，<br /><br />***記得*** 一樣要去申請api key，至於如何申請，請至<a href="http://blog.kenyang.net/2011/05/integrate-captcha-to-your-site-using.html">前一篇</a>檢閱。<br /><br />而使用AJAX API的優點，簡單來說，你在你的.jsp, .asp, .php....etc的頁面中，<br /><br />不會看到該language的語法，例如：&lt;% %&gt; ＜？　？＞, ...等等之類的。<br /><br />我們只要用簡單的javascript語法就可以顯示一個驗證碼。<br />首先我們得在我們頁面中，這裡假設是captcha.html中，<br /><br />【第一步】加入 Google的js檔案，如下:<br /><pre class="brush: js">&lt;script type="text/javascript" src="http://www.google.com/recaptcha/api/js/recaptcha_ajax.js"&gt;&lt;/script&gt;<br /></pre><br /><br /><br />【第二步】在captcha.html中加入一個div的element，如下:<br /><pre class="brush: html">&lt;div id="captcha"&gt;&lt;/div&gt;<br /></pre><br /><br /><br />【第三步】開始create一個驗證碼，請加入下列javascript語法：<br /><pre class="brush: js">&lt;script&gt;<br />     window.onload = function() {<br />          Recaptcha.create(<br />                   "xxxxxxx",  //你的api key<br />                   "captcha",  //第二步驟中div的id<br />                   {<br />                        theme: "red",<br />                        callback: Recaptcha.focus_response_field<br />                   }<br />          );<br />  <br />     }<br />&lt;/script&gt;<br /><br /></pre><br /><br />這樣就大功告成，至於如何驗證，<br />其實驗證方式也是有兩種，<br />兩種都是透過ajax，<br />第一種是寫一隻程式，這隻程式是用來接收參數並且驗證資料<br />並且用ajax向這隻程式傳遞參數。可以參考我前一篇的<a href="http://blog.kenyang.net/2011/05/integrate-captcha-to-your-site-using.html">驗證方法</a><br /><br />而第二種是直接向此連結<span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif; font-size: x-small; line-height: 16px;">http://www.google.com/recaptcha/api/verify</span>發出request，<br />但是大概懂ajax的人都知道""基本上""是無法跨domain進行request，<br />當然有其他solution，但因為我先前已經有寫好上個方法的驗證方法，<br />所以我就直接用第一種方式，也較簡易!<br />但是還是建議大家直接用第二種方式，不然使用ajax api就失去了意義!<br /><br />而這篇是教導大家如何using ajax api去顯示一個驗證碼。<br />所以就不詳細說明如何利用ajax去進行驗證。(反正用jQuery的ajax api很簡單，就不贅述了!）<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/07/22/displaying-recaptcha-without-plugins" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Install Android Plugin for Eclipse</h1>

      <div class="entry">
        這篇主要是在教導大家如何在Eclipse中，安裝開發Android程式的plugin，<div>其實這類型的文章在網路上很多，但會打這篇主要是為了今年資管營的學生們，</div><div>為了讓他們能夠快速地找到安裝教學，因此打這篇。</div><div><br /></div><div><br /></div><div>首先我們要先去下載</div><div><ol><li><a href="http://www.oracle.com/technetwork/java/javase/downloads/jdk-6u26-download-400750.html">JDK (請在下面選擇符合自己作業系統的版本)</a></li><li><a href="http://www.eclipse.org/downloads/packages/eclipse-classic-37/indigor">Eclipse Classic 3.7 (請在右邊選單選擇符合自己的版本)</a></li><li><a href="http://dl.google.com/android/android-sdk_r11-windows.zip">Android SDK</a></li></ol><div><br /></div></div><div>下載完成以後，請照著下面的步驟操作：</div><div><ol><li>安裝第一個下載的檔案JDK</li><li>將第二個下載的檔案Eclipse解壓縮出來到一個目錄，無須安裝，即可使用</li><li>將第三個檔案Android SDK解壓縮出來到一個目錄即可。</li><li>開啟Eclipse</li><li>看到上方的選單，請點選【Help】→點選【Install New Software】→點選【Add】→在Name地方輸入android，Location地方輸入http://dl-ssl.google.com/android/eclipse &nbsp;→點選下方按鈕【Next】進行安裝。</li><li>完成上步驟，應該會重新啟動Eclipse，應該會看到如圖中的紅色框框選項<a href="http://2.bp.blogspot.com/-pTvVhox-Nn8/ThNhoprnIQI/AAAAAAAAAWU/AZSYV5Kv_DY/s1600/3.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="66" src="http://2.bp.blogspot.com/-pTvVhox-Nn8/ThNhoprnIQI/AAAAAAAAAWU/AZSYV5Kv_DY/s320/3.PNG" width="320" /></a></li><li>此時再點選上方選單的【Window】→點選【Preferences】→點選【Android】→在右邊視窗的SDK Location選擇剛剛第三個檔案解壓縮的位置→點選【Apply】→點選【OK】</li><li>完成上步驟，再點選下圖中的紅色框框<a href="http://2.bp.blogspot.com/-pTvVhox-Nn8/ThNhoprnIQI/AAAAAAAAAWU/AZSYV5Kv_DY/s1600/3.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="66" src="http://2.bp.blogspot.com/-pTvVhox-Nn8/ThNhoprnIQI/AAAAAAAAAWU/AZSYV5Kv_DY/s320/3.PNG" width="320" /></a></li><li>點選【Available packages】→將兩個選項都打勾→點選【Install selected】→接著就一直按next或者finish即可。</li><li>按照上面9步驟即可完成安裝Android Plugin for Eclipse</li></ol><div><br /></div></div><div><br /></div><div><br /></div><div class="separator" style="clear: both; text-align: center;"></div>
      </div>

      <a href="/2011/07/06/install-android-plugin-for-eclipse" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Using Eclipse for Windows to connect to Hadoop</h1>

      <div class="entry">
        先前已經在<a href="http://blog.kenyang.net/2011/06/how-to-install-hadoop-on-ubuntu-single.html">前一篇</a>，教導大家如何<a href="http://blog.kenyang.net/2011/06/how-to-install-hadoop-on-ubuntu-single.html">安裝hadoop</a>在ubuntu上面了，<br />這篇主要是在說明如何在windows的環境下，<br />使用eclipse去<b>連結</b>到ubuntu上的hadoop，<br />將會在下一篇教導大家如何撰寫一個Map/Reduce程式。<br /><br /><br />在我連結成功之前，在Google上找了不知道多少資料。<br />但沒有任何一篇是完完全全符合這個案例的!<br />大部分找到的案例都是，在Windows環境下安裝cygwin，<br />利用cygwin來模擬出unix環境，然後再unix中架設hadoop，<br /><br />問題是這樣的案例...根本沒有太大意義，因為是模擬，就只是單純玩玩而已，<br />所以才打這篇教學，如何在windows真的連結到一台實體的linux server上。<br /><br />我的本機基本環境如下：<br />Eclipse 3.6<br />Windows 7 64bits<br /><br />實體linux server環境如下：<br />ubuntu 10.10<br />hadoop 0.20.2<br /><br /><br /><span class="Apple-style-span" style="font-size: large;"><b>【步驟一】首先我們得去下載三個檔案，</b></span><br /><br /><ol><li>&nbsp;<a href="https://issues.apache.org/jira/secure/attachment/12460491/hadoop-eclipse-plugin-0.20.3-SNAPSHOT.jar">hadoop-eclipse-plugin-0.20.3-SNAPSHOT.jar</a>&nbsp;先下載這個jar檔，並放在eclipse資料夾底下的/plugin資料夾裡面，有人可能會發現，為什麼我們實體server上的hadoop版本是0.20.2，可是我們用的eclipse plugin版本卻是0.20.3，而不是用0.20.2，這是因為0.20.2有問題。（稍後會說明甚麼問題）</li><li><a href="http://www.cygwin.com/">cygwin</a>　第二個下載這個並且安裝起來，安裝過程很簡單，恕不贅述，但或許有人會納悶..為什麼要安裝這個? 這個不是模擬unix嗎? 我們不是要連結到實體的linux server上嗎? 如果懂MapReduce原理的人，可能就會稍微理解，大家可以去看由2位Google Fellow所提出的<a href="http://labs.google.com/papers/mapreduce-osdi04.pdf">paper</a>。簡單的說Reduce最後會將結果輸出到本機硬碟上，而這裡的本機是linux，所以會用到一些相關指令是windows沒有的，例如:chown，所以我們得利用<a href="http://www.cygwin.com/">cygwin</a>安裝好後裡面/bin資料夾的一些linux指令。</li><li><a href="http://labs.renren.com/apache-mirror/hadoop/core/hadoop-0.20.2/hadoop-0.20.2.tar.gz">hadoop 0.20.2</a>&nbsp;第三個下載hadoop，原因是再eclipse for windows中開發hadoop專案，會用到一些hadoop的jar檔案，並且解壓縮出來，在這篇，還不需要用到，在下一篇進行程式開發，將會用到!</li></ol><br /><br /><span class="Apple-style-span" style="font-size: large;"><b>【步驟二】設定環境變數</b></span><br />下載以及安裝完成以後，<br />請記得設定環境變數，<br />設定方式如下（不好意思，我的OS是英文版，請大家自行對照自己電腦）<br />在我的電腦上點選右鍵→點選內容，<br />會看到下圖(圖一)，請點選Change Setting，<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-9ShbMycRvbE/ThBk69JEuSI/AAAAAAAAAVY/82hNym9ipiY/s1600/1.PNG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="183" src="http://3.bp.blogspot.com/-9ShbMycRvbE/ThBk69JEuSI/AAAAAAAAAVY/82hNym9ipiY/s400/1.PNG" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />點選完後，會看到下圖（圖二），再點選Advanced，<br />點選以後再點選Environment Variables<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-ZhTkYNhlITU/ThBk7DL-xGI/AAAAAAAAAVc/dMdvsjZMCgI/s1600/2.PNG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://4.bp.blogspot.com/-ZhTkYNhlITU/ThBk7DL-xGI/AAAAAAAAAVc/dMdvsjZMCgI/s400/2.PNG" width="362" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />點選完成後，會看到下圖（圖三），請先找到Path這個系統變數，<br />並按下Edit按鈕。<br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-tQPDVBmS-qg/ThBk7snYgUI/AAAAAAAAAVg/bdMYffeg5T0/s1600/3.PNG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://2.bp.blogspot.com/-tQPDVBmS-qg/ThBk7snYgUI/AAAAAAAAAVg/bdMYffeg5T0/s400/3.PNG" width="370" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖三</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />點選完以後，會看到下圖（圖四），<br />請在最後面增加";c:\cygwin\bin"，<br />不需要雙引號喔！增加完成以後按下OK，請先重開機!<br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-U8Z1mxxbLq8/ThBk8ANAPbI/AAAAAAAAAVk/EvHGJFxRF1Q/s1600/4.PNG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="168" src="http://3.bp.blogspot.com/-U8Z1mxxbLq8/ThBk8ANAPbI/AAAAAAAAAVk/EvHGJFxRF1Q/s400/4.PNG" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖四</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【步驟三】設定Eclipse</span></b><br />設定完成以後，並且有把.jar檔放入eclipse/plugin以後，<br />請開啟Eclipse，<br />並點選Eclipse視窗中的右上角，如下圖(圖五)上方的框框，再點選other，<br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-tS4hDiqTA9s/ThBp_D58STI/AAAAAAAAAVo/EECA6iRvAs4/s1600/5.png" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/-tS4hDiqTA9s/ThBp_D58STI/AAAAAAAAAVo/EECA6iRvAs4/s1600/5.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖五</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />點選完以後，會看到下圖(圖六)<br />請選擇Map/Reduce，<br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-xVD-BpIrFyI/ThBp_rMi-AI/AAAAAAAAAVs/B1_HOzMg_mY/s1600/6.PNG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="320" src="http://1.bp.blogspot.com/-xVD-BpIrFyI/ThBp_rMi-AI/AAAAAAAAAVs/B1_HOzMg_mY/s320/6.PNG" width="262" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖六</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【步驟四】新增Map/Reduce Location</span></b><br /><br />點選完成會看到下圖(圖七)，<br />應該會有個Map/Reduce Locations的視窗，如左邊紅色框框，<br />此時請點選右邊紅色框框來新增一個Location<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-wXrmpAnShWA/ThBp_9CCzVI/AAAAAAAAAVw/azZU2RCNgws/s1600/7.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-wXrmpAnShWA/ThBp_9CCzVI/AAAAAAAAAVw/azZU2RCNgws/s1600/7.PNG" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖七</td></tr></tbody></table><br /><br /><br />點選完成會看到下圖(圖八)，<br />就根據你們自己的位置輸入相關資訊吧!<br />那個user name並無大礙，填寫完成以後按下Finish。<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-ShVMxBNCeSw/ThBqAdQxdLI/AAAAAAAAAV0/Na7XiyPlaQA/s1600/8.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="480" src="http://3.bp.blogspot.com/-ShVMxBNCeSw/ThBqAdQxdLI/AAAAAAAAAV0/Na7XiyPlaQA/s640/8.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖八</td></tr></tbody></table><br /><br /><br /><br />點選完成以後，會看到下圖(圖九)<br />會發現多了一個選項了，但是還沒完成喔，<br />我們在這個選項上點選右鍵，並點選Edit，<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-jRZOl52CGhA/ThBrZ_3eFZI/AAAAAAAAAWA/zqMcGX2iFQU/s1600/9.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="80" src="http://2.bp.blogspot.com/-jRZOl52CGhA/ThBrZ_3eFZI/AAAAAAAAAWA/zqMcGX2iFQU/s640/9.PNG" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖九</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【步驟五】設定Map/Reduce Location的參數</span></b><br />再點選上圖，圖八中的Advanced Parameters，來修改一些參數，<br />有些人可能會問，為什麼不一開始就修改，因為有些參數，必須先建立好第一步，<br />然後再進行修改它才會出現。<br /><br />此時我們先找兩個參數，<br /><br />第一個是dfs.permissions.supergroup，請修改成你能對server上的hadoop進行存取的群組，我的server上群組是hadoop，所以我會在這欄修改成【hadoop】。<br />第二個是hadoop.job.ugi，跟上面一樣，但請修改成【hadoop,Tardis】。<br /><br /><br /><br />完成上面的步驟以後，<br />看到eclipse左邊的視窗，並點開DFS Locations，<br />會見到下圖(圖十)，會發現你已經連線成功了，如果你是根據我這篇的<a href="http://blog.kenyang.net/2011/06/how-to-install-hadoop-on-ubuntu-single.html">安裝教學</a>，你看到的資料夾名稱應該會是app，而不是appKen。<br />且不會看到user/hadoop/input這個資料夾，這個資料夾的功用是放置，程式將要讀取的資料。<br />將在下一篇，教導大家如何建立一個Map/Reduce專案。<br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-4yR7A3a2A9k/ThBqA1XDszI/AAAAAAAAAV8/JTLbVjeR23Q/s1600/10.PNG" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" src="http://3.bp.blogspot.com/-4yR7A3a2A9k/ThBqA1XDszI/AAAAAAAAAV8/JTLbVjeR23Q/s1600/10.PNG" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖十</td></tr></tbody></table><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />相關文章：<br /><br /><ul><li><a href="http://blog.kenyang.net/2011/06/how-to-install-hadoop-on-ubuntu-single.html">如何安裝Hadoop</a></li></ul><br /><br /><br /><br />
      </div>

      <a href="/2011/07/03/using-eclipse-for-windows-to-connect-to" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>How to install Hadoop on Ubuntu (single-node cluster)</h1>

      <div class="entry">
        這篇主要教導大家如何在ubuntu上架起single-node的hadoop。<br />會在其他篇教導大家如何架設multi-node。<br />因為架設multi-node的前提是先得架設single-node。<br />所以先教導大家如何架設。<br />至於如何執行一個MapReduce的project將在下一篇教導大家。<br /><br />我的環境如下：<br />ubuntu版本：10.10<br />hadoop：0.20.2<br /><br /><span class="Apple-style-span" style="font-size: large;"><br /></span><br /><b><span class="Apple-style-span" style="font-size: large;">【1】要架設hadoop起來的前提是必須安裝Sun的java-jdk</span></b><br />&nbsp; &nbsp; &nbsp;<b>【1.1】首先先增加Canonical Partner Repository到我們的repositories，語法如下：</b><br /><pre class="brush: java">sudo add-apt-repository "deb http://archive.canonical.com/ lucid partner"</pre>&nbsp; &nbsp; &nbsp;<b>【1.2】更新我們的source.list，語法如下：</b><br /><pre class="brush: java">sudo apt-get update</pre>&nbsp; &nbsp; &nbsp;<b>【1.3】安裝sun java sdk，語法如下：</b><br /><pre class="brush: java">sudo apt-get install sun-java6-jdk</pre>&nbsp; &nbsp; &nbsp;<b>【1.4】因為linux的jdk預設為open-jdk，所以語法如下：</b><br /><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【2】建立一個Hadoop系統的專屬使用者</span></b><br /><pre class="brush: java">sudo addgroup hadoop<br />sudo adduser --ingroup hadoop hadoop<br /></pre><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【3】設定SSH，因為hadoop利用ssh去管理node</span></b><br />&nbsp; &nbsp; &nbsp;<b>【3.1】首先先產生一個SSH key給hadoop user，語法如下：</b><br /><pre class="brush: java">su - hadoop<br />ssh-keygen -t rsa -P "" &nbsp;</pre>&nbsp; &nbsp; &nbsp;<b>【3.2】利用新產生的key去accees本機上的機器，語法如下：</b><br /><pre class="brush: java">su - hadoop<br />cat $HOME/.ssh/id_rsa.pub &gt;&gt; $HOME/.ssh/authorized_keys<br /></pre><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【4】關閉IPv6</span></b><br />&nbsp; &nbsp; &nbsp;<b>【4.1】利用vim去開啟設定檔，語法如下：</b><br /><pre class="brush: java">vim /etc/sysctl.conf&nbsp;</pre>&nbsp; &nbsp; &nbsp;<b>【4.2】將檔案中的設定改</b><b>如下：</b><br /><pre class="brush: java">#disable ipv6<br />net.ipv6.conf.all.disable_ipv6 = 1<br />net.ipv6.conf.default.disable_ipv6 = 1<br />net.ipv6.conf.lo.disable_ipv6 = 1<br /></pre><br /><br /><br /><b>上面都是為了安裝Hadoop的先前作業</b><br /><b>下面是正式進行下載以及安裝Hadoop</b><br /><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【5】下載Hadoop並且解壓縮</span></b><br /><pre class="brush: java">cd /usr/local<br />wget http://apache.ntu.edu.tw/hadoop/core/hadoop-0.20.2/hadoop-0.20.2.tar.gz<br />tar zxvf hadoop-0.20.2.tar.gz<br />sudo mv hadoop-0.20.2 hadoop<br />sudo chown -R hadoop:hadoop hadoop<br /></pre><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【6】更新$HOME/.bashrc(注意!是以hadoop身分執行語法)</span></b><br />&nbsp; &nbsp; &nbsp;<b>【6.1】利用vim去開啟.bashrc，語法如下：</b><br /><pre class="brush: java">sudo vim $HOME/.bashrc&nbsp;</pre>&nbsp; &nbsp; &nbsp;<b>【6.2】將檔案中的設定更改成如下：</b><br /><pre class="brush: java"># Set Hadoop-related environment variables<br />export HADOOP_HOME=/usr/local/hadoop<br /><br /># Add Hadoop bin/ directory to PATH<br />export PATH=$PATH:$HADOOP_HOME/bin<br /></pre><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【7】Hadoop的設定</span></b><br />&nbsp; &nbsp; &nbsp;<b>&nbsp;接著是一連串的Hadoop設定檔，設定檔的位置都位於/usr/local/hadoop/conf/底下，</b><br />&nbsp; &nbsp; &nbsp;<b>&nbsp;都是先利用vim去開啟設定檔案做編輯，故下面就省略vim的語法</b><br />&nbsp; &nbsp; &nbsp;<b>【7.1】hadoop-env.sh，語法如下：</b><br />&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp;把預設的JAVA_HOME位置更改掉<br /><pre class="brush: java"># The java implementation to use.  Required.<br />export JAVA_HOME=/usr/lib/jvm/java-6-sun&nbsp;</pre>&nbsp; &nbsp; &nbsp;<b>【7.2】core-site.xml，語法如下：</b><br />&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp;紀錄Hadoop將資料存在哪<br />&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;先建立一個Hadoop的暫存資料夾，並設定權限及擁有人<br /><pre class="brush: java">sudo mkdir /app/hadoop/tmp<br />sudo chown hadoop:hadoop /app/hadoop/tmp<br />sudo chmod 750 /app/hadoop/tmp&nbsp;</pre>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;接著就是打開設定檔更改設定，注意!請填自己的ip，改成如下:<br /><pre class="brush: xml"><property><br />  <name>hadoop.tmp.dir</name><br />  <value>/app/hadoop/tmp</value><br />  <description>A base for other temporary directories.</description><br /></property><br /><br /><property><br />  <name>fs.default.name</name><br />  <value>hdfs://140.133.xxx.xxx:54310</value><br />  <description>The name of the default file system.  A URI whose<br />  scheme and authority determine the FileSystem implementation.  The<br />  uri's scheme determines the config property (fs.SCHEME.impl) naming<br />  the FileSystem implementation class.  The uri's authority is used to<br />  determine the host, port, etc. for a filesystem.</description><br /></property><br /></pre><br />&nbsp; &nbsp; &nbsp; <b>【7.3】mapred-site.xml，語法如下：</b><br />&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;打開設定檔更改設定，注意!請填自己的ip，改成如下:<br /><pre class="brush: xml"><property><br />  <name>mapred.job.tracker</name><br />  <value>140.133.xxx.xxx:54311</value><br />  <description>The host and port that the MapReduce job tracker runs<br />  at.  If "local", then jobs are run in-process as a single map<br />  and reduce task.<br />  </description><br /></property><br /></pre><br />&nbsp; &nbsp; &nbsp;<span class="Apple-style-span" style="font-weight: bold;">【7.4】hdfs-site.xml，語法如下：</span><br />&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp;打開設定檔更改設定，此檔案紀錄著檔案被複製的數量，改成如下:<br /><pre class="brush: xml"><property><br />  <name>dfs.replication</name><br />  <value>1</value><br />  <description>Default block replication.<br />  The actual number of replications can be specified when the file is created.<br />  The default is used if replication is not specified in create time.<br />  </description><br /></property><br /></pre><br /><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【8】對我們的namenode格式化</span></b><br /><pre class="brush: xml">/usr/local/hadoop/bin/hadoop namenode -format<br /></pre><br />出來的output應該會如下：<br /><pre class="brush: xml">11/06/30 16:59:56 INFO namenode.NameNode: STARTUP_MSG:<br />/************************************************************<br />STARTUP_MSG: Starting NameNode<br />STARTUP_MSG:   host = ubuntu/140.133.xxx.xxx<br />STARTUP_MSG:   args = [-format]<br />STARTUP_MSG:   version = 0.20.2<br />STARTUP_MSG:   build = https://svn.apache.org/repos/asf/hadoop/common/branches/branch-0.20 -r 911707; compiled by 'chrisdo' on Fri Feb 19 08:07:34 UTC 2010<br />************************************************************/<br />10/05/08 16:59:56 INFO namenode.FSNamesystem: fsOwner=hadoop,hadoop<br />10/05/08 16:59:56 INFO namenode.FSNamesystem: supergroup=supergroup<br />10/05/08 16:59:56 INFO namenode.FSNamesystem: isPermissionEnabled=true<br />10/05/08 16:59:56 INFO common.Storage: Image file of size 96 saved in 0 seconds.<br />10/05/08 16:59:57 INFO common.Storage: Storage directory .../hadoop-hadoop/dfs/name has been successfully formatted.<br />10/05/08 16:59:57 INFO namenode.NameNode: SHUTDOWN_MSG:<br />/************************************************************<br />SHUTDOWN_MSG: Shutting down NameNode at ubuntu/140.133.xxx.xxx<br />************************************************************/<br /><br /></pre><br /><br /><br /><b><span class="Apple-style-span" style="font-size: large;">【9】啟動我們的single-node cluster</span></b><br /><pre class="brush: xml">/usr/local/hadoop/bin/start-all.sh<br /></pre><br /><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; line-height: 24px;">這將會啟動機器上的Namenode, Datanode, Jobtracker and a Tasktracker!!</span><br />出來的output應該會如下：<br /><pre class="brush: java">starting namenode, logging to /usr/local/hadoop/bin/../logs/hadoop-hadoop-namenode-ubuntu.out<br />localhost: starting datanode, logging to /usr/local/hadoop/bin/../logs/hadoop-hadoop-datanode-ubuntu.out<br />localhost: starting secondarynamenode, logging to /usr/local/hadoop/bin/../logs/hadoop-hadoop-secondarynamenode-ubuntu.out<br />starting jobtracker, logging to /usr/local/hadoop/bin/../logs/hadoop-hadoop-jobtracker-ubuntu.out<br />localhost: starting tasktracker, logging to /usr/local/hadoop/bin/../logs/hadoop-hadoop-tasktracker-ubuntu.out<br /></pre><br /><br />如果要檢查是否有啟動成功，可以打入下列語法:<br /><pre class="brush: java">jps</pre><br />正確出來的output應該會如下：<br /><pre class="brush: java">2287 TaskTracker<br />2149 JobTracker<br />1938 DataNode<br />2085 SecondaryNameNode<br />2349 Jps<br />1788 NameNode<br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><blockquote></blockquote>
      </div>

      <a href="/2011/07/01/how-to-install-hadoop-on-ubuntu-single" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Integrate CAPTCHA to your site (using plugin)-【1】</h1>

      <div class="entry">
        CAPTCHA，相信大家不陌生，<br />是驗證碼的意思(如圖)，<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-RIWB8_DEW-A/TeLTZ0tI0_I/AAAAAAAAAT4/vkgx2JFD2iw/s1600/Captu3re.PNG" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="134" src="http://1.bp.blogspot.com/-RIWB8_DEW-A/TeLTZ0tI0_I/AAAAAAAAAT4/vkgx2JFD2iw/s320/Captu3re.PNG" width="320" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />原本我是在Google App Engine中，自己畫出那些驗證碼的數字!<br />在local端可以繪出圖形來，但是deploy上去GAE以後，<br />就失敗了，原因是因為有個class並不被GAE支援。<br />因此無法繪圖。<br /><br />我也懶得找其他的solution，第一個念頭就是找是否有相關的API。<br />找到了<a href="http://code.google.com/intl/zh-TW/apis/recaptcha/intro.html">reCAPTCHA</a>(被Google買的)。<br /><br />接下來就來說明<a href="http://code.google.com/intl/zh-TW/apis/recaptcha/intro.html">reCAPTCHA</a>如何整合及運作。<br />reCAPTCHA提供了兩種方法，讓開發者將reCAPTCHA整合至自己的網站中，<br />1) using plugin.<br />2)&nbsp;writing code to communicate with our servers.<br />第一種就是Google已經以大部分的程式語言撰寫出一個套件讓開發者使用。<br />第二種就是寫一些簡單的code和他們的server進行溝通(驗證) <br />兩種其實都不難，都很簡單。<br /><br />但這裡我就先教大家第一種。<br />1)&nbsp;首先請大家先至<a href="https://www.google.com/recaptcha/admin/create">此網站</a>進行申請，輸入您要使用reCAPTCHA的domain。&nbsp;如圖一<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-xB0EYR4EvuU/TeLVYAbWTGI/AAAAAAAAAT8/1vBqAiTurPs/s1600/1.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="235" src="http://4.bp.blogspot.com/-xB0EYR4EvuU/TeLVYAbWTGI/AAAAAAAAAT8/1vBqAiTurPs/s400/1.PNG" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table>2) 輸入完成以後，會得到兩組key，一組是public，一組是private。<br /><br />3) 申請完成以後，就選擇你要以哪種程式語言進行整合。(這裡選JAVA)<br /><br />4) 來<a href="http://code.google.com/p/recaptcha/downloads/list?q=label:java-Latest">此處</a>下載lib(recaptcha4j-0.0.7.jar)，並且放進去project。<br /><br />5) 接著就開始coding。<br /><br />先撰寫client端要顯示CAPTCHA圖片的code<br /><br />1) 首先先撰寫client端的code，先import需要的class<br /><pre class="brush: java">&lt;%@ page import="net.tanesha.recaptcha.ReCaptcha" %&gt;<br />&lt;%@ page import="net.tanesha.recaptcha.ReCaptchaFactory" %&gt;<br /></pre><br /><br />2) 建立一個intance以準備create一個captcha，記得填入自己的public、private key。<br />第三個參數在官方文件中並沒有說明，但是去看source code，是"includeNoscript"的意思，<br />意思是說此instance(object)是否包含Noscript，而這邊是沒有，所以是false<br /><pre class="brush: java">ReCaptcha c = ReCaptchaFactory.newReCaptcha("your_public_key", "your_private_key", false);<br /><br /></pre><br /><br />3) 利用剛剛object的顯示出CAPTCHA來。<br />第一個參數(errorMessage)是指當有錯誤時要顯示甚麼樣的訊息<br />第二個參數(options)是指一些要給此object的一些特別屬性(如:theme)<br /><pre class="brush: java">c.createRecaptchaHtml(null, null)<br /><br /></pre><br /><br /><br />接下來就寫server端驗證的code!<br /><br /><pre class="brush: java">String remoteAddr = request.getRemoteAddr();<br />ReCaptchaImpl reCaptcha = new ReCaptchaImpl();<br />reCaptcha.setPrivateKey("your_private_key");<br /><br />String challenge = request.getParameter("recaptcha_challenge_field"); //這個參數是要給server要求驗證的<br />String uresponse = request.getParameter("recaptcha_response_field"); //這個參數是使用者輸入的參數!<br />ReCaptchaResponse reCaptchaResponse = reCaptcha.checkAnswer(remoteAddr, challenge, uresponse);<br /><br />if (reCaptchaResponse.isValid()) {<br /> out.print("Answer was entered correctly!");<br />} else {<br /> out.print("Answer is wrong");<br />}<br /><br /></pre><br /><br /><br />這樣就大功告成了。
      </div>

      <a href="/2011/05/30/integrate-captcha-to-your-site-using" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>a tutorial on install GAE plugin on eclipse</h1>

      <div class="entry">
        因為學弟妹需要在GAE上使用Google Analytics，<br />因此打這篇安裝流程給學弟妹。<br /><br /><br />主要分成兩大步驟，<br />(一) 先去註冊Google App Engine<br />(二) 在Eclipse上安裝GAE Plugin<br /><br />(一)在上課時就請大家申請好了，這邊就不多做說明。<br />主要講解(二)&nbsp;步驟，<br /><br />(二)的逐步步驟如下：<br /><br />1) 先來到這個網址&nbsp;<a href="http://www.eclipse.org/downloads/">http://www.eclipse.org/downloads/</a>&nbsp;,接著下載 "<b>Eclipse Classic 3.6.2, 171 MB"</b><br /><b><br /></b><br />2) 下載完成，就進行解壓縮，不需要進行安裝的動作就可以使用<b>Eclipse&nbsp;</b><br /><b><br /></b><br />3) 接著就打開<b>Eclipse </b>，點選工具列上的Help（如圖一）<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-2uHTaYtQqbE/TdIeGIs6C0I/AAAAAAAAATQ/k6VcFVWwP18/s1600/1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="328" src="http://4.bp.blogspot.com/-2uHTaYtQqbE/TdIeGIs6C0I/AAAAAAAAATQ/k6VcFVWwP18/s640/1.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table><br /><br /><div class="separator" style="clear: both; text-align: center;"></div>4) 並點選Install New Software，會見到以下畫面（圖二）<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-PX1srSNbOmA/TdIegvqn7aI/AAAAAAAAATs/nk256EBGKqA/s1600/Capture.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="357" src="http://4.bp.blogspot.com/-PX1srSNbOmA/TdIegvqn7aI/AAAAAAAAATs/nk256EBGKqA/s400/Capture.PNG" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><br />5) 請點選上圖（圖二）中的Add按鈕，點選以後會出現下圖（圖三）<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-g5K_tDAvlj4/TdIeGbZ0pfI/AAAAAAAAATU/-PPfLv99aws/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="115" src="http://3.bp.blogspot.com/-g5K_tDAvlj4/TdIeGbZ0pfI/AAAAAAAAATU/-PPfLv99aws/s320/2.png" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖三</td></tr></tbody></table><br />6) 請在圖三中的兩個欄位（Name、Location）輸入這些資訊<br />Name：隨意取，但盡量取相關名稱<br />Location：告訴Eclipse你要安裝的plugin在哪個位置<br /><br />7) 輸入完成後請按OK，並稍等一下，會見到下圖（圖四）<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/--1cvKtn_gTI/TdIeG0KWAiI/AAAAAAAAATY/1_-C7ujlU2g/s1600/3.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="362" src="http://2.bp.blogspot.com/--1cvKtn_gTI/TdIeG0KWAiI/AAAAAAAAATY/1_-C7ujlU2g/s400/3.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖四</td></tr></tbody></table>8) 出現上圖（圖四）以後，請勾選Plugin以及SDKs，勾選以後點選Next即可進行安裝。<br /><br />9) 安裝完成，會發現工具列上多了四個按鈕（如圖五）<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/-xxJAyRvgZ2Q/TdIeHXulnFI/AAAAAAAAATc/Xt1yVWNUIlo/s1600/4.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="48" src="http://1.bp.blogspot.com/-xxJAyRvgZ2Q/TdIeHXulnFI/AAAAAAAAATc/Xt1yVWNUIlo/s400/4.png" width="400" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖五</td></tr></tbody></table>以上是安裝GAE Plugin 的步驟。<br /><br /><br />接下來說明建立一個project的步驟。<br /><br />1) 點選下圖（圖六）中的藍色圈圈，並點選New Web Application Project<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-5kL69U7nfT0/TdIeHrSq9XI/AAAAAAAAATg/7pdezICVwoA/s1600/5.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://4.bp.blogspot.com/-5kL69U7nfT0/TdIeHrSq9XI/AAAAAAAAATg/7pdezICVwoA/s1600/5.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖六</td></tr></tbody></table><br />2) 點選以後，會見到下圖（圖七），並輸入相關資訊<br /><b>Project Name：</b>專案名稱（需英文）。EX: test<br /><b>Package：　　</b>之後建立的class都會在此package名稱底下，package名稱由兩個以上的英文組成，並且英文之間須以句號(.)來進行分隔。 EX: com.ken<br /><b>Location：　　</b>此project會存在哪裡，預設是存在workspace，當然也可以更改儲存路徑<br /><b>Google SDKs：</b>這邊有兩個選項(1) Use Google Web Toolkit、(2) Use Google App Engine，在這邊我們只需要勾選(2)就好，不需要勾選(1)GWT。<br /><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-ao77qEkl_yE/TdIeH0Cfg4I/AAAAAAAAATk/SfXvfE7PlUw/s1600/6.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="400" src="http://3.bp.blogspot.com/-ao77qEkl_yE/TdIeH0Cfg4I/AAAAAAAAATk/SfXvfE7PlUw/s400/6.png" width="321" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖七</td></tr></tbody></table><br />3) 輸入相關資訊後，按下Finish即可完成建立。<br /><br />4) 接著就可以安插Google&nbsp;Analytics的js code。（這邊以前上JSP/Servlet過的話應該都會了，就不進行說明）這裡就是普通的JSP/Servlet，GAE較不同且較精華的是Database的部分，GAE是採用datastore(big table)，它是屬於物件式資料庫，並不是傳統在學校學的關聯式資料庫。這邊學弟妹只需要上傳Google&nbsp;Analytics的code，因此就不深入講解datastore。<br /><br />5) 安插以後，按下圖八中的飛機按鈕進行deploy的動作。<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/-pz9pWu8WnHg/TdIeIZFkfEI/AAAAAAAAATo/TdgnQzEBu5A/s1600/7.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://2.bp.blogspot.com/-pz9pWu8WnHg/TdIeIZFkfEI/AAAAAAAAATo/TdgnQzEBu5A/s1600/7.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖八</td></tr></tbody></table>6) 按下以後會見到下圖（圖九），按下按鈕Deploy之前！！！！請先點選圖九中的App Engine project settings<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/-O4i07K7XfMg/TdIiQWqDJeI/AAAAAAAAATw/9Dh3J78g1aQ/s1600/Capture1.PNG" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="176" src="http://3.bp.blogspot.com/-O4i07K7XfMg/TdIiQWqDJeI/AAAAAAAAATw/9Dh3J78g1aQ/s320/Capture1.PNG" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖九</td></tr></tbody></table>7) 點選以後會見到下圖（圖十），請記得填寫自己的Application ID。填寫完成按下按鈕OK，就會回到圖九，此時再按下按鈕Deploy，就完成了<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-7hJhZtLiTbU/TdIiQrPaaRI/AAAAAAAAAT0/dCdXQovfsaA/s1600/Capture2.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="279" src="http://1.bp.blogspot.com/-7hJhZtLiTbU/TdIiQrPaaRI/AAAAAAAAAT0/dCdXQovfsaA/s320/Capture2.PNG" width="320" /></a></div><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/05/17/tutorial-on-install-gae-plugin-on" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>JSTL problem of Import with param</h1>

      <div class="entry">
        我有一個set of entity，<br />我想要把這entity的資料，redirect到另一個page（footer.jsp），<br />我用了JSTL的<c:import></c:import><br />如下：<br /><pre class="brush: html"> <br />&lt;c:import url = "/footer.jsp"  charEncoding="utf-8"&gt;<br /> &lt;c:param name="com"&gt;${requestScope.company }&lt;/c:param&gt;<br />&lt;/c:import&gt;<br /><br /></pre><br />但是http在request&nbsp;parameters時會當作string來對待，<br />但在這個例子中，我傳的是一個object，<br />所以在接收頁時會有錯誤，因為該object已經被轉成string，<br />所以會找不到該property，<br />因為在<c:param>會自行把value轉換成string，</c:param><br />如同String.valueOf()。<br /><br />所以我改用另一個方法，如下<br /><pre class="brush: html">&lt;c:set var="com" value="${requestScope.company}" scope="request" /&gt;    <br />&lt;c:import url = "/footer.jsp"  charEncoding="utf-8" /&gt;<br /><br /></pre><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/04/28/jstl-problem-of-import-with-param" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>ubuntu install vsftpd</h1>

      <div class="entry">
        今天剛灌好ubuntu server，順便把vsftpd裝起來，<br />但是發現一直找不到該package，<br />結果發現其實只是沒有更新sources.list，<br />只要下<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 200px;">sudo apt-get update </div><br />更新完以後，就可以找到了。<br />只要下<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 200px;">sudo apt-get install vsftpd </div>就可以安裝起來。<br />安裝完成以後，就針對設定檔進行一些微調<br />像是我不希望我的ftp server可以匿名登入，<br />那麼我就要去設定檔把匿名登入關掉，<br />首先先用編輯器開啟設定檔<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 200px;">sudo vim /etc/vsftpd.conf</div>打開以後，把<br /><br />anonymous_enable=YES<br />改成<br /><br />anonymous_enable=no<br /><br />接著存檔離開。<br />並重新啟動<br /><div style="background: #E3F0FA; border: 1px dashed #89A6C6; margin-left: 10px; margin-top: 10px; padding-left: 10px; width: 300px;">sudo /etc/init.d/vsftpd restart</div><br />這樣即可。<br />詳細設定檔可以去鳥哥看<br /><br />
      </div>

      <a href="/2011/03/31/ubuntu-install-vsftpd" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>GAE/J DatastoreNeedIndexException: no matching index found解決方式</h1>

      <div class="entry">
        今天在實作一對多的relation，<br /><br />在部署上去以後，一直覺得出錯，<br /><br />錯誤訊息是：<b>com.google.appengine.api.datastore.DatastoreNeedIndexException: no matching index found..</b><br /><br />原因當然是因為沒有建立index，可是覺得很怪，<br /><br />因為之前記得會自動幫我建立index，<br /><br />找了一下solution，<br /><br />發現只要在local端run一次，就會自動幫我建立好index，<br /><br />並且會放在project_path\war\WEB-INF\appengine-generated資料夾底下，<br /><br />檔名為datastore-indexes-auto.xml<br /><br />裡面就是幫你建立相關的index語法。<br /><br />當然你也可以自己建立index。<br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/03/18/gaej-datastoreneedindexexception-no" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Implement Yahoo Login (Using BBAuth)</h1>

      <div class="entry">
        想讓自己網站上的使用者不用註冊就可以使用自己的網站，<br /><br />只要有Yahoo帳號就可以登入自己的網站的話，<br /><br />可以導入Yahoo Login API，<br /><br />而Yahoo Login API主要分成三種，<br /><br />可以用下列三種認證/授權方式，<br /><br />1. OAuth<br /><br />2. OpenID<br /><br />3. BBAuth<br /><br />這邊選用第三種BBAuth，<br /><br />首先要先去註冊你的appid，<br /><br /><a href="https://developer.apps.yahoo.com/wsregapp/">點這裡來註冊</a><br /><br />點開以後，會看到如下圖（圖一）的表格，<br /><br />第一格Yahoo ID：不用自己填，會幫你填好<br /><br />第二格Authentication method：點選第二個（Browser Based Authentication）<br /><br />第三格Developer/Company Name：填寫自己的名稱或公司名稱<br /><br />第四格Product Name：填寫產品名稱<br /><br />第五格Web Application URL：是指你網站的網址（不能IP喔）<br /><br /><b>第六格BBAuth Success URL：這格很重要，意思是當使用者登入成功以後，下個頁面要轉到哪個頁面</b><br /><b><br /></b><br />第七格Contact Email：填入自己的信箱就好<br /><br />第八格Phone Number：填入電話，這格為optional，可以不填<br /><br />第九格Description of application：敘述<br /><br /><b>第十格Require Access Scope：這格也很重要！意思是說這個認證可以在Yahoo的哪些服務進行存取，這邊我們先勾選Single Sign On, no user data can be accessed就好</b><br /><b><br /></b><br />填寫完成以後就點選Continue，<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://lh6.googleusercontent.com/-Xzu1Zal2Yrc/TXgz2F15ZFI/AAAAAAAAARs/6U5eGC00EhM/s1600/1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="628" src="https://lh6.googleusercontent.com/-Xzu1Zal2Yrc/TXgz2F15ZFI/AAAAAAAAARs/6U5eGC00EhM/s640/1.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table>點完按鈕Continue以後，會看到下圖（圖二）<br /><br />這頁主要是要進行認證的動作，Yahoo要check這個domain是屬於你的！<br /><br />做法是在自己的domain的根目錄底下放置一個.html檔案，<br /><br />檔名yahoo會提供給你，這邊的檔名是ydnv6nnxP.html。<br /><br />將此檔案放置在domain根目錄底下，<br /><br />然後按下圖中的按鈕Check Domain，<br /><br />此時Yahoo就會去request該.html檔，如果有放置上去，<br /><br />就會通過驗證。就會如圖中的Result: <span class="Apple-style-span" style="color: #38761d;">Pass</span><br /><br />如果是Pass，就繼續往下一步，按下按鈕Continue<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><div class="separator" style="clear: both; text-align: center;"></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://lh6.googleusercontent.com/-Ti8XoBygyGE/TXgzHJLVt0I/AAAAAAAAARc/0CUUXbJLaDY/s1600/1.5.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="304" src="https://lh6.googleusercontent.com/-Ti8XoBygyGE/TXgzHJLVt0I/AAAAAAAAARc/0CUUXbJLaDY/s640/1.5.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table><div class="separator" style="clear: both; text-align: -webkit-auto;"><br /></div><div class="separator" style="clear: both; text-align: -webkit-auto;">點完Continue按鈕以後，會看到下圖（圖三）的畫面</div><div class="separator" style="clear: both; text-align: -webkit-auto;"><br /></div><div class="separator" style="clear: both; text-align: -webkit-auto;">代表申請成功，Yahoo會給你app id和secret</div><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://lh3.googleusercontent.com/-U7J5MM21LMY/TXgzHz4HlTI/AAAAAAAAARk/bLcaZyaNerU/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="262" src="https://lh3.googleusercontent.com/-U7J5MM21LMY/TXgzHz4HlTI/AAAAAAAAARk/bLcaZyaNerU/s640/2.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖三</td></tr></tbody></table><br />申請完成以後就開始來寫code了！！<br /><br />這邊我以JSP/SERVLET為主，<br /><br /><pre class="brush: java">try{<br />     final String strAppId = "appID"; //應用程式碼<br />     final String strSecrect = "secect"; //驗證用<br />     String strTimeStamp = String.valueOf(new Date().getTime()/1000); //把毫秒轉成秒數<br />             <br />     //接下來這段主要是在做md5，<br />     MessageDigest Signature = MessageDigest.getInstance("MD5");<br />     //下面這行是Yahoo要求要進行md5的參數<br />     String tempMD5 = String.format("/WSLogin/V1/wslogin?appid=%s&amp;.intl=tw&amp;send_userhash=1&amp;ts=%s%s", strAppId, strTimeStamp, strSecrect);<br />     Signature.update(tempMD5.getBytes());<br /> <br />     byte[] Bt = Signature.digest();<br />     StringBuffer buffer = new StringBuffer();<br />     for (int i = 0; i &lt; Bt.length; ++i) {<br />          byte b = Bt[i];<br />          int value = (b &amp; 0x7F) + (b &lt; 0 ? 128 : 0);<br />          buffer.append(value &lt; 16 ? "0" : "");<br />          buffer.append(Integer.toHexString(value));<br />     }<br />     //md5 結束<br />           <br />     //進行完md5以後，就進行Redirect<br />     resp.sendRedirect(String.format("https://api.login.yahoo.com/WSLogin/V1/wslogin?appid=%s&amp;.intl=tw&amp;send_userhash=1&amp;ts=%s&amp;sig=%s", strAppId, strTimeStamp, buffer.toString()));<br />  <br />}catch (Exception e) {<br />     //MD5 Exception<br />}<br /></pre><br /><br />在進行完redirect以後，就會轉向Yahoo登入的頁面，<br /><br />登入完成就會將頁面導向之前<b>第六格BBAuth Success</b>的URL<br /><br />接下來有比較重要的幾點，<br /><br />由於Yahoo Login是無法取得使用者的資訊，<br /><br />它不同於Facebook、Goolge Login，<br /><br />可是一般的網站不是都要記住session嗎?<br /><br />可能是將使用者帳號之類的資訊存在session裡面，<br /><br />可是Yahoo卻無法存取到使用者相關資訊，<br /><br />但是!Yahoo會回傳一個userhash，到<b>第六格BBAuth Success</b>的URL中，<br /><br />而這個userhash是唯一的，不會有重複!<br /><br />所以我們一樣可以利用此userhash存在session裡面，<br /><br />還會回傳appid、token、appdata、ts、sig這些參數回來。<br /><br />但比較重要的是userhash，因為這個是Unique的identifier!!<br /><br />大致上這樣就完成一個Yahoo Login了。<br /><br /><br /><a href="http://developer.yahoo.com/bbauth/user.html">參考來源</a><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/03/10/implement-yahoo-login-using-bbauth" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Java static,final 基本概念</h1>

      <div class="entry">
        從很久以前我就了解到，<br /><br />不僅僅要知道know how，<br /><br />還要知道know why，<br /><br />舉個例子，當我派工作給底下的人做時，<br /><br />例如要他做出一個發送mail的功能出來，<br /><br />恩，拜Google大神所賜，通常很快都可以找到發送mail的code。<br /><br />但是當我細下去問每一行code的用途時，<br /><br />大多是...."恩...不知道"。<br /><br />我覺得此風不可長。<br /><br />甚至有些學弟們搞不清楚何時要用static、final。<br /><br />也不懂甚麼是interface、abstract等等之類的。<br /><br />因為他們也不知道這些東西的作用。<br /><br />所以用這篇文章來稍微解說一下。<br /><br /><span class="Apple-style-span" style="font-size: x-large;"><b>static：</b></span><br /><br />靜態的意思<br /><br />可以用來宣告一個函數或者變數，<br /><br />只要記得當一個函數或者變數被宣告為static時，<br /><br />他就具有唯一值的概念！！<br /><br />他就永遠只佔著那一組記憶體空間。<br /><br />不管該類別被new幾個object，該值永遠都會是一樣的！<br /><br />舉個例子！<br /><br />我們看到下面code的例子<br /><br /><pre class="brush: java">class test{<br />     static int iValue = 0;<br />     public test() {<br />     }<br />}<br />public class main {<br />     public static void main(String[] argv)  {<br />          test test1 = new test();<br />          test test2 = new test();<br />          System.out.println(test1.iValue);<br />          test2.iValue  = 10;<br />          System.out.println(test2.iValue);<br />          System.out.println(test1.iValue);<br />     } <br />}<br /><br /><br /></pre><br />我們把test這個類別裡的資料成員iValue宣告為static，<br /><br />然後再main裡面分別去new兩個object出來。<br /><br />分別是test1, test2，<br /><br />然後先印出test1的iValue出來，（印出0，當然！一開始是0）<br /><br />接著我們用test2這個object去將iValue設值設為10，<br /><br />接著再去印出test2的iValue出來，（印出10出來，當然！因為設成10了阿）<br /><br />重點來了！<br /><br />這時候再印出test1的iValue出來！<br /><br />大部分的人會覺得，應該是印出0阿，<br /><br />但是印出的是10。<br /><br />原因是因為我們將iValue宣告成static了。<br /><br />而iValue成為一個共同的變數。<br /><br />這就是static 的一個特性！<br /><br /><b><span class="Apple-style-span" style="font-size: large;">特性一：永遠會是一個唯一值！！</span></b><br /><b><br /></b><br />且static 還有一個特性，<br /><br /><b><span class="Apple-style-span" style="font-size: large;">特性二：static可以透過類別直接存取使用！</span></b><br /><br />意思是我們其實不需要new 一個object出來。<br /><br />也可以透過類別直接去存取該變數<br /><br />例子如下！<br /><br /><pre class="brush: java">class test{<br />     static int iValue = 0;<br />     public test() {<br />     }<br />}<br />public class main {<br />     public static void main(String[] argv)  {<br />          System.out.println(test.iValue);<br />     }<br />}<br /><br /><br /></pre><br />你會發現在main中，我們並沒有new一個object出來！！<br /><br />也可以存取到test這個類別中的資料成員（iValue）<br /><br />static的介紹大概到這，<br /><br />接著介紹final<br /><br /><span class="Apple-style-span" style="font-size: x-large;">final：</span><br /><br />相較於static，final的概念就容易了解許多！<br /><br />可以用來宣告一個類別、函數、或者變數。<br /><br />類別：當宣告在類別上時，該類別就無法被繼承！<br /><br />函數：當一個函數被宣告為final時，則繼承他的子類別無法覆寫<br /><br />變數：當一個變數被宣告為final時，意思是他是一個常數，是無法被修改的。<br /><br /><br /><span class="Apple-style-span" style="font-size: large;">注意！</span><br /><br />使用static final需要注意一點！！<br /><br />如上面所述說的，當我們有一個常數要宣告時，<br /><br />會宣告如下<br /><br /><pre class="brush: java">public static final String strValue = "ken";<br /></pre><br />為什麼宣告這樣會有個風險呢？<br /><br />因為java在進行compile的時候，<br /><br />會將宣告成static final的變數，直接包進去程式裡面。<br /><br />什麼意思呢？<br /><br /><pre class="brush: java">System.out.println(strValue);<br /></pre><br />當你有類似存取strValue的code時， <br /><br />我們去把java會把compile成的class，decompile來看 <br /><br />會發現它變成如下的code <br /><br /><pre class="brush: java">System.out.println("ken");<br /></pre><br /><br />好啊好啊，那到底風險又在哪？<br /><br />當然啦，如果你今天有用一些好用的IDE進行開發，<br /><br />應該是不會遇到這樣的風險，<br /><br />以Eclipse為例，只要你一儲存或者執行，Eclipse就會幫你進行compile！<br />（如果有勾選Build Automatically的話）<br /><br />可是如果你今天是徒法煉鋼！<br /><br />自己下指令進行compile的時候...<br /><br />又剛好你程式改了，把strValue的值改為"yang"，<br /><br />又剛好你忘記進行compile....<br /><br />這時候...如果有人去存取strValue就會出錯!!<br /><br />那怎麼解決???<br /><br />我們可以利用static block來進行宣告的動作!!!<br /><br />如下：<br /><br /><pre class="brush: java">static String strValue;<br />static{<br />     strValue = "ken";<br />}<br /></pre><br />如果用這樣的宣告方式，即可避免上面述說的問題！<br /><br /><br />原諒我，太累了。<br /><br />今天就先講解static,final 基本概念<br /><br />下篇在講解interface, abstract!!<br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/03/10/java-staticfinal" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>實作 Facebook Login【舊版】</h1>

      <div class="entry">
        這篇主要是在GAE上整合Facebook Login。<br /><br />在整合之前得先做一些準備!<br /><br />先講解三個基本運作條件。<br /><ol><li>User Authentication. 首先Facebook會先去認證這個user，判斷它的帳密是否有誤。</li><li>App Authorization. 第二步Facebook會先去認證你的網站，這可以保證user給予的<b><u>基本</u></b>資訊是給你的網站，而不是其他的。</li><li>App Authentication. 第三步是可以保證user知道有那些較<b><u>詳細</u></b>的資料可以被你的網站挖掘。</li></ol>知道基本運作條件以後，<br /><br />請先至<a href="http://www.facebook.com/developers/">http://www.facebook.com/developers/</a>此網站，<br /><br />進去以後會看到下圖（圖一），並且點選圖中紅色方框中的按鈕<b>Set Up New App。</b><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TVCjnQAGoHI/AAAAAAAAAQ8/OwvpFu4z9zQ/s1600/0.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="304" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TVCjnQAGoHI/AAAAAAAAAQ8/OwvpFu4z9zQ/s640/0.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖一</td></tr></tbody></table>點選以後， 如果先前並沒有開發過Facebook相關app的developer，<br /><br />會見到下圖（圖二），告知您並沒有驗證過，請透過mobile phone or credit card驗證。（免費的）<br /><br />這裡我們選擇moblie phone做驗證。<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TVCjpmh7OEI/AAAAAAAAARE/UioJ7P0QYpU/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="136" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TVCjpmh7OEI/AAAAAAAAARE/UioJ7P0QYpU/s640/2.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖二</td></tr></tbody></table>&nbsp;點選圖二中的mobile phone以後，會見到下圖（圖三），會要求您輸入您的電話號碼，<br /><br />記得要選取為台灣的國籍碼886，還有一點很重要！！！！<br /><br />在Phone Number欄位中，填寫的手機號碼，記得把0拿掉！！！<br /><br />如：963123123（不要加上0）<br /><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TVCjqCQF2JI/AAAAAAAAARI/v2YA5iFiRC0/s1600/3.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="498" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TVCjqCQF2JI/AAAAAAAAARI/v2YA5iFiRC0/s640/3.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖三</td></tr></tbody></table><br />點下圖三中的Confirm按鈕以後，Facebook會回傳一組verify code至您的手機，<br /><br />請將verify code輸入。並按下按鈕OK。驗證成功後會出現下圖（圖四）<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TVCjqt16p4I/AAAAAAAAARM/xdXuA-Ixzbk/s1600/4.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="490" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TVCjqt16p4I/AAAAAAAAARM/xdXuA-Ixzbk/s640/4.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖四</td></tr></tbody></table>&nbsp;當驗證完成以後，再去點選圖一中紅色方框中的按鈕<b>Set Up New App。</b><br /><b><br /></b><br />並且輸入App名稱，然後再點選圖五中的按鈕Create App。<br /><b><br /></b><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TVCjq3MipXI/AAAAAAAAARQ/4STQTHXX5js/s1600/5.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="306" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TVCjq3MipXI/AAAAAAAAARQ/4STQTHXX5js/s640/5.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖五</td></tr></tbody></table>完成以後，Facebook 會給予你這個app一些基本資訊（App ID、API Key、App Secret....etc）<br /><br />接著得做一些設定，點選圖六中的方框中的連結<b>Edit Settings</b><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TVCjrb8GEFI/AAAAAAAAARU/QOU3IqlhIcY/s1600/6.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="396" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TVCjrb8GEFI/AAAAAAAAARU/QOU3IqlhIcY/s640/6.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖六</td></tr></tbody></table>點選以後，會進到如下圖(圖七)的畫面，請先點選左方的Web Site ，接著就輸入一些相關資訊！<br /><br /><br /><ol><li>Site URL：輸入您的網址（如：www.google.com）</li><li>Site Domain：輸入您的domain（如：google.com）</li></ol><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TVCjrw869kI/AAAAAAAAARY/SAYS614DJZg/s1600/7.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="340" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TVCjrw869kI/AAAAAAAAARY/SAYS614DJZg/s640/7.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">圖七</td></tr></tbody></table><br />完成上述設定步驟以後，就可以來寫code了喔！！！<br /><br /><span style="color: red; font-size: x-large;">注意!!! 底下的code已經不能使用了! 因為FB改版了!</span><br /><span style="color: red; font-size: x-large;">所以請至<a href="http://blog.kenyang.net/2012/01/facebook-login.html">另一篇來看如何實作</a>!</span><br /><br />首先，請在你的加入facebook的script。<br /><br />如底下：<br /><br /><pre class="brush: html">&lt;script src="http://connect.facebook.net/en_US/all.js"&gt;&lt;/script&gt;<br /></pre><br /><br /><br />接著就輸入下段code！<br /><br /><pre class="brush: javascript">&lt;script&gt;<br /> //先做init的動作，輸入自己的app id<br /> FB.init({ <br />  appId:'你自己的app id', <br />  cookie:true, <br />  status:true, <br />  xfbml:true <br /> });<br /> <br /> //接著去subscribe一個event，就是去監聽一個event<br /> //這邊去監聽有關login的event。（也就是說login成功以後，會接收到訊息）<br /> FB.Event.subscribe('auth.login', function(response) {<br />  if (response.session) {<br />   alert('login success');//登入成功 <br />  } else {<br />   alert('login fail');<br />  }<br /> });<br />&lt;/script&gt;<br /></pre><br /><br /><br />完成以後就在你的頁面上，xfbml語法放置一個Facebook登入的button<br /><br />如下：<br /><br /><pre class="brush: html">&lt;fb:login-button&gt;Login with Facebook&lt;/fb:login-button&gt;<br /></pre><br /><br /><br />這樣就大功告成了！！！<br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2011/02/08/implement-facebook-login" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android emulator install apk</h1>

      <div class="entry">
        今天要把某個app套入中華電信hami的SDK...<br /><br />因為一定要手機裝上Hami Store...但我不想在我手機上裝上這種東西....<br /><br />所以就用emulator...<br /><br />所以就利用指令在emulator上install Hami Store App!<br /><br />首先先切換至<b>Android_SDK</b>目錄底下!<br /><br />在切換至底下的<b>platform-tools(在某個版本之前是在tools底下，如果找不到的話，可以去tools底下找找)，</b><br /><b><br /></b><br />利用底下的adb.exe去執行安裝apk<br /><br />指令如下：<br /><br /><span class="Apple-style-span" style="color: blue;">adb install </span><span class="Apple-style-span" style="color: red;">path\your_apk_name.apk</span><br /><br />指令如圖：<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TTIZ5QC6YtI/AAAAAAAAAQg/JC6lg7FNglQ/s1600/%25E6%2593%25B7%25E5%258F%2596.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="80" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TTIZ5QC6YtI/AAAAAAAAAQg/JC6lg7FNglQ/s640/%25E6%2593%25B7%25E5%258F%2596.PNG" width="640" /></a></div><br /><br /><br />輸入指令完以後，<br /><br />如果安裝成功，則會顯示success字樣的訊息！！<br /><br /><br /><br /><br />
      </div>

      <a href="/2011/01/16/android-emulator-install-apk" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>碩一上報過的Paper</h1>

      <div class="entry">
        把碩一上報過的paper都記錄一下好了。<br /><br /><br /><ul><li>From Niches to Riches: Anatomy of the Long Tail</li><ul><li>Erik Brynjolfsson, Yu "Jeffery" Hu and Michael D. Smith-<b>MIS Sloan Management &nbsp;Reveiw</b></li><li>主要是在講長尾理論在資訊科技業的影響</li></ul><li>MapReduce: Simplified Data Processing&nbsp;on Large Clusters</li><ul><li>Jeffrey Dean and Sanjay Ghemawat-<b>COMMUNICATIONS OF THE ACM January &nbsp;2008/Vol. 51, No. 1</b></li><li>這篇是由Google Fellow提出的，主要是在講運用MapReduce(Master-Slaver架構)去處理大量的資料</li></ul><li>CLOUD COMPUTING&nbsp;FOR MOBILE USERS:&nbsp;CAN OFFLOADING&nbsp;COMPUTATION &nbsp;SAVE ENERGY?</li><ul><li>Karthik Kumar and Yung-Hsiang Lu, Purdue University-<b>IEEE Computer Society</b></li><li>這篇是在探討將computation offloading到cloud上面的效益，以及告知我們什麼時候該把computation offloading</li></ul><li>Adaptive Computation Offloading for Energy Conservation on&nbsp;Battery-Powered Systems</li><ul><li>Changjiu Xian,&nbsp;Yung-Hsiang Lu,&nbsp;Zhiyuan Li-<b>IEEE</b></li><li>這篇也是在探討computation offloading的問題，但是是探討offloading到普通的server上去，且告知我們五種offloading的時機，會帶來的效益，以及能省多少電</li></ul><li>A View&nbsp;of Cloud&nbsp;Computing</li><ul><li>Michael Armbrust, Armando Fox, Rean Griffith, Anthony D. Josephi, Randy Katz, Andy Konwinski, Gunho Lee, David Patterson, Ariel Rabkin, Ion Stoica, Matei Zaharia-<b>&nbsp;Communications of the ACM &nbsp; | &nbsp;April 2010 &nbsp;| &nbsp;VOL. 53 &nbsp;| &nbsp;NO. 4</b></li><li>這篇在介紹Cloud&nbsp;Computing的概念，以及介紹幾種Cloud 平台(GAE, Azure, AWS)，以及介紹十種Cloud Computing 的障礙</li></ul><li>to be continued....</li></ul><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div>
      </div>

      <a href="/2011/01/14/paper" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>IP的分級和網域的概念</h1>

      <div class="entry">
        記得以前大二上網路概論的課有講到，<br /><br />但都忘光了，今天去把它惡補回來。<br /><br />並做點筆記!<br /><br />IP類似現實世界房子門牌的概念，<br /><br />而IP是由32個bits所組成<br /><br />而32個bits中包含了<span class="Apple-style-span" style="color: red;">Net_id</span>和<span class="Apple-style-span" style="color: red;">Host_id</span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br />什麼是Net_id?<br /><br />Net_id意思是一個網域<br /><br />而Host_id意思是該網域底下的主機編號<br /><br />以現實例子來想，Net_id可以想像成一個大樓（台北市XX路）<br /><br />而一棟大樓裡面一定有很多戶人家，Host_id就是該大樓裡面所有的門牌號碼<br /><br />而有幾個bits是<span class="Apple-style-span" style="color: red;">Net_id</span>呢? 又有幾個bits是<span class="Apple-style-span" style="color: red;">Host_id</span>呢?<br /><br />就要講到IP分級了，<br /><br />IP主要分為五級(A、B、C、D、E)<br /><br />Class A網域的IP<br /><br /><span class="Apple-style-span" style="color: red;"><b>０</b>ｘｘｘｘｘｘｘ</span>．ｘｘｘｘｘｘｘｘ．ｘｘｘｘｘｘｘｘ．ｘｘｘｘｘｘｘｘ<div><br />Net_id有8個bits，<span class="Apple-style-span" style="color: red;">可是！</span><br /><br />第一個bits一定要為0，<br /><br />所以就剩下7個bits，也就是2的7次方。<br /><br />也就是說<br /><br />Class A網域的IP範圍為０．ｘ．ｘ．ｘ～１２７．ｘ．ｘ．ｘ<br /><br />以此類推，<br /><br /><br /><br />Class B網域的IP<br /><br /><span class="Apple-style-span" style="color: red;"><b>１０</b>ｘｘｘｘｘｘ</span>．<span class="Apple-style-span" style="color: red;">ｘｘｘｘｘｘ</span><span class="Apple-style-span" style="color: red;">ｘｘ</span>．ｘｘｘｘｘｘｘｘ．ｘｘｘｘｘｘｘｘ<br /><br /><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Net_id有16個bits，<span class="Apple-style-span" style="color: red;">可是！</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;">前二個bits一定要為１０，</span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span>也就是說</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Class B的IP範圍為１２８．ｘ．ｘ．ｘ～１９１．ｘ．ｘ．ｘ</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Class&nbsp;C網域的IP</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><b><br /></b></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><b>１１０</b>ｘｘｘｘｘ</span>．<span class="Apple-style-span" style="color: red;">ｘｘｘｘｘｘ</span><span class="Apple-style-span" style="color: red;">ｘｘ</span>．<span class="Apple-style-span" style="color: red;">ｘｘｘｘｘｘ</span><span class="Apple-style-span" style="color: red;">ｘｘ</span>．ｘｘｘｘｘｘｘｘ</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Net_id有24個bits，<span class="Apple-style-span" style="color: red;">可是！</span></div></div><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;">前二個bits一定要為１</span></span>１０，</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span>也就是說</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Class C網域的IP範圍為１９２．ｘ．ｘ．ｘ～２２３．ｘ．ｘ．ｘ</div><br /><br /><br />Class D E都被保留，這裡就不詳談。<br /><br /><br /><br />注意！！！<br /><br /><b>網域</b><span class="Apple-style-span" style="color: red;">不等於</span><b>網段</b><br /><br />網段的定義是，該網段底下的ip的net_id都相同，那麼就屬於同一網段！<br /><br />將在下一篇進行解說subnet的概念。<br /><br /><br /><br /><br /><br /></div>
      </div>

      <a href="/2011/01/10/ip" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Market改版內容</h1>

      <div class="entry">
        今天又收到android market的更新來信，<br /><br />內容大致如下：<br /><br /><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">* The purchase refund period is now 15 minutes, and the maximum size for .apk files is now 50MB.</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">以後charge back的時間從一天縮短為15分鐘，且上傳的.apk最大容量提升到50MB</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">* The details page for every app now displays the app’s “Promotional Graphic” assets at the top.</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">然後如果您的APP有宣傳影片，則會在detail page上播放</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">* Market is now capable of filtering based on screen sizes and densities. NOTE: Filtering based on GL texture compression formats is not active at this time, but will be available in early January 2011.</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">然後將來market會根據螢幕尺寸解析度來過濾內容。最快會在2011年一月實現。</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">* Applications are now automatically added to new Live Wallpapers and Widgets categories, as appropriate.</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">然後以後App有牽涉到桌布或者widget的，會自動歸類到那兩個類別。</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">* The maximum size of the description field for an application is raised to 4000 characters.</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">以後app的描述可以達到四千字！！！</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">* A minimum of two screen shots is now required for all applications. You can supply up to eight screenshots for each application.</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;">每個app至少需要兩個screen shot，最高可以到八個！！</span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif;"><br /></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></span>
      </div>

      <a href="/2010/12/24/android-market" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android menu &amp; onCreateOptionsMenu和onPrepareOptionsMenu的差別</h1>

      <div class="entry">
        其實要實作android menu很簡單，<br /><br />這裡會快速的帶過，<br /><br />主要會講一下<b>onCreateOptionsMenu</b>和<b>onPrepareOptionsMenu</b>的差別<br /><br />首先先在/res/資料夾底下，開立一個資料夾/menu<br /><br />然後再/res/menu/資料夾底下，建立一個menu_option.xml的檔案<br /><br />檔案內容如下<br /><br /><pre class="brush: xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;menu xmlns:android="http://schemas.android.com/apk/res/android"&gt;<br /> &lt;item android:id="@+id/menuOption1" android:title="option1"&gt;&lt;/item&gt;<br /> &lt;item android:id="@+id/menuOption2" android:title="option2"&gt;&lt;/item&gt;<br />&lt;/menu&gt;<br /><br /></pre><br /><br /><br /><br />建立完成以後，<br /><br />就在activity中加入menu的code如下:<br /><br /><pre class="brush: java">public class main extends Activity {<br /> <br />    @Override<br />    public void onCreate(Bundle savedInstanceState) {<br />        super.onCreate(savedInstanceState);<br />        setContentView(R.layout.main);<br />    }<br />    <br />    <br />    //當menu option被點選以後的反應<br />    @Override<br />    public boolean onMenuItemSelected(int featureId, MenuItem item) {<br />     Toast.makeText(this, String.valueOf(item.getItemId()), Toast.LENGTH_LONG).show();<br />     return super.onMenuItemSelected(featureId, item);<br />    }<br />    <br />    <br />    //建立option menu，等等會講解和onPrepareOptionsMenu的差別<br />    @Override<br />    public boolean onCreateOptionsMenu(Menu menu) {<br />     MenuInflater inflater = getMenuInflater();<br />     inflater.inflate(R.menu.menu_option, menu);<br />     return super.onCreateOptionsMenu(menu);<br />    }<br />    <br />    <br />    //一樣是建立option menu，等等會講解和onCreateOptionsMenu的差別<br />    @Override<br />    public boolean onPrepareOptionsMenu(Menu menu) {     <br />     MenuInflater inflater = getMenuInflater();<br />     inflater.inflate(R.menu.menu_option, menu);<br />     return super.onPrepareOptionsMenu(menu);<br />    }<br />    <br />}<br /><br /></pre><br /><br /><br /><br /><br /><br />這樣MENU就會建立完成，<br /><br />但是<b>onCreateOptionsMenu</b>和<b>onPrepareOptionsMenu</b>的差別在哪呢?<br /><br /><b>onCreateOptionsMenu</b><br /><b>　　只會<span class="Apple-style-span" style="font-weight: normal;"><b>呼叫</b></span>一次，他只會在MENU顯示之前，去做一次！！！之後就不會再去呼叫！</b><br /><br /><br /><b>onPrepareOptionsMenu</b><br /><b>　　</b><b>onPrepareOptionsMenu是每次在display menu之前，都會去呼叫，</b><br /><b>　　只要按一次menu按鍵，就會呼叫一次。</b><br /><b>　　所以你會發現每次只要按一次menu按鍵，</b><br /><b>　　menu選單就會多兩個（因為我們預設是兩個）</b><br /><b>　　你可以利用</b><b>onPrepareOptionsMenu來做update menu狀態的動作</b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br />如果你要把menu現有的option清空，<br /><br />就是下面那行ＣＯＤＥ<br /><br /><pre class="brush: java"><br />menu.clear();<br /></pre><br /><br /><br />
      </div>

      <a href="/2010/12/20/android-menu-oncreateoptionsmenuonprepa" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android SharedPreferences</h1>

      <div class="entry">
        如果想要做到儲存資訊，<br /><br />且又是少量的，<br /><br />如果用到sqllite又會太過於麻煩(且也會較慢)<br /><br />這裡就可以用到SharedPreferences，<br /><br />假設我們要做個登入介面<br /><br />有個Email的欄位，<br /><br />且使用者可以勾選是否要記憶住帳號及密碼，<br /><br />我們就可以用SharedPreferences來做<br /><br />首先我們先來做<b><span class="Apple-style-span" style="color: red;">儲存</span></b>資訊的function<br /><br />如下:<br /><br /><pre class="brush: java">/*<br /> * 用來把mail存在preference裡面<br /> */<br /> private final void fnStorePrefs(){<br />  //先取得preference，且名稱為STR_PREF 的prefernce，STR_PREF 請自行宣告<br />  final SharedPreferences settings = getSharedPreferences(STR_PREF , 0);  <br />  <br />  //然後再取得editor，為了儲存資訊 <br />  final Editor editor = settings.edit();<br /><br />  //把資料存進去<br />  editor.putString(STR_PREF_EMAIL , edEmail.getText().toString());<br />     <br />  //然後一定要commit，才會存進去<br />   editor.commit();<br /> }<br /> <br /><br /></pre><br /><br />然後再做<b style="color: red;">取得</b>資訊的function<br /><br /><br /><pre class="brush: java">/*<br /> * 用來把mail從preference抓回來<br /> */<br /> private final void fnRestorePrefs(){<br />  //先取得preference，且名稱為STR_PREF 的prefernce，STR_PREF 請自行宣告<br />  final SharedPreferences settings = getSharedPreferences(STR_PREF , 0);<br /><br />  //然後直接取得資料<br />  final String strEmail            = settings.getString(STR_PREF_EMAIL ,"");<br /><br />  //然後再放進去EditText裡面去<br />  edEmail.setText(strEmail);<br /> }<br /></pre><br /><br /><br /><br /><br />基本上就這二種基本的運用，一個儲存的function、一個取得的function<br /><br />就看什麼時候要<b>存</b>，什麼時候要<b>取</b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br /><b><br /></b><br /><br /><br />
      </div>

      <a href="/2010/12/19/android-sharedpreferences" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Google App Engine (GAE/J) 使用 Picasa API 取得相簿列表</h1>

      <div class="entry">
        不管你在哪裡(GAE、Java Application)要使用Picasa<br /><br />都一定要reference 4個jar檔，<br /><br /><br /><ol><li>gdata-core-1.0.jar</li><li>gdata-media-1.0.jar</li><li>gdata-photos-2.0.jar</li><li>google-collect-1.0-rc1.jar</li></ol><br /><br />可是Google Code的說明文件卻少說一個，<br /><br />文件上並沒有叫人家reference第四個，<br /><br />但是要reference進來才不會有錯<br /><br />reference進去以後就開始撰寫程式碼了<br /><br /><br /><br />這邊是以一個<b>固定帳號</b>去做登入<br /><br />跟之前<a href="http://blog.kenyang.net/search/label/google%20calendar">在GAE中使用行事曆</a>的例子<b>不一樣</b><br /><br />那個例子是會有Google登入畫面讓使用者輸入自己的帳號密碼，<br /><br />然後去存取使用者自己本身的行事曆<br /><br />不過這個例子不是，這個例子是用寫死的帳號密碼登入<br /><br />(<span class="Apple-style-span" style="font-size: x-small;">如果妳一樣要讓使用者填選，那麼也是要用<span class="Apple-style-span" style="font-family: Verdana, Arial, sans-serif; line-height: 16px;">AuthSub來認證，可以去行事曆那個例子看，差不</span></span><span class="Apple-style-span" style="font-family: Verdana, Arial, sans-serif; font-size: 13px; line-height: 16px;">多)</span><br /><span class="Apple-style-span" style="font-family: Verdana, Arial, sans-serif; font-size: 13px; line-height: 16px;"><br /></span><br />開始撰寫程式碼了<br /><br /><pre class="brush: java">package edu.chao.lab.servlet;<br /><br />import java.io.IOException;<br />import java.net.URL;<br />import java.util.List;<br /><br />import javax.servlet.ServletException;<br />import javax.servlet.http.HttpServlet;<br />import javax.servlet.http.HttpServletRequest;<br />import javax.servlet.http.HttpServletResponse;<br /><br />import com.google.gdata.client.photos.PicasawebService;<br />import com.google.gdata.data.photos.AlbumFeed;<br />import com.google.gdata.data.photos.GphotoEntry;<br />import com.google.gdata.util.ServiceException;<br /><br />public class test extends HttpServlet {<br /> <br /> @Override<br /> protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {<br />  super.doGet(req, resp);<br /> try {<br />  String strAcc = "你的帳號";<br />  String strPwd = "你的密碼";<br />  <br />  PicasawebService service = new PicasawebService("sample");<br />  service.setUserCredentials(strAcc, strPwd);    //登入<br />  URL feedUrl = new URL("https://picasaweb.google.com/data/feed/api/user/"+strAcc+"?kind=album");<br />  AlbumFeed myUserFeed = service.getFeed(feedUrl, AlbumFeed.class); //取得所有相簿烈表<br />  List&lt;GphotoEntry&gt; lAlbum = myUserFeed.getEntries();<br />  <br />  for (GphotoEntry myAlbum : lAlbum) {<br />   resp.getWriter().println(myAlbum.getTitle().getPlainText());//印出相簿名稱<br />   resp.getWriter().println(myAlbum.getGphotoId());   //印出相簿編號<br />   <br />   <br />  }<br /> } catch (ServiceException e) {<br />   // TODO Auto-generated catch block<br />   e.printStackTrace();<br /> }<br /> }<br />  <br />}<br /><br /><br /></pre><br /><span class="Apple-style-span" style="font-family: Verdana, Arial, sans-serif; font-size: 13px; line-height: 16px;"><br /></span><br /><span class="Apple-style-span" style="font-family: Verdana, Arial, sans-serif; font-size: 13px; line-height: 16px;"><br /></span><br />這樣就完成了讀取相簿列表<br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/12/16/google-app-engine-gaej-picasa-api" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>如何撰寫一個Chrome App</h1>

      <div class="entry">
        今早才看到<a href="https://chrome.google.com/webstore">Chrome Web Store</a>的Chrome App<br /><br />就覺得這個跟 Chrome Extension一樣<br /><br />先做先贏，<br /><br />就想說趕緊來做一個，<br /><br />去看了一下API，<br /><br />其實我對Chrome App有點失望...<br /><br />我覺得根本就只是轉址而已(個人愚見)<br /><br />爆發點應該會是在Google TV上的應用!<br /><br />不過對廠商來說，的確是多了一個管道銷售。(更何況是Google幫它銷售)<br /><br />對廠商來說，有利無弊。<br /><br />但是對我這種開發者而言，似乎沒有什麼太大意義。<br /><br />畢竟你還是得先有一個服務(不管是game、小工具)<br /><br />然後透過Chorme App轉址過去....<br /><br />好吧，費話不多說，<br /><br />就直接教學了，<br /><br />其實Chrome App和Chrome Extension差不多<br /><br />都是利用json來部屬。<br /><br />我這裡就直接PO範例了<br /><br /><pre class="brush: jscript">{<br />  "name": "App的名稱",<br />  "version": "2",<br />  "description": "打你要描述的內容.",<br />  "app": {<br />    "launch": {<br />      "web_url": "http://www.google.com.tw/"<br />    }<br />  },<br />  "icons": {<br />     "128": "icon.png"<br />  }<br />  <br />}<br /><br /></pre><br /><br />而上傳方式就跟上傳Chrome Extension一樣，<br /><br />大家可以去參考<a href="http://blog.kenyang.net/2010/07/chrome-app.html">這篇</a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/12/08/chrome-app" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android connect to MSN (JML)</h1>

      <div class="entry">
        Android connect to MSN (JML)<br /><br />在Android用Java MSN Messenger Library(JML)登入<br /><br />其實JML是一個很好用的lib，<br /><br />在J2SE的環境下使用非常好整合，<br /><br />BUT...要整合至ANDROID中會有幾個小問題。<br /><br />第一：會少了一個GetPropertyAction的CLASS<br /><br />第二：JML裡用的SSL是採取SSLv3，但是android只能支援TLS<br /><br />第三：一樣會少了一個DatatypeFactory這個CLASS<br /><br />解決方法就是<br /><br />直接去找到JML的source code，<br /><br />直接拿它來做修改，而不是直接去拿jar來用。<br /><br />為了解決第一部，<br /><br />我們可以在網路上找到人家寫好的這個class（GetPropertyAction）<br /><br /><a href="http://jcs.mobile-utopia.com/jcs/2154_GetPropertyAction.java">來這下載</a><br /><br />下載好以後，記得放在package名稱為sun.security.action的底下<br /><br /><br /><br />解決第二個方法就是<br /><br />去下載JML的SOURCE CODE<br /><br /><a href="http://sourceforge.net/projects/java-jml/files/java-jml/jml-1.0b4/">來這下載</a>　（是載.ZIP檔案喔，這樣才會有SOURCE CODE）<br /><br />下載完成後，把src資料夾底下的net通通拉進來我們的project裡面<br /><br />拉進來後，畫面會如下<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TP3tUVeF0VI/AAAAAAAAAPw/kYI6uJ-n4mk/s1600/%25E6%259C%25AA%25E5%2591%25BD%25E5%2590%258D.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TP3tUVeF0VI/AAAAAAAAAPw/kYI6uJ-n4mk/s320/%25E6%259C%25AA%25E5%2591%25BD%25E5%2590%258D.png" width="217" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />拉進來以後，<br /><br />找到package名稱為net.sf.jml.protocol.soap，<br /><br />點兩下展開以後，<br /><br />點選class名稱為ContactList的class<br /><br />打開以後找到下面那行CODE<br /><br /><pre class="brush: java">    SSLContext sc = SSLContext.getInstance("SSLv3");<br /></pre><br /><br />把它改成下面那行CODE<br /><br /><br /><pre class="brush: java">    SSLContext sc = SSLContext.getInstance("TLS");<br /></pre><br /><br />這樣第二部就解決了。<br /><br />至於第三個解決方式，<br /><br />目前是先把ANDROID SDK設為2.2，<br /><br />2.2就有支援DatatypeFactory，<br /><br /><br /><br />接著來寫連結至msn的code了。<br /><br />其實很簡單，你只要克服上面的問題，<br /><br />CODE應該就難不倒你，<br /><br /><pre class="brush: java">    try {<br />        final String email = "msn帳號";<br />        final String password = "您的密碼";<br />        final MsnMessenger messenger = MsnMessengerFactory.createMsnMessenger(email,<br />                 password);<br /><br />        messenger.getOwner().setInitStatus(MsnUserStatus.ONLINE);<br /><br />        //這邊一定要用thread去執行登入<br />        Thread thread = new Thread(new Runnable() {<br />                public void run() {<br />                    messenger.login();<br />                }<br />        });<br /> <br />        thread.start();  <br /><br />         <br />    } catch (Exception e) {<br />        Log.d("msn",e.toString());<br />    }<br /><br /></pre><br /><br /><br /><br />這樣就完成了MSN登入了。<br /><br />至於怎麼截取聯絡人清單，只要您解決上面那三個問題<br /><br />則擷取連絡人，就不是問題了。<br /><br /><br /><br />
      </div>

      <a href="/2010/12/07/android-connect-to-msn-jml" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android 2.3 SDK released!!!</h1>

      <div class="entry">
        等了好久<br /><br />Android 2.3 SDK 終於釋放了<br /><br /><a href="http://android-developers.blogspot.com/2010/12/android-23-platform-and-updated-sdk.html">來這看相關說明!!!</a><br /><br />看說明影片，不知道裡面那隻手機是不是Nexus 2....<br /><br />希望不要啊!!<br /><br />好醜!!<br /><br /><br /><br /><br />然後2.3還有新增ProGuard的支援!!!<br /><br />真的是太棒了，我在想應該是想解決前陣子一直被人詬病的破解問題!<br /><br />至少可以提高一些門檻了!<br /><br /><br /><br /><br />快去更新來玩玩吧!
      </div>

      <a href="/2010/12/07/android-23-sdk-released" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>thinkpad t410 換8G記憶體</h1>

      <div class="entry">
        記得一個月前，一條4G的記憶體一條大概要快3000!!<br /><br />但是在兩個禮拜前，好像突然降到一條大概2000，<br /><br />最近還有1700的。<br /><br />但是我在Y拍上面買 19xx多的。<br /><br />買了兩條。<br /><br />這裡就順便教人家怎麼拆解T410，<br /><br />通常筆電的兩個記憶體插槽都在背部，<br /><br />T410一樣也是，但是T410的背部記憶體插槽只有一個!!<br /><br />另一個在鍵盤底下，<br /><br />這邊就順便教大家怎麼拆鍵盤<br /><br /><br /><br /><br /><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TPCwVIJ4jNI/AAAAAAAAAOc/-uO1m0gKkyM/s1600/IMG_20101126_231940.jpg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TPCwVIJ4jNI/AAAAAAAAAOc/-uO1m0gKkyM/s320/IMG_20101126_231940.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">金士頓 1333 4G*2</td></tr></tbody></table><br /><div style="text-align: left;"></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><div style="text-align: left;"><br /></div><br /><div class="separator" style="clear: both; text-align: center;"></div><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCy-5cGYhI/AAAAAAAAAPM/_PBfrSl0pr0/s1600/IMG_20101126_232054.jpg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCy-5cGYhI/AAAAAAAAAPM/_PBfrSl0pr0/s320/IMG_20101126_232054.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">首先翻到背面，看到圖中的紅色圈圈，把那顆螺絲卸下來</td></tr></tbody></table><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCzIFYWC3I/AAAAAAAAAPQ/gswaRrGpWOQ/s1600/IMG_20101126_232447.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCzIFYWC3I/AAAAAAAAAPQ/gswaRrGpWOQ/s320/IMG_20101126_232447.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">打開以後，會看到背部的第二個記憶體插槽，可以將一條記憶體插上<br />然後圖中一樣有個紅色圈圈的螺絲點，一樣要把他卸下來<br />那顆螺絲是鍵盤的螺絲</td></tr></tbody></table><br /><br /><br /><div class="separator" style="clear: both; text-align: center;"></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: right; margin-left: 1em; text-align: right;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCxv6uqrxI/AAAAAAAAAPI/AnpOl9PiJck/s1600/IMG_20101127_000009.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCxv6uqrxI/AAAAAAAAAPI/AnpOl9PiJck/s320/IMG_20101127_000009.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">卸下螺絲後，回到正面，然後稍微用一點力，把鍵盤往上推，<br />可以利用一字螺絲起子，插入鍵盤最下方的細縫，稍微往上推，鍵盤就起來了</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCxCf-JtfI/AAAAAAAAAO0/flgmmkrqlb4/s1600/IMG_20101126_235440.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="240" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TPCxCf-JtfI/AAAAAAAAAO0/flgmmkrqlb4/s320/IMG_20101126_235440.jpg" width="320" /></a></div><br /><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><table cellpadding="0" cellspacing="0" class="tr-caption-container" style="float: left; margin-right: 1em; text-align: left;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TPCxLjYDT_I/AAAAAAAAAO4/w7fQ5_dk4jQ/s1600/IMG_20101126_235449.jpg" imageanchor="1" style="clear: left; margin-bottom: 1em; margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TPCxLjYDT_I/AAAAAAAAAO4/w7fQ5_dk4jQ/s320/IMG_20101126_235449.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">鍵盤底下會有一塊黑色的東西，把它掀起來(別撕掉喔)<br />第一個記憶體插槽就在這!</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TPCxUPrVkKI/AAAAAAAAAO8/QyMj1PCB-Qk/s1600/IMG_20101126_235458.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TPCxUPrVkKI/AAAAAAAAAO8/QyMj1PCB-Qk/s320/IMG_20101126_235458.jpg" width="320" /></a></div><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"><br /></div><br />
      </div>

      <a href="/2010/11/27/thinkpad-t410-8g" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>RequestDispatcher和springmvc的差別</h1>

      <div class="entry">
        <br />今天就在想RequestDispatcher和springmvc的差別<br /><br />通常會用springmvc，是因為想要做到MVC的架構，<br /><br />如果單單透過servlet，是無法達到該效果。<br /><br />但是如果透過servlet的RequestDispatcher是可以的!<br /><br />我就突然想到，那這樣我通通用RequestDispatcher不就好了<br /><br />但再仔細想想兩者間的差別，大概的想法如下<br /><br /><br />如果透過RequestDispatcher<br /><br />譬如說我要看會員列表(/action/member/list)<br /><br />就得在web.xml中部屬一個mapping<br /><br />mapping到某隻 servlet（讀取會員清單的操作）<br /><br />再透過RequestDispatcher把會員清單資料傳到應對應到的頁面<br /><br /><br />如果要新增一個會員(/action/member/insert)<br /><br />一樣得在web.xml中mapping到某個servlet<br /><br />這時候在web.xml會有2個serlvet mapping<br /><br /><br /><br />如果是透過springmvc<br /><br />是先透過在web.xml中springmvc設定的DispatcherServlet<br /><br />然後再透過該DispatcherServlet定義的config檔案<br /><br />看要Dispatch到哪個Controller<br /><br />看到這，似乎兩者之間看起來差不多?<br /><br />但是如果我們同樣需要兩個功能<br /><br />一個是新增會員，一個是讀取會員列表<br /><br />我們不需要像上面一樣定義到兩個servlet<br /><br />我們只需要定義一個專門在處理會員的controller<br /><br />然後透過controller去控制<br /><br />該controller裡面就會有兩個method<br /><br />public ModelAndView <span class="Apple-style-span" style="color: red;">list</span>(HttpServletRequest req, HttpServletResponse resp)<br />public ModelAndView <span class="Apple-style-span" style="color: red;">insert</span>(HttpServletRequest req, HttpServletResponse resp)<br /><br /><br /><br />這是我想到的地方，<br /><br />如果有誤，歡迎更正。謝謝<br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/11/19/requestdispatcherspringmvc" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>css固定footer</h1>

      <div class="entry">
        介紹一個<a href="http://ryanfait.com/sticky-footer/">stick footer</a>，<br /><br />什麼是stick footer，<br /><br />可以打開<a href="http://www.techbang.com.tw/pages/t_mobile">T客邦的網站</a>，<br /><br />然後看到最下面那條，那條就是footer，<br /><br />通常都會在那塊放至版權的宣告、合作方式...等等之類的。<br /><br />通常我們html的設計方式大概如下<br /><pre class="brush: html">&lt;html&gt;<br /> &lt;head&gt;&lt;/head&gt;<br /> &lt;body&gt;<br />  &lt;div id="header"&gt;通常放置在網頁上的最上方區塊，通常是顯示LOGO或者登入、註冊連結之類的&lt;/div&gt;<br />  &lt;div id="wrapper"&gt;就是放置內文了&lt;/div&gt;<br />  &lt;div id="footer"&gt;就是版權宣告的區塊&lt;/div&gt;<br /> &lt;/body&gt;<br />&lt;/html&gt;<br /></pre><br />如果你沒有對footer作特殊的設計，那麼出來的版面可能會有點醜。<br /><br />如下圖，你會發現在版權宣告區的最下方會有一大塊白白的東西，還蠻醜的:<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TOVhLqrmKJI/AAAAAAAAAMs/HnilRohKBsw/s1600/test.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="384" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TOVhLqrmKJI/AAAAAAAAAMs/HnilRohKBsw/s640/test.png" width="640" /></a></div><br /><br /><br />如果你想要把下面那塊固定在最下方，如下圖，<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TOViL16LVWI/AAAAAAAAAMw/Qx8YbXE2nHs/s1600/tes1t.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="384" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TOViL16LVWI/AAAAAAAAAMw/Qx8YbXE2nHs/s640/tes1t.png" width="640" /></a></div><br /><br /><br /><br />就可以透過sticky footer來實作，<br /><br />至於css的code就去看<a href="http://ryanfait.com/sticky-footer/">http://ryanfait.com/sticky-footer/</a>這個站看<br /><br />因為太簡單了，就不PO教學了啦。<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/11/19/cssfooter" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>ApacheBench 進行stress testing</h1>

      <div class="entry">
        <br />Apache提供了一個<b>免費</b>的工具(ApacheBench )來讓我們測試網站的承受壓力程度，<br /><br />不過ApacheBench 僅能提供對單一URL進行測試，但是真正的情況下，<br /><br />可能是同時很多個user連結不同的url，ApacheBench 並不能做到這樣的test<br /><br />但可以利用它來test會耗費較多效能的程式，來看看該網頁程式的承受程度。<br /><br />所以其實ApacheBench 是無法去模擬真實的狀況，沒辦法，It's free！<br /><br /><br /><br />ＯＫ，來開始說明吧。<br /><br />只要您有安裝Apache，那麼也一定會有ApacheBench ，<br /><br />就在<b>／</b><b>apache安裝目錄／bin<span class="Apple-style-span" style="font-weight: normal;"><b>／</b></span>ab.exe</b><br /><b><br /></b><br /><a href="http://httpd.apache.org/docs/2.2/programs/ab.html">我們可以到官網來看使用說明</a><br /><br />也可以直接下個command來看所有的使用參數說明<br /><br /><span class="Apple-style-span" style="background-color: #eeeeee;">&nbsp;&nbsp;ab.exe -h &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</span><br /><br />這裡就不作詳細的參數說明，大家可以到官網觀看。<br /><br /><br /><br />這裡舉個例子<br /><br /><span class="Apple-style-span" style="background-color: #eeeeee;">&nbsp;&nbsp; ab -n 100 &nbsp;http://www.google.com<span class="Apple-style-span" style="color: red;">/</span> &nbsp; &nbsp;</span><br /><br />注意: &nbsp;如果不是指定某page，一定要以<span class="Apple-style-span" style="color: red;">/</span>為結尾，如果是指定到page就不用了。<br /><br />參數-n意思是&nbsp;對該網站發出幾次request<br /><br />下了該command以後<br /><br />會response一長串的資訊<br /><br />我們只要看到幾個重要性的指標就好<br /><br />首先先看到兩個指標Complete requests、Failed requests<br /><br /><b>Complete requests &nbsp;：完成的request次數</b><br /><br /><b>Failed requests　　：失敗的次數</b><br /><br />如果失敗的次數太高，代表著該網站同一時間能承受的request數量不能太高。<br /><br />然後再看到<b>Connection Times：進行stress testing時的處理時間</b><br /><br /><br /><blockquote>Connection Times (ms)</blockquote><blockquote>&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;min &nbsp;mean[+/-sd] median &nbsp; max</blockquote><blockquote>Connect: &nbsp; &nbsp; &nbsp; &nbsp;17 &nbsp; &nbsp; &nbsp;33 &nbsp;62.9 &nbsp; &nbsp; &nbsp;22 &nbsp; &nbsp; &nbsp; &nbsp;421</blockquote><blockquote>Processing: &nbsp; 20 &nbsp; &nbsp; &nbsp;40 &nbsp;86.1 &nbsp; &nbsp; &nbsp;25 &nbsp; &nbsp; &nbsp; &nbsp;688</blockquote><blockquote>Waiting: &nbsp; &nbsp; &nbsp; &nbsp; 19 &nbsp; &nbsp; &nbsp;35 &nbsp;71.8 &nbsp; &nbsp; &nbsp;25 &nbsp; &nbsp; &nbsp; &nbsp;688</blockquote><blockquote>Total: &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; 39 &nbsp; &nbsp; &nbsp;73 104.9 &nbsp; &nbsp; 47 &nbsp; &nbsp; &nbsp; &nbsp;709</blockquote><br /><br />connect：是我們發出request，一直到server收到request的時間<br /><br />processing：是request後，一直到server response這期間的時間<br /><br />waiting：發出request以後，一直到收到response第一個byte的時間<br /><br />total：就是connect+processing<br /><br /><br />我們大概可以從<b>Complete requests</b>、<b>Failed requests</b>、<b>Connection Times</b> 這幾個指標來衡量一隻程式能承受的壓力程度。<br /><div><br /></div><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/11/08/apachebench-stress-testing" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Apache 限制目錄瀏覽</h1>

      <div class="entry">
        前天去看了社群網站<br /><br />片頭有講到哈佛裡面的有些宿舍網站的apache 沒有拿掉index，<br /><br />因此有目錄瀏覽的功能，這樣該目錄底下所有的檔案都會被使用者看見，<br /><br />那該怎麼關掉呢?<br /><br />打開httpd.conf<br /><br />找到這行<br /><b><br /></b><br /><b>Options Indexes FollowSymLinks</b><br /><br />然後把<b>Indexes </b>拿掉<br /><br />然後重開apache，該目錄底下的檔案就不會被顯示出來!<br /><br />且會response 403 Forbidden。<br /><br />如果你要有些特定目錄是允許使用者看見的，<br /><br />那麼就在該目錄底下，把index放上去即可。<br /><br />假設<br /><br />test1底下的/images是允許被看見的<br /><br />test2底下是不允許的<br /><br />那麼設置就如下<br /><br /><br /><br /><br /><pre class="brush: xml">&lt;Directory "D:/test1/images"&gt; <br />     .....<br />     # 可以被看見的<br />     Options Indexes FollowSymLinks<br />     .....<br />&lt;/Directory&gt;<br />&lt;Directory "D:/test2/images"&gt; <br />     .....<br />     # 不可以被看見的<br />     Options FollowSymLinks<br />     .....<br />&lt;/Directory&gt;<br /><br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/11/06/apache" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>JSP 兩種include 的差別</h1>

      <div class="entry">
        在JSP中，<br /><br />include有分兩種<br /><br /><pre class="brush: xml">&lt;%@include file="/footer.jsp" %&gt;&lt;!-- 第一種 --&gt;<br /><br /><br />&lt;jsp:include page="/footer.jsp"&gt;&lt;/jsp:include&gt;&lt;!-- 第二種 --&gt;<br /><br /><br /><br /></pre><br /><br />第一種稱為<span class="Apple-style-span" style="color: red;">指令元素</span><br /><br />第二種稱為<span class="Apple-style-span" style="color: red;">動作元素</span><br /><br />差別在於<br /><br />第一種的include會在編譯時期（轉換成servlet）就將file include進來，<br /><br />而第二種在編譯時期並不會被編譯，是在client request時，才會動態的去載入在去編譯。<br /><br /><br />且第一種最後只會有一個.class檔案，<br /><br />因為他會在被轉換成servlet之前就把include的file融合至原本的內容中<br /><br />最後才轉換成servlet，故只有一個.class檔案<br /><br />而第二種就會有兩種。<br /><br /><br />總結<br /><br />第一種是在編譯時期就去include<br /><br />第二種是在run time時期去include（這個效能似乎較差一點點，但較靈活）<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/11/06/jsp-include" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>非常不專業之iMAC開箱文</h1>

      <div class="entry">
        <br /><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">恩，因緣際會下，</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">有人送我一台iMac，</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">當然不是平白無故的，</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">天底下沒有白吃的午餐!!</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">條件是要我part-time，寫iPhone app..</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">其實對我來說，沒有甚麼損失，多碰點東西!</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">之前一直局限於設備，雖然說可以用vmware來灌os x，</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">但一直沒動力，不過竟然有人要提供給我mac了，</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">我就順便接下來阿~~~~~</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">從一開始的mac book pro→mac mini→iMac</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">最後是拿到iMac</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">不過並不是全新的啦!</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">不過至少規格也不差!!!</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">至少比我目前的桌機好!</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">今天用了一下的心得就是</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">apple的滑鼠(magic mouse)真的很好用!!!!!</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">鍵盤也好打!!!!!!!</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">大螢幕也真的很爽(可惜不是27吋)</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">btw, 我今天一直找不到開機扭在哪裡(我好俗喔!!!)</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;">底下是圖片~~~</div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TNLRoL7esYI/AAAAAAAAALQ/IK0oRlmRiSE/s1600/IMG_20101104_230122.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TNLRoL7esYI/AAAAAAAAALQ/IK0oRlmRiSE/s320/IMG_20101104_230122.jpg" width="320" /></a></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TNLRsqF-8BI/AAAAAAAAALU/901xwvIZNG4/s1600/IMG_20101104_230133.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TNLRsqF-8BI/AAAAAAAAALU/901xwvIZNG4/s320/IMG_20101104_230133.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">magic mouse，好用!</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TNLRzfBw5BI/AAAAAAAAALY/TS2AQs3G64k/s1600/IMG_20101104_230137.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TNLRzfBw5BI/AAAAAAAAALY/TS2AQs3G64k/s320/IMG_20101104_230137.jpg" width="320" /></a></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TNLR3MwcNYI/AAAAAAAAALc/PsdXt2pGMaI/s1600/IMG_20101104_230441.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TNLR3MwcNYI/AAAAAAAAALc/PsdXt2pGMaI/s320/IMG_20101104_230441.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">漂亮的螢幕</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TNLR76eORgI/AAAAAAAAALg/ZuJja0PamU0/s1600/IMG_20101104_230512.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TNLR76eORgI/AAAAAAAAALg/ZuJja0PamU0/s320/IMG_20101104_230512.jpg" width="320" /></a></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div><div style="color: #333333; font-family: 'lucida grande', tahoma, verdana, arial, sans-serif; line-height: 1.5em; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; text-align: left;"><br /></div>
      </div>

      <a href="/2010/11/04/imac" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android detect screen on and screen off</h1>

      <div class="entry">
        android detect screen on and screen off<br /><br />android偵測螢幕的關閉與開啟，<br /><br />和偵測sd card一樣，<br /><br />Intent.ACTION_SCREEN_OFF和Intent.ACTION_SCREEN_ON是不能在AndroidManifest.xml裡面宣告的<br /><br />如:<br /><br /><pre class="brush: xml">&lt;receiver android:name="receiverScreen"&gt; <br />    &lt;intent-filter&gt;  <br />        &lt;action android:name="android.intent.action.SCREEN_ON" /&gt;<br />        &lt;action android:name="android.intent.action.SCREEN_OFF" /&gt;<br />    &lt;/intent-filter&gt;  <br />&lt;/receiver&gt;  <br /></pre><br /><br />這樣子的宣告<span class="Apple-style-span" style="color: red;"><b>沒有用</b></span>，你永遠都receive不到任何action<br /><br />詳細原因我也不知道，但是可以透過registerReceiver去實作，<br /><br />這裡舉個例子，先啟動一個service，由這個service去registerReceiver<br /><br />由service啟動的好處是，service可以常駐，<br /><br />如果你用acitivity去registerReceiver<br /><br />這個acitivity關閉以後，你一樣receive不到任何action<br /><br />且如果你只是想偵測acitivity的關閉與否的話，可以直接利用onResume和onPause去偵測即可<br /><br />不用特地去registerReceiver<br /><br /><br />但是如果今天你有一個widget在桌面，<br /><br />且我們是無法透過widget去registerReceiver，<br /><br />會出現exception（ReceiverCallNotAllowedException）<br /><br />所以一定得透過service去啟動。<br /><br />service的code如下:<br /><br /><pre class="brush: java">public class serviceScreen extends Service {<br /><br /> @Override<br /> public IBinder onBind(Intent intent) {<br />  // TODO Auto-generated method stub<br />  return null;<br /> }<br /> <br /> @Override<br /> public void onStart(Intent intent, int startId) {<br />     super.onStart(intent, startId);<br />     try {<br />          IntentFilter filter = new IntentFilter(Intent.ACTION_SCREEN_ON);<br />    <br />          filter.addAction(Intent.ACTION_SCREEN_OFF);<br />    <br />          BroadcastReceiver mReceiver = new receiverScreen();<br />   <br />          registerReceiver(mReceiver, filter);<br />     } catch (Exception e) {<br />          Log.d("main",e.toString());<br />     }<br /> }<br /><br />}<br /><br /><br /></pre><br /><br />receiver的code如下：<br /><br /><pre class="brush: java">public class receiverScreen extends BroadcastReceiver {<br /><br /> @Override<br /> public void onReceive(Context context, Intent intent) {<br />  <br />     if (intent.getAction().equals(Intent.ACTION_SCREEN_ON)){<br />          //收到螢幕開啟的通知<br />     }else{<br />          //收到螢幕關閉的通知<br />     }<br />  <br /> }<br /><br />}<br /><br /><br /></pre><br /><br /><br />接著就是在widget中去startService<br /><br />如下：<br /><br /><pre class="brush: java">public class widgetSmall extends AppWidgetProvider {<br /> <br /><br /> @SuppressWarnings("static-access")<br /> @Override<br /> public void onUpdate(Context context, AppWidgetManager appWidgetManager,int[] appWidgetIds) {<br />     super.onUpdate(context, appWidgetManager, appWidgetIds);<br />            <br />    //啟動一個service<br />     context.startService(new Intent(context, serviceScreen.class));<br />  <br />  <br /> }<br /> <br /><br /> @SuppressWarnings("static-access")<br /> @Override<br /> public void onDeleted(Context context, int[] appWidgetIds) {<br />     super.onDeleted(context, appWidgetIds);<br /><br /><br />    //當這個widget被刪除時，就stopService<br />      context.stopService(new Intent(context, serviceScreen.class) );<br />   <br />      android.os.Process.killProcess(android.os.Process.myPid());<br />  <br /> <br /> }<br /> <br /><br />}<br /><br /><br /></pre><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/11/01/android-detect-screen-on-and-screen-off" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>主動式與被動式FTP 差別</h1>

      <div class="entry">
        FTP是一個特殊的protocol之一，<br /><br />其他的protocol，如:http、pop3、....等等之類的，<br /><br />都只需要1個connection、1個port。<br /><br />但是FTP則不是，FTP需要2個connection、2個port。<br /><br />一個是Command connection / port，用來傳遞client與FTP Server之間的command。(通常設在port 21)<br /><br />另一個是Data&nbsp;connection /&nbsp;port，是用來傳遞資料的。(通常設在port 20)<br /><br /><br />一般的人都會認為關掉20、21port，FTP Server就會無法運作，<br /><br />從某種角度來說，這樣的觀念是正確的，但是其實是錯誤的觀念！！<br /><br />但這是在傳統式模式FTP的條件下，這樣的觀念才是正確的。<br /><br />FTP主要分成兩種模式：<br /><span class="Apple-style-span" style="color: red;"><b>1.主動式（POST）</b></span><br /><span class="Apple-style-span" style="color: red;"><b>2.被動式</b></span><span class="Apple-style-span" style="color: red;"><b>（PASV）</b></span><br /><br />傳統的FTP是採用主動式的模式進行連線，<br /><br />底下為主動式FTP運作圖<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TMjo0nS6Y0I/AAAAAAAAALI/hEnR6232wkg/s1600/%E4%B8%BB%E5%8B%95%E5%BC%8F.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="295" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TMjo0nS6Y0I/AAAAAAAAALI/hEnR6232wkg/s400/%E4%B8%BB%E5%8B%95%E5%BC%8F.png" width="400" /></a></div><br /><br /><span class="Apple-style-span" style="color: red;">1. client端會開啟一個大於</span><span class="Apple-style-span" style="color: red;">1024</span><span class="Apple-style-span" style="color: red;">的</span><span class="Apple-style-span" style="color: red;">port&nbsp;</span>( port x )<span class="Apple-style-span" style="color: red;">對FTP Server的port 21進行connection</span><br /><br /><span class="Apple-style-span" style="color: red;">2. FTP Server會回應client端的connection，告知Client端收到連線了</span><br /><br /><span class="Apple-style-span" style="color: blue;">3. FTP Server的port 20會主動和 Client端的port 1025</span>(port x+1)<span class="Apple-style-span" style="color: blue;">進行連線(進行資料傳輸)</span><br /><span class="Apple-style-span" style="color: blue;"><br /></span><br /><span class="Apple-style-span" style="color: blue;">4. Client會回應Server端的連線。</span><br /><br />看完步驟說明，大家會發現一個問題，<br /><br />一開始client端會開啟兩個port，<br /><br />port x (connection port)和port x+1 (data port)<br /><br />在connection port沒有甚麼問題存在，<br /><br />問題出在data port，<br /><br />因為client端並不是自己建立一個connection，而是自行開啟一個port等待FTP Server連線進來<br /><br />這很有可能被Client端的防火牆過濾掉<br /><br /><br /><br />因此為了解決FTP連線到Client端被過濾掉的問題，所以發展出另一種連線模式<br /><br />就是被動式模式<br /><br />被動式模式不管是command &nbsp;connection或是data connection都是由client端建立的<br /><br />底下為運作圖<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TMjugUmILnI/AAAAAAAAALM/tu85ED5r1KA/s1600/%E8%A2%AB%E5%8B%95%E5%BC%8F.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="296" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TMjugUmILnI/AAAAAAAAALM/tu85ED5r1KA/s400/%E8%A2%AB%E5%8B%95%E5%BC%8F.png" width="400" /></a></div><br /><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;">1. 首先，client端會開啟一個大於</span><span class="Apple-style-span" style="color: red;">1024</span><span class="Apple-style-span" style="color: red;">的</span><span class="Apple-style-span" style="color: red;">port&nbsp;</span>( port x )<span class="Apple-style-span" style="color: red;">對FTP Server的port 21進行connection</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;">2. FTP Server會回應client端的connection，並告知Client端，Server開啟了port 1200等待資料連線</span></div><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: blue;">3. Client端的port 1026會和</span><span class="Apple-style-span" style="color: blue;">FTP Server的port 1200</span><span class="Apple-style-span" style="color: blue;">進行資料連線</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: blue;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: blue;">4.&nbsp;Server會回應Client端的連線。</span></div><br /><br /><br /><br />使用了被動模式，解決了client端的問題，<br /><br />可是相反的，也把這些問題帶給了server。<br /><br /><br /><br /><br /><br />至於要用哪種模式，是由client端決定的，<br /><br />client端會在command connection時發出POST或PASV的命令<br /><br />但是server可以決定是否支援這些模式。<br /><br /><br /><br />
      </div>

      <a href="/2010/10/28/ftp" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android multiple language</h1>

      <div class="entry">
        android 多國語系開發!<br /><br />android multiple language<br /><br />只要將/res/values資料夾名稱改成您要支援的語系名稱<br /><br />這裡假設，我們要有英文和中文的內容<br /><br />那麼就在/res/values名稱改成/res/values-en，<br /><br />然後再複製/res/values/，然後一樣改成values-zh-rTW<br /><br /><br />且將其底下的string.xml的內容改成該語系的內容。<br /><br />android將會自動幫您判斷要呈現甚麼語言。<br /><br />至於有支援什麼語系，可以去底下這網站上觀看<span class="Apple-style-span" style="color: #333333; font-family: Arial, Helvetica, sans-serif; font-size: 13px; font-weight: bold;">ISO 639-1 Code</span><br /><br /><a href="http://www.loc.gov/standards/iso639-2/php/code_list.php">http://www.loc.gov/standards/iso639-2/php/code_list.php</a><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/10/28/android-multiple-language" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Drawable (hdpi,ldpi,mdpi) 的分別</h1>

      <div class="entry">
        <br />Drawable (hdpi,ldpi,mdpi)的分別。<br /><br />自從android 2.0.1版以後，只要新增project，<br /><br />你會發現res/drawable資料夾變成!<br /><br />/res/drawable-hdpi &nbsp; 【WVGA (480x800),FWVGA (480x854)】<br />/res/drawable-mdpi &nbsp;【HVGA (320x480)】<br />/res/drawable-ldpi &nbsp; &nbsp;【QVGA (240x320)】<br /><br />大概知道是用來做mutilple screen的，但是沒有太care，<br /><br />我通常都會把這三個通通刪掉，然後改成員先的/res/drawable（壞習慣，別學）<br /><br />結果剛剛發現如果同張圖分別放在三個不同的資料夾<br /><br />你會發現讀進來的圖檔大小都會不一樣喔！！！<br /><br />太讓我surpriesed!!<br /><br />我以為還要定義一個<span class="Apple-style-span" style="color: #000088; font-family: monospace; font-size: 13px; white-space: pre;">supports-screens</span>的xml檔案<br /><br />這些資料夾名稱的設置才會有用！<br /><br /><br /><br /><br /><br /><br />btw如果你跟我做法一樣，是三個刪掉，變成一個，<br /><br />那麼預設值讀進來的圖大小會是以/res/drawable-mdpi為主<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/10/26/drawable-hdpildpimdpi" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Spring MVC sample</h1>

      <div class="entry">
        <br />要使用Spring MVC架構，請先去下載Spring的jar檔，<br /><br />一個是spring-webmvc.jar<br /><br />一個是spring.jar<br /><br />一個是commons-logging.jar<br /><br />接著打開web.xml設定servlet-mapping<br /><br />跟他說當user &nbsp;request到哪個url時，要呼叫到Spring &nbsp;的dispatch，<br /><br />透過該dispatch，在引導該url至該controller<br /><br />如下:<br /><br /><pre class="brush: xml">&lt;servlet-mapping&gt;<br />    &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;<br />    &lt;url-pattern&gt;/html/*&lt;/url-pattern&gt;<br />&lt;/servlet-mapping&gt;<br /><br /></pre><br /><br /><br /><br />上面的範例是指當user request到/html/底下任何的page<br /><br />都會導引到servlet-name為springmvc的servlet去<br /><br />但是我們現在沒有servlet-name為springmvc的servlet<br /><br />所以也要在設定<br /><br />如下:<br /><br /><pre class="brush: xml">&lt;servlet&gt;<br />    &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt;<br />    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;<br />    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;<br />    &lt;init-param&gt;<br />        &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;<br />        &lt;param-value&gt;/WEB-INF/spring-mvc-config.xml&lt;/param-value&gt;<br />    &lt;/init-param&gt;<br />&lt;/servlet&gt;<br /></pre><br /><br /><br /><br /><br /><br />上面的範例意思是當您的servlet-mapping裡servlet-name為springmvc時<br /><br />會mapping到此org.springframework.web.servlet.DispatcherServlet class<br /><br />且你要指定該dispatch的config location<br /><br />這裡預設為/WEB-INF/spring-mvc-config.xml<br /><br />在這個檔案裡面會主要會放置了url-mapping<br /><br />用來告訴dipatch該怎麼分配至應該分配的controller<br /><br /><br />對了！！有個很重要的東西要注意到，<br /><br />在web.xml中的root element裡面的attribute一定要設為2.4，一開始建立project是預設2.5，<br /><br />在controller return view的時候，view會無法使用${}tag<br /><br />如下:<br /><br /><pre class="brush: xml">&lt;web-app <br />version="2.4"<br />xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br />xmlns="http://java.sun.com/xml/ns/javaee"<br />xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_4.xsd"<br />xsi:schemaLocation="http://java.sun.com/xml/ns/javaee<br />http://java.sun.com/xml/ns/javaee/web-app_2_4.xsd" &gt;<br /><br /></pre><br /><br /><br /><br /><br /><br />接著就會說到該spring-mvc-config.xml的檔案架構<br /><br />如下:<br /><br /><pre class="brush: xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;<br />&lt;beans xmlns="http://www.springframework.org/schema/beans"<br /> xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"<br /> xsi:schemaLocation="http://www.springframework.org/schema/beans<br /> http://www.springframework.org/schema/beans/spring-beans-2.5.xsd"&gt;<br /><br /><br />    &lt;!-- <br />        (1)<br />        會先看這個urlMapping<br />        這裡的設置意思是當您的page是在/html/action/*<br />        意思是/html底下的/action/底下的任何page，<br />        則就呼叫bean id為customerController的class  <br />    --&gt;<br />    &lt;bean id="urlMapping"<br />         class="org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"&gt;<br />        &lt;property name="mappings"&gt;<br />            &lt;value&gt;         <br />                /action/*=customController<br />            &lt;/value&gt;<br />        &lt;/property&gt;<br />    &lt;/bean&gt;<br /><br />    &lt;!-- <br />     (2)<br />     因為上面的設定是當/html/action/底下任何page會指定到此bean<br />     也就是說他會呼叫到net.ken.test.mvc此package底下的.multiActionController<br />     等等會說明multiActionController此檔案<br />     --&gt;        <br />    &lt;bean id="customController" class="net.ken.test.mvc.multiActionController"&gt;&lt;/bean&gt;    <br />     <br />     <br />    &lt;!-- <br />      (3)<br />      這裡是指你要對應到的view的路徑名稱<br />     --&gt; <br />    &lt;bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver"&gt;<br />    &lt;property name="viewClass" value="org.springframework.web.servlet.view.JstlView"/&gt;<br />       &lt;property name="prefix" value="/jsp/"/&gt;<br />       &lt;property name="suffix" value=".jsp"/&gt;<br />   &lt;/bean&gt; <br />     <br /><br />     <br />&lt;/beans&gt;<br /></pre><br /><br /><br /><br />接著就來撰寫multiActionController此controller的code <br /><br /><pre class="brush: java">package springmvc.web;<br /><br />import org.springframework.web.servlet.mvc.multiaction.MultiActionController;<br /><br /><br />import javax.servlet.http.HttpServletRequest;<br />import javax.servlet.http.HttpServletResponse;<br />import org.springframework.web.servlet.ModelAndView;<br /> <br /><br />//首先要繼承MultiActionController<br />public class CustomerController extends MultiActionController{<br /><br /><br /> //這邊的method命名規則是根據您的page名稱來命名，如果您的page是在/html/action/Add.do<br /> //則會呼叫到下面這個method。<br /> public ModelAndView Add(HttpServletRequest request,<br />  HttpServletResponse response) throws Exception {<br />  <br /> /*<br />  * 會return一個型態為ModelAndView的物件回去，<br />  * 第一個參數為view的名稱，就是要接收此物件的jsp檔案名稱，在此例子就是說會傳到hello_world.jsp此page去<br />  * 第二個是view要接收的參數名稱<br />  * 第三個是參數的值<br />  */<br />  return new ModelAndView("hello_world", "message","testAddCustomer() method");<br /> <br /> }<br /> <br /> public ModelAndView Delete(HttpServletRequest request,<br />  HttpServletResponse response) throws Exception {<br /> <br />  return new ModelAndView("hello_world", "message","testDeleteCustomer() method");<br /> <br /> }<br /> <br /> public ModelAndView Update(HttpServletRequest request,<br />  HttpServletResponse response) throws Exception {<br /> <br />  return new ModelAndView("hello_world", "message","testUpdateCustomer() method");<br /> <br /> }<br /> <br /> <br />}<br /><br /><br /></pre><br /><br />接著來寫個接收modelAndView的code吧!（就是hello_world.jsp）<br /><br />${message}的意思就是接收上面ModelAndView此物件的第二個參數的參數名稱 <br /><br /><pre class="brush: html">&lt;html&gt;<br />&lt;body&gt;<br /> &lt;p&gt;This is my message: ${message} &lt;/p&gt;<br />&lt;/body&gt;<br />&lt;/html&gt;<br /><br /></pre><br /><br /><br /><br />最後就寫個簡單的html來測試是否work， <br /><br />你會發現點選第一個link，<br /><br />您的page就會show出<b><span class="Apple-style-span" style="color: red;">This is my message: testAddCustomer() method</span></b>此訊息 <br /><br /><br /><pre class="brush: html">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"&gt;<br /><br />&lt;html&gt;<br />  &lt;head&gt;<br />    &lt;meta http-equiv="content-type" content="text/html; charset=UTF-8"&gt;<br />    &lt;title&gt;Hello App Engine&lt;/title&gt;<br />  &lt;/head&gt;<br /><br />  &lt;body&gt;<br />    &lt;h1&gt;Hello App Engine!&lt;/h1&gt;<br /> <br />    &lt;table&gt;<br />      &lt;tr&gt;<br />        &lt;td&gt;&lt;a href="/html/action/Add.htm"&gt;Go to Add() &lt;/a&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />      &lt;tr&gt;<br />        &lt;td&gt;&lt;a href="/html/action/Delete.htm"&gt;Go to Delete() &lt;/a&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br />      &lt;tr&gt;<br />        &lt;td&gt;&lt;a href="/html/action/Update.htm"&gt;Go to Update() &lt;/a&gt;&lt;/td&gt;<br />      &lt;/tr&gt;<br /> <br />    &lt;/table&gt;<br />  &lt;/body&gt;<br />&lt;/html&gt;<br /></pre><br /><br /><br /><br />這篇教學寫得好亂，真不好意思。<br /><br />有不清楚的再問我吧！<br /><br />
      </div>

      <a href="/2010/10/15/spring-mvcspringjar-spring-webmvc" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Eclipse show line number</h1>

      <div class="entry">
        Eclipse show line number<br /><br />想知道你寫了多少行的code嗎?<br /><br />或者想知道這行code是在第幾行?<br /><br />先點選Window-&gt;Preferences<br /><br />打開視窗以後，點選General-&gt;Editors-&gt;Text Editor<br /><br />把Show line numbers勾選起來。<br /><br />這樣就會顯示出line number了。
      </div>

      <a href="/2010/10/12/eclipse-show-line-number" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Eclipse Classic with Java Server Page (JSP)</h1>

      <div class="entry">
        因為有再寫GAE和android<br /><br />大家也都知道Eclipse分很多種版本<br /><br />1. Eclipse classic<br /><br />2. Eclipse IDEfor Java EE Developer<br /><br />3. Eclipse IDEfor Java Developer<br /><br />等等之類的!<br /><br />如果你想寫JSP、又想寫一般的java application。<br /><br />有些人會去下載兩種 eclipse（2、3）<br /><br />然後想寫ＪＳＰ，就開第二個，想寫java就開第三個。<br /><br />會不會太麻煩勒？<br /><br /><br /><br />我也遇到個問題，想在同個IDE環境中寫GAE和Android。<br /><br />該怎麼做呢？<br /><br />先去下載<a href="http://www.eclipse.org/downloads/packages/eclipse-classic-361/heliossr1">Eclipse classic</a><br /><br />解壓縮出來後，<br /><br />就去install new software（android、GAE)<br /><br />安裝這兩個的步驟就不說明了！<br /><br />直接跳過！<br /><br /><br /><br />完成後，當你建立一個.jsp檔案時，<br /><br />有沒有發現完全沒有highlight，也沒有content assist！！<br /><br />那是因為沒有裝pluging！<br /><br />那就把它裝起來吧！<br /><br />首先！<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TLHcInoMV8I/AAAAAAAAAK0/U363joRV6-g/s1600/1.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="280" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TLHcInoMV8I/AAAAAAAAAK0/U363joRV6-g/s640/1.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">首先先點選Install New Software</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TLHcJvu4i4I/AAAAAAAAAK4/5C29Yco1kl0/s1600/2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="452" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TLHcJvu4i4I/AAAAAAAAAK4/5C29Yco1kl0/s640/2.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">接著選取圖中選取的項目，注意！版本不同，項目中的版本名稱會有所不同，此版本為HELIOS</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TLHcKdDJ3WI/AAAAAAAAAK8/ZZ-wREFau18/s1600/3.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TLHcKdDJ3WI/AAAAAAAAAK8/ZZ-wREFau18/s1600/3.png" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">接著拉到最下面，點選Web, XML , Java EE Developement</td></tr></tbody></table><br /><br /><br /><br />點開以後，點選Web Page Editor就好！<br /><br />不要安裝其他的（要裝也是可以拉，你有需求的話）<br /><br />安裝完成以後，就會發現*.jsp檔案中的highlight和content assist都出現了！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/10/10/eclipse-classic-with-java-server-page" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>thinkpad t410 非常不專業 開箱文【不是教學文】</h1>

      <div class="entry">
        期待已久的thinkpad，<br /><br />終於在昨天入手了，<br /><br />規格：<br /><br />cpu：i7 620M　（可惜不是7開頭的）<br />Memory：ddr3 2G　（過陣子有錢，在直上兩條4G的）<br />hdd：320G 7200rpm　（被我換成hitachi的7k500，7200rpm，500G）<br />顯示卡：NVIDIA NVS 3100M<br />螢幕：14.1吋 (16:10)<br />電池：6cell<br /><br />接下來來ＰＯ圖了！<br /><br /><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TLFuRI8QSCI/AAAAAAAAAJ8/834xakdOayM/s1600/IMG_20101009_155655.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TLFuRI8QSCI/AAAAAAAAAJ8/834xakdOayM/s320/IMG_20101009_155655.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">thinkpad的箱子！就是這麼簡單！</td></tr></tbody></table><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFuYLRTCDI/AAAAAAAAAKA/rz1CJUgGHys/s1600/IMG_20101009_155746.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFuYLRTCDI/AAAAAAAAAKA/rz1CJUgGHys/s320/IMG_20101009_155746.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">打開後，箱子內部的配置</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TLFueJqu5LI/AAAAAAAAAKE/vLZgo6VB2-M/s1600/IMG_20101009_155842.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TLFueJqu5LI/AAAAAAAAAKE/vLZgo6VB2-M/s320/IMG_20101009_155842.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">筆電拿出來的樣子，旁邊那兩條有點醜</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/TLFuirlgUzI/AAAAAAAAAKI/EVsfcjXffTg/s1600/IMG_20101009_155847.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://1.bp.blogspot.com/_6SxqtkJQECI/TLFuirlgUzI/AAAAAAAAAKI/EVsfcjXffTg/s320/IMG_20101009_155847.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">變壓器</td></tr></tbody></table><br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TLFunD_oQ4I/AAAAAAAAAKM/jn2_G3o49EA/s1600/IMG_20101009_155944.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TLFunD_oQ4I/AAAAAAAAAKM/jn2_G3o49EA/s320/IMG_20101009_155944.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">變壓器＋電池</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFuqyxWJNI/AAAAAAAAAKQ/baRiv6FcCwk/s1600/IMG_20101009_160011.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFuqyxWJNI/AAAAAAAAAKQ/baRiv6FcCwk/s320/IMG_20101009_160011.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">thinkpad本身！！</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFuzX1GQOI/AAAAAAAAAKY/IVgbVgyPTRg/s1600/IMG_20101009_160047.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFuzX1GQOI/AAAAAAAAAKY/IVgbVgyPTRg/s320/IMG_20101009_160047.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><br /></td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFu3y_B_kI/AAAAAAAAAKc/QwBQWfsEQVQ/s1600/IMG_20101009_160059.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFu3y_B_kI/AAAAAAAAAKc/QwBQWfsEQVQ/s320/IMG_20101009_160059.jpg" width="240" /></a></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFu-oGb2TI/AAAAAAAAAKg/5-LXfnK3gw4/s1600/IMG_20101009_160104.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFu-oGb2TI/AAAAAAAAAKg/5-LXfnK3gw4/s320/IMG_20101009_160104.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;"><br /></td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFvDabqrOI/AAAAAAAAAKk/uv9qeIzBPxU/s1600/IMG_20101010_153122.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFvDabqrOI/AAAAAAAAAKk/uv9qeIzBPxU/s320/IMG_20101010_153122.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">與舊筆電的比較圖</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFvHaoneMI/AAAAAAAAAKo/4BhyM0_uSx8/s1600/IMG_20101010_153148.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TLFvHaoneMI/AAAAAAAAAKo/4BhyM0_uSx8/s320/IMG_20101010_153148.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">很明顯的thinkpad比較窄一點，因為喇叭設計在鍵盤左右方，不然的話應該可以更窄</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFvLlxw3lI/AAAAAAAAAKs/_Apn55ye3pY/s1600/IMG_20101010_153153.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFvLlxw3lI/AAAAAAAAAKs/_Apn55ye3pY/s320/IMG_20101010_153153.jpg" width="320" /></a></div><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFvQF5RFDI/AAAAAAAAAKw/jQt4SsXI53M/s1600/IMG_20101010_153209.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="240" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TLFvQF5RFDI/AAAAAAAAAKw/jQt4SsXI53M/s320/IMG_20101010_153209.jpg" width="320" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">厚度很明顯差不多</td></tr></tbody></table><br /><br />用了一天之後的心得是鍵盤真的很好打！！！！<br /><br />小紅點也很好用！！！<br /><br />且我喜歡他的霧面螢幕<br /><br />16:10的設置不會讓我覺得螢幕跟之前acer的15.6(16:9)來的小<br /><br />蠻舒適的！！<br /><br />其實acer也很好用！只是如果要隨身攜帶真的頗不方便的！<br /><br />也剛好友人要買ＮＢ，於是乾脆就賣他了！<br /><br />真是有點不捨！<br /><br /><br /><br />不好意思，這篇開箱文非常不專業ＸＤ<br /><br />我太懶惰了！<br /><br />請多多包涵，有問題再問我吧！<br /><br />總而言之，這台電腦好用！<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/10/10/thinkpad-t410" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>MyISAM 與 InnoDB 的筆記</h1>

      <div class="entry">
        &nbsp;MyISAM 與 InnoDB 誰較快?誰安全性較高?<br /><br />最近都在玩GAE，好久沒有碰MySQL<br /><br />再把新nb裝起來，正在重灌，<br /><br />就看到了MyISAM 與 InnoDB 選項<br /><br />一時想不起來兩者差別，忘記哪個快，哪個有支援transaction?<br /><br />查了一下資料才想起來，年紀大了，還是做筆記把他記下來吧!<br /><br /><br /><br />InnoDB&nbsp;是不支援全文索引，如果資料量大，建議用InnoDB ，<br /><br />大量的insert語法在MyISAM會比較快一點，但update在InnoDB會比較快，<br /><br />count不適用於InnoDB（等等會說明），MyISAM是不支援foreign key的喔<br /><br />因為設計上MyISAM比InnoDB簡單，因此效能上也較好一點，小型的應用使用MyISAM可能會較好一點<br /><br />InnoDB不會紀錄table的行數，因此當使用者下select count(*) from xxxx，InnoDB會去掃描整張table，但MyISAM就只是讀取記錄好的行數即可，<br /><br />但是!!當你的count後面有下where條件時，InnoDB和MyISAM都會去掃描整張table<br /><br /><br />以上是我的筆記，如有誤，請指教<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/10/10/myisam-innodb" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android 取得camera的照片</h1>

      <div class="entry">
        android 取得camera的照片<br /><br />其實想在android裡面實現照相的功能，大致上分成兩種，<br /><br />第一種是自己去implement一個camera介面出來（不難但複雜，較具有彈性）<br /><br />第二種是直接利用android內部的預設介面（簡單，就只有單單的拍照功能）<br /><br /><br />第一種通常會用到的時機，可能是你要作一個類似信義房屋先前作的app，<br /><br />你可以需要開啟相機，並拿著手機看看周圍，並在你的view上顯示出來這個方向有沒有房子<br /><br />這種方式要實作，並不困難，只是比較複雜。改天在po code上來教學。<br /><br />今天是要教學第二種！！<br /><br />第二種就非常簡單了！<br /><br />但相對的就沒有什麼彈性，就只有單單的開起android的照相界面，<br /><br />然後取得照片罷了！<br /><br />步驟<br /><br />1.先利用intent去開啟照相的介面<br /><br />2.在本身的activity去等待回傳的 result<br /><br /><br /><br /><br /><pre class="brush: java">Intent intent =  new Intent(android.provider.MediaStore.ACTION_IMAGE_CAPTURE);//利用intent去開啟android本身的照相介面<br /><br /><br />//設定圖片的儲存位置，以及檔名<br />File tmpFile = new File(<br />               Environment.getExternalStorageDirectory(), <br />        "image.jpg");<br />Uri outputFileUri　= Uri.fromFile(tmpFile);<br />   <br />/*<br /> * 把上述的設定put進去！然後startActivityForResult,<br /> * 記住，因為是有ForResult，所以在本身自己的acitivy裡面等等要複寫onActivityResult<br /> * 稍後再說明onActivityResult<br /> */    <br />intent.putExtra(MediaStore.EXTRA_OUTPUT, outputFileUri); <br />startActivityForResult(intent, 0); <br /><br /></pre><br /><br /><br />接著就來說明<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">onActivityResult</span><br /><br /><br /><pre class="brush: java">@Override<br /> protected void onActivityResult(int requestCode, int resultCode, Intent data) {  <br />  super.onActivityResult(requestCode, resultCode, data);<br />  <br />  if (resultCode == RESULT_OK) {<br />   Bitmap bmp = BitmapFactory.decodeFile(outputFileUri.getPath()); //利用BitmapFactory去取得剛剛拍照的圖像<br />   ImageView ivTest = (ImageView)findViewById(R.id.ivTest);<br />   ivTest.setImageBitmap(bmp);<br />  }<br /> }<br /><br /></pre><br /><br />最後還得在AndroidManifest.xml上加上下面幾個permission，<br /><pre class="brush: xml">  &lt;!-- CAMERA --&gt;<br />   &lt;uses-permission android:name=&quot;android.permission.CAMERA&quot; /&gt;<br />   &lt;uses-permission android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; /&gt;<br />   &lt;uses-feature android:name=&quot;android.hardware.camera&quot; /&gt;<br />  &lt;uses-feature android:name=&quot;android.hardware.camera.autofocus&quot; /&gt;   <br /><br /></pre><br /><br />這樣就完成一個簡單的照相功能！！<br /><br /><br /><br /><br />
      </div>

      <a href="/2010/10/09/android-camera" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>我的好夥伴byebye【不是教學文】</h1>

      <div class="entry">
        <div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TK_pX4XQCHI/AAAAAAAAAJ4/iZO4uyxDMSs/s1600/IMG_20101009_011122.jpg" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="240" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TK_pX4XQCHI/AAAAAAAAAJ4/iZO4uyxDMSs/s320/IMG_20101009_011122.jpg" width="320" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />這台notebook，是用我第一次賺的錢所買的，<br /><br />因此對我意義非凡，第一次用自己賺的錢買東西，這種感覺很奇妙，<br /><br />買他的時間大概是去年八月。<br /><br />但昨天買了thinkpad t410，今天即將去取貨。<br /><br />要換NB的原因主要是因為這台太大了，<br /><br />身為個研究生，還得帶著他東跑西跑，實在有點累!<br /><br />所以才打算換一台thinkpad...<br /><br />心裡有點感傷XDD<br /><br />畢竟陪伴了我一年多!!<br /><br />陪我去過很多地方，接了幾個案子，去了Yahoo Hack Day、Google DevFest。<br /><br />幫我賺了大概有9萬塊！！<br /><br />真是不捨啊！<br /><br />但是我也幫他找到了好主人，我的一位好朋友！<br /><br />相信他會好好對待他的！<br /><br /><br /><br />掰掰！等我有錢再把你贖回來！<br /><br /><br /><br />5738G<br /><br />CPU: P8700<br /><br />HD: 500G 7200rpm<br /><br />Memory: 4G<br /><br />Graphic: ATI4500 512m<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/10/09/byebye" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android market 台灣可以上傳付費軟體了</h1>

      <div class="entry">
        今天早上到了Google DevFest Day，<br /><br />就收到了mail，<br /><br /><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;">developers from 20 additional countries (Argentina, Australia, Belgium, Brazil, Canada, Denmark, Finland, Hong Kong, Ireland, Israel, Mexico, New Zealand, Norway, Portugal, Russia, Singapore, South Korea, Sweden, Switzerland and&nbsp;<span class="Apple-style-span" style="color: red;">Taiwan</span>) can now<span class="Apple-style-span" style="color: red;">&nbsp;sell paid apps</span>&nbsp;on Android Market</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></span></div><div><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></span></div><br /><br /><br /><br />預計是在兩個禮拜內!!<br /><br />在現場的Google工程師也開始講解上傳的一些規則及技巧了!!<br /><br /><br /><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: small;"><span class="Apple-style-span" style="border-collapse: collapse; font-size: 13px;"><span class="Apple-style-span" style="font-family: Arial;"><span class="Apple-style-span" style="border-collapse: separate; font-size: medium;"><br /></span></span></span></span><br /><span class="Apple-style-span" style="border-collapse: collapse; font-family: arial, sans-serif; font-size: 13px;"><br /></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: small;"><span class="Apple-style-span" style="border-collapse: collapse; font-size: 13px;"><br /></span></span>
      </div>

      <a href="/2010/10/01/android-market" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Adsense for mobile content（android放置Google 廣告【下】）</h1>

      <div class="entry">
        在上篇已經介紹過如何設定一個Adsense for mobile content<a href="http://ken-note.blogspot.com/2010/09/adsense-for-mobile-contentandroidgoogle.html">（上篇）</a><br /><br />這篇將會介紹如何在android app裡面，使用您設定好的Adsense for mobile content<br /><br />首先請在您的layout裡放置一個WebView<br /><br /><pre class="brush: xml"><linearlayout android:layout_height="fill_parent" android:layout_width="fill_parent" android:orientation="vertical" xmlns:android="http://schemas.android.com/apk/res/android"><br /> <webview android:id="@+id/wvAdSense" android:layout_height="50px" android:layout_width="320px"><br /> </webview><br /></linearlayout><br /><br /></pre><br /><br />然後在activity裡設定ＵＲＬ<br /><br /><pre class="brush: java">public class main extends Activity {<br />    <br />    @Override<br />    public void onCreate(Bundle savedInstanceState) {<br />     requestWindowFeature(Window.FEATURE_NO_TITLE);//把activity title拿掉<br />        super.onCreate(savedInstanceState);<br />        setContentView(R.layout.main);<br />  WebView wvSense = (WebView) findViewById(R.id.wvAdSense);<br />        wvSense.getSettings().setJavaScriptEnabled(true);<br />        wvSense.loadUrl("http://ken-mis.appspot.com/"); //這個url是您放置您的Adsense的網站<br /> }<br /> <br />}<br /><br /></pre><br /><br />這樣就完成了！<br /><br />您就可以在您的app裡看到您的Google廣告。<br /><br />在提醒一次，其實這樣的方式Google不允許！<br /><br />如果害怕可以使用AdMob。<br /><br />然後慢慢等Adsnse for mobile application在亞洲地區上市吧！<br /><br /><br /><br /><br />
      </div>

      <a href="/2010/09/18/adsense-for-mobile-contentandroidgoogle_18" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Adsense for mobile content（android放置Google 廣告【上】）</h1>

      <div class="entry">
        Adsense for mobile content<br /><br />注意！這篇是for mobile content<br /><br />for mobile content<br /><br />是用來給手機網站放置的。<br /><br />並不能放置android裡面去。<br /><br />not for mobile application<br /><br />當然也有for mobile application<br /><br />for mobile application只有在美國、加拿大開放而已啊！囧！<br /><br />但是可以利用一些漏洞在android放置google adsense。<br /><br />（注意！但是Google是不允許這樣的ＸＤ，但是不知道就算用了，Google會怎處理）<br /><br />反正就先教學吧！<br /><br />想要在Android裡放置Google廣告，<br /><br />那麼必須請先去Google Adsense的網站註冊，<br /><a href="https://www.google.com/adsense/report/overview">https://www.google.com/adsense/report/overview</a><br /><br />並點選<span class="Apple-style-span" style="color: red;">Adsense行動內容廣告</span>（Adsense for mobile content）<br /><br />然後先<span class="Apple-style-span" style="color: red;">【</span><span class="Apple-style-span" style="color: red;">選擇廣告類型】：不用作任何修改，直接按繼續&nbsp;</span><br /><br />在來是<span class="Apple-style-span" style="color: red;">【</span><span class="Apple-style-span" style="color: red;">廣告風格</span><span class="Apple-style-span" style="color: red;">】：</span><span class="Apple-style-span" style="color: red;">這邊就依個人，看你廣告頁面的顏色配置</span><br /><br />在來是<span class="Apple-style-span" style="color: red;">【選擇廣告頻道</span><span class="Apple-style-span" style="color: red;">】：這裡不要設定任何channel，除非要測試某些特定類型的廣告。</span><br /><br />在來就是<span class="Apple-style-span" style="color: red;">【取得廣告程式碼】</span><br /><br />取得您的Adsense程式碼後(javascript)<br /><br /><pre class="brush: js"><script type="text/javascript"><br /><!--<br />window.googleAfmcRequest = {<br />  client: 'ca-mb-pub-3783438370424072',<br />  ad_type: 'text_image',<br />  output: 'html',<br />  channel: '',<br />  format: '320x50_mb',<br />  oe: 'utf8',<br />  color_border: '336699',<br />  color_bg: 'FFFFFF',<br />  color_link: '0000FF',<br />  color_text: '000000',<br />  color_url: '008000',<br />};<br />//--><br /></script><br /><script c="http://pagead2.googlesyndication.com/pagead/show_afmc_ads.js" sr="" type="text/javascript"><br /></script><br /><br /><br /></pre><br /><br /><br /><br /><br />將這段code上傳至您的網站上，<br /><br />（注意！是貼您的那段ＣＯＤＥ，不是我這段，如果貼我的，人家點擊，也是我在賺==我是不介意ＸＤ）<br /><br />這裡我就上傳至我的GAE上，(http://ken-mis.appspot.com)<br /><br />記得，只有手機的瀏覽器才看得到廣告!<br /><br />至於怎麼放置在android app裡面，在<a href="http://ken-note.blogspot.com/2010/09/adsense-for-mobile-contentandroidgoogle_18.html">（下篇）</a>會介紹。<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/09/18/adsense-for-mobile-contentandroidgoogle" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>BroadcastReceiver trigger ANR</h1>

      <div class="entry">
        <span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">BroadcastReceiver trigger &nbsp;ANR</span></span><br /><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">今天發現某支app丟出了一個ANR!</span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">看了一下LOG!</span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-size: medium;"><span class="Apple-style-span" style="font-size: 16px;">發現是由</span></span><span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver丟出來的!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">看了一下官方ANR的有關說明!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">才發現!!!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 10.8333px; line-height: 16px;"><span class="Apple-style-span" style="color: red;">A&nbsp;</span><code style="font-family: monospace; line-height: 1em;"><a href="http://developer.android.com/reference/android/content/BroadcastReceiver.html"><span class="Apple-style-span" style="color: red;">BroadcastReceiver</span></a></code><span class="Apple-style-span" style="color: red;">&nbsp;hasn't finished executing within 10 seconds</span></span></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">原來一個</span><span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver要在十秒之內完成，否則會丟出一個ANR!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div>雖然我知道一個long operation盡量在service中完成，</div><div><br /></div><div>但我不知道<span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver的限制time out 這麼短!!!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div>在<span class="Apple-style-span" style="font-size: 15.8333px;">BroadcastReceiver的說明文件中也有提到!</span></div><div><br /></div><div><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 10.8333px; line-height: 16px;"><span class="Apple-style-span" style="color: red;">(there is a timeout of 10 seconds that the system allows before considering the receiver to be blocked and a candidate to be killed</span></span></div><div><br /></div><div><span class="Apple-style-span" style="font-size: 15.8333px;">所以大家在send&nbsp;</span><span class="Apple-style-span" style="font-size: 15.8333px;">Broadcast，大家要注意一下了!!</span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div><div><span class="Apple-style-span" style="font-size: 15.8333px;"><br /></span></div>
      </div>

      <a href="/2010/09/10/broadcastreceiver-trigger-anr" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android DB on SD Card 新增、查詢（DB 2/2）</h1>

      <div class="entry">
        android insert value to DB、select value from DB<br /><br />這篇文章會介紹<br /><br />如何新增資料到sqllite database，並在database作查詢等動作<br /><br /><a href="http://ken-note.blogspot.com/2010/09/android-create-db-on-sdcard.html">上一篇已經介紹如何在sd card新增資料庫</a><br /><br />這裡就只略過如何新增資料庫，直接說明新增and查詢的動作<br /><br /><pre class="brush: java">public class db_sample {<br /> public static final String STR_TABLE_NAME    = "table_name"; //table名稱<br /> public static final String STR_FIELD_ID     = "field_id";  //欄位名稱 <br /> public static final String STR_FIELD_NAME    = "field_name"; //欄位名稱<br /> private static Context context;         <br /> <br /> public db_sample(Context context) {<br />  this.context = context; //new這個class時，一定要傳入context，因為openOrCreateDatabase是由context底下的method<br /> }<br /> <br /> //建立table的method<br /> public static final void fnCreateDB(){<br />  //MODE_WORLD_WRITEABLE，只能有寫的權限<br />  SQLiteDatabase dbwrite <br />      = context.openOrCreateDatabase("/sdcard/hi_test.db", context.MODE_WORLD_WRITEABLE, null);<br />  <br />  //建立table<br />  String sql = <br />    String.format("CREATE TABLE %s (%s INTEGER primary key autoincrement, %s text )"<br />        , STR_TABLE_NAME  <br />        , STR_FIELD_ID    <br />        , STR_FIELD_NAME   <br />    ); <br />  dbwrite.execSQL(sql);<br /> }<br /> <br /> //新增資料的method<br /> public static final long fnInsert(String strText){<br />  SQLiteDatabase dbwrite <br />      = context.openOrCreateDatabase("/sdcard/hi_test.db", context.MODE_WORLD_WRITEABLE, null);<br />  ContentValues cv = new ContentValues();<br />  cv.put(STR_FIELD_NAME, strText);<br />  return dbwrite.insert(STR_TABLE_NAME, null, cv);//如果return -1代表有錯誤，否則會return該筆資料在第幾列<br /> }<br /> <br /> //撈資料的method<br /> public  static final int fnRead(String strText){<br />  //MODE_WORLD_WRITEABLE，只能有讀取的權限<br />  SQLiteDatabase dbread <br />      = context.openOrCreateDatabase("/sdcard/hi_test.db",context. MODE_WORLD_READABLE, null);<br />  <br />  <br />  Cursor cursor <br />    = dbread.rawQuery( <br />      "select "+STR_FIELD_ID+" from "+STR_TABLE_NAME+" where "+STR_FIELD_NAME+"=?", <br />      new String[] {strText}<br />    );<br />  <br />  if (cursor.moveToFirst()) { <br />   return cursor.getInt(0);<br />  }<br />  return -1;<br /> }<br /> <br />}<br /><br /></pre><br /><br /><br />呼叫方法就如下： <br /><br /><pre class="brush: java">public class test extends Activity{<br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br /> super.onCreate(savedInstanceState);<br /> db_sample db = new db_sample(this);<br /> db.fnCreateDB();<br /> db.fnInsert("HI");<br /> int iID = db.fnRead("HI");<br /> }<br /><br />}<br /></pre>
      </div>

      <a href="/2010/09/04/android-insert-value-to-dbselect-value" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android create DB on sdcard（DB 1/2）</h1>

      <div class="entry">
        android create db on sdcard<br /><br />把DB建立在SD Card上其實很簡單。<br /><br />先建立一個有關db操作的class，<br /><br />注意，此範例尚無新增、查詢等method，將在<a href="http://ken-note.blogspot.com/2010/09/android-insert-value-to-dbselect-value.html">下一篇</a>介紹如何新增、查詢<br /><br />此範例單純只有在sd card建立sqlite datebase<br /><br />如下<br /><br /><pre class="brush: java">public class db_sample {<br /> public static final String STR_TABLE_NAME    = "table_name"; //table名稱<br /> public static final String STR_FIELD_ID     = "field_id";  //欄位名稱 <br /> public static final String STR_FIELD_NAME    = "field_name"; //欄位名稱<br /> private static Context context;         <br /> <br /> public db_sample(Context context) {<br />  this.context = context; //new這個class時，一定要傳入context，因為openOrCreateDatabase是由context底下的method<br /> }<br /> <br /> //建立table的method<br /> public static final void fnCreateDB(){<br />  //MODE_WORLD_WRITEABLE，只能有寫的權限<br />  SQLiteDatabase dbwrite <br />      = context.openOrCreateDatabase("/sdcard/hi_test.db", context.MODE_WORLD_WRITEABLE, null);<br />  <br />  //建立table<br />  String sql = <br />    String.format("CREATE TABLE %s (%s INTEGER primary key autoincrement, %s text )"<br />        , STR_TABLE_NAME  <br />        , STR_FIELD_ID    <br />        , STR_FIELD_NAME   <br />    ); <br />  dbwrite.execSQL(sql);<br /> }<br /> <br /> <br />}<br /><br /></pre><br /><br /><br />接著就在需要的地方呼叫即可～<br /><br /><pre class="brush: java">public class test extends Activity{<br /> @Override<br /> protected void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  db_sample db = new db_sample(this);<br />  db.fnCreateDB();<br />  <br /> }<br /><br />}<br /></pre><br /><br />
      </div>

      <a href="/2010/09/04/android-create-db-on-sdcard" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android AsyncTask sample</h1>

      <div class="entry">
        android 的AsyncTask<br /><br />如果你可能要去download、request一個蠻龐大的網頁或者檔案時，<br /><br />如果是在主要的activity、widget或其他中去作，<br /><br />那麼想必你的activity、widget或其他的UI會像是被lock住!<br /><br />很LAG的感覺!<br /><br />那麼就使用AsyncTask吧!<br /><br />顧名思義，就是非同步排程(應該可以這樣翻)==<br /><br />AsyncTask的好處就是可以在background執行，<br /><br />並不影響前端的UI<br /><br />下面就是實作方法<br /><br />先去new一個class並繼承AsyncTask<br /><br /><pre class="brush: java">public class downloadTask extends AsyncTask&lt;String, Void , String&gt;{<br /> <br /> public static int iFileSize   = 0;<br /> public static double dReadSum   = 0;<br /> public static boolean bIsDownload = false;<br /> <br /> @Override<br /> protected void onProgressUpdate(Void... values) {<br />  <br />  //此method是在呼叫publishProgress()時的才會trigger到的<br />  //可以當配progressBar來使用，這裡不多作說明。<br />  <br />  super.onProgressUpdate(values);<br /><br /> }<br /><br /> <br /> @Override<br /> protected void onPreExecute() {<br />  //此method是在執行doInBackground以前，才會呼叫的<br />  super.onPreExecute();<br /> }<br /> <br /> @Override<br /> protected void onPostExecute(String result) {<br />  //此method是在doInBackground完成以後，才會呼叫的<br />  super.onPostExecute(result);<br />  if (iFileSize == dReadSum){<br />   Log.d("main","下載完成");<br />  }<br />  <br /> }<br /><br />  /*<br />  *注意!strUrlFile是一個array..代表著在呼叫此class時<br />  *可以帶入很多個參數(strUrlFile)，<br />  *如:new downloadTask().execute("http://www.xxx","http://www.xxx");<br />  */ <br /> protected String doInBackground(String... strUrlFile) {<br />     URL urlFileLocation = null;<br />   HttpURLConnection connFile = null;<br />   try {<br />    int iUrlCount = strUrlFile.length;<br />   for (int i =0 ; i &lt; iUrlCount ; i++){<br />    urlFileLocation  = new URL(strUrlFile[i]);   <br />    connFile    = (HttpURLConnection) urlFileLocation.openConnection();   <br />    connFile.setDoInput(true);<br />    <br />    InputStream is = connFile.getInputStream();<br />    iFileSize  = connFile.getContentLength();    //取得檔案大小<br />    <br />    byte[] buffer = new byte[1024];<br />    int len1 = 0;<br />    dReadSum  = 0;<br />    <br />    while ( (len1 = is.read(buffer)) != -1) {<br />     dReadSum += len1;<br />     publishProgress(dReadSum*100/iFileSize);<br />    }<br />   }<br />    <br />    <br />   } catch (Exception e) {<br />    Log.d("main","download---" + e.toString());<br />   }<br />   <br />        return "";<br />     }<br /><br />   <br /> }<br /></pre><br /><br /><br />呼叫此Class就只要一行:<br /><br /><pre class="brush: java"> new downloadTask().execute("http://www.xxx"); <br />/*<br />*注意，參數其實是可以很多個，如下<br />*new downloadTask().execute("http://www.xxx","http://www.xxx");<br />*這樣子此task就會去download兩次<br />*/<br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/09/02/android-asynctask-sample" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android parse xml</h1>

      <div class="entry">
        android parse xml<br /><br />在anroid parse xml其實有蠻多方法的<br /><br />例如SAX(Simple API for XML)、DOM...<br /><br />大家都知道用SAX來parse會較省記憶體。<br /><br />但用SAX的麻煩就是必須自己去寫content handler...<br /><br />但如果您的XML檔並不大，且去讀取的次數沒有很頻繁，<br /><br />那麼還是建議您用DOM吧!較簡單!<br /><br />實作方法如下:<br /><br /><pre class="brush: java"> private static DocumentBuilder documentBuilder  = null;  <br /> private static Document document        = null;<br /> private static NodeList elements        = null;<br /> private static int iElementLength= 0;<br /><br /> @Override<br /> public void onStart(Intent intent, int startId) {<br />  super.onStart(intent, startId);<br />  try{<br />   <br />   URL urlUpdate = new URL("http://www.xxx.xxx/xxx.xml");<br />   documentBuilder = DocumentBuilderFactory.newInstance().newDocumentBuilder();  <br />   document = documentBuilder.parse(urlUpdate.openStream());      <br />   document.getDocumentElement().normalize();  <br />   <br />   /*<br />   *其實簡單到我也不知該怎麼寫註解了，<br />   *先get到你要的tag吧，記得回傳型態是NodeList，<br />   *不要看我命名為elements，就以為他是Element<br />   */<br />   elements  = document.getElementsByTagName("update_images");<br />   iElementLength=elements.getLength();<br />   if (iElementLength ==0 )<br />    return;<br />    <br />   for (int i = 0; i &lt; iElementLength ; i++) {<br />    Element element = (Element) elements.item(i);<br />    Log.d("main",element.getAttribute("pic_name"));<br />   }<br />  }catch (Exception e) {<br />   Log.d("main",String.valueOf(e.toString()));<br />  }<br />   <br /> }<br /></pre><br /><br />大概就是這樣!<br /><br />
      </div>

      <a href="/2010/09/01/android-parse-xml" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android service keep alive or another way??</h1>

      <div class="entry">
        android service crashed (restart)<br /><br />如果你有支APP有個SERVICE是可能每隔一段時間去做一次的!<br /><br />那麼我建議你改用AlarmManager。<br /><br />最近發現自己寫的某支APP裡面的service會被android os restart!<br /><br />大概知道是因為是background service的關係，<br /><br />想要讓一個service keep alive。<br /><br />當然有解決方法，在2.0以前的device，<br /><br />可以使用setForeground(true);<br /><br />但是2.0以上，這個method，失效了。<br /><br />改成startForeground(id, notification)。<br /><br />但我改用了AlarmManager<br /><br />原因當然有很多，像是其實啟動一個service，就是啟動一個process。<br /><br />想必就消耗掉一點memory...<br /><br />當然還有其他原因，大家可以去Google一下。<br /><br />實作方法如下:<br /><br /><pre class="brush: java">public void onUpdate(Context context, AppWidgetManager appWidgetManager,int[] appWidgetIds) {<br />   Intent intent = new Intent(context, receiverChange.class);  //放入你每隔一段時間要執行的class<br />   PendingIntent pendingIntent   = PendingIntent.getBroadcast(context, 0, intent, 0);<br />   AlarmManager alarmManager  = (AlarmManager) context.getSystemService(Context.ALARM_SERVICE);<br />   //接著就是set一個repeat，這裡是設定每隔一分鐘去執行<br />   alarmManager.setRepeating(AlarmManager.RTC_WAKEUP,  System.currentTimeMillis() , (60*1000), pendingIntent);<br /> }<br /></pre><br /><br />然後您每隔一段時間要做的事情就寫在一個BroadcastReceiver裡面<br /><br /><pre class="brush: java">public class receiverChangePicture extends BroadcastReceiver {<br /> @Override<br /> public void onReceive(Context context, Intent intent) {<br />  Log.d("main","hi I receive message every minutes..");<br /> }<br /><br />}<br /></pre><br /><br /><br />這樣就完成了，但是注意此實作方法只限定於有週期性要執行的code才適用!!!!<br /><br />如果今天你是要偵測sd card的狀態，那麼建議你還是用service!(就如同我上篇文章所說的)<br /><br />以alarmManager來實作，只是節省一點成本罷了!<br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/08/31/android-service-keep-alive-or-another" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android 偵測 sdcard</h1>

      <div class="entry">
        最近在寫一些有關檔案的操作，<br /><br />要把檔案寫到sdcard裡去<br /><br />至於怎麼寫，這裡就不多說<br /><br />在寫檔之前，好的programmer一定要注意到防呆!<br /><br />就是detect sdcard的狀態<br /><br />是否有被mount上去?<br /><br />之前都直接寫一個function去取得目前sdcard的狀態，如下   <br /><pre class="brush: java"> private static final boolean fnIsSDcard(){<br />  return Environment.getExternalStorageState().equals(Environment.MEDIA_MOUNTED);  <br /> }<br /></pre><br /><br /><br />但是在我的需求中，這種寫法會有問題，<br /><br />因為我的檔案較大，在寫的過程中會耗費比較久的時間，<br /><br />如果在寫檔的過程中，sdcard被unmounted了! 很好，這個process會被killed掉!<br /><br />因為這是process中有參照到sdcard裡的位置，所以android os會強制kill掉!<br /><br />所以我就在想...sdcard有沒有event listener啊??<br /><br />但是沒有，所以我透過Service和BroadcastReceiver去實作<br /><br />首先先新增一個class，然後要extends Service，如下<br /><br /><br /><pre class="brush: java">public class serviceSDcard extends Service {<br /> @Override<br /> public IBinder onBind(Intent intent) {<br />  return null;<br /> }<br /><br /> @Override<br /> public void onStart(Intent intent, int startId) {<br />  //新增一個IntentFilter<br />  IntentFilter intentFilter = new IntentFilter();   <br />  //並且新增兩個action，告知此 service什麼時候的動作才要通知你<br />  intentFilter.addAction(Intent.ACTION_MEDIA_MOUNTED); //如果sdcard被掛載上去時通知<br />  intentFilter.addAction(Intent.ACTION_MEDIA_UNMOUNTED); //如果sdcard被卸載時通知<br />  intentFilter.addDataScheme("file"); <br />  intentFilter.addDataAuthority("*", null);<br />  registerReceiver(receiver, intentFilter);    //註冊一個BroadcastReceiver<br />  super.onStart(intent, startId);<br /> }<br /> private BroadcastReceiver receiver = new BroadcastReceiver() {<br />  <br />  @Override<br />  public void onReceive(Context context, Intent intent) {<br />   try {<br />    <br />    if (intent.getAction().equals(Intent.ACTION_MEDIA_UNMOUNTED)){<br />     //sdcard被卸載時的動作<br />     <br />    }else{<br />     //sdcard被掛載時的動作<br />    }<br />    <br />    <br />   } catch (Exception e) {<br />    Log.d("main", e.toString());<br />   }<br />  <br />  }<br /> };<br />}<br /></pre><br /><br /><br />一個Service就完成了，現在就要把Service啟動!<br /><br />在主要執行的activity中去startService();，如下<br /><br /><br /><pre class="brush: java">public class main extends Activity {<br />    @Override<br />    public void onCreate(Bundle savedInstanceState) {<br />        super.onCreate(savedInstanceState);<br />        setContentView(R.layout.main);<br />        Intent intent = new Intent(this,serviceSDcard.class);<br />        startService(intent);<br />    }<br />}<br /></pre><br /><br /><br /><br />這樣就完成啦! 記得要在manifest.xml中新增一個service喔!!如下:<br /><br /><br /><pre class="brush: java">&lt;service android:name=".serviceSDcard"&gt;&lt;/service&gt;<br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/08/19/android-sdcard" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android ProgressBar in AppWidget</h1>

      <div class="entry">
        android ProgressBar in AppWidget<br /><br />會產生一些問題!<br /><br />基本上在顯示，或者設定目前progress都是沒問題的!!<br /><br />但是當你要把ProgressBar 設為Invisible的時候就會產生BUG!<br /><br />目前看來似乎是android本身的bug...<br /><br />至少找資料找到現在...蠻多人都說這樣的!<br /><br /><pre class="brush: java">Views.setViewVisibility(R.id.TextView01, View.VISIBLE);<br /></pre><br />以往只要打這行code就能把某個元件Invisible或者GONE掉<br /><br />但是如果元件是Progress Bar的話!<br /><br />會無法動作!!<br /><br />所以在這建議大家使用兩個layout<br /><br />一個是有progress bar，一個沒有!<br /><br />如下!<br /><br /><br /><pre class="brush: java">RemoteViews withProgressViews= new RemoteViews(this.getPackageName(),R.layout.progress_layout);//這個是有Progress的<br /><br />RemoteViews withoutProgressViews= new RemoteViews(this.getPackageName(),R.layout.init_layout);//這沒有Progress的<br /><br />app_manager.updateAppWidget(appWidgetId, withProgressViews/withoutProgressViews);//在透過app_manager去更新妳widget的layout樣式<br /><br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/08/07/android-progressbar-in-appwidget" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android file.mkdir()</h1>

      <div class="entry">
        <br />今天在實作在 sdcard裡面建立一個檔案!<br /><br />其實這沒什麼難度!<br /><br /><pre class="brush: java">File file = new File("/sdcard/tmp/tmp.db");<br />file.createNewFile();<br /></pre><br /><br />這樣乍看之下是沒甚麼問題<br /><br />但如果沒有tmp此目錄的話!<br /><br />則會出現exception<br /><br />當然! 要建立一個目錄也很簡單!!只要用mkdir即可!<br /><br /><pre class="brush: java">file.mkdir();<br /></pre><br /><br />但是!<br /><br />必須加入一個權限才可以建立目錄!<br /><br /><pre class="brush: java">&lt;uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE"&gt;&lt;/uses-permission&gt;<br /><br /></pre><br /><br />但是建立檔案就不用了!
      </div>

      <a href="/2010/08/07/android-filemkdir" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Drawable 轉換 Bitmap</h1>

      <div class="entry">
        在實做widget的時候，<br /><br />要在前景把圖片換掉<br /><br />發現只有<br /><br />setImageViewBitmap<br />setImageViewResource<br />setImageViewUri<br /><br />這三個method可以用<br /><br />但是我的圖片是從sqllite中抓出來的!<br /><br />只能先存成drawable!!<br /><br /><pre class="brush: java">ByteArrayInputStream stream = new ByteArrayInputStream( cursor.getBlob(1)); <br />Drawable p_pic              = Drawable.createFromStream(stream, "p_pic"); <br />//fnCastToBitmap是等等自己撰寫的function..<br />Bitmap bitmapTmp = fnCastToBitmap(p_pic);<br /></pre><br /><br /><br />但是這樣的drawable根本沒有id，無法使用setImageViewResource來抓圖!<br /><br />所以只好把它轉成bitmap..<br /><br />如下段CODE:<br /><br /><pre class="brush: java"><br />public Bitmap fnCastToBitmap(Drawable drawable){<br /><br />     //先設定一個config給等等要產生的bitmap，先判斷他的透明度，在判斷他的格式 <br />     Bitmap.Config config =<br />      drawable.getOpacity() != PixelFormat.OPAQUE <br />      ? Bitmap.Config.ARGB_8888 <br />      : Bitmap.Config.RGB_565;<br /><br />     //產生一個bitmap...寬跟高如原來圖的一樣  <br />     Bitmap bitmap = Bitmap.createBitmap( drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight(),  config );<br /><br />     //在建立一個canvas，並把圖畫在上面去即可!!!<br />     Canvas canvas = new Canvas(bitmap);<br />     drawable.setBounds(0, 0, drawable.getIntrinsicWidth(), drawable.getIntrinsicHeight());<br />     drawable.draw(canvas);<br />            <br /> <br />     return bitmap;<br />}<br /><br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/08/01/drawable-bitmap" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android tab activity</h1>

      <div class="entry">
        今天來介紹一下Android tab activity好了!<br /><br />其實最近實作了不少東西，但一直沒有時間記錄下來<br /><br />Tab Actity倒是蠻久之前的，拿出來溫習一下吧!<br /><br />先新增一個class吧!<br /><br />但要繼承的是TabActivity!<br /><br />如果要做到Tab變換時，會有所動作時，<br /><br />要記得implements OnTabChangeListener<br /><br />如下:<br /><br /><pre class="brush: java">public class main extends TabActivity implements OnTabChangeListener {<br /><br />}<br /></pre><br /><br />接著就來部屬Tab的長相了!<br /><br />這邊先預設兩個Tab(tab1、tab2)，其實tab裡的東西可以重複使用，這裡只是為了清楚定義<br /><br />而宣告兩個!<br /><br /><br /><pre class="brush: xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;FrameLayout xmlns:android="http://schemas.android.com/apk/res/android"<br /> android:orientation="vertical" android:layout_width="fill_parent"<br /> android:layout_height="fill_parent"&gt;<br /> &lt;LinearLayout <br />  android:id="@+id/tab1" <br />  android:layout_width="fill_parent"<br />  android:layout_height="fill_parent" <br />  androidrientation="vertical"<br />  android:background="#ffffff"<br /> &gt;<br /> &lt;/LinearLayout&gt;<br /><br /> &lt;LinearLayout <br />  android:id="@+id/tab2" <br />  android:layout_width="fill_parent"<br />  android:layout_height="fill_parent" <br />  androidrientation="vertical"<br />  android:background="#ff0000"<br /> &gt;<br /> &lt;/LinearLayout&gt;<br />&lt;/FrameLayout&gt;<br /></pre><br /><br />接著來撰寫主要的CODE了!<br /><br /><br /><pre class="brush: java"> <br />public class main extends TabActivity implements OnTabChangeListener {<br /> private TabHost tabHost;  //宣告一個TabHost，主機的意思。所有的TAB都要被加在裡面<br /> private TabSpec tab1, tab2;  //先宣告兩個tab<br /><br /> @Override<br /> public void onCreate(Bundle savedInstanceState) {<br />  super.onCreate(savedInstanceState);<br />  tabHost = this.getTabHost(); //先取得TabHost<br />  <br />  //利用Inflater來渲染版變<br />  LayoutInflater.from(this).inflate(R.layout.main,tabHost.getTabContentView(), true);<br />  <br />  //接著就利用newTabSpec新增一個TAB，setIndicator是設定TITLE和背景圖，setContent是設定這個TAB裡面的樣式<br />  tab1 = tabHost.newTabSpec("Id1")<br />      .setIndicator("Tab1",this.getResources().getDrawable(R.drawable.icon2))<br />      .setContent(R.id.tab1);<br />  //加入至tabHost<br />  tabHost.addTab(tab1);<br />  <br />  tab2 = tabHost.newTabSpec("Id2")<br />      .setIndicator("Tab2",this.getResources().getDrawable(R.drawable.icon))<br />      .setContent(R.id.tab2);<br />  tabHost.addTab(tab2);<br />  tabHost.setOnTabChangedListener(this);<br /> }<br /><br /> @Override<br /> public void onTabChanged(String tabId) {<br />  new AlertDialog.Builder(this).setTitle("Hint").setMessage(tabId)<br />    .setPositiveButton("OK", null).show();<br /> }<br />}<br /></pre><br /><br /><br /><br />基本上這樣就大功告成了!<br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/07/26/android-tab-activity" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>讓android app安裝在SD card</h1>

      <div class="entry">
        怎麼讓android app安裝在SDcard裡面去?<br /><br />這個問題我研究了一陣子==<br /><br />一直以為是上傳至MARKET有個選項讓我們勾(Application can be copied from the device)<br /><br />以為勾了就可以使那隻APP能夠安裝到記憶卡裡去==<br /><br />原來不是!<br /><br />是要在AndroidManifest.xml裡面插入一個attributes<br /><br />如下<br /><br /><pre class="brush: xml">&lt;manifest <br />      xmlns:android="http://schemas.android.com/apk/res/android"<br />      android:installLocation="preferExternal"&gt;<br /><br /></pre><br />使用<span class="Apple-style-span" style="font-family: monospace; white-space: pre;">android:installLocation此屬性即可，有三個選項</span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><br /></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;">1.internalOnly(只能安裝在手機裡)</span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><br /></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;">2.</span><span class="Apple-style-span" style="font-family: monospace; white-space: pre;">preferExternal(自動安裝至記憶卡裡)</span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;"><br /></span><br /><span class="Apple-style-span" style="font-family: monospace; white-space: pre;">3.auto(就是讓使用者自己選啦)</span><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/07/21/android-appsd-card" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>如何製作一個chrome extension</h1>

      <div class="entry">
        <br />如何製作一個chrome extension!<br /><br />其實chrome extension大概分為兩種!<br /><br />一種是serverless的<br /><br />一種是extings Web server的!<br /><br />這邊主要作serverless的介紹!<br /><br />1.首先先建立一個資料夾，例如: C:/chrome_app/<br /><br />2.在資料夾裡面建立一個檔名為manifest的json檔案，如：manifest.json<br /><br />內容格式如下：<br /><br /><pre class="brush: jscript">{<br />  "name": "just sample",<br />  "version": "1.0",<br />  "description": "hello, this is ken's sample",<br />  "browser_action": {<br />      "default_icon": "icon.png",<br />      "popup"       : "popup.html"<br />  }<br />}<br /></pre><br /><br />name &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ：你的chrome app 名稱<br />vserions &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;：你的版本別<br />description&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;：敘述<br />browser_action &nbsp;：是這支app的一些基本設定，有很多種，大家可以去看官方的說明文件<br />default_icon &nbsp; &nbsp; &nbsp;&nbsp;：是這支app的logo<br />popup &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ：是當按下這支app時，所呈現的畫面頁面<br /><br /><br />3.接著就把你的icon放到C:/chrome_app/底下去<br /><br />4.在資料夾裡面建立一個檔名為popup.html的檔案<br /><br />內容格式如下：<br /><br /><br /><pre class="brush: html">&lt;html&gt;<br /> <br /> &lt;body &gt;<br />     &lt;img src="http://www.google.com/ig/images/weather/sunny.gif" /&gt;<br />&lt;/body&gt;<br /> <br />&lt;/html&gt;<br /><br /><br /><br /><br /></pre>這樣一個簡易的APP就完成了!<br /><br /><br />那要放上去我們的瀏覽器呢?<br /><br />其實這分成兩種<br /><br />一種是本地端的使用<br /><br />一種是放在Google擴充功能上給大家使用<br /><br />先教第一種!<br /><br />首先先點選瀏覽器上的扳手按鈕<br /><br />在點選擴充功能<br /><br />在點選載入未封裝功能<br /><br />這樣就完成了啊!!!<br /><br />第二種是上傳至google去<br /><br />先至此網站<a href="https://chrome.google.com/extensions/developer/dashboard?hl=zh-TW">https://chrome.google.com/extensions/developer/dashboard?hl=zh-TW</a><br /><br />接著就add new item<br /><br />並且把剛剛的資料夾壓縮成zip檔案<br /><br />然後上傳上去即可!<br /><br />之後會請你做一些chrome的說明!<br /><br />例如放圖片之類的!<br /><br />這邊是簡易的使用啦!<br /><br />日後有機會再作深入的介紹!<br /><br /><br />我也做了一個正妹報時的Chrome的擴充功能<br /><br /><a href="https://chrome.google.com/extensions/detail/bagkcnhpbahjemhkogojcondikbciebp?hl=en">https://chrome.google.com/extensions/detail/bagkcnhpbahjemhkogojcondikbciebp?hl=en</a><br /><br />可以安裝玩看看!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/07/11/chrome-app" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>nexus android 2.2 ota開始了!!</h1>

      <div class="entry">
        嘿!在前天早上十點的時候收到OTA...真是太開心了!<br /><br />我的手機版本是T-mobile的版本!!之前是2.1 update-1的版本!<br /><br />但是當時正在學校等meeting..根本無法拍下畫面...<br /><br />只好事後上傳一些更新完成後的照片摟!<br /><br />可以從下面這張圖片看到此次OTA更新的版本別為FRF85B喔!<br /><br /><br /><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TCt7rLqhiQI/AAAAAAAAAIg/2d91_6cXuHk/s1600/1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TCt7rLqhiQI/AAAAAAAAAIg/2d91_6cXuHk/s320/1.png" width="192" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />更新過後的桌面會多了一個算是widget的東西(只是不能刪除)<br /><br />最左邊的就是撥打電話的功能，中間就是開啟功能列表，最右邊就是開起瀏覽器摟<br /><br /><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/TCt7up6mslI/AAAAAAAAAIo/ILK52IfHJUU/s1600/2.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/_6SxqtkJQECI/TCt7up6mslI/AAAAAAAAAIo/ILK52IfHJUU/s320/2.png" width="192" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />且從JVM改成JIT以後，可用記憶體大大的提升了!<br /><br />圖中最下方有顯是可用記憶體大概是234+55MB!<br /><br />的確是順蠻多的!<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TCt8SP4h0XI/AAAAAAAAAI4/5nJMTnHJxcU/s1600/4.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TCt8SP4h0XI/AAAAAAAAAI4/5nJMTnHJxcU/s320/4.png" width="192" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />且可以把某些app移至SD card裡去，但目前只有一些些可以移而已!<br /><br />正在check哪些可以，為什麼可以?<br /><br />解決以後再跟大家說!<br /><br /><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TCt8S4gjH6I/AAAAAAAAAJA/puCXibsepkE/s1600/5.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TCt8S4gjH6I/AAAAAAAAAJA/puCXibsepkE/s320/5.png" width="192" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />對了!此次的更新..也支援中文語音搜尋喔!<br /><br />辨識度還算高啦!<br /><br />且在通話紀錄的方面，也變得比較有規律，<br /><br />以前譬如打給了A 10通電話，在通話紀錄裡可是會SHOW出連續的10通==可是很礙眼的!<br /><br />現在不會喔，會像圖中一樣顯示， 會在括號()中顯示你打了幾通電話。<br /><br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/TCt9rE56CaI/AAAAAAAAAJI/Zvs01RN5iUY/s1600/6.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://4.bp.blogspot.com/_6SxqtkJQECI/TCt9rE56CaI/AAAAAAAAAJI/Zvs01RN5iUY/s320/6.png" width="192" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />先這樣了!希望拿n1的朋友們也可以快點收到OTA通知!!<br /><br />繼續來把玩我的N1了!<br /><br />有發現到什麼新功能在PO上來!<br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/07/01/nexus-android-22-ota" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android avd 無法開啟(中文路徑的問題)</h1>

      <div class="entry">
        幫人解決了好幾次這樣的問題!<br /><br />好幾次avd都無法開啟!<br /><br />都卡在ANDROID這樣的字樣畫面!!<br /><br />是因為avd是不能建立在中文目錄底下的!!!<br /><br />有些人的C曹會以中文姓名命名!<br /><br />但可惜的是，android是不允許這樣的事情發生的!<br /><br />因此我們必須手動移動我們的avd至英文目錄底下去!<br /><br /><br />android move avd -n <span class="Apple-style-span" style="color: red;">avd名稱</span> -p <span class="Apple-style-span" style="color: red;">要移至的路徑，記得要是英文路徑</span>
      </div>

      <a href="/2010/06/20/android-avd" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>GAE/J deploy 失敗，使用appcfg rollback</h1>

      <div class="entry">
        GAE/J deploy 失敗<br /><br />今天一直在上傳，但也因為邊看世足!<br /><br />就沒有去注意錯誤訊息!<br /><br />只知道後來是不能上傳的!<br /><br />後來想說新增一個version，然後上傳上去!<br /><br />再把舊的version刪掉!<br /><br />但發現也不能!<br /><br />GAE一直叫我rollback!<br /><br />沒辦法啦!<br /><br />只好打開cmd了~<br /><br />找到你app engine的sdk目錄，/bin底下有個command，"appcfg.cmd"這個!<br /><br />不是.sh的，.sh是for mac osX的!<br /><br /><br /><br />指令：<span class="Apple-style-span" style="color: red;">appcfg.cmd rollback </span><span class="Apple-style-span" style="color: blue;">你project的war路徑</span><br /><br />就可以解除封鎖!<br /><br />就可以繼續update你的project了喔~<br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/06/14/gaej-deploy-appcfg-rollback" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android 判斷是否有網路</h1>

      <div class="entry">
        很多android app都和網路脫不了關係!<br /><br />但是也很多設計不良的app，本身是需要網路連線，但他卻沒有做判斷。<br /><br />這是app就會出現error!<br /><br />下面是判斷有無網路的code...<br /><br />但是要先加入一個permission...如下!<br /><br /><br /><br /><pre class="brush: xml">&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"&gt;&lt;/uses-permission&gt;</pre><br /><br /><br />這邊就是判斷的code了<br /><br /><br /><pre class="brush: java">ConnectivityManager conManager = (ConnectivityManager) getSystemService(CONNECTIVITY_SERVICE);//先取得此service<br /><br />NetworkInfo networInfo = conManager.getActiveNetworkInfo();       //在取得相關資訊<br /><br />if (networInfo == null || !networInfo.isAvailable()){ //判斷是否有網路<br /><br /> new AlertDialog.Builder(main.this)<br /> .setMessage("沒")<br /> .show();<br /><br />}else{<br /><br /> new AlertDialog.Builder(main.this)<br /> .setMessage("有")<br /> .show();<br /><br />}</pre><br /><br /><br /><br />
      </div>

      <a href="/2010/06/04/android" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>GAE 使用 Google Calendar (使用AuthSub認證)</h1>

      <div class="entry">
        <span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">如果想要使用Google Data API，在Google中有幾種認證提供選擇!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">在這裡利用AuthSub來做說明!!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">在Google App Engine中使用Google行事曆!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">首先我們必須先去申請AuthSub!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><a href="https://www.google.com/accounts/ManageDomains">網址在這</a>!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">然後必須先AddDomain!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">這邊我們加入了一個Domain為: ken-note.<span class="Apple-style-span" style="color: blue;">appspot.com</span></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">注意:一定要是根目錄!不能是: ken-note.<span class="Apple-style-span" style="color: blue;">appspot.com</span><span class="Apple-style-span" style="color: red;">/login</span></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">新增成功後呢!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">Google必須驗證此Domain的擁有權是否為你的!</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">有三種新增方式:</div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div><ol><li>中繼標記 &nbsp; &nbsp;(就是把code放在head之中)</li><li>上載HTML檔 &nbsp; (Google會提供一個HTML檔案，把它上傳至gae後，按驗證即可)</li><li>新增DNS記錄 &nbsp; &nbsp; (因為一定要是domain的擁有人才可以新增，我們不是<span class="Apple-style-span" style="color: blue;">appspot.com的</span>擁有人，因此不能新增)</li></ol><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">這邊我們用第一個例子來做說明!</div></div></div><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div></div></div><div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">只要在您首頁的header加入meta，譬如是:<span class="Apple-style-span" style="color: red;">index.jsp</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">如:</div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><pre class="brush: html" style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">&lt;head&gt;<br />&lt;meta name="google-site-verification" content="bHmA4RSzJdTse8mArcUO47g0rLfAYTOjxsq9E7i6sog" /&gt;<br /><br />&lt;/head&gt;<br /><br /></pre><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;">接著上傳上去以後，回到驗證擁有權的頁面!<br /><br />按下驗證，驗證成功後<br /><br />會到下個頁面去<br /><br />如圖<br /><br /><br /><br /><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/TAM4Ci6DWtI/AAAAAAAAAII/tlAm0aVNE5Y/s1600/2222.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="376" src="http://3.bp.blogspot.com/_6SxqtkJQECI/TAM4Ci6DWtI/AAAAAAAAAII/tlAm0aVNE5Y/s640/2222.png" width="640" /></a></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><br /><br /><br /><br /><br />在上圖的<span class="Apple-style-span" style="color: red;">紅色</span>方塊中，我們需填入我們需要對Google行事曆作操作的page..<br /><br />在這個例子就是<span class="Apple-style-span" style="color: red;">http://ken-note.appspot.com</span><span class="Apple-style-span" style="color: blue;">/select/calendar</span><br /><br />接著按下save即可!!<br /><br />申請工作就完成了!!<br /><br /><br />接著就來寫CODE了!<br /><br />打開你的eclipse吧!!<br /><br />首先必須先產生一個連結!<br /><br />讓使用者點選!<br /><br />點選以後會到一個頁面(Google給您的)來做確認是否要存取行事曆!<br /><br />那段CODE如下<br /><br /><br /><pre class="brush: java">&lt;%<br /><br />String strUrl= AuthSubUtil.getRequestUrl("http://ken-note.appspot.com/select/calendar","http://www.google.com/calendar/feeds/",false,true);<br /><br />String strLink = "&lt;a href=\"" + strUrl + "\" "+onclick+"&gt;點選此處登入Google行事曆。&lt;/a&gt;";<br /><br />%&gt;<br /><br />&lt;%=strLink %&gt;<br /><br /></pre><br /><br />AuthSubUtil.getRequestUrl(填入如在驗證擁有權的page,填入要存取的服務,false,true);<br /><br /><br /><br />接著就來寫對google行事曆作操作的code!<br /><br />就是該<span class="Apple-style-span" style="color: red;">/select/calendar</span> page<br /><br /><br /><pre class="brush: java"> <br />CalendarService cs = new CalendarService("test"); //先create一個Calendar Service的Object<br /><br /> String token = AuthSubUtil.getTokenFromReply(request.getQueryString()); //接著要取得token，token是google回傳給您的<br /><br /> token = AuthSubUtil.exchangeForSessionToken(token, null); //進行轉換的動作!<br /><br /> cs.setAuthSubToken(token);   <br /><br /> java.net.URL feedUrl = new java.net.URL("http://www.google.com/calendar/feeds/default/allcalendars/full");<br /><br /> CalendarFeed resultFeed = cs.getFeed(feedUrl, CalendarFeed.class); //進行連線<br /><br /> <br /><br /> for (int i = 0; i &lt; resultFeed.getEntries().size(); i++) {<br /><br /> CalendarEntry entry = resultFeed.getEntries().get(i);<br /><br /> response.getWriter().print(entry.getTitle().getPlainText()); //取得行事曆的內文，entry(CalendarEntry)底下有很多method，大家可以自行試試看   <br /><br />&nbsp;<br /><br /> } </pre><br /><br /><br />照著上列步驟操作即可完成對Google 行事曆作操作了!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /></div></div></div></span></span>
      </div>

      <a href="/2010/05/31/gaejgoogle-authsub" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android 刪除 process</h1>

      <div class="entry">
        &nbsp;一般來說在ANDROID!<br /><br />如果你按下返回按鍵!<br /><br />或者按下HOME那顆按鈕!<br /><br />雖然程式看似被關閉了!<br /><br />但其實他的process還是存在的!<br /><br />要怎麼徹底砍掉該process呢?<br /><br />如下段CODE!<br /><br /><br /><br /><pre class="brush: java"><br />@Override<br />protected void onDestroy() {<br />     super.onDestroy();<br />     android.os.Process.killProcess(android.os.Process.myPid());<br />}<br /><br /></pre><br /><br /><br /><br />如果是在AVD裡面想要看是否真的有砍掉的話!<br /><br />可以用ddms來觀看!<br /><br />在你的sdk/tools/目錄底下!<br /><br />打開後，可以按Device-&gt;Show process來觀看喔!<br /><br /><br />如果是在真實手機!<br /><br />那就請去下載一些task的app吧!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/05/28/android-process" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android button background 效果</h1>

      <div class="entry">
        <br /><br />如果想在android製作不同的button效果！<br /><br />要先建立一個<span class="Apple-style-span" style="color: red;">自己取檔名.xml（這裡暫取</span><span class="Apple-style-span" style="color: blue;">button_style</span><span class="Apple-style-span" style="color: red;">)檔</span>！放在drawable底下！<br /><br />並且準備三張button的圖片！<br /><br />建議使用9-patch產生的圖片！這樣比較不會失真！<br /><br />至於如何用9-patch就看之前的教學文章吧！<br /><br />這三張圖片一樣放在drawable底下！<br /><br /><br /><br /><span class="Apple-style-span" style="color: blue;">button_style</span><span class="Apple-style-span" style="color: red;">.xmll</span>格式如下<br /><br /><br /><pre class="brush: xml;"><br />&lt;?xml version="1.0" encoding="utf-8"?&gt; &nbsp; &nbsp;<br />&lt;selector xmlns:android="http://schemas.android.com/apk/res/android"&gt;<br /><br />&nbsp;&nbsp; &nbsp;&lt;item  android:state_pressed="true"android:drawable="@drawable/button_pressed" /&gt;<br /><br />&nbsp;&nbsp; &nbsp;&lt;item android:state_focused="true" android:drawable="@drawable/button_focused" /&gt;<br /><br />&nbsp;&nbsp; &nbsp;&lt;item android:state_focused="false" android:state_pressed="false" android:drawable="@drawable/button_normal" /&gt;<br /><br />&lt;/selector&gt;<br /><br /></pre><br /><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="font-size: x-large;">android:state_focused="false" android:state_pressed="false"</span></span><br />意思是button預設的樣子！既沒有受到焦點、也沒有被按的狀態下的樣子！<br /><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="font-size: x-large;">android:state_focused="true"</span></span><br />意思是當button被焦點時的樣子！<br /><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="font-size: x-large;">android:state_pressed="true"</span></span><br />意思是當button被按下時的樣子！<br /><br /><br />接著在main.xml中的button的屬性裡加入一個屬性！<br />把button的background設為我們剛剛為它特別設計的樣式！<br /><br />這樣就可以為你的BUTTON設置特別的效果喔! <pre class="brush: java;"><br />android:background="@drawable/button_style"<br /></pre><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/05/21/dfdfd" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Android Designing for Performance</h1>

      <div class="entry">
        Android官方發布了一篇有關效能改進的文章，<br />這篇<a href="http://developer.android.com/guide/practices/design/performance.html">文章</a>裏面講到了幾點有關於效能改進的！<br />下面列出幾點來說明<br /><br /><div style="background: #d8d8d8;"><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; line-height: 24px;">A somewhat more radical idea is to slice up multidimensional arrays into parallel single one-dimension arrays</span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"></span></div><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;">意思是說建立一個多維陣列的效能會比建立多個平行式的一維陣列來的差！</span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><span class="Apple-style-span" style="font-family: Arial; line-height: normal;"></span></span><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"></div><div style="background: #d8d8d8;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;">When processing strings, don't hesitate to use specialty methods like String.indexOf(), String.lastIndexOf(), and their cousins. These are typically implemented in C/C++ code that easily runs 10-100x faster than doing the same thing in a Java loop.</span><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"></span></div></div><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;">意思是說不要猶豫使用indexOf()等等String.method之類！</span><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;">因為他們都是用C/C++去implement的！他們會比用JAVA迴圈來的快！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;"><br /></span></span></div>&lt;div apple-style-span"=""&gt;&lt;div apple-style-span"=""&gt;&lt;div apple-style-span"=""&gt;<div style="background: #d8d8d8;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;">If you don't need to access an object's fields, make your method static. It can be called faster, because it doesn't require a virtual method table indirection</span><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"></span></span></div></div></div><span class="Apple-style-span" style="font-family: arial, sans-serif;"> </span><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;">意思叫你盡量用static method，這就不多作解釋！懂java的人應該要懂static和non-statc的差別！</span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;">最後一點是，避免使用getter/setter， </span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;">下列有段code，看出瑕疵的地方嗎？</span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><br /></span></div><pre class="brush: java">for (int i = 0; i &lt; this.getCount(); i++)<br />    dumpItems(this.getItem(i));<br /></pre><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;">答案就是別在for迴圈作this.getCount()這種操作！很浪費！！</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;">請先宣告個變數，再放到ＦＯＲ迴圈裡面</span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="font-family: arial, sans-serif; line-height: 24px;"><br /></span></span></div><br /><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;"><br /></span></span></div><div style="margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px;"><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 24px;"><br /></span></span></div><br /><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 19px; line-height: 24px;"><br /></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 19px; line-height: 24px;"><br /></span>
      

      <a href="/2010/05/21/android-designing-for-performance" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Draw 9-patch</h1>

      <div class="entry">
        Draw 9-patch是android sdk裡面內建的一支程式<br /><br />可以讓圖變長、變寬也不會失真!!<br /><br />這支程式在你的SDK目錄的tools底下!<br /><br />檔名為:<span class="Apple-style-span" style="color: red;">draw9patch.bat</span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br />打開軟體以後<br /><br />可以直接把你.PNG類型的檔案直接拖曳至軟體中!<br /><br />也可以點選<span class="Apple-style-span" style="color: red;">File-&gt;</span><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: red;">Open 9-patch...&nbsp;</span><span class="Apple-style-span" style="color: black;">來開啟</span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">打開圖片以後!</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">底下會有兩條scroll bar!</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><span class="Apple-style-span" style="font-size: 16px;">如圖:</span></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/_6SxqtkJQECI/S_UkakqXoTI/AAAAAAAAAH4/AoCJ9jnodpI/s1600/%E6%9C%AA%E5%91%BD%E5%90%8D.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="38" src="http://1.bp.blogspot.com/_6SxqtkJQECI/S_UkakqXoTI/AAAAAAAAAH4/AoCJ9jnodpI/s400/%E6%9C%AA%E5%91%BD%E5%90%8D.png" width="400" /></a></div><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><span class="Apple-style-span" style="color: red;">Zoom：</span>只是單純讓你放大，比較好操作，不會對最終檔案有甚麼差異！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><span class="Apple-style-span" style="color: red;">Patch scale：</span>只是讓你看圖片最終變長、變寬以後的樣子。在你儲存前都可以修改！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">接著就要對圖片作操作了！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">圖片的周圍會圍繞著1px寬度的空白！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">是為了讓你點選要重複的區域！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">通常你只要點左邊和上面就好！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">只要點1px即可！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">如圖：</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/S_UmqqoAinI/AAAAAAAAAIA/hKbJdliZkUU/s1600/%E6%9C%AA%E5%91%BD%E5%90%8D.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://2.bp.blogspot.com/_6SxqtkJQECI/S_UmqqoAinI/AAAAAAAAAIA/hKbJdliZkUU/s320/%E6%9C%AA%E5%91%BD%E5%90%8D.png" /></a></div><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">接著可以拉下面<span class="Apple-style-span" style="color: red;">Patch scale</span>這條看看效果如何！！！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">如果滿意！就點選<span class="Apple-style-span" style="color: red;">File-&gt;Save XXX</span>搂！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">儲存的檔名會是 <span class="Apple-style-span" style="color: red;">你取的檔名</span><span class="Apple-style-span" style="color: blue;">.9</span><span class="Apple-style-span" style="color: red;">.png</span></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">.9是他的規則！不用修改！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;">這樣你的圖片就不會失真了！！！</span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="font-family: arial, sans-serif;"><span class="Apple-style-span" style="line-height: 20px;"><br /></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: #333333; font-family: arial, sans-serif; font-size: 16px; line-height: 20px;"><span class="Apple-style-span" style="color: black;"><br /></span></span>
      </div>

      <a href="/2010/05/20/draw-9-patch" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android 移除狀態列、移除標題</h1>

      <div class="entry">
        一般android程式預設會有系統的狀態列和app的標題列。<br /><br />如下圖。<br /><br /><a href="http://3.bp.blogspot.com/_6SxqtkJQECI/S_PZv2SGn1I/AAAAAAAAAHg/4UFD6tUr54s/s1600/1.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://3.bp.blogspot.com/_6SxqtkJQECI/S_PZv2SGn1I/AAAAAAAAAHg/4UFD6tUr54s/s320/1.png" /></a><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />如果想要移除狀態列就<br /><br />輸入下段code<br /><br /><br /><pre class="brush: java;"><br />this.getWindow().setFlags(<br />                   WindowManager.LayoutParams.FLAG_FULLSCREEN,<br />                   WndowManager.LayoutParams.FLAG_FULLSCREEN<br />                          );<br /></pre><br /><br />呈現結果如下圖<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://2.bp.blogspot.com/_6SxqtkJQECI/S_Papn7uINI/AAAAAAAAAHo/ixaFc4ISNuE/s1600/2.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" height="320" src="http://2.bp.blogspot.com/_6SxqtkJQECI/S_Papn7uINI/AAAAAAAAAHo/ixaFc4ISNuE/s320/2.png" width="212" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />如果要移除標題列就輸入下段CODE<br /><br /><br /><pre class="brush: java;"><br />requestWindowFeature(Window.FEATURE_NO_TITLE); &nbsp;<br /></pre><br /><br /><br />結果如下圖<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/_6SxqtkJQECI/S_PbX2mTW3I/AAAAAAAAAHw/Wuoo3XaBMjY/s1600/3.png" imageanchor="1" style="clear: left; float: left; margin-bottom: 1em; margin-right: 1em;"><img border="0" src="http://4.bp.blogspot.com/_6SxqtkJQECI/S_PbX2mTW3I/AAAAAAAAAHw/Wuoo3XaBMjY/s320/3.png" /></a></div><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />如果想要同時消失狀態列和標題，那就兩段CODE都填入就OK啦!<br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br /><br />
      </div>

      <a href="/2010/05/19/android" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>GAE/J Datastore Own Relationship 實作</h1>

      <div class="entry">
        <span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;">之前寫了gae/j datastore own relationship..</span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;">但是一時找不到放哪去!</span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;">還是來做個筆記!</span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;">實作一對多的例子!</span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br />一個帳號會對應到多個留言<br /><br />先建立一個<span class="Apple-style-span" style="color: red;">data_account.java(這個是父類別)</span><br /><br /> <br /><pre class="brush: java;"><br />//省略import<br />@PersistenceCapable(identityType = IdentityType.APPLICATION, detachable="true")<br />public class data_account {<br /><br />@PrimaryKey<br />@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)<br />@Extension(vendorName="datanucleus", key="gae.encoded-pk", value="true")<br />private String encodedKey; //編碼的Key,自動產生<br /><br />@Persistent<br />@Extension(vendorName="datanucleus" , key="gae.pk-id", value="true")<br />private Long id; //自動產生<br /><br />@Persistent<br />private String account;<br /><br />@Persistent<br />private Date date = new Date();<br /><br />@Persistent(mappedBy = "da") &nbsp;//這裡名稱是對應到data_plurk裡面的data_account xx這個名稱<br />List <data_plurk> data_plurks; &nbsp;//一對多關係的標註<data_plurk><br /><br />//setter省略<br />//getter也省略<br /><br />}<br /><br /><span class="Apple-style-span" style="font-size: small;"><br /></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;">在建立一個<span class="Apple-style-span" style="color: red;">data_plurk.java(這個是子類別)</span></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"></span></span></span><br /> <pre class="brush: java;"><br /><br />@PersistenceCapable(identityType = IdentityType.APPLICATION, detachable="true")<br />public class data_plurk {<br /><br />@PrimaryKey<br />@Persistent(valueStrategy = IdGeneratorStrategy.IDENTITY)<br />@Extension(vendorName="datanucleus", key="gae.encoded-pk", value ="true")<br />private String encodedKey; //編碼的Key,//自動產生<br /><br />@Persistent<br />@Extension(vendorName="datanucleus", key="gae.pk-id", value="true")<br />private Long id;//自動產生<br /><br />@Persistent<br />private String content;<br /><br />@Persistent<br />@Extension(vendorName="datanucleus", key="gae.parent-pk", value="true")<br />private Key plurkKey; &nbsp;//父類別的設置<br /><br />@Persistent<br />private data_account da; &nbsp;//一對一關係的標註<br /><br />//setter省略<br />//getter也省略<br /></pre>  <span class="Apple-style-span" style="font-size: small;"><br /></span><br />接著就是做insert的操作了!<br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;">建立一個<span class="Apple-style-span" style="color: red;">toInsert.java的servlet</span></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span><br /><span class="Apple-style-span" style="font-size: small;"><span class="Apple-style-span" style="font-size: 13px;"><span class="Apple-style-span" style="font-size: medium;"></span></span></span><br />   <pre class="brush: java"><br /><br />public class toInsert extends HttpServlet {<br />public void doPost(HttpServletRequest req, HttpServletResponse resp)<br />  throws IOException {<br /><br /> PersistenceManager pm = PMF.get().getPersistenceManager();<br /> try {<br />  data_account da = new data_account();<br />  da.setAccount("test");<br />  da.setDate(new Date());<br />  pm.makePersistent(da); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br />  Key daKey = KeyFactory.stringToKey(da. getEncodedKey());<br /><br />  data_plurk dp1 = new data_plurk();<br />  dp1.setConten("hi");<br />  dp1.setEmployee (da);<br />  dp1.setKey(daKey); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//將data_account設為父類別<br />  da.getPlurkSets().add(dp1); &nbsp; &nbsp; &nbsp; &nbsp;//保證data_account的一對多<br />  pm.makePersistent(dp1); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <br /><br /><br />  data_plurk dp2 = new data_plurk();<br />  dp2&nbsp;.setConten("hi");<br />  dp2&nbsp;.setEmployee (da);<br />  dp2&nbsp;.setKey(daKey); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;//將data_account設為父類別<br />  da.getPlurkSets().add(dp2&nbsp;); &nbsp; &nbsp; &nbsp; &nbsp;//保證data_account的一對多<br />  pm.makePersistent(dp2&nbsp;); &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <br /><br /> }catch(Exception e){<br />  resp.getWriter().println(e.toString());<br /> }finally {<br />  pm.close();<br /> }<br />}<br />}<br /><br /><br /></pre>
      

      <a href="/2010/05/10/gaej-datastore-own-relationship" class="read-more">Read More</a>
    
  
    <article class="post">

      <h1>android map key 申請</h1>

      <div class="entry">
        <span class="Apple-style-span" style="color: #222222; font-family: Helvetica, 'Helvetica Neue', Arial, sans-serif; font-size: 12px; line-height: 16px;"></span><br /><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">想在android裡面開發有關map應用<span class="Apple-style-span" style="color: #333333; font-family: 'trebuchet ms', verdana, arial, sans-serif; font-size: small; font-weight: bold; line-height: normal; white-space: normal;">&nbsp;<code><br /></code></span></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">必須先去申請map key!</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">請先打開eclipse</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">接著點選windows-&gt;preferences-&gt;android-&gt;build</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">找到Default debug keystore，把位置複製下來。</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">接著打開cmd..</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">然後cd 到java/jdk/bin目錄底下，輸入下面指令</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">keytool.exe -list -alias <span style="color: red;">androiddebugkey</span> -keystore <span style="color: red;">"C:\Users\ken\.android\debug.keystore"</span> -storepass android -keypass android</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">接著會回傳一段MD5過後的結果!</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">請複製下來!</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">接著到</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"><a href="http://code.google.com/intl/zh-TW/android/maps-api-signup.html">http://code.google.com/intl/zh-TW/android/maps-api-signup.html</a></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">此處去登記!</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">即可得到map API key!!!</pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;"><br /></pre><pre class="geshifilter-text" style="border-bottom-width: 0px; border-color: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; font-family: inherit; font-size: 0.8em; font-style: inherit; font-weight: inherit; font: normal normal normal 1em/normal 'andale mono', 'lucida console', monospace; line-height: 1.5; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; overflow-x: auto; overflow-y: visible; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline; white-space: pre;">（切記！！！上面的紅色的參數，都是Android預設的，也就是說這把key只能用在本機開發測試用！因為要上傳至Android Market會自己create一把key，然後用那把key去sigin and export出來，所以預設的key和自己create的key所產生的md5結果會不同）</pre>
      </div>

      <a href="/2010/05/03/android-map-key" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>android 2.0 以上 app_widget不支援每秒update一次</h1>

      <div class="entry">
        android 2.0 以上 app_widget不支援每秒update一次<br /><br />最小時間是三十分鐘..<br /><br />這邊利用thread去做到每秒執行很多次...<br /><br />首先我們要先建立一個widget的設定檔<br /><br /><span class="Apple-style-span" style="color: red;">xml/analog_appwidget.xml</span><br /><br /> <pre class="brush: xml"><br />&lt;?xml version="1.0" encoding="utf-8"?&gt;<br />&lt;appwidget-provider xmlns:android="http://schemas.android.com/apk/res/android" &nbsp;<br />&nbsp;&nbsp;android:minWidth="146dip" &nbsp;<br />&nbsp;&nbsp;android:minHeight="146dip" &nbsp;<br />&nbsp;&nbsp;android:updatePeriodMillis="1000" &nbsp;<br />&nbsp;&nbsp;android:initialLayout="@layout/analog_appwidget" &gt; &nbsp;<br />&lt;/appwidget-provider&gt; &nbsp;<br /></pre>   <span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><br /></span><br /><span class="Apple-style-span" style="color: black;">以及widget的樣式</span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: red;">layout/analog_appwidget.xml</span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"></span></span><br />  <pre class="brush: xml"><br />&lt;?xml version="1.0" encoding="utf-8"?&gt;<br /><br />&lt;LinearLayout<br />  android:id="@+id/LinearLayout01"<br />  android:layout_width="fill_parent"<br />  android:layout_height="fill_parent"<br />  xmlns:android="http://schemas.android.com/apk/res/android"&gt;<br />   <br />   &nbsp;&lt;TextView<br />   &nbsp;  android:id="@+id/TextView01"<br />   &nbsp;  android:layout_width="wrap_content"<br />   &nbsp;  android:layout_height="wrap_content"<br />   &nbsp;  android:text="efefefefefef"&gt;<br />   &nbsp;&lt;/TextView&gt;<br />&lt;/LinearLayout&gt;<br /></pre>        <span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><br /></span><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: black;">接著在</span>AndroidMainfest.xml<span class="Apple-style-span" style="color: black;">貼入下段</span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"></span><span class="Apple-style-span" style="color: black;"></span></span><br /><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;">  <pre class="brush: xml"> <br /> &lt;receiver android:name="AnalogAppWidgetProvider" &gt; &nbsp; <br />       &nbsp;&lt;intent-filter&gt; &nbsp; <br />       &nbsp; &nbsp;&lt;action android:name="android.appwidget.action.APPWIDGET_UPDATE" /&gt; &nbsp; <br />       &nbsp;&lt;/intent-filter&gt; &nbsp; <br />       &nbsp;&lt;meta-data android:name="android.appwidget.provider" &nbsp;&nbsp; <br />       &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; android:resource="@xml/analog_appwidget" /&gt; &nbsp; <br /> &lt;/receiver&gt;  <br /> </pre>     </span></span><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><span class="Apple-style-span" style="color: red;"><br /><span class="Apple-style-span" style="color: black;">接著開始寫CODE搂~</span><br /><span class="Apple-style-span" style="color: black;"><br /></span><br />AnalogAppWidgetProvider.java<br /><span class="Apple-style-span" style="color: black;"><br /></span><span class="Apple-style-span" style="color: black;"></span></span></span></span><br />    <pre class="brush: java">   <br /> //import省略   <br />public class AnalogAppWidgetProvider extends AppWidgetProvider { <br />    <br />   Context context_main ; <br />   AppWidgetManager app_manager; <br />   int []appWidgetId; <br />    <br />   @Override <br />   public void onUpdate(Context context, AppWidgetManager appWidgetManager, <br />     int[] appWidgetIds) { <br />    super.onUpdate(context, appWidgetManager, appWidgetIds); <br />     <br />    app_manager = appWidgetManager; <br />    context_main = context; <br />    appWidgetId = appWidgetIds; <br />     <br />    &nbsp; &nbsp;Thread thread = new Thread(new update_thread()); <br />    &nbsp; &nbsp;thread.start(); <br /> <br />   } <br />    <br />   public class update_thread implements Runnable{ <br />    @Override <br />    public void run() { <br />     int i = 0; <br />     while(true &amp;&amp; i++ &lt;100){ <br />       RemoteViews views = <br />&nbsp;new RemoteViews(context_main.getPackageName(), R.layout.analog_appwidget); <br />       views.setTextViewText(R.id.TextView01, String.valueOf(Math.random()) ); <br /> <br />       app_manager.updateAppWidget(appWidgetId, views); <br />     }       <br />    }      <br />   } <br /> <br />}    <br /></pre>    <span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: red;"><span class="Apple-style-span" style="color: black;"><br /></span><span class="Apple-style-span" style="color: black;"><br /></span><br /><span class="Apple-style-span" style="color: black;"><br /></span><br /><span class="Apple-style-span" style="color: black;"><br /></span></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br />照著上列步驟即可實現...</span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;">如果需要是以每秒去update在自行更改</span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;">此範例只是個小sample</span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /></span><br /><span class="Apple-style-span" style="color: red;"><br /><span class="Apple-style-span" style="color: black;"><br /></span><br /><span class="Apple-style-span" style="color: black;"><br /></span></span>
      </div>

      <a href="/2010/04/30/android-20-appwidgetupdate" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>Google App Engine Java 亂碼</h1>

      <div class="entry">
        <div><div>Google App Engine Java 亂碼的問題<br /><div><br /></div><div>如果在GAE有中文上傳上去以後</div><div><br /></div><div>竟然發現是亂碼</div><div><br /></div><div>盡管在eclipse的properties設為utf-8!</div><div><br /></div><div>但還是一樣!</div><div><br /></div><div>解決方法只要加入下段CODE即可!</div><div><br /></div><div><div></div></div><div><div></div><div></div><div><br /> <pre class="brush: java"><br />&lt;%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%&gt;<br /></pre> &nbsp;&nbsp;<br /></div><div><br /></div><div>其實我原本就有加入這行!</div><div><br /></div><div>但我習慣用include!<br /><br /></div><div>這段CODE我都加在一定會出現在最上面的include!</div><div><br /></div><div>但沒想到下面的竟然會無法認可!</div><div><br /></div><div><br /></div><div>所以只要在下面要呈現中文的PAGE一樣加入下列CODE即可</div><div><br /></div><div><div></div></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div></div></div>
      </div>

      <a href="/2010/04/24/google-app-engine-java" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>eclipse裡no default proposals</h1>

      <div class="entry">
        <blockquote></blockquote>重灌win7 64bit以後!<div><br /></div><div>也把eclipse裝起來!</div><div><br /></div><div>但發現在寫java時...</div><div><br /></div><div>很多提示語法都不見了!</div><div><br /></div><div>例如:  xxx.equal("");</div><div><br /></div><div>但你輸入xxx.</div><div><br /></div><div>卻沒有提示可以找!</div><div><br /></div><div><br /></div><div><br /></div><div>google了一下!</div><div><br /></div><div>找到解決方法!</div><div><br /></div><div>在eclipse點windows-&gt;preferences-&gt;Java-&gt;Editor-&gt;Content Assist-&gt;advanced</div><div><br /></div><div>接著把java proposal勾起來就行了!</div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><br /></div><div><blockquote></blockquote><blockquote></blockquote><br /></div>
      </div>

      <a href="/2010/04/11/eclipseno-default-proposals" class="read-more">Read More</a>
    </article>
  
    <article class="post">

      <h1>在Google App Engine for Java裡，開啟session</h1>

      <div class="entry">
        <div>恩~大部份的人(之前只碰過Python部分)!</div><div><br /></div><div>會以為GAE沒有支援SESSION!</div><div><br /></div><div>但在for java卻有喔!</div><div><br /></div><div>只要在<span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif; font-size: small; line-height: 23px;"> <code style="color: #007000; font-family: monospace;">appengine-web.xml</code> </span><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif; line-height: 23px;">底下加入下段code</span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="font-size: small; line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;">就可以支援了喔</span></span></div><pre class="brush: xml">   &lt;sessions-enabled&gt;true&lt;/sessions-enabled&gt;<br /></pre><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;">之前不知道!</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;">還以為沒有!</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;">用cookie+memcache來實作!</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;">真夠笨的!</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;">所以說手冊一定要看清楚@@</span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><br /></span></span></div><div><span class="Apple-style-span" style="font-family: Helvetica, Arial, sans-serif;"><span class="Apple-style-span" style="line-height: 23px;"><span class="Apple-style-span" style="font-size: medium;"><br /></span></span></span></div>
      </div>

      <a href="/2010/04/04/google-app-engine-for-javasession" class="read-more">Read More</a>
    </article>
  

</data_plurk></data_plurk></pre></div></article></div>

      </div>

    </div>

    <div id="footer">
      <div class="container">
        <p>&copy; 2015 Ken Yang
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://getbootstrap.com" target="_blank">Bootstrap</a>
        </p>
      </div>
    </div>

    





    <!-- Latest compiled and minified JavaScript, requires jQuery 1.x (2.x not supported in IE8) -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script src="/assets/themes/bootstrap-3/bootstrap/js/bootstrap.min.js"></script>
  </body>
</html>

